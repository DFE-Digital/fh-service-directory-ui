{"version":3,"sources":["tmp/js/components/analytics.js","tmp/js/components/cookie-functions.js","tmp/js/components/helpers.js","tmp/js/components/cookie-banner.js","tmp/js/components/cookies-page.js","tmp/js/bundle.js"],"names":["loadAnalytics","window","dataLayer","w","d","s","l","i","push","Date","getTime","event","f","getElementsByTagName","j","createElement","async","src","parentNode","insertBefore","document","CONSENT_COOKIE_NAME","TRACKING_LIVE_ID","COOKIE_CATEGORIES","analytics","essential","DEFAULT_COOKIE_CONSENT","Cookie","name","value","options","getCookie","deleteCookie","days","setCookie","getConsentCookie","consentCookieObj","consentCookie","JSON","parse","err","isValidConsentCookie","version","GDS_CONSENT_COOKIE_VERSION","setConsentCookie","cookieConsent","option","stringify","resetCookies","cookieType","Analytics","forEach","cookie","userAllowsCookieCategory","cookieCategory","cookiePreferences","e","console","error","userAllowsCookie","cookieName","category","indexOf","nameEQ","cookies","split","len","length","charAt","substring","decodeURIComponent","cookieString","date","setTime","toUTCString","location","protocol","hostname","nodeListForEach","nodes","callback","NodeList","prototype","call","cookieBannerAcceptSelector","cookieBannerRejectSelector","cookieBannerHideButtonSelector","cookieMessageSelector","cookieConfirmationAcceptSelector","cookieConfirmationRejectSelector","CookieBanner","$module","this","CookiesPage","init","$cookieBanner","$acceptButton","querySelector","$rejectButton","$cookieMessage","$cookieConfirmationAccept","$cookieConfirmationReject","$cookieBannerHideButtons","querySelectorAll","onCookiesPage","currentConsentCookie","CookieFunctions.getConsentCookie","CookieFunctions.isValidConsentCookie","CookieFunctions.resetCookies","removeAttribute","addEventListener","acceptCookies","bind","rejectCookies","$cookieBannerHideButton","hideBanner","setAttribute","CookieFunctions.setConsentCookie","revealConfirmationMessage","confirmationMessage","getAttribute","focus","pathname","$cookiePage","$cookieForm","$cookieFormFieldsets","$successNotification","$successLink","$cookieFormFieldset","showUserPreference","savePreferences","preventDefault","preferences","getCookieType","selectedItem","showSuccessNotification","preference","undefined","radioValue","checked","referrer","URL","href","scrollTo","id","userConsent","$cookiesPage","backLinks","link","history","back","button","getElementById","filterButton","style","display","global","factory","exports","module","define","amd","GOVUKFrontend","mergeConfigs","flattenObject","configObject","flattenedObject","flattenLoop","obj","prefix","key","Object","hasOwnProperty","prefixedKey","formattedConfigObject","arguments","extractConfigByNamespace","namespace","Error","newObject","keyParts","shift","join","I18n","translations","config","locale","documentElement","lang","normaliseString","trimmedValue","trim","isFinite","Number","normaliseDataset","dataset","out","t","lookupKey","count","getPluralSuffix","translationString","match","replacePlaceholders","formatter","hasIntlNumberFormatSupport","Intl","NumberFormat","replace","placeholderWithBraces","placeholderKey","placeholderValue","format","hasIntlPluralRulesSupport","Boolean","PluralRules","supportedLocalesOf","preferredForm","select","selectPluralFormUsingFallbackRules","warn","Math","abs","floor","ruleset","getPluralRulesForLocale","pluralRules","localeShort","pluralRule","pluralRulesMap","languages","arabic","chinese","french","german","irish","russian","scottish","spanish","welsh","n","lastTwo","last","nativeDefineProperty","supportsAccessors","ERR_ACCESSORS_NOT_SUPPORTED","ERR_VALUE_ACCESSORS","defineProperty","object","property","descriptor","Element","TypeError","propertyString","String","hasValueOrWritable","getterType","get","setterType","set","__defineGetter__","__defineSetter__","self","Function","that","isCallable","$Array","Array","$Object","ObjectPrototype","ArrayPrototype","Empty","to_string","toString","hasToStringTag","Symbol","toStringTag","fnToStr","tryFunctionObject","fnClass","genClass","strClass","array_slice","slice","array_concat","concat","array_push","max","target","bound","args","binder","result","apply","boundLength","boundArgs","x","classList","toggle","className","DOMTokenList","createElementNS","dpSupport","defineGetter","fn","configurable","el","prop","tokens","tokenMap","maxLength","addIndexGetter","preop","reindex","rSpace","test","SyntaxError","code","baseVal","toLocaleString","item","idx","contains","token","add","remove","ignore","force","constructor","native","WorkerGlobalScope","importScripts","HTMLDocument","Document","HTMLElement","interval","vbody","appendChild","frameDocument","contentWindow","cache","shiv","element","deep","childNode","childNodes","index","nodeType","elements","nativeCreateElement","loopLimit","attachEvent","propertyName","nonValue","newValue","oldValue","hasAttribute","bodyCheck","onreadystatechange","setInterval","nodeName","toLowerCase","removeChild","clearTimeout","body","readyState","addProp","o","attr","tokenList","THIS","gibberishProperty","visage","mirror","reflections","_R","HTMLLinkElement","HTMLAnchorElement","HTMLAreaElement","aB","attributes","map","attribute","propName","substr","toUpperCase","enumerable","ACCORDION_TRANSLATIONS","hideAllSections","hideSection","hideSectionAriaLabel","showAllSections","showSection","showSectionAriaLabel","Accordion","$sections","browserSupportsSessionStorage","helper","checkForSessionStorage","defaultConfig","i18n","controlsClass","showAllClass","showAllTextClass","sectionExpandedClass","sectionButtonClass","sectionHeaderClass","sectionHeadingClass","sectionHeadingTextClass","sectionHeadingTextFocusClass","sectionShowHideToggleClass","sectionShowHideToggleFocusClass","sectionShowHideTextClass","upChevronIconClass","downChevronIconClass","sectionSummaryClass","sectionSummaryFocusClass","initControls","initSectionHeaders","areAllSectionsOpen","checkIfAllSectionsOpen","updateShowAllButton","$showAllButton","$icon","$accordionControls","firstChild","$wrappershowAllText","onShowOrHideAllToggle","$section","$header","constructHeaderMarkup","setExpanded","isExpanded","onSectionToggle","setInitialState","$headerWrapper","$span","$heading","$summary","$button","nodeValue","$headingText","$headingTextFocus","innerHTML","$showToggle","$showToggleFocus","$showToggleText","getButtonPunctuationEl","$summarySpan","$summarySpanFocus","replaceChild","expanded","storeState","nowExpanded","$showHideText","newButtonText","innerText","ariaLabelParts","ariaLabelMessage","$showAllIcon","$showAllText","testString","sessionStorage","setItem","getItem","removeItem","exception","contentId","contentState","$punctuationEl","Window","Event","unlistenableWindowEvents","click","dblclick","keyup","keypress","keydown","mousedown","mouseup","mousemove","mouseover","mouseenter","mouseleave","mouseout","storage","storagecommit","textinput","existingProto","type","eventInitDict","createEvent","bubbles","cancelable","initEvent","createEventObject","writable","listener","_events","eventElement","list","events","returnValue","stopPropagation","cancelBubble","stopImmediatePropagation","cancelImmediate","currentTarget","relatedTarget","fromElement","srcElement","timeStamp","clientX","pageX","scrollLeft","pageY","clientY","scrollTop","removeEventListener","splice","detachEvent","dispatchEvent","cancelBubbleEvent","fireEvent","parentWindow","array","Button","debounceFormSubmitTimer","preventDoubleClick","handleKeyDown","debounce","keyCode","setTimeout","DEBOUNCE_TIMEOUT_IN_SECONDS","Details","closestAttributeValue","$element","attributeName","closestElementWithAttribute","closest","open","polyfillDetails","$content","performance","now","c","r","random","tabIndex","polyfillHandleInputs","polyfillSetAttributes","node","matches","webkitMatchesSelector","oMatchesSelector","msMatchesSelector","mozMatchesSelector","selector","ownerDocument","SVGElement","parentElement","CHARACTER_COUNT_TRANSLATIONS","charactersUnderLimit","one","other","charactersAtLimit","charactersOverLimit","wordsUnderLimit","wordsAtLimit","wordsOverLimit","textareaDescription","CharacterCount","threshold","datasetConfig","configOverrides","maxlength","maxwords","$textarea","$visibleCountMessage","$screenReaderCountMessage","lastInputTimestamp","Checkboxes","$inputs","ErrorSummary","disableAutoFocus","NotificationBanner","Header","$menuButton","$menu","menuIsOpen","mql","Radios","SkipLink","$linkedElement","linkedElementListener","Tabs","$tabs","keys","left","right","up","down","jsHiddenClass","$textareaDescription","insertAdjacentElement","bindChangeEvents","updateCountMessage","handleKeyUp","handleFocus","handleBlur","updateVisibleCountMessage","valueChecker","updateIfValueChanged","clearInterval","updateScreenReaderCountMessage","remainingNumber","isOverThreshold","getCountMessage","text","countType","formatCountMessage","translationKeySuffix","currentLength","$input","syncAllConditionalReveals","handleClick","syncConditionalRevealWithInputState","$target","inputIsChecked","unCheckAllInputsExcept","$inputWithSameName","form","unCheckExclusiveInputs","$exclusiveInput","setFocus","focusTarget","tagName","inputId","getFragmentFromUrl","$legendOrLabel","getAssociatedLegendOrLabel","scrollIntoView","preventScroll","url","pop","$fieldset","legends","$candidateLegend","legendTop","getBoundingClientRect","top","inputRect","height","innerHeight","matchMedia","syncState","addListener","handleMenuButtonClick","$clickedInput","hasSameFormOwner","getLinkedElement","focusLinkedElement","linkedElementId","removeFocusProperties","hash","nextSibling","previousSibling","setupResponsiveChecks","setup","checkMode","teardown","$tabList","$tabListItems","$item","$tab","setAttributes","boundTabClick","onTabClick","boundTabKeydown","onTabKeydown","hideTab","$activeTab","getTab","showTab","boundOnHashChange","onHashChange","unsetAttributes","$tabWithHash","changingHash","$previousTab","getCurrentTab","unhighlightTab","hidePanel","highlightTab","showPanel","panelId","getHref","$panel","getPanel","$newTab","$currentTab","createHistoryEntry","activatePreviousTab","activateNextTab","currentTab","nextTabListItem","nextElementSibling","nextTab","previousTabListItem","previousElementSibling","previousTab","tab","initAll","$scope","scope","$accordion","accordion","$characterCount","characterCount","$checkbox","$detail","$errorSummary","errorSummary","$notificationBanner","notificationBanner","$radio"],"mappings":"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","file":"bundle.js","sourcesContent":["// it doesn't make sense to do typescript type checking in a javascript file where you can't specify the type (is there a way?)\n// (f is a HTMLScriptElement but we can't cast it in js)\n// so switch off javascript compilation for this file...\n// @ts-nocheck\nexport default function loadAnalytics() {\n    // ga side: https://www.youtube.com/watch?v=28d60ejfk3s\n    // should we set up consent?: https://developers.google.com/tag-platform/devguides/consent#tag-manager\n    if (!window.dataLayer) {\n        (function (w, d, s, l, i) {\n            w[l] = w[l] || [];\n            w[l].push({\n                'gtm.start': new Date().getTime(), event: 'gtm.js'\n            });\n            var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';\n            j.async = true;\n            j.src =\n                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;\n            f.parentNode.insertBefore(j, f);\n        })(window, document, 'script', 'dataLayer', 'GTM-W6QMSGQ');\n        // nonce enabled version (if we decide to enable nonces)\n        //\n        // see: https://dev.to/matijamrkaic/using-google-tag-manager-with-a-content-security-policy-9ai\n        // <script id=\"gtmScript\" data-nonce=\"@Context.GetNonce()\" asp-add-nonce>\n        //\n        //    (function (w, d, s, l, i) {\n        //        w[l] = w[l] || [];\n        //        w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\n        //        var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true;\n        //        j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl; var n = d.querySelector('[nonce]'); n && j.setAttribute('nonce', n.nonce || n.getAttribute('nonce'));\n        //        f.parentNode.insertBefore(j, f);\n        //    }\n        //    )(window, document, 'script', 'dataLayer', 'GTM-W6QMSGQ');\n    }\n}\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvYW5hbHl0aWNzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLCtIQUErSDtBQUMvSCx3REFBd0Q7QUFDeEQsd0RBQXdEO0FBQ3hELGNBQWM7QUFFZCxNQUFNLENBQUMsT0FBTyxVQUFVLGFBQWE7SUFFakMsdURBQXVEO0lBQ3ZELHNHQUFzRztJQUV0RyxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRTtRQUVuQixDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUM7WUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7WUFBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO2dCQUN6QixXQUFXLEVBQ1AsSUFBSSxJQUFJLEVBQUUsQ0FBQyxPQUFPLEVBQUUsRUFBRSxLQUFLLEVBQUUsUUFBUTthQUM1QyxDQUFDLENBQUM7WUFBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQ3BDLENBQUMsR0FBRyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsR0FBRyxDQUFDLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFBQyxDQUFDLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztZQUFDLENBQUMsQ0FBQyxHQUFHO2dCQUNyRiw2Q0FBNkMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ2hHLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLFdBQVcsRUFBRSxhQUFhLENBQUMsQ0FBQztRQUUvRCx3REFBd0Q7UUFDeEQsRUFBRTtRQUNGLCtGQUErRjtRQUMvRix5RUFBeUU7UUFDekUsRUFBRTtRQUNGLGlDQUFpQztRQUNqQyw0QkFBNEI7UUFDNUIsNEVBQTRFO1FBQzVFLCtIQUErSDtRQUMvSCwrS0FBK0s7UUFDL0ssMENBQTBDO1FBQzFDLE9BQU87UUFDUCxnRUFBZ0U7S0FDL0Q7QUFDTCxDQUFDIiwiZmlsZSI6ImNvbXBvbmVudHMvYW5hbHl0aWNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbi8vIGl0IGRvZXNuJ3QgbWFrZSBzZW5zZSB0byBkbyB0eXBlc2NyaXB0IHR5cGUgY2hlY2tpbmcgaW4gYSBqYXZhc2NyaXB0IGZpbGUgd2hlcmUgeW91IGNhbid0IHNwZWNpZnkgdGhlIHR5cGUgKGlzIHRoZXJlIGEgd2F5PylcclxuLy8gKGYgaXMgYSBIVE1MU2NyaXB0RWxlbWVudCBidXQgd2UgY2FuJ3QgY2FzdCBpdCBpbiBqcylcclxuLy8gc28gc3dpdGNoIG9mZiBqYXZhc2NyaXB0IGNvbXBpbGF0aW9uIGZvciB0aGlzIGZpbGUuLi5cclxuLy8gQHRzLW5vY2hlY2tcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGxvYWRBbmFseXRpY3MoKSB7XHJcblxyXG4gICAgLy8gZ2Egc2lkZTogaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0yOGQ2MGVqZmszc1xyXG4gICAgLy8gc2hvdWxkIHdlIHNldCB1cCBjb25zZW50PzogaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vdGFnLXBsYXRmb3JtL2Rldmd1aWRlcy9jb25zZW50I3RhZy1tYW5hZ2VyXHJcblxyXG4gICAgaWYgKCF3aW5kb3cuZGF0YUxheWVyKSB7XHJcblxyXG4gICAgICAgIChmdW5jdGlvbiAodywgZCwgcywgbCwgaSkge1xyXG4gICAgICAgICAgICB3W2xdID0gd1tsXSB8fCBbXTsgd1tsXS5wdXNoKHtcclxuICAgICAgICAgICAgICAgICdndG0uc3RhcnQnOlxyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKCkuZ2V0VGltZSgpLCBldmVudDogJ2d0bS5qcydcclxuICAgICAgICAgICAgfSk7IHZhciBmID0gZC5nZXRFbGVtZW50c0J5VGFnTmFtZShzKVswXSxcclxuICAgICAgICAgICAgICAgIGogPSBkLmNyZWF0ZUVsZW1lbnQocyksIGRsID0gbCAhPSAnZGF0YUxheWVyJyA/ICcmbD0nICsgbCA6ICcnOyBqLmFzeW5jID0gdHJ1ZTsgai5zcmMgPVxyXG4gICAgICAgICAgICAgICAgJ2h0dHBzOi8vd3d3Lmdvb2dsZXRhZ21hbmFnZXIuY29tL2d0bS5qcz9pZD0nICsgaSArIGRsOyBmLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGosIGYpO1xyXG4gICAgICAgIH0pKHdpbmRvdywgZG9jdW1lbnQsICdzY3JpcHQnLCAnZGF0YUxheWVyJywgJ0dUTS1XNlFNU0dRJyk7XHJcblxyXG4gICAgLy8gbm9uY2UgZW5hYmxlZCB2ZXJzaW9uIChpZiB3ZSBkZWNpZGUgdG8gZW5hYmxlIG5vbmNlcylcclxuICAgIC8vXHJcbiAgICAvLyBzZWU6IGh0dHBzOi8vZGV2LnRvL21hdGlqYW1ya2FpYy91c2luZy1nb29nbGUtdGFnLW1hbmFnZXItd2l0aC1hLWNvbnRlbnQtc2VjdXJpdHktcG9saWN5LTlhaVxyXG4gICAgLy8gPHNjcmlwdCBpZD1cImd0bVNjcmlwdFwiIGRhdGEtbm9uY2U9XCJAQ29udGV4dC5HZXROb25jZSgpXCIgYXNwLWFkZC1ub25jZT5cclxuICAgIC8vXHJcbiAgICAvLyAgICAoZnVuY3Rpb24gKHcsIGQsIHMsIGwsIGkpIHtcclxuICAgIC8vICAgICAgICB3W2xdID0gd1tsXSB8fCBbXTtcclxuICAgIC8vICAgICAgICB3W2xdLnB1c2goeyAnZ3RtLnN0YXJ0JzogbmV3IERhdGUoKS5nZXRUaW1lKCksIGV2ZW50OiAnZ3RtLmpzJyB9KTtcclxuICAgIC8vICAgICAgICB2YXIgZiA9IGQuZ2V0RWxlbWVudHNCeVRhZ05hbWUocylbMF0sIGogPSBkLmNyZWF0ZUVsZW1lbnQocyksIGRsID0gbCAhPSAnZGF0YUxheWVyJyA/ICcmbD0nICsgbCA6ICcnOyBqLmFzeW5jID0gdHJ1ZTtcclxuICAgIC8vICAgICAgICBqLnNyYyA9ICdodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbS9ndG0uanM/aWQ9JyArIGkgKyBkbDsgdmFyIG4gPSBkLnF1ZXJ5U2VsZWN0b3IoJ1tub25jZV0nKTsgbiAmJiBqLnNldEF0dHJpYnV0ZSgnbm9uY2UnLCBuLm5vbmNlIHx8IG4uZ2V0QXR0cmlidXRlKCdub25jZScpKTtcclxuICAgIC8vICAgICAgICBmLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGosIGYpO1xyXG4gICAgLy8gICAgfVxyXG4gICAgLy8gICAgKSh3aW5kb3csIGRvY3VtZW50LCAnc2NyaXB0JywgJ2RhdGFMYXllcicsICdHVE0tVzZRTVNHUScpO1xyXG4gICAgfVxyXG59Il19\n","/**\n * Cookie functions\n * ================\n *\n * Used by the cookie banner component and cookies page pattern.\n *\n * Includes function `Cookie()` for getting, setting, and deleting cookies, and\n * functions to manage the users' consent to cookies.\n *\n * Note: there is an inline script in cookie-banner.njk to show the banner\n * as soon as possible, to avoid a high Cumulative Layout Shift (CLS) score.\n * The consent cookie version is defined in cookie-banner.njk\n */\nimport Analytics from './analytics.js';\n/* Name of the cookie to save users cookie preferences to. */\nvar CONSENT_COOKIE_NAME = 'service_directory_cookies_policy';\n/* Google Analytics tracking IDs for preview and live environments. */\n/*measurement ids or tag ids*/\n/*Fatayi is going to link the existing ga (this id) into gtm (as a tag), then we can check the disabling*/\n//var TRACKING_PREVIEW_ID = 'GA_TODO:STICKITHERE'\nvar TRACKING_LIVE_ID = 'G-30G6ZFTEJE';\n/* Users can (dis)allow different groups of cookies. */\nvar COOKIE_CATEGORIES = {\n    analytics: ['_ga', '_ga_' + TRACKING_LIVE_ID],\n    /* Essential cookies\n     *\n     * Essential cookies cannot be deselected, but we want our cookie code to\n     * only allow adding cookies that are documented in this object, so they need\n     * to be added here.\n     */\n    essential: ['service_directory_cookies_policy']\n};\n/*\n * Default cookie preferences if user has no cookie preferences.\n *\n * Note that this doesn't include a key for essential cookies, essential\n * cookies cannot be disallowed. If the object contains { essential: false }\n * this will be ignored.\n */\nvar DEFAULT_COOKIE_CONSENT = {\n    analytics: false\n};\n/*\n * Set, get, and delete cookies.\n *\n * Usage:\n *\n *   Setting a cookie:\n *   Cookie('hobnob', 'tasty', { days: 30 })\n *\n *   Reading a cookie:\n *   Cookie('hobnob')\n *\n *   Deleting a cookie:\n *   Cookie('hobnob', null)\n */\nexport function Cookie(name, value, options) {\n    if (typeof value !== 'undefined') {\n        if (value === false || value === null) {\n            deleteCookie(name);\n        }\n        else {\n            // Default expiry date of 30 days\n            if (typeof options === 'undefined') {\n                options = { days: 30 };\n            }\n            setCookie(name, value, options);\n        }\n    }\n    else {\n        return getCookie(name);\n    }\n}\n/** Return the user's cookie preferences.\n *\n * If the consent cookie is malformed, or not present,\n * returns null.\n */\nexport function getConsentCookie() {\n    var consentCookie = getCookie(CONSENT_COOKIE_NAME);\n    var consentCookieObj;\n    if (consentCookie) {\n        try {\n            consentCookieObj = JSON.parse(consentCookie);\n        }\n        catch (err) {\n            return null;\n        }\n    }\n    else {\n        return null;\n    }\n    return consentCookieObj;\n}\n/** Check the cookie preferences object.\n *\n * If the consent object is not present, malformed, or incorrect version,\n * returns false, otherwise returns true.\n *\n * This is also duplicated in cookie-banner.njk - the two need to be kept in sync\n */\nexport function isValidConsentCookie(options) {\n    return (options && options.version >= window.GDS_CONSENT_COOKIE_VERSION);\n}\n/** Update the user's cookie preferences. */\nexport function setConsentCookie(options) {\n    var cookieConsent = getConsentCookie();\n    if (!cookieConsent) {\n        cookieConsent = JSON.parse(JSON.stringify(DEFAULT_COOKIE_CONSENT));\n    }\n    // Merge current cookie preferences and new preferences\n    for (var option in options) {\n        cookieConsent[option] = options[option];\n    }\n    // Essential cookies cannot be deselected, ignore this cookie type\n    delete cookieConsent.essential;\n    cookieConsent.version = window.GDS_CONSENT_COOKIE_VERSION;\n    // Set the consent cookie\n    setCookie(CONSENT_COOKIE_NAME, JSON.stringify(cookieConsent), { days: 365 });\n    // Update the other cookies\n    resetCookies();\n}\n/** Apply the user's cookie preferences\n *\n * Deletes any cookies the user has not consented to.\n */\nexport function resetCookies() {\n    var options = getConsentCookie();\n    // If no preferences or old version use the default\n    if (!isValidConsentCookie(options)) {\n        options = JSON.parse(JSON.stringify(DEFAULT_COOKIE_CONSENT));\n    }\n    for (var cookieType in options) {\n        if (cookieType === 'version') {\n            continue;\n        }\n        // Essential cookies cannot be deselected, ignore this cookie type\n        if (cookieType === 'essential') {\n            continue;\n        }\n        // Initialise analytics if allowed\n        if (cookieType === 'analytics' && options[cookieType]) {\n            // Enable GA if allowed\n            window['ga-disable-' + TRACKING_LIVE_ID] = false;\n            Analytics();\n        }\n        else {\n            // Disable GA if not allowed\n            window['ga-disable-' + TRACKING_LIVE_ID] = true;\n        }\n        if (!options[cookieType]) {\n            // Fetch the cookies in that category\n            var cookiesInCategory = COOKIE_CATEGORIES[cookieType];\n            cookiesInCategory.forEach(function (cookie) {\n                // Delete cookie\n                Cookie(cookie, null);\n            });\n        }\n    }\n}\nfunction userAllowsCookieCategory(cookieCategory, cookiePreferences) {\n    // Essential cookies are always allowed\n    if (cookieCategory === 'essential') {\n        return true;\n    }\n    // Sometimes cookiePreferences is malformed in some of the tests, so we need to handle these\n    try {\n        return cookiePreferences[cookieCategory];\n    }\n    catch (e) {\n        console.error(e);\n        return false;\n    }\n}\nfunction userAllowsCookie(cookieName) {\n    // Always allow setting the consent cookie\n    if (cookieName === CONSENT_COOKIE_NAME) {\n        return true;\n    }\n    // Get the current cookie preferences\n    var cookiePreferences = getConsentCookie();\n    // If no preferences or old version use the default\n    if (!isValidConsentCookie(cookiePreferences)) {\n        cookiePreferences = DEFAULT_COOKIE_CONSENT;\n    }\n    for (var category in COOKIE_CATEGORIES) {\n        var cookiesInCategory = COOKIE_CATEGORIES[category];\n        if (cookiesInCategory.indexOf(cookieName) !== '-1') {\n            return userAllowsCookieCategory(category, cookiePreferences);\n        }\n    }\n    // Deny the cookie if it is not known to us\n    return false;\n}\nfunction getCookie(name) {\n    var nameEQ = name + '=';\n    var cookies = document.cookie.split(';');\n    for (var i = 0, len = cookies.length; i < len; i++) {\n        var cookie = cookies[i];\n        while (cookie.charAt(0) === ' ') {\n            cookie = cookie.substring(1, cookie.length);\n        }\n        if (cookie.indexOf(nameEQ) === 0) {\n            return decodeURIComponent(cookie.substring(nameEQ.length));\n        }\n    }\n    return null;\n}\n// do we need to set the domain?\nfunction setCookie(name, value, options) {\n    if (userAllowsCookie(name)) {\n        if (typeof options === 'undefined') {\n            options = {};\n        }\n        var cookieString = name + '=' + value + '; path=/; SameSite=Strict';\n        if (options.days) {\n            var date = new Date();\n            date.setTime(date.getTime() + (options.days * 24 * 60 * 60 * 1000));\n            cookieString = cookieString + '; expires=' + date.toUTCString();\n        }\n        if (document.location.protocol === 'https:') {\n            cookieString = cookieString + '; Secure';\n        }\n        document.cookie = cookieString;\n    }\n}\nfunction deleteCookie(name) {\n    if (Cookie(name)) {\n        // Cookies need to be deleted in the same level of specificity in which they were set\n        // If a cookie was set with a specified domain, it needs to be specified when deleted\n        // If a cookie wasn't set with the domain attribute, it shouldn't be there when deleted\n        // You can't tell if a cookie was set with a domain attribute or not, so try both options\n        document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/';\n        document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT;domain=' + window.location.hostname + ';path=/';\n        document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT;domain=.' + window.location.hostname + ';path=/';\n    }\n}\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvY29va2llLWZ1bmN0aW9ucy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7O0dBWUc7QUFFSCxPQUFPLFNBQVMsTUFBTSxnQkFBZ0IsQ0FBQTtBQUV0Qyw2REFBNkQ7QUFDN0QsSUFBSSxtQkFBbUIsR0FBRyxrQ0FBa0MsQ0FBQztBQUU3RCxzRUFBc0U7QUFDdEUsOEJBQThCO0FBQzlCLDBHQUEwRztBQUMxRyxpREFBaUQ7QUFDakQsSUFBSSxnQkFBZ0IsR0FBRyxjQUFjLENBQUM7QUFFdEMsdURBQXVEO0FBQ3ZELElBQUksaUJBQWlCLEdBQUc7SUFDcEIsU0FBUyxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQztJQUM3Qzs7Ozs7T0FLRztJQUNILFNBQVMsRUFBRSxDQUFDLGtDQUFrQyxDQUFDO0NBQ2xELENBQUE7QUFFRDs7Ozs7O0dBTUc7QUFDSCxJQUFJLHNCQUFzQixHQUFHO0lBQ3pCLFNBQVMsRUFBRSxLQUFLO0NBQ25CLENBQUE7QUFFRDs7Ozs7Ozs7Ozs7OztHQWFHO0FBQ0gsTUFBTSxVQUFVLE1BQU0sQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLE9BQU87SUFDdkMsSUFBSSxPQUFPLEtBQUssS0FBSyxXQUFXLEVBQUU7UUFDOUIsSUFBSSxLQUFLLEtBQUssS0FBSyxJQUFJLEtBQUssS0FBSyxJQUFJLEVBQUU7WUFDbkMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3RCO2FBQU07WUFDSCxpQ0FBaUM7WUFDakMsSUFBSSxPQUFPLE9BQU8sS0FBSyxXQUFXLEVBQUU7Z0JBQ2hDLE9BQU8sR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsQ0FBQTthQUN6QjtZQUNELFNBQVMsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQ25DO0tBQ0o7U0FBTTtRQUNILE9BQU8sU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQzFCO0FBQ0wsQ0FB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QUcsWUFBWSxHQUFHLFlBQVksR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7U0FDbkU7UUFDRCxJQUFJLFFBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxLQUFLLFFBQVEsRUFBRTtZQUN6QyxZQUFZLEdBQUcsWUFBWSxHQUFHLFVBQVUsQ0FBQztTQUM1QztRQUNELFFBQVEsQ0FBQyxNQUFNLEdBQUcsWUFBWSxDQUFDO0tBQ2xDO0FBQ0wsQ0FBQztBQUVELFNBQVMsWUFBWSxDQUFDLElBQUk7SUFDdEIsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDZCxxRkFBcUY7UUFDckYscUZBQXFGO1FBQ3JGLHVGQUF1RjtRQUN2Rix5RkFBeUY7UUFDekYsUUFBUSxDQUFDLE1BQU0sR0FBRyxJQUFJLEdBQUcsZ0RBQWdELENBQUM7UUFDMUUsUUFBUSxDQUFDLE1BQU0sR0FBRyxJQUFJLEdBQUcsaURBQWlELEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEdBQUcsU0FBUyxDQUFDO1FBQ2xILFFBQVEsQ0FBQyxNQUFNLEdBQUcsSUFBSSxHQUFHLGtEQUFrRCxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsUUFBUSxHQUFHLFNBQVMsQ0FBQztLQUN0SDtBQUNMLENBQUMiLCJmaWxlIjoiY29tcG9uZW50cy9jb29raWUtZnVuY3Rpb25zLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENvb2tpZSBmdW5jdGlvbnNcclxuICogPT09PT09PT09PT09PT09PVxyXG4gKlxyXG4gKiBVc2VkIGJ5IHRoZSBjb29raWUgYmFubmVyIGNvbXBvbmVudCBhbmQgY29va2llcyBwYWdlIHBhdHRlcm4uXHJcbiAqXHJcbiAqIEluY2x1ZGVzIGZ1bmN0aW9uIGBDb29raWUoKWAgZm9yIGdldHRpbmcsIHNldHRpbmcsIGFuZCBkZWxldGluZyBjb29raWVzLCBhbmRcclxuICogZnVuY3Rpb25zIHRvIG1hbmFnZSB0aGUgdXNlcnMnIGNvbnNlbnQgdG8gY29va2llcy5cclxuICpcclxuICogTm90ZTogdGhlcmUgaXMgYW4gaW5saW5lIHNjcmlwdCBpbiBjb29raWUtYmFubmVyLm5qayB0byBzaG93IHRoZSBiYW5uZXJcclxuICogYXMgc29vbiBhcyBwb3NzaWJsZSwgdG8gYXZvaWQgYSBoaWdoIEN1bXVsYXRpdmUgTGF5b3V0IFNoaWZ0IChDTFMpIHNjb3JlLlxyXG4gKiBUaGUgY29uc2VudCBjb29raWUgdmVyc2lvbiBpcyBkZWZpbmVkIGluIGNvb2tpZS1iYW5uZXIubmprXHJcbiAqL1xyXG5cclxuaW1wb3J0IEFuYWx5dGljcyBmcm9tICcuL2FuYWx5dGljcy5qcydcclxuXHJcbi8qIE5hbWUgb2YgdGhlIGNvb2tpZSB0byBzYXZlIHVzZXJzIGNvb2tpZSBwcmVmZXJlbmNlcyB0by4gKi9cclxudmFyIENPTlNFTlRfQ09PS0lFX05BTUUgPSAnc2VydmljZV9kaXJlY3RvcnlfY29va2llc19wb2xpY3knO1xyXG5cclxuLyogR29vZ2xlIEFuYWx5dGljcyB0cmFja2luZyBJRHMgZm9yIHByZXZpZXcgYW5kIGxpdmUgZW52aXJvbm1lbnRzLiAqL1xyXG4vKm1lYXN1cmVtZW50IGlkcyBvciB0YWcgaWRzKi9cclxuLypGYXRheWkgaXMgZ29pbmcgdG8gbGluayB0aGUgZXhpc3RpbmcgZ2EgKHRoaXMgaWQpIGludG8gZ3RtIChhcyBhIHRhZyksIHRoZW4gd2UgY2FuIGNoZWNrIHRoZSBkaXNhYmxpbmcqL1xyXG4vL3ZhciBUUkFDS0lOR19QUkVWSUVXX0lEID0gJ0dBX1RPRE86U1RJQ0tJVEhFUkUnXHJcbnZhciBUUkFDS0lOR19MSVZFX0lEID0gJ0ctMzBHNlpGVEVKRSc7XHJcblxyXG4vKiBVc2VycyBjYW4gKGRpcylhbGxvdyBkaWZmZXJlbnQgZ3JvdXBzIG9mIGNvb2tpZXMuICovXHJcbnZhciBDT09LSUVfQ0FURUdPUklFUyA9IHtcclxuICAgIGFuYWx5dGljczogWydfZ2EnLCAnX2dhXycgKyBUUkFDS0lOR19MSVZFX0lEXSwgLy8gZG8gd2UgYWxzbyBuZWVkICdfZ2lkJyA/XHJcbiAgICAvKiBFc3NlbnRpYWwgY29va2llc1xyXG4gICAgICpcclxuICAgICAqIEVzc2VudGlhbCBjb29raWVzIGNhbm5vdCBiZSBkZXNlbGVjdGVkLCBidXQgd2Ugd2FudCBvdXIgY29va2llIGNvZGUgdG9cclxuICAgICAqIG9ubHkgYWxsb3cgYWRkaW5nIGNvb2tpZXMgdGhhdCBhcmUgZG9jdW1lbnRlZCBpbiB0aGlzIG9iamVjdCwgc28gdGhleSBuZWVkXHJcbiAgICAgKiB0byBiZSBhZGRlZCBoZXJlLlxyXG4gICAgICovXHJcbiAgICBlc3NlbnRpYWw6IFsnc2VydmljZV9kaXJlY3RvcnlfY29va2llc19wb2xpY3knXVxyXG59XHJcblxyXG4vKlxyXG4gKiBEZWZhdWx0IGNvb2tpZSBwcmVmZXJlbmNlcyBpZiB1c2VyIGhhcyBubyBjb29raWUgcHJlZmVyZW5jZXMuXHJcbiAqXHJcbiAqIE5vdGUgdGhhdCB0aGlzIGRvZXNuJ3QgaW5jbHVkZSBhIGtleSBmb3IgZXNzZW50aWFsIGNvb2tpZXMsIGVzc2VudGlhbFxyXG4gKiBjb29raWVzIGNhbm5vdCBiZSBkaXNhbGxvd2VkLiBJZiB0aGUgb2JqZWN0IGNvbnRhaW5zIHsgZXNzZW50aWFsOiBmYWxzZSB9XHJcbiAqIHRoaXMgd2lsbCBiZSBpZ25vcmVkLlxyXG4gKi9cclxudmFyIERFRkFVTFRfQ09PS0lFX0NPTlNFTlQgPSB7XHJcbiAgICBhbmFseXRpY3M6IGZhbHNlXHJcbn1cclxuXHJcbi8qXHJcbiAqIFNldCwgZ2V0LCBhbmQgZGVsZXRlIGNvb2tpZXMuXHJcbiAqXHJcbiAqIFVzYWdlOlxyXG4gKlxyXG4gKiAgIFNldHRpbmcgYSBjb29raWU6XHJcbiAqICAgQ29va2llKCdob2Jub2InLCAndGFzdHknLCB7IGRheXM6IDMwIH0pXHJcbiAqXHJcbiAqICAgUmVhZGluZyBhIGNvb2tpZTpcclxuICogICBDb29raWUoJ2hvYm5vYicpXHJcbiAqXHJcbiAqICAgRGVsZXRpbmcgYSBjb29raWU6XHJcbiAqICAgQ29va2llKCdob2Jub2InLCBudWxsKVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIENvb2tpZShuYW1lLCB2YWx1ZSwgb3B0aW9ucykge1xyXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICBpZiAodmFsdWUgPT09IGZhbHNlIHx8IHZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZUNvb2tpZShuYW1lKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBEZWZhdWx0IGV4cGlyeSBkYXRlIG9mIDMwIGRheXNcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHsgZGF5czogMzAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldENvb2tpZShuYW1lLCB2YWx1ZSwgb3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZ2V0Q29va2llKG5hbWUpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKiogUmV0dXJuIHRoZSB1c2VyJ3MgY29va2llIHByZWZlcmVuY2VzLlxyXG4gKlxyXG4gKiBJZiB0aGUgY29uc2VudCBjb29raWUgaXMgbWFsZm9ybWVkLCBvciBub3QgcHJlc2VudCxcclxuICogcmV0dXJucyBudWxsLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbnNlbnRDb29raWUoKSB7XHJcbiAgICB2YXIgY29uc2VudENvb2tpZSA9IGdldENvb2tpZShDT05TRU5UX0NPT0tJRV9OQU1FKTtcclxuICAgIHZhciBjb25zZW50Q29va2llT2JqO1xyXG5cclxuICAgIGlmIChjb25zZW50Q29va2llKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc2VudENvb2tpZU9iaiA9IEpTT04ucGFyc2UoY29uc2VudENvb2tpZSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGNvbnNlbnRDb29raWVPYmo7XHJcbn1cclxuXHJcbi8qKiBDaGVjayB0aGUgY29va2llIHByZWZlcmVuY2VzIG9iamVjdC5cclxuICpcclxuICogSWYgdGhlIGNvbnNlbnQgb2JqZWN0IGlzIG5vdCBwcmVzZW50LCBtYWxmb3JtZWQsIG9yIGluY29ycmVjdCB2ZXJzaW9uLFxyXG4gKiByZXR1cm5zIGZhbHNlLCBvdGhlcndpc2UgcmV0dXJucyB0cnVlLlxyXG4gKlxyXG4gKiBUaGlzIGlzIGFsc28gZHVwbGljYXRlZCBpbiBjb29raWUtYmFubmVyLm5qayAtIHRoZSB0d28gbmVlZCB0byBiZSBrZXB0IGluIHN5bmNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkQ29uc2VudENvb2tpZShvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gKG9wdGlvbnMgJiYgb3B0aW9ucy52ZXJzaW9uID49IHdpbmRvdy5HRFNfQ09OU0VOVF9DT09LSUVfVkVSU0lPTik7XHJcbn1cclxuXHJcbi8qKiBVcGRhdGUgdGhlIHVzZXIncyBjb29raWUgcHJlZmVyZW5jZXMuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRDb25zZW50Q29va2llKG9wdGlvbnMpIHtcclxuICAgIHZhciBjb29raWVDb25zZW50ID0gZ2V0Q29uc2VudENvb2tpZSgpO1xyXG5cclxuICAgIGlmICghY29va2llQ29uc2VudCkge1xyXG4gICAgICAgIGNvb2tpZUNvbnNlbnQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KERFRkFVTFRfQ09PS0lFX0NPTlNFTlQpKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBNZXJnZSBjdXJyZW50IGNvb2tpZSBwcmVmZXJlbmNlcyBhbmQgbmV3IHByZWZlcmVuY2VzXHJcbiAgICBmb3IgKHZhciBvcHRpb24gaW4gb3B0aW9ucykge1xyXG4gICAgICAgIGNvb2tpZUNvbnNlbnRbb3B0aW9uXSA9IG9wdGlvbnNbb3B0aW9uXTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFc3NlbnRpYWwgY29va2llcyBjYW5ub3QgYmUgZGVzZWxlY3RlZCwgaWdub3JlIHRoaXMgY29va2llIHR5cGVcclxuICAgIGRlbGV0ZSBjb29raWVDb25zZW50LmVzc2VudGlhbDtcclxuXHJcbiAgICBjb29raWVDb25zZW50LnZlcnNpb24gPSB3aW5kb3cuR0RTX0NPTlNFTlRfQ09PS0lFX1ZFUlNJT047XHJcblxyXG4gICAgLy8gU2V0IHRoZSBjb25zZW50IGNvb2tpZVxyXG4gICAgc2V0Q29va2llKENPTlNFTlRfQ09PS0lFX05BTUUsIEpTT04uc3RyaW5naWZ5KGNvb2tpZUNvbnNlbnQpLCB7IGRheXM6IDM2NSB9KTtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIG90aGVyIGNvb2tpZXNcclxuICAgIHJlc2V0Q29va2llcygpO1xyXG59XHJcblxyXG4vKiogQXBwbHkgdGhlIHVzZXIncyBjb29raWUgcHJlZmVyZW5jZXNcclxuICpcclxuICogRGVsZXRlcyBhbnkgY29va2llcyB0aGUgdXNlciBoYXMgbm90IGNvbnNlbnRlZCB0by5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZXNldENvb2tpZXMoKSB7XHJcbiAgICB2YXIgb3B0aW9ucyA9IGdldENvbnNlbnRDb29raWUoKTtcclxuXHJcbiAgICAvLyBJZiBubyBwcmVmZXJlbmNlcyBvciBvbGQgdmVyc2lvbiB1c2UgdGhlIGRlZmF1bHRcclxuICAgIGlmICghaXNWYWxpZENvbnNlbnRDb29raWUob3B0aW9ucykpIHtcclxuICAgICAgICBvcHRpb25zID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShERUZBVUxUX0NPT0tJRV9DT05TRU5UKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yICh2YXIgY29va2llVHlwZSBpbiBvcHRpb25zKSB7XHJcbiAgICAgICAgaWYgKGNvb2tpZVR5cGUgPT09ICd2ZXJzaW9uJykge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEVzc2VudGlhbCBjb29raWVzIGNhbm5vdCBiZSBkZXNlbGVjdGVkLCBpZ25vcmUgdGhpcyBjb29raWUgdHlwZVxyXG4gICAgICAgIGlmIChjb29raWVUeXBlID09PSAnZXNzZW50aWFsJykge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpc2UgYW5hbHl0aWNzIGlmIGFsbG93ZWRcclxuICAgICAgICBpZiAoY29va2llVHlwZSA9PT0gJ2FuYWx5dGljcycgJiYgb3B0aW9uc1tjb29raWVUeXBlXSkge1xyXG4gICAgICAgICAgICAvLyBFbmFibGUgR0EgaWYgYWxsb3dlZFxyXG4gICAgICAgICAgICB3aW5kb3dbJ2dhLWRpc2FibGUtJyArIFRSQUNLSU5HX0xJVkVfSURdID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBBbmFseXRpY3MoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBEaXNhYmxlIEdBIGlmIG5vdCBhbGxvd2VkXHJcbiAgICAgICAgICAgIHdpbmRvd1snZ2EtZGlzYWJsZS0nICsgVFJBQ0tJTkdfTElWRV9JRF0gPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFvcHRpb25zW2Nvb2tpZVR5cGVdKSB7XHJcbiAgICAgICAgICAgIC8vIEZldGNoIHRoZSBjb29raWVzIGluIHRoYXQgY2F0ZWdvcnlcclxuICAgICAgICAgICAgdmFyIGNvb2tpZXNJbkNhdGVnb3J5ID0gQ09PS0lFX0NBVEVHT1JJRVNbY29va2llVHlwZV1cclxuXHJcbiAgICAgICAgICAgIGNvb2tpZXNJbkNhdGVnb3J5LmZvckVhY2goZnVuY3Rpb24oY29va2llKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBEZWxldGUgY29va2llXHJcbiAgICAgICAgICAgICAgICBDb29raWUoY29va2llLCBudWxsKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiB1c2VyQWxsb3dzQ29va2llQ2F0ZWdvcnkoY29va2llQ2F0ZWdvcnksIGNvb2tpZVByZWZlcmVuY2VzKSB7XHJcbiAgICAvLyBFc3NlbnRpYWwgY29va2llcyBhcmUgYWx3YXlzIGFsbG93ZWRcclxuICAgIGlmIChjb29raWVDYXRlZ29yeSA9PT0gJ2Vzc2VudGlhbCcpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTb21ldGltZXMgY29va2llUHJlZmVyZW5jZXMgaXMgbWFsZm9ybWVkIGluIHNvbWUgb2YgdGhlIHRlc3RzLCBzbyB3ZSBuZWVkIHRvIGhhbmRsZSB0aGVzZVxyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gY29va2llUHJlZmVyZW5jZXNbY29va2llQ2F0ZWdvcnldO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiB1c2VyQWxsb3dzQ29va2llKGNvb2tpZU5hbWUpIHtcclxuICAgIC8vIEFsd2F5cyBhbGxvdyBzZXR0aW5nIHRoZSBjb25zZW50IGNvb2tpZVxyXG4gICAgaWYgKGNvb2tpZU5hbWUgPT09IENPTlNFTlRfQ09PS0lFX05BTUUpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgY29va2llIHByZWZlcmVuY2VzXHJcbiAgICB2YXIgY29va2llUHJlZmVyZW5jZXMgPSBnZXRDb25zZW50Q29va2llKCk7XHJcblxyXG4gICAgLy8gSWYgbm8gcHJlZmVyZW5jZXMgb3Igb2xkIHZlcnNpb24gdXNlIHRoZSBkZWZhdWx0XHJcbiAgICBpZiAoIWlzVmFsaWRDb25zZW50Q29va2llKGNvb2tpZVByZWZlcmVuY2VzKSkge1xyXG4gICAgICAgIGNvb2tpZVByZWZlcmVuY2VzID0gREVGQVVMVF9DT09LSUVfQ09OU0VOVDtcclxuICAgIH1cclxuXHJcbiAgICBmb3IgKHZhciBjYXRlZ29yeSBpbiBDT09LSUVfQ0FURUdPUklFUykge1xyXG4gICAgICAgIHZhciBjb29raWVzSW5DYXRlZ29yeSA9IENPT0tJRV9DQVRFR09SSUVTW2NhdGVnb3J5XTtcclxuXHJcbiAgICAgICAgaWYgKGNvb2tpZXNJbkNhdGVnb3J5LmluZGV4T2YoY29va2llTmFtZSkgIT09ICctMScpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVzZXJBbGxvd3NDb29raWVDYXRlZ29yeShjYXRlZ29yeSwgY29va2llUHJlZmVyZW5jZXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBEZW55IHRoZSBjb29raWUgaWYgaXQgaXMgbm90IGtub3duIHRvIHVzXHJcbiAgICByZXR1cm4gZmFsc2VcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Q29va2llKG5hbWUpIHtcclxuICAgIHZhciBuYW1lRVEgPSBuYW1lICsgJz0nO1xyXG4gICAgdmFyIGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTtcclxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjb29raWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGNvb2tpZSA9IGNvb2tpZXNbaV07XHJcbiAgICAgICAgd2hpbGUgKGNvb2tpZS5jaGFyQXQoMCkgPT09ICcgJykge1xyXG4gICAgICAgICAgICBjb29raWUgPSBjb29raWUuc3Vic3RyaW5nKDEsIGNvb2tpZS5sZW5ndGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29va2llLmluZGV4T2YobmFtZUVRKSA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGNvb2tpZS5zdWJzdHJpbmcobmFtZUVRLmxlbmd0aCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcblxyXG4vLyBkbyB3ZSBuZWVkIHRvIHNldCB0aGUgZG9tYWluP1xyXG5mdW5jdGlvbiBzZXRDb29raWUobmFtZSwgdmFsdWUsIG9wdGlvbnMpIHtcclxuICAgIGlmICh1c2VyQWxsb3dzQ29va2llKG5hbWUpKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICBvcHRpb25zID0ge31cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGNvb2tpZVN0cmluZyA9IG5hbWUgKyAnPScgKyB2YWx1ZSArICc7IHBhdGg9LzsgU2FtZVNpdGU9U3RyaWN0JztcclxuICAgICAgICBpZiAob3B0aW9ucy5kYXlzKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgZGF0ZS5zZXRUaW1lKGRhdGUuZ2V0VGltZSgpICsgKG9wdGlvbnMuZGF5cyAqIDI0ICogNjAgKiA2MCAqIDEwMDApKTtcclxuICAgICAgICAgICAgY29va2llU3RyaW5nID0gY29va2llU3RyaW5nICsgJzsgZXhwaXJlcz0nICsgZGF0ZS50b1VUQ1N0cmluZygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2wgPT09ICdodHRwczonKSB7XHJcbiAgICAgICAgICAgIGNvb2tpZVN0cmluZyA9IGNvb2tpZVN0cmluZyArICc7IFNlY3VyZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZVN0cmluZztcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZGVsZXRlQ29va2llKG5hbWUpIHtcclxuICAgIGlmIChDb29raWUobmFtZSkpIHtcclxuICAgICAgICAvLyBDb29raWVzIG5lZWQgdG8gYmUgZGVsZXRlZCBpbiB0aGUgc2FtZSBsZXZlbCBvZiBzcGVjaWZpY2l0eSBpbiB3aGljaCB0aGV5IHdlcmUgc2V0XHJcbiAgICAgICAgLy8gSWYgYSBjb29raWUgd2FzIHNldCB3aXRoIGEgc3BlY2lmaWVkIGRvbWFpbiwgaXQgbmVlZHMgdG8gYmUgc3BlY2lmaWVkIHdoZW4gZGVsZXRlZFxyXG4gICAgICAgIC8vIElmIGEgY29va2llIHdhc24ndCBzZXQgd2l0aCB0aGUgZG9tYWluIGF0dHJpYnV0ZSwgaXQgc2hvdWxkbid0IGJlIHRoZXJlIHdoZW4gZGVsZXRlZFxyXG4gICAgICAgIC8vIFlvdSBjYW4ndCB0ZWxsIGlmIGEgY29va2llIHdhcyBzZXQgd2l0aCBhIGRvbWFpbiBhdHRyaWJ1dGUgb3Igbm90LCBzbyB0cnkgYm90aCBvcHRpb25zXHJcbiAgICAgICAgZG9jdW1lbnQuY29va2llID0gbmFtZSArICc9O2V4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBHTVQ7cGF0aD0vJztcclxuICAgICAgICBkb2N1bWVudC5jb29raWUgPSBuYW1lICsgJz07ZXhwaXJlcz1UaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAwIEdNVDtkb21haW49JyArIHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSArICc7cGF0aD0vJztcclxuICAgICAgICBkb2N1bWVudC5jb29raWUgPSBuYW1lICsgJz07ZXhwaXJlcz1UaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAwIEdNVDtkb21haW49LicgKyB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgKyAnO3BhdGg9Lyc7XHJcbiAgICB9XHJcbn0iXX0=\n","/**\n * This seems to fail in IE8, requires more investigation.\n * See: https://github.com/imagitama/nodelist-foreach-polyfill\n */\nfunction nodeListForEach(nodes, callback) {\n    if (window.NodeList.prototype.forEach) {\n        return nodes.forEach(callback);\n    }\n    for (var i = 0; i < nodes.length; i++) {\n        callback.call(window, nodes[i], i, nodes);\n    }\n}\nexport { nodeListForEach };\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvaGVscGVycy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0dBR0c7QUFDSCxTQUFTLGVBQWUsQ0FBQyxLQUFLLEVBQUUsUUFBUTtJQUNwQyxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRTtRQUNuQyxPQUFPLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUE7S0FDakM7SUFDRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUNuQyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFBO0tBQzVDO0FBQ0wsQ0FBQztBQUVELE9BQU8sRUFDSCxlQUFlLEVBQ2xCLENBQUEiLCJmaWxlIjoiY29tcG9uZW50cy9oZWxwZXJzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFRoaXMgc2VlbXMgdG8gZmFpbCBpbiBJRTgsIHJlcXVpcmVzIG1vcmUgaW52ZXN0aWdhdGlvbi5cclxuICogU2VlOiBodHRwczovL2dpdGh1Yi5jb20vaW1hZ2l0YW1hL25vZGVsaXN0LWZvcmVhY2gtcG9seWZpbGxcclxuICovXHJcbmZ1bmN0aW9uIG5vZGVMaXN0Rm9yRWFjaChub2RlcywgY2FsbGJhY2spIHtcclxuICAgIGlmICh3aW5kb3cuTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2gpIHtcclxuICAgICAgICByZXR1cm4gbm9kZXMuZm9yRWFjaChjYWxsYmFjaylcclxuICAgIH1cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjYWxsYmFjay5jYWxsKHdpbmRvdywgbm9kZXNbaV0sIGksIG5vZGVzKVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQge1xyXG4gICAgbm9kZUxpc3RGb3JFYWNoXHJcbn0iXX0=\n","import * as CookieFunctions from './cookie-functions.js';\n/*todo: we don't meed a pollyfill for bind, as long as we server up the non js version of the site for ie8 (https://caniuse.com/?search=bind) */\n/*import 'govuk-frontend/govuk/vendor/polyfills/Function/prototype/bind'*/\n/*todo: i think we're ok for this too (see above about ie8), but we _might_ need it for >8 ie (use? https://www.npmjs.com/package/events-polyfill)*/\n/*import 'govuk-frontend/govuk/vendor/polyfills/Event'*/\nimport { nodeListForEach } from './helpers.js';\nvar cookieBannerAcceptSelector = '.js-cookie-banner-accept';\nvar cookieBannerRejectSelector = '.js-cookie-banner-reject';\nvar cookieBannerHideButtonSelector = '.js-cookie-banner-hide';\nvar cookieMessageSelector = '.js-cookie-banner-message';\nvar cookieConfirmationAcceptSelector = '.js-cookie-banner-confirmation-accept';\nvar cookieConfirmationRejectSelector = '.js-cookie-banner-confirmation-reject';\nfunction CookieBanner($module) {\n    this.$module = $module;\n}\nCookieBanner.prototype.init = function () {\n    this.$cookieBanner = this.$module;\n    this.$acceptButton = this.$module.querySelector(cookieBannerAcceptSelector);\n    this.$rejectButton = this.$module.querySelector(cookieBannerRejectSelector);\n    this.$cookieMessage = this.$module.querySelector(cookieMessageSelector);\n    this.$cookieConfirmationAccept = this.$module.querySelector(cookieConfirmationAcceptSelector);\n    this.$cookieConfirmationReject = this.$module.querySelector(cookieConfirmationRejectSelector);\n    this.$cookieBannerHideButtons = this.$module.querySelectorAll(cookieBannerHideButtonSelector);\n    // Exit if no cookie banner module\n    // or if we're on the cookies page to avoid circular journeys\n    if (!this.$cookieBanner || this.onCookiesPage()) {\n        return;\n    }\n    // Show the cookie banner to users who have not consented or have an\n    // outdated consent cookie\n    var currentConsentCookie = CookieFunctions.getConsentCookie();\n    if (!currentConsentCookie || !CookieFunctions.isValidConsentCookie(currentConsentCookie)) {\n        // If the consent cookie version is not valid, we need to remove any cookies which have been\n        // set previously\n        CookieFunctions.resetCookies();\n        this.$cookieBanner.removeAttribute('hidden');\n    }\n    this.$acceptButton.addEventListener('click', this.acceptCookies.bind(this));\n    this.$rejectButton.addEventListener('click', this.rejectCookies.bind(this));\n    nodeListForEach(this.$cookieBannerHideButtons, function ($cookieBannerHideButton) {\n        $cookieBannerHideButton.addEventListener('click', this.hideBanner.bind(this));\n    }.bind(this));\n};\nCookieBanner.prototype.hideBanner = function () {\n    this.$cookieBanner.setAttribute('hidden', true);\n};\nCookieBanner.prototype.acceptCookies = function () {\n    // Do actual cookie consent bit\n    CookieFunctions.setConsentCookie({ analytics: true });\n    // Hide banner and show confirmation message\n    this.$cookieMessage.setAttribute('hidden', true);\n    this.revealConfirmationMessage(this.$cookieConfirmationAccept);\n};\nCookieBanner.prototype.rejectCookies = function () {\n    // Do actual cookie consent bit\n    CookieFunctions.setConsentCookie({ analytics: false });\n    // Hide banner and show confirmation message\n    this.$cookieMessage.setAttribute('hidden', true);\n    this.revealConfirmationMessage(this.$cookieConfirmationReject);\n};\nCookieBanner.prototype.revealConfirmationMessage = function (confirmationMessage) {\n    confirmationMessage.removeAttribute('hidden');\n    // Set tabindex to -1 to make the confirmation banner focusable with JavaScript\n    if (!confirmationMessage.getAttribute('tabindex')) {\n        confirmationMessage.setAttribute('tabindex', '-1');\n        confirmationMessage.addEventListener('blur', function () {\n            confirmationMessage.removeAttribute('tabindex');\n        });\n    }\n    confirmationMessage.focus();\n};\nCookieBanner.prototype.onCookiesPage = function () {\n    return window.location.pathname === '/cookies/';\n};\nexport default CookieBanner;\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvY29va2llLWJhbm5lci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEtBQUssZUFBZSxNQUFNLHVCQUF1QixDQUFBO0FBQ3hELGdKQUFnSjtBQUNoSiwwRUFBMEU7QUFDMUUsb0pBQW9KO0FBQ3BKLHdEQUF3RDtBQUN4RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sY0FBYyxDQUFBO0FBRTlDLElBQUksMEJBQTBCLEdBQUcsMEJBQTBCLENBQUE7QUFDM0QsSUFBSSwwQkFBMEIsR0FBRywwQkFBMEIsQ0FBQTtBQUMzRCxJQUFJLDhCQUE4QixHQUFHLHdCQUF3QixDQUFBO0FBQzdELElBQUkscUJBQXFCLEdBQUcsMkJBQTJCLENBQUE7QUFDdkQsSUFBSSxnQ0FBZ0MsR0FBRyx1Q0FBdUMsQ0FBQTtBQUM5RSxJQUFJLGdDQUFnQyxHQUFHLHVDQUF1QyxDQUFBO0FBRTlFLFNBQVMsWUFBWSxDQUFDLE9BQU87SUFDekIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUE7QUFDMUIsQ0FBQztBQUVELFlBQVksQ0FBQyxTQUFTLENBQUMsSUFBSSxHQUFHO0lBQzFCLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQTtJQUNqQyxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLDBCQUEwQixDQUFDLENBQUE7SUFDM0UsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQywwQkFBMEIsQ0FBQyxDQUFBO0lBQzNFLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMscUJBQXFCLENBQUMsQ0FBQTtJQUN2RSxJQUFJLENBQUMseUJBQXlCLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsZ0NBQWdDLENBQUMsQ0FBQTtJQUM3RixJQUFJLENBQUMseUJBQXlCLEdBQUcsSUFBSSxD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bkQsQ0FBQyxDQUFDLENBQUE7S0FDTDtJQUVELG1CQUFtQixDQUFDLEtBQUssRUFBRSxDQUFBO0FBQy9CLENBQUMsQ0FBQTtBQUVELFlBQVksQ0FBQyxTQUFTLENBQUMsYUFBYSxHQUFHO0lBQ25DLE9BQU8sTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEtBQUssV0FBVyxDQUFBO0FBQ25ELENBQUMsQ0FBQTtBQUVELGVBQWUsWUFBWSxDQUFBIiwiZmlsZSI6ImNvbXBvbmVudHMvY29va2llLWJhbm5lci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIENvb2tpZUZ1bmN0aW9ucyBmcm9tICcuL2Nvb2tpZS1mdW5jdGlvbnMuanMnXHJcbi8qdG9kbzogd2UgZG9uJ3QgbWVlZCBhIHBvbGx5ZmlsbCBmb3IgYmluZCwgYXMgbG9uZyBhcyB3ZSBzZXJ2ZXIgdXAgdGhlIG5vbiBqcyB2ZXJzaW9uIG9mIHRoZSBzaXRlIGZvciBpZTggKGh0dHBzOi8vY2FuaXVzZS5jb20vP3NlYXJjaD1iaW5kKSAqL1xyXG4vKmltcG9ydCAnZ292dWstZnJvbnRlbmQvZ292dWsvdmVuZG9yL3BvbHlmaWxscy9GdW5jdGlvbi9wcm90b3R5cGUvYmluZCcqL1xyXG4vKnRvZG86IGkgdGhpbmsgd2UncmUgb2sgZm9yIHRoaXMgdG9vIChzZWUgYWJvdmUgYWJvdXQgaWU4KSwgYnV0IHdlIF9taWdodF8gbmVlZCBpdCBmb3IgPjggaWUgKHVzZT8gaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvZXZlbnRzLXBvbHlmaWxsKSovXHJcbi8qaW1wb3J0ICdnb3Z1ay1mcm9udGVuZC9nb3Z1ay92ZW5kb3IvcG9seWZpbGxzL0V2ZW50JyovXHJcbmltcG9ydCB7IG5vZGVMaXN0Rm9yRWFjaCB9IGZyb20gJy4vaGVscGVycy5qcydcclxuXHJcbnZhciBjb29raWVCYW5uZXJBY2NlcHRTZWxlY3RvciA9ICcuanMtY29va2llLWJhbm5lci1hY2NlcHQnXHJcbnZhciBjb29raWVCYW5uZXJSZWplY3RTZWxlY3RvciA9ICcuanMtY29va2llLWJhbm5lci1yZWplY3QnXHJcbnZhciBjb29raWVCYW5uZXJIaWRlQnV0dG9uU2VsZWN0b3IgPSAnLmpzLWNvb2tpZS1iYW5uZXItaGlkZSdcclxudmFyIGNvb2tpZU1lc3NhZ2VTZWxlY3RvciA9ICcuanMtY29va2llLWJhbm5lci1tZXNzYWdlJ1xyXG52YXIgY29va2llQ29uZmlybWF0aW9uQWNjZXB0U2VsZWN0b3IgPSAnLmpzLWNvb2tpZS1iYW5uZXItY29uZmlybWF0aW9uLWFjY2VwdCdcclxudmFyIGNvb2tpZUNvbmZpcm1hdGlvblJlamVjdFNlbGVjdG9yID0gJy5qcy1jb29raWUtYmFubmVyLWNvbmZpcm1hdGlvbi1yZWplY3QnXHJcblxyXG5mdW5jdGlvbiBDb29raWVCYW5uZXIoJG1vZHVsZSkge1xyXG4gICAgdGhpcy4kbW9kdWxlID0gJG1vZHVsZVxyXG59XHJcblxyXG5Db29raWVCYW5uZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLiRjb29raWVCYW5uZXIgPSB0aGlzLiRtb2R1bGVcclxuICAgIHRoaXMuJGFjY2VwdEJ1dHRvbiA9IHRoaXMuJG1vZHVsZS5xdWVyeVNlbGVjdG9yKGNvb2tpZUJhbm5lckFjY2VwdFNlbGVjdG9yKVxyXG4gICAgdGhpcy4kcmVqZWN0QnV0dG9uID0gdGhpcy4kbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoY29va2llQmFubmVyUmVqZWN0U2VsZWN0b3IpXHJcbiAgICB0aGlzLiRjb29raWVNZXNzYWdlID0gdGhpcy4kbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoY29va2llTWVzc2FnZVNlbGVjdG9yKVxyXG4gICAgdGhpcy4kY29va2llQ29uZmlybWF0aW9uQWNjZXB0ID0gdGhpcy4kbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoY29va2llQ29uZmlybWF0aW9uQWNjZXB0U2VsZWN0b3IpXHJcbiAgICB0aGlzLiRjb29raWVDb25maXJtYXRpb25SZWplY3QgPSB0aGlzLiRtb2R1bGUucXVlcnlTZWxlY3Rvcihjb29raWVDb25maXJtYXRpb25SZWplY3RTZWxlY3RvcilcclxuICAgIHRoaXMuJGNvb2tpZUJhbm5lckhpZGVCdXR0b25zID0gdGhpcy4kbW9kdWxlLnF1ZXJ5U2VsZWN0b3JBbGwoY29va2llQmFubmVySGlkZUJ1dHRvblNlbGVjdG9yKVxyXG5cclxuICAgIC8vIEV4aXQgaWYgbm8gY29va2llIGJhbm5lciBtb2R1bGVcclxuICAgIC8vIG9yIGlmIHdlJ3JlIG9uIHRoZSBjb29raWVzIHBhZ2UgdG8gYXZvaWQgY2lyY3VsYXIgam91cm5leXNcclxuICAgIGlmICghdGhpcy4kY29va2llQmFubmVyIHx8IHRoaXMub25Db29raWVzUGFnZSgpKSB7XHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2hvdyB0aGUgY29va2llIGJhbm5lciB0byB1c2VycyB3aG8gaGF2ZSBub3QgY29uc2VudGVkIG9yIGhhdmUgYW5cclxuICAgIC8vIG91dGRhdGVkIGNvbnNlbnQgY29va2llXHJcbiAgICB2YXIgY3VycmVudENvbnNlbnRDb29raWUgPSBDb29raWVGdW5jdGlvbnMuZ2V0Q29uc2VudENvb2tpZSgpXHJcblxyXG4gICAgaWYgKCFjdXJyZW50Q29uc2VudENvb2tpZSB8fCAhQ29va2llRnVuY3Rpb25zLmlzVmFsaWRDb25zZW50Q29va2llKGN1cnJlbnRDb25zZW50Q29va2llKSkge1xyXG4gICAgICAgIC8vIElmIHRoZSBjb25zZW50IGNvb2tpZSB2ZXJzaW9uIGlzIG5vdCB2YWxpZCwgd2UgbmVlZCB0byByZW1vdmUgYW55IGNvb2tpZXMgd2hpY2ggaGF2ZSBiZWVuXHJcbiAgICAgICAgLy8gc2V0IHByZXZpb3VzbHlcclxuICAgICAgICBDb29raWVGdW5jdGlvbnMucmVzZXRDb29raWVzKClcclxuXHJcbiAgICAgICAgdGhpcy4kY29va2llQmFubmVyLnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJylcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLiRhY2NlcHRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmFjY2VwdENvb2tpZXMuYmluZCh0aGlzKSlcclxuICAgIHRoaXMuJHJlamVjdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMucmVqZWN0Q29va2llcy5iaW5kKHRoaXMpKVxyXG5cclxuICAgIG5vZGVMaXN0Rm9yRWFjaCh0aGlzLiRjb29raWVCYW5uZXJIaWRlQnV0dG9ucywgZnVuY3Rpb24gKCRjb29raWVCYW5uZXJIaWRlQnV0dG9uKSB7XHJcbiAgICAgICAgJGNvb2tpZUJhbm5lckhpZGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhpZGVCYW5uZXIuYmluZCh0aGlzKSlcclxuICAgIH0uYmluZCh0aGlzKSlcclxufVxyXG5cclxuQ29va2llQmFubmVyLnByb3RvdHlwZS5oaWRlQmFubmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy4kY29va2llQmFubmVyLnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgdHJ1ZSlcclxufVxyXG5cclxuQ29va2llQmFubmVyLnByb3RvdHlwZS5hY2NlcHRDb29raWVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgLy8gRG8gYWN0dWFsIGNvb2tpZSBjb25zZW50IGJpdFxyXG4gICAgQ29va2llRnVuY3Rpb25zLnNldENvbnNlbnRDb29raWUoeyBhbmFseXRpY3M6IHRydWUgfSlcclxuXHJcbiAgICAvLyBIaWRlIGJhbm5lciBhbmQgc2hvdyBjb25maXJtYXRpb24gbWVzc2FnZVxyXG4gICAgdGhpcy4kY29va2llTWVzc2FnZS5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsIHRydWUpXHJcbiAgICB0aGlzLnJldmVhbENvbmZpcm1hdGlvbk1lc3NhZ2UodGhpcy4kY29va2llQ29uZmlybWF0aW9uQWNjZXB0KVxyXG59XHJcblxyXG5Db29raWVCYW5uZXIucHJvdG90eXBlLnJlamVjdENvb2tpZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyBEbyBhY3R1YWwgY29va2llIGNvbnNlbnQgYml0XHJcbiAgICBDb29raWVGdW5jdGlvbnMuc2V0Q29uc2VudENvb2tpZSh7IGFuYWx5dGljczogZmFsc2UgfSlcclxuXHJcbiAgICAvLyBIaWRlIGJhbm5lciBhbmQgc2hvdyBjb25maXJtYXRpb24gbWVzc2FnZVxyXG4gICAgdGhpcy4kY29va2llTWVzc2FnZS5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsIHRydWUpXHJcbiAgICB0aGlzLnJldmVhbENvbmZpcm1hdGlvbk1lc3NhZ2UodGhpcy4kY29va2llQ29uZmlybWF0aW9uUmVqZWN0KVxyXG59XHJcblxyXG5Db29raWVCYW5uZXIucHJvdG90eXBlLnJldmVhbENvbmZpcm1hdGlvbk1lc3NhZ2UgPSBmdW5jdGlvbiAoY29uZmlybWF0aW9uTWVzc2FnZSkge1xyXG4gICAgY29uZmlybWF0aW9uTWVzc2FnZS5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpXHJcblxyXG4gICAgLy8gU2V0IHRhYmluZGV4IHRvIC0xIHRvIG1ha2UgdGhlIGNvbmZpcm1hdGlvbiBiYW5uZXIgZm9jdXNhYmxlIHdpdGggSmF2YVNjcmlwdFxyXG4gICAgaWYgKCFjb25maXJtYXRpb25NZXNzYWdlLmdldEF0dHJpYnV0ZSgndGFiaW5kZXgnKSkge1xyXG4gICAgICAgIGNvbmZpcm1hdGlvbk1lc3NhZ2Uuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpXHJcblxyXG4gICAgICAgIGNvbmZpcm1hdGlvbk1lc3NhZ2UuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uZmlybWF0aW9uTWVzc2FnZS5yZW1vdmVBdHRyaWJ1dGUoJ3RhYmluZGV4JylcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpcm1hdGlvbk1lc3NhZ2UuZm9jdXMoKVxyXG59XHJcblxyXG5Db29raWVCYW5uZXIucHJvdG90eXBlLm9uQ29va2llc1BhZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAnL2Nvb2tpZXMvJ1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDb29raWVCYW5uZXIiXX0=\n","import { getConsentCookie, setConsentCookie } from './cookie-functions.js';\nimport { nodeListForEach } from './helpers.js';\nfunction CookiesPage($module) {\n    this.$module = $module;\n}\nCookiesPage.prototype.init = function () {\n    this.$cookiePage = this.$module;\n    if (!this.$cookiePage) {\n        return;\n    }\n    this.$cookieForm = this.$cookiePage.querySelector('.js-cookies-page-form');\n    this.$cookieFormFieldsets = this.$cookieForm.querySelectorAll('.js-cookies-page-form-fieldset');\n    this.$successNotification = this.$cookiePage.querySelector('.js-cookies-page-success');\n    this.$successLink = this.$cookiePage.querySelector('.js-cookies-page-success-link');\n    nodeListForEach(this.$cookieFormFieldsets, function ($cookieFormFieldset) {\n        this.showUserPreference($cookieFormFieldset, getConsentCookie());\n        /*        $cookieFormFieldset.removeAttribute('hidden')*/\n    }.bind(this));\n    // Show submit button\n    //this.$cookieForm.querySelector('.js-cookies-form-button').removeAttribute('hidden')\n    this.$cookieForm.addEventListener('submit', this.savePreferences.bind(this));\n};\nCookiesPage.prototype.savePreferences = function (event) {\n    // Stop default form submission behaviour\n    event.preventDefault();\n    var preferences = {};\n    nodeListForEach(this.$cookieFormFieldsets, function ($cookieFormFieldset) {\n        var cookieType = this.getCookieType($cookieFormFieldset);\n        var selectedItem = $cookieFormFieldset.querySelector('input[name=' + cookieType + ']:checked').value;\n        preferences[cookieType] = selectedItem === 'true';\n    }.bind(this));\n    // Save preferences to cookie and show success notification\n    setConsentCookie(preferences);\n    // handle the corner case, where the user has selected their preference on the cookie page, whilst the banner is still open as they haven't previously selected their preference\n    //todo: call hideBanner\n    var banner = document.querySelector('[data-module=\"govuk-cookie-banner\"]');\n    banner.setAttribute('hidden', 'true');\n    this.showSuccessNotification();\n};\nCookiesPage.prototype.showUserPreference = function ($cookieFormFieldset, preferences) {\n    var cookieType = this.getCookieType($cookieFormFieldset);\n    var preference = false;\n    if (cookieType && preferences && preferences[cookieType] !== undefined) {\n        preference = preferences[cookieType];\n    }\n    var radioValue = preference ? 'true' : 'false';\n    var radio = $cookieFormFieldset.querySelector('input[name=' + cookieType + '][value=' + radioValue + ']');\n    radio.checked = true;\n};\nCookiesPage.prototype.showSuccessNotification = function () {\n    this.$successNotification.removeAttribute('hidden');\n    // if the user's come to the cookies page through the link in the cookie banner, show a link to take them back to the page they came from\n    var referrer = document.referrer ? new URL(document.referrer).pathname : false;\n    if (referrer && referrer !== document.location.pathname) {\n        this.$successLink.href = referrer;\n        this.$successLink.removeAttribute('hidden');\n    }\n    else {\n        this.$successLink.setAttribute('hidden', 'true');\n    }\n    // Set tabindex to -1 to make the element focusable with JavaScript.\n    // GOV.UK Frontend will remove the tabindex on blur as the component doesn't\n    // need to be focusable after the user has read the text.\n    if (!this.$successNotification.getAttribute('tabindex')) {\n        this.$successNotification.setAttribute('tabindex', '-1');\n    }\n    this.$successNotification.focus();\n    // scroll to the top of the page\n    window.scrollTo(0, 0);\n};\nCookiesPage.prototype.getCookieType = function ($cookieFormFieldset) {\n    return $cookieFormFieldset.id;\n};\nexport default CookiesPage;\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvY29va2llcy1wYWdlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHVCQUF1QixDQUFBO0FBQzFFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxjQUFjLENBQUE7QUFFOUMsU0FBUyxXQUFXLENBQUMsT0FBTztJQUN4QixJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQTtBQUMxQixDQUFDO0FBRUQsV0FBVyxDQUFDLFNBQVMsQ0FBQyxJQUFJLEdBQUc7SUFDekIsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFBO0lBRS9CLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFO1FBQ25CLE9BQU07S0FDVDtJQUVELElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsdUJBQXVCLENBQUMsQ0FBQTtJQUMxRSxJQUFJLENBQUMsb0JBQW9CLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFBO0lBQy9GLElBQUksQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQywwQkFBMEIsQ0FBQyxDQUFBO0lBQ3RGLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsK0JBQStCLENBQUMsQ0FBQTtJQUVuRixlQUFlLENBQUMsSUFBSSxDQUFDLG9CQUFvQixFQUFFLFVBQVUsbUJBQW1CO1FBQ3BFLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxtQkFBbUIsRUFBRSxnQkFBZ0IsRUFBRSxDQUFDLENBQUE7UUFDeEUseURBQXlEO0lBQ3JELENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQTtJQUViLHFCQUFxQjtJQUNyQixxRkFBcUY7SUFFckYsSUFBSSxDQUFDLFdBQVcsQ0FBQyxn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QVksQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUE7S0FDM0Q7SUFFRCxJQUFJLENBQUMsb0JBQW9CLENBQUMsS0FBSyxFQUFFLENBQUE7SUFFakMsZ0NBQWdDO0lBQ2hDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFBO0FBQ3pCLENBQUMsQ0FBQTtBQUVELFdBQVcsQ0FBQyxTQUFTLENBQUMsYUFBYSxHQUFHLFVBQVUsbUJBQW1CO0lBQy9ELE9BQU8sbUJBQW1CLENBQUMsRUFBRSxDQUFBO0FBQ2pDLENBQUMsQ0FBQTtBQUVELGVBQWUsV0FBVyxDQUFBIiwiZmlsZSI6ImNvbXBvbmVudHMvY29va2llcy1wYWdlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0Q29uc2VudENvb2tpZSwgc2V0Q29uc2VudENvb2tpZSB9IGZyb20gJy4vY29va2llLWZ1bmN0aW9ucy5qcydcclxuaW1wb3J0IHsgbm9kZUxpc3RGb3JFYWNoIH0gZnJvbSAnLi9oZWxwZXJzLmpzJ1xyXG5cclxuZnVuY3Rpb24gQ29va2llc1BhZ2UoJG1vZHVsZSkge1xyXG4gICAgdGhpcy4kbW9kdWxlID0gJG1vZHVsZVxyXG59XHJcblxyXG5Db29raWVzUGFnZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuJGNvb2tpZVBhZ2UgPSB0aGlzLiRtb2R1bGVcclxuXHJcbiAgICBpZiAoIXRoaXMuJGNvb2tpZVBhZ2UpIHtcclxuICAgICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLiRjb29raWVGb3JtID0gdGhpcy4kY29va2llUGFnZS5xdWVyeVNlbGVjdG9yKCcuanMtY29va2llcy1wYWdlLWZvcm0nKVxyXG4gICAgdGhpcy4kY29va2llRm9ybUZpZWxkc2V0cyA9IHRoaXMuJGNvb2tpZUZvcm0ucXVlcnlTZWxlY3RvckFsbCgnLmpzLWNvb2tpZXMtcGFnZS1mb3JtLWZpZWxkc2V0JylcclxuICAgIHRoaXMuJHN1Y2Nlc3NOb3RpZmljYXRpb24gPSB0aGlzLiRjb29raWVQYWdlLnF1ZXJ5U2VsZWN0b3IoJy5qcy1jb29raWVzLXBhZ2Utc3VjY2VzcycpXHJcbiAgICB0aGlzLiRzdWNjZXNzTGluayA9IHRoaXMuJGNvb2tpZVBhZ2UucXVlcnlTZWxlY3RvcignLmpzLWNvb2tpZXMtcGFnZS1zdWNjZXNzLWxpbmsnKVxyXG5cclxuICAgIG5vZGVMaXN0Rm9yRWFjaCh0aGlzLiRjb29raWVGb3JtRmllbGRzZXRzLCBmdW5jdGlvbiAoJGNvb2tpZUZvcm1GaWVsZHNldCkge1xyXG4gICAgICAgIHRoaXMuc2hvd1VzZXJQcmVmZXJlbmNlKCRjb29raWVGb3JtRmllbGRzZXQsIGdldENvbnNlbnRDb29raWUoKSlcclxuLyogICAgICAgICRjb29raWVGb3JtRmllbGRzZXQucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKSovXHJcbiAgICB9LmJpbmQodGhpcykpXHJcblxyXG4gICAgLy8gU2hvdyBzdWJtaXQgYnV0dG9uXHJcbiAgICAvL3RoaXMuJGNvb2tpZUZvcm0ucXVlcnlTZWxlY3RvcignLmpzLWNvb2tpZXMtZm9ybS1idXR0b24nKS5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpXHJcblxyXG4gICAgdGhpcy4kY29va2llRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnNhdmVQcmVmZXJlbmNlcy5iaW5kKHRoaXMpKVxyXG59XHJcblxyXG5Db29raWVzUGFnZS5wcm90b3R5cGUuc2F2ZVByZWZlcmVuY2VzID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAvLyBTdG9wIGRlZmF1bHQgZm9ybSBzdWJtaXNzaW9uIGJlaGF2aW91clxyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG5cclxuICAgIHZhciBwcmVmZXJlbmNlcyA9IHt9XHJcblxyXG4gICAgbm9kZUxpc3RGb3JFYWNoKHRoaXMuJGNvb2tpZUZvcm1GaWVsZHNldHMsIGZ1bmN0aW9uICgkY29va2llRm9ybUZpZWxkc2V0KSB7XHJcbiAgICAgICAgdmFyIGNvb2tpZVR5cGUgPSB0aGlzLmdldENvb2tpZVR5cGUoJGNvb2tpZUZvcm1GaWVsZHNldClcclxuICAgICAgICB2YXIgc2VsZWN0ZWRJdGVtID0gJGNvb2tpZUZvcm1GaWVsZHNldC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPScgKyBjb29raWVUeXBlICsgJ106Y2hlY2tlZCcpLnZhbHVlXHJcblxyXG4gICAgICAgIHByZWZlcmVuY2VzW2Nvb2tpZVR5cGVdID0gc2VsZWN0ZWRJdGVtID09PSAndHJ1ZSdcclxuICAgIH0uYmluZCh0aGlzKSlcclxuXHJcbiAgICAvLyBTYXZlIHByZWZlcmVuY2VzIHRvIGNvb2tpZSBhbmQgc2hvdyBzdWNjZXNzIG5vdGlmaWNhdGlvblxyXG4gICAgc2V0Q29uc2VudENvb2tpZShwcmVmZXJlbmNlcyk7XHJcblxyXG4gICAgLy8gaGFuZGxlIHRoZSBjb3JuZXIgY2FzZSwgd2hlcmUgdGhlIHVzZXIgaGFzIHNlbGVjdGVkIHRoZWlyIHByZWZlcmVuY2Ugb24gdGhlIGNvb2tpZSBwYWdlLCB3aGlsc3QgdGhlIGJhbm5lciBpcyBzdGlsbCBvcGVuIGFzIHRoZXkgaGF2ZW4ndCBwcmV2aW91c2x5IHNlbGVjdGVkIHRoZWlyIHByZWZlcmVuY2VcclxuICAgIC8vdG9kbzogY2FsbCBoaWRlQmFubmVyXHJcbiAgICB2YXIgYmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbW9kdWxlPVwiZ292dWstY29va2llLWJhbm5lclwiXScpO1xyXG4gICAgYmFubmVyLnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgJ3RydWUnKTtcclxuICAgIFxyXG4gICAgdGhpcy5zaG93U3VjY2Vzc05vdGlmaWNhdGlvbigpXHJcbn1cclxuXHJcbkNvb2tpZXNQYWdlLnByb3RvdHlwZS5zaG93VXNlclByZWZlcmVuY2UgPSBmdW5jdGlvbiAoJGNvb2tpZUZvcm1GaWVsZHNldCwgcHJlZmVyZW5jZXMpIHtcclxuICAgIHZhciBjb29raWVUeXBlID0gdGhpcy5nZXRDb29raWVUeXBlKCRjb29raWVGb3JtRmllbGRzZXQpXHJcbiAgICB2YXIgcHJlZmVyZW5jZSA9IGZhbHNlXHJcblxyXG4gICAgaWYgKGNvb2tpZVR5cGUgJiYgcHJlZmVyZW5jZXMgJiYgcHJlZmVyZW5jZXNbY29va2llVHlwZV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHByZWZlcmVuY2UgPSBwcmVmZXJlbmNlc1tjb29raWVUeXBlXVxyXG4gICAgfVxyXG5cclxuICAgIHZhciByYWRpb1ZhbHVlID0gcHJlZmVyZW5jZSA/ICd0cnVlJyA6ICdmYWxzZSdcclxuICAgIHZhciByYWRpbyA9ICRjb29raWVGb3JtRmllbGRzZXQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0nICsgY29va2llVHlwZSArICddW3ZhbHVlPScgKyByYWRpb1ZhbHVlICsgJ10nKVxyXG4gICAgcmFkaW8uY2hlY2tlZCA9IHRydWVcclxufVxyXG5cclxuQ29va2llc1BhZ2UucHJvdG90eXBlLnNob3dTdWNjZXNzTm90aWZpY2F0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy4kc3VjY2Vzc05vdGlmaWNhdGlvbi5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpXHJcblxyXG4gICAgLy8gaWYgdGhlIHVzZXIncyBjb21lIHRvIHRoZSBjb29raWVzIHBhZ2UgdGhyb3VnaCB0aGUgbGluayBpbiB0aGUgY29va2llIGJhbm5lciwgc2hvdyBhIGxpbmsgdG8gdGFrZSB0aGVtIGJhY2sgdG8gdGhlIHBhZ2UgdGhleSBjYW1lIGZyb21cclxuICAgIHZhciByZWZlcnJlciA9IGRvY3VtZW50LnJlZmVycmVyID8gbmV3IFVSTChkb2N1bWVudC5yZWZlcnJlcikucGF0aG5hbWUgOiBmYWxzZTtcclxuICAgIGlmIChyZWZlcnJlciAmJiByZWZlcnJlciAhPT0gZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWUpIHtcclxuICAgICAgICB0aGlzLiRzdWNjZXNzTGluay5ocmVmID0gcmVmZXJyZXI7XHJcbiAgICAgICAgdGhpcy4kc3VjY2Vzc0xpbmsucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLiRzdWNjZXNzTGluay5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICd0cnVlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2V0IHRhYmluZGV4IHRvIC0xIHRvIG1ha2UgdGhlIGVsZW1lbnQgZm9jdXNhYmxlIHdpdGggSmF2YVNjcmlwdC5cclxuICAgIC8vIEdPVi5VSyBGcm9udGVuZCB3aWxsIHJlbW92ZSB0aGUgdGFiaW5kZXggb24gYmx1ciBhcyB0aGUgY29tcG9uZW50IGRvZXNuJ3RcclxuICAgIC8vIG5lZWQgdG8gYmUgZm9jdXNhYmxlIGFmdGVyIHRoZSB1c2VyIGhhcyByZWFkIHRoZSB0ZXh0LlxyXG4gICAgaWYgKCF0aGlzLiRzdWNjZXNzTm90aWZpY2F0aW9uLmdldEF0dHJpYnV0ZSgndGFiaW5kZXgnKSkge1xyXG4gICAgICAgIHRoaXMuJHN1Y2Nlc3NOb3RpZmljYXRpb24uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy4kc3VjY2Vzc05vdGlmaWNhdGlvbi5mb2N1cygpXHJcblxyXG4gICAgLy8gc2Nyb2xsIHRvIHRoZSB0b3Agb2YgdGhlIHBhZ2VcclxuICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKVxyXG59XHJcblxyXG5Db29raWVzUGFnZS5wcm90b3R5cGUuZ2V0Q29va2llVHlwZSA9IGZ1bmN0aW9uICgkY29va2llRm9ybUZpZWxkc2V0KSB7XHJcbiAgICByZXR1cm4gJGNvb2tpZUZvcm1GaWVsZHNldC5pZFxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDb29raWVzUGFnZSJdfQ==\n","// js components have been snaffled from https://github.com/alphagov/govuk-design-system/blob/main/src/javascripts/components/\nimport CookieBanner from './components/cookie-banner.js';\nimport { getConsentCookie, isValidConsentCookie } from './components/cookie-functions.js';\nimport Analytics from './components/analytics.js';\nimport CookiesPage from './components/cookies-page.js';\n// Initialise cookie banner\nvar $cookieBanner = document.querySelector('[data-module=\"govuk-cookie-banner\"]');\nnew CookieBanner($cookieBanner).init();\n// Initialise analytics if consent is given\nvar userConsent = getConsentCookie();\nif (userConsent && isValidConsentCookie(userConsent) && userConsent.analytics) {\n    Analytics();\n}\n//todo: move this into scripts section on cookie page\n// Initialise cookie page\nvar $cookiesPage = document.querySelector('[data-module=\"app-cookies-page\"]');\nnew CookiesPage($cookiesPage).init();\nconst backLinks = document.querySelectorAll(\".app-back-link\");\nbackLinks.forEach((link) => {\n    link.addEventListener(\"click\", () => {\n        window.history.back();\n    });\n});\nconst button = document.getElementById('open-close-filters');\nbutton === null || button === void 0 ? void 0 : button.addEventListener('click', function handleClick(event) {\n    //todo: update to ts 2?\n    const filterButton = document.getElementById(\"filters\");\n    if (filterButton.style.display === \"none\") {\n        filterButton.style.display = \"block\";\n    }\n    else {\n        filterButton.style.display = \"none\";\n    }\n});\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSw4SEFBOEg7QUFROUgsT0FBTyxZQUFZLE1BQU0sK0JBQStCLENBQUE7QUFDeEQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLG9CQUFvQixFQUFFLE1BQU0sa0NBQWtDLENBQUE7QUFDekYsT0FBTyxTQUFTLE1BQU0sMkJBQTJCLENBQUE7QUFDakQsT0FBTyxXQUFXLE1BQU0sOEJBQThCLENBQUE7QUFFdEQsMkJBQTJCO0FBQzNCLElBQUksYUFBYSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMscUNBQXFDLENBQUMsQ0FBQTtBQUNqRixJQUFJLFlBQVksQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtBQUV0QywyQ0FBMkM7QUFDM0MsSUFBSSxXQUFXLEdBQUcsZ0JBQWdCLEVBQUUsQ0FBQTtBQUNwQyxJQUFJLFdBQVcsSUFBSSxvQkFBb0IsQ0FBQyxXQUFXLENBQUMsSUFBSSxXQUFXLENBQUMsU0FBUyxFQUFFO0lBQzNFLFNBQVMsRUFBRSxDQUFBO0NBQ2Q7QUFFRCxxREFBcUQ7QUFDckQseUJBQXlCO0FBQ3pCLElBQUksWUFBWSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsa0NBQWtDLENBQUMsQ0FBQTtBQUM3RSxJQUFJLFdBQVcsQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtBQUVwQyxNQUFNLFNBQVMsR0FBRyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztBQUM5RCxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBdUIsRUFBRSxFQUFFO0lBQzFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFO1FBQ2hDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDMUIsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQztBQUVILE1BQU0sTUFBTSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsb0JBQW9CLENBQUMsQ0FBQztBQUM3RCxNQUFNLGFBQU4sTUFBTSx1QkFBTixNQUFNLENBQUUsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLFNBQVMsV0FBVyxDQUFDLEtBQUs7SUFDeEQsdUJBQXVCO0lBQ3ZCLE1BQU0sWUFBWSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUEwQixDQUFDO0lBQ2pGLElBQUksWUFBWSxDQUFDLEtBQUssQ0FBQyxPQUFPLEtBQUssTUFBTSxFQUFFO1FBQ3ZDLFlBQVksQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztLQUN4QztTQUFNO1FBQ0gsWUFBWSxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO0tBQ3ZDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8ganMgY29tcG9uZW50cyBoYXZlIGJlZW4gc25hZmZsZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vYWxwaGFnb3YvZ292dWstZGVzaWduLXN5c3RlbS9ibG9iL21haW4vc3JjL2phdmFzY3JpcHRzL2NvbXBvbmVudHMvXHJcblxyXG5kZWNsYXJlIGdsb2JhbCB7XHJcbiAgICBpbnRlcmZhY2UgV2luZG93IHtcclxuICAgICAgICBHRFNfQ09OU0VOVF9DT09LSUVfVkVSU0lPTjogYW55O1xyXG4gICAgfVxyXG59XHJcblxyXG5pbXBvcnQgQ29va2llQmFubmVyIGZyb20gJy4vY29tcG9uZW50cy9jb29raWUtYmFubmVyLmpzJ1xyXG5pbXBvcnQgeyBnZXRDb25zZW50Q29va2llLCBpc1ZhbGlkQ29uc2VudENvb2tpZSB9IGZyb20gJy4vY29tcG9uZW50cy9jb29raWUtZnVuY3Rpb25zLmpzJ1xyXG5pbXBvcnQgQW5hbHl0aWNzIGZyb20gJy4vY29tcG9uZW50cy9hbmFseXRpY3MuanMnXHJcbmltcG9ydCBDb29raWVzUGFnZSBmcm9tICcuL2NvbXBvbmVudHMvY29va2llcy1wYWdlLmpzJ1xyXG5cclxuLy8gSW5pdGlhbGlzZSBjb29raWUgYmFubmVyXHJcbnZhciAkY29va2llQmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbW9kdWxlPVwiZ292dWstY29va2llLWJhbm5lclwiXScpXHJcbm5ldyBDb29raWVCYW5uZXIoJGNvb2tpZUJhbm5lcikuaW5pdCgpXHJcblxyXG4vLyBJbml0aWFsaXNlIGFuYWx5dGljcyBpZiBjb25zZW50IGlzIGdpdmVuXHJcbnZhciB1c2VyQ29uc2VudCA9IGdldENvbnNlbnRDb29raWUoKVxyXG5pZiAodXNlckNvbnNlbnQgJiYgaXNWYWxpZENvbnNlbnRDb29raWUodXNlckNvbnNlbnQpICYmIHVzZXJDb25zZW50LmFuYWx5dGljcykge1xyXG4gICAgQW5hbHl0aWNzKClcclxufVxyXG5cclxuLy90b2RvOiBtb3ZlIHRoaXMgaW50byBzY3JpcHRzIHNlY3Rpb24gb24gY29va2llIHBhZ2VcclxuLy8gSW5pdGlhbGlzZSBjb29raWUgcGFnZVxyXG52YXIgJGNvb2tpZXNQYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbW9kdWxlPVwiYXBwLWNvb2tpZXMtcGFnZVwiXScpXHJcbm5ldyBDb29raWVzUGFnZSgkY29va2llc1BhZ2UpLmluaXQoKVxyXG5cclxuY29uc3QgYmFja0xpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5hcHAtYmFjay1saW5rXCIpO1xyXG5iYWNrTGlua3MuZm9yRWFjaCgobGluazogSFRNTEFuY2hvckVsZW1lbnQpID0+IHtcclxuICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB3aW5kb3cuaGlzdG9yeS5iYWNrKCk7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5jb25zdCBidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3Blbi1jbG9zZS1maWx0ZXJzJyk7XHJcbmJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiBoYW5kbGVDbGljayhldmVudCkge1xyXG4gICAgLy90b2RvOiB1cGRhdGUgdG8gdHMgMj9cclxuICAgIGNvbnN0IGZpbHRlckJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZmlsdGVyc1wiKSBhcyBIVE1MRGl2RWxlbWVudCB8IG51bGw7XHJcbiAgICBpZiAoZmlsdGVyQnV0dG9uLnN0eWxlLmRpc3BsYXkgPT09IFwibm9uZVwiKSB7XHJcbiAgICAgICAgZmlsdGVyQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZpbHRlckJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICB9XHJcbn0pO1xyXG4iXX0=\n\n(function (global, factory) {\r\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\r\n\ttypeof define === 'function' && define.amd ? define('GOVUKFrontend', ['exports'], factory) :\r\n\t(factory((global.GOVUKFrontend = {})));\r\n}(this, (function (exports) { 'use strict';\r\n\r\n/**\r\n * Common helpers which do not require polyfill.\r\n *\r\n * IMPORTANT: If a helper require a polyfill, please isolate it in its own module\r\n * so that the polyfill can be properly tree-shaken and does not burden\r\n * the components that do not need that helper\r\n *\r\n * @module common/index\r\n */\r\n\r\n/**\r\n * TODO: Ideally this would be a NodeList.prototype.forEach polyfill\r\n * This seems to fail in IE8, requires more investigation.\r\n * See: https://github.com/imagitama/nodelist-foreach-polyfill\r\n *\r\n * @param {NodeListOf<Element>} nodes - NodeList from querySelectorAll()\r\n * @param {nodeListIterator} callback - Callback function to run for each node\r\n * @returns {undefined}\r\n */\r\nfunction nodeListForEach (nodes, callback) {\r\n  if (window.NodeList.prototype.forEach) {\r\n    return nodes.forEach(callback)\r\n  }\r\n  for (var i = 0; i < nodes.length; i++) {\r\n    callback.call(window, nodes[i], i, nodes);\r\n  }\r\n}\r\n\r\n/**\r\n * Used to generate a unique string, allows multiple instances of the component\r\n * without them conflicting with each other.\r\n * https://stackoverflow.com/a/8809472\r\n *\r\n * @returns {string} Unique ID\r\n */\r\nfunction generateUniqueID () {\r\n  var d = new Date().getTime();\r\n  if (typeof window.performance !== 'undefined' && typeof window.performance.now === 'function') {\r\n    d += window.performance.now(); // use high-precision timer if available\r\n  }\r\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n    var r = (d + Math.random() * 16) % 16 | 0;\r\n    d = Math.floor(d / 16);\r\n    return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16)\r\n  })\r\n}\r\n\r\n/**\r\n * Config flattening function\r\n *\r\n * Takes any number of objects, flattens them into namespaced key-value pairs,\r\n * (e.g. {'i18n.showSection': 'Show section'}) and combines them together, with\r\n * greatest priority on the LAST item passed in.\r\n *\r\n * @returns {object} A flattened object of key-value pairs.\r\n */\r\nfunction mergeConfigs (/* configObject1, configObject2, ...configObjects */) {\r\n  /**\r\n   * Function to take nested objects and flatten them to a dot-separated keyed\r\n   * object. Doing this means we don't need to do any deep/recursive merging of\r\n   * each of our objects, nor transform our dataset from a flat list into a\r\n   * nested object.\r\n   *\r\n   * @param {object} configObject - Deeply nested object\r\n   * @returns {object} Flattened object with dot-separated keys\r\n   */\r\n  var flattenObject = function (configObject) {\r\n    // Prepare an empty return object\r\n    var flattenedObject = {};\r\n\r\n    // Our flattening function, this is called recursively for each level of\r\n    // depth in the object. At each level we prepend the previous level names to\r\n    // the key using `prefix`.\r\n    var flattenLoop = function (obj, prefix) {\r\n      // Loop through keys...\r\n      for (var key in obj) {\r\n        // Check to see if this is a prototypical key/value,\r\n        // if it is, skip it.\r\n        if (!Object.prototype.hasOwnProperty.call(obj, key)) {\r\n          continue\r\n        }\r\n        var value = obj[key];\r\n        var prefixedKey = prefix ? prefix + '.' + key : key;\r\n        if (typeof value === 'object') {\r\n          // If the value is a nested object, recurse over that too\r\n          flattenLoop(value, prefixedKey);\r\n        } else {\r\n          // Otherwise, add this value to our return object\r\n          flattenedObject[prefixedKey] = value;\r\n        }\r\n      }\r\n    };\r\n\r\n    // Kick off the recursive loop\r\n    flattenLoop(configObject);\r\n    return flattenedObject\r\n  };\r\n\r\n  // Start with an empty object as our base\r\n  var formattedConfigObject = {};\r\n\r\n  // Loop through each of the remaining passed objects and push their keys\r\n  // one-by-one into configObject. Any duplicate keys will override the existing\r\n  // key with the new value.\r\n  for (var i = 0; i < arguments.length; i++) {\r\n    var obj = flattenObject(arguments[i]);\r\n    for (var key in obj) {\r\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n        formattedConfigObject[key] = obj[key];\r\n      }\r\n    }\r\n  }\r\n\r\n  return formattedConfigObject\r\n}\r\n\r\n/**\r\n * Extracts keys starting with a particular namespace from a flattened config\r\n * object, removing the namespace in the process.\r\n *\r\n * @param {object} configObject - The object to extract key-value pairs from.\r\n * @param {string} namespace - The namespace to filter keys with.\r\n * @returns {object} Flattened object with dot-separated key namespace removed\r\n */\r\nfunction extractConfigByNamespace (configObject, namespace) {\r\n  // Check we have what we need\r\n  if (!configObject || typeof configObject !== 'object') {\r\n    throw new Error('Provide a `configObject` of type \"object\".')\r\n  }\r\n  if (!namespace || typeof namespace !== 'string') {\r\n    throw new Error('Provide a `namespace` of type \"string\" to filter the `configObject` by.')\r\n  }\r\n  var newObject = {};\r\n  for (var key in configObject) {\r\n    // Split the key into parts, using . as our namespace separator\r\n    var keyParts = key.split('.');\r\n    // Check if the first namespace matches the configured namespace\r\n    if (Object.prototype.hasOwnProperty.call(configObject, key) && keyParts[0] === namespace) {\r\n      // Remove the first item (the namespace) from the parts array,\r\n      // but only if there is more than one part (we don't want blank keys!)\r\n      if (keyParts.length > 1) {\r\n        keyParts.shift();\r\n      }\r\n      // Join the remaining parts back together\r\n      var newKey = keyParts.join('.');\r\n      // Add them to our new object\r\n      newObject[newKey] = configObject[key];\r\n    }\r\n  }\r\n  return newObject\r\n}\r\n\r\n/**\r\n * @callback nodeListIterator\r\n * @param {Element} value - The current node being iterated on\r\n * @param {number} index - The current index in the iteration\r\n * @param {NodeListOf<Element>} nodes - NodeList from querySelectorAll()\r\n * @returns {undefined}\r\n */\r\n\r\n/**\r\n * Internal support for selecting messages to render, with placeholder\r\n * interpolation and locale-aware number formatting and pluralisation\r\n *\r\n * @class\r\n * @private\r\n * @param {TranslationsFlattened} translations - Key-value pairs of the translation strings to use.\r\n * @param {object} [config] - Configuration options for the function.\r\n * @param {string} config.locale - An overriding locale for the PluralRules functionality.\r\n */\r\nfunction I18n (translations, config) {\r\n  // Make list of translations available throughout function\r\n  this.translations = translations || {};\r\n\r\n  // The locale to use for PluralRules and NumberFormat\r\n  this.locale = (config && config.locale) || document.documentElement.lang || 'en';\r\n}\r\n\r\n/**\r\n * The most used function - takes the key for a given piece of UI text and\r\n * returns the appropriate string.\r\n *\r\n * @param {string} lookupKey - The lookup key of the string to use.\r\n * @param {object} options - Any options passed with the translation string, e.g: for string interpolation.\r\n * @returns {string} The appropriate translation string.\r\n */\r\nI18n.prototype.t = function (lookupKey, options) {\r\n  if (!lookupKey) {\r\n    // Print a console error if no lookup key has been provided\r\n    throw new Error('i18n: lookup key missing')\r\n  }\r\n\r\n  // If the `count` option is set, determine which plural suffix is needed and\r\n  // change the lookupKey to match. We check to see if it's undefined instead of\r\n  // falsy, as this could legitimately be 0.\r\n  if (options && typeof options.count !== 'undefined') {\r\n    // Get the plural suffix\r\n    lookupKey = lookupKey + '.' + this.getPluralSuffix(lookupKey, options.count);\r\n  }\r\n\r\n  if (lookupKey in this.translations) {\r\n    // Fetch the translation string for that lookup key\r\n    var translationString = this.translations[lookupKey];\r\n\r\n    // Check for ${} placeholders in the translation string\r\n    if (translationString.match(/%{(.\\S+)}/)) {\r\n      if (!options) {\r\n        throw new Error('i18n: cannot replace placeholders in string if no option data provided')\r\n      }\r\n\r\n      return this.replacePlaceholders(translationString, options)\r\n    } else {\r\n      return translationString\r\n    }\r\n  } else {\r\n    // If the key wasn't found in our translations object,\r\n    // return the lookup key itself as the fallback\r\n    return lookupKey\r\n  }\r\n};\r\n\r\n/**\r\n * Takes a translation string with placeholders, and replaces the placeholders\r\n * with the provided data\r\n *\r\n * @param {string} translationString - The translation string\r\n * @param {object} options - Any options passed with the translation string, e.g: for string interpolation.\r\n * @returns {string} The translation string to output, with ${} placeholders replaced\r\n */\r\nI18n.prototype.replacePlaceholders = function (translationString, options) {\r\n  var formatter;\r\n\r\n  if (this.hasIntlNumberFormatSupport()) {\r\n    formatter = new Intl.NumberFormat(this.locale);\r\n  }\r\n\r\n  return translationString.replace(/%{(.\\S+)}/g, function (placeholderWithBraces, placeholderKey) {\r\n    if (Object.prototype.hasOwnProperty.call(options, placeholderKey)) {\r\n      var placeholderValue = options[placeholderKey];\r\n\r\n      // If a user has passed `false` as the value for the placeholder\r\n      // treat it as though the value should not be displayed\r\n      if (placeholderValue === false) {\r\n        return ''\r\n      }\r\n\r\n      // If the placeholder's value is a number, localise the number formatting\r\n      if (typeof placeholderValue === 'number' && formatter) {\r\n        return formatter.format(placeholderValue)\r\n      }\r\n\r\n      return placeholderValue\r\n    } else {\r\n      throw new Error('i18n: no data found to replace ' + placeholderWithBraces + ' placeholder in string')\r\n    }\r\n  })\r\n};\r\n\r\n/**\r\n * Check to see if the browser supports Intl and Intl.PluralRules.\r\n *\r\n * It requires all conditions to be met in order to be supported:\r\n * - The browser supports the Intl class (true in IE11)\r\n * - The implementation of Intl supports PluralRules (NOT true in IE11)\r\n * - The browser/OS has plural rules for the current locale (browser dependent)\r\n *\r\n * @returns {boolean} Returns true if all conditions are met. Returns false otherwise.\r\n */\r\nI18n.prototype.hasIntlPluralRulesSupport = function () {\r\n  return Boolean(window.Intl && ('PluralRules' in window.Intl && Intl.PluralRules.supportedLocalesOf(this.locale).length))\r\n};\r\n\r\n/**\r\n * Check to see if the browser supports Intl and Intl.NumberFormat.\r\n *\r\n * It requires all conditions to be met in order to be supported:\r\n * - The browser supports the Intl class (true in IE11)\r\n * - The implementation of Intl supports NumberFormat (also true in IE11)\r\n * - The browser/OS has number formatting rules for the current locale (browser dependent)\r\n *\r\n * @returns {boolean} Returns true if all conditions are met. Returns false otherwise.\r\n */\r\nI18n.prototype.hasIntlNumberFormatSupport = function () {\r\n  return Boolean(window.Intl && ('NumberFormat' in window.Intl && Intl.NumberFormat.supportedLocalesOf(this.locale).length))\r\n};\r\n\r\n/**\r\n * Get the appropriate suffix for the plural form.\r\n *\r\n * Uses Intl.PluralRules (or our own fallback implementation) to get the\r\n * 'preferred' form to use for the given count.\r\n *\r\n * Checks that a translation has been provided for that plural form – if it\r\n * hasn't, it'll fall back to the 'other' plural form (unless that doesn't exist\r\n * either, in which case an error will be thrown)\r\n *\r\n * @param {string} lookupKey - The lookup key of the string to use.\r\n * @param {number} count - Number used to determine which pluralisation to use.\r\n * @returns {PluralRule} The suffix associated with the correct pluralisation for this locale.\r\n */\r\nI18n.prototype.getPluralSuffix = function (lookupKey, count) {\r\n  // Validate that the number is actually a number.\r\n  //\r\n  // Number(count) will turn anything that can't be converted to a Number type\r\n  // into 'NaN'. isFinite filters out NaN, as it isn't a finite number.\r\n  count = Number(count);\r\n  if (!isFinite(count)) { return 'other' }\r\n\r\n  var preferredForm;\r\n\r\n  // Check to verify that all the requirements for Intl.PluralRules are met.\r\n  // If so, we can use that instead of our custom implementation. Otherwise,\r\n  // use the hardcoded fallback.\r\n  if (this.hasIntlPluralRulesSupport()) {\r\n    preferredForm = new Intl.PluralRules(this.locale).select(count);\r\n  } else {\r\n    preferredForm = this.selectPluralFormUsingFallbackRules(count);\r\n  }\r\n\r\n  // Use the correct plural form if provided\r\n  if (lookupKey + '.' + preferredForm in this.translations) {\r\n    return preferredForm\r\n  // Fall back to `other` if the plural form is missing, but log a warning\r\n  // to the console\r\n  } else if (lookupKey + '.other' in this.translations) {\r\n    if (console && 'warn' in console) {\r\n      console.warn('i18n: Missing plural form \".' + preferredForm + '\" for \"' +\r\n        this.locale + '\" locale. Falling back to \".other\".');\r\n    }\r\n\r\n    return 'other'\r\n  // If the required `other` plural form is missing, all we can do is error\r\n  } else {\r\n    throw new Error(\r\n      'i18n: Plural form \".other\" is required for \"' + this.locale + '\" locale'\r\n    )\r\n  }\r\n};\r\n\r\n/**\r\n * Get the plural form using our fallback implementation\r\n *\r\n * This is split out into a separate function to make it easier to test the\r\n * fallback behaviour in an environment where Intl.PluralRules exists.\r\n *\r\n * @param {number} count - Number used to determine which pluralisation to use.\r\n * @returns {PluralRule} The pluralisation form for count in this locale.\r\n */\r\nI18n.prototype.selectPluralFormUsingFallbackRules = function (count) {\r\n  // Currently our custom code can only handle positive integers, so let's\r\n  // make sure our number is one of those.\r\n  count = Math.abs(Math.floor(count));\r\n\r\n  var ruleset = this.getPluralRulesForLocale();\r\n\r\n  if (ruleset) {\r\n    return I18n.pluralRules[ruleset](count)\r\n  }\r\n\r\n  return 'other'\r\n};\r\n\r\n/**\r\n * Work out which pluralisation rules to use for the current locale\r\n *\r\n * The locale may include a regional indicator (such as en-GB), but we don't\r\n * usually care about this part, as pluralisation rules are usually the same\r\n * regardless of region. There are exceptions, however, (e.g. Portuguese) so\r\n * this searches by both the full and shortened locale codes, just to be sure.\r\n *\r\n * @returns {PluralRuleName | undefined} The name of the pluralisation rule to use (a key for one\r\n *   of the functions in this.pluralRules)\r\n */\r\nI18n.prototype.getPluralRulesForLocale = function () {\r\n  var locale = this.locale;\r\n  var localeShort = locale.split('-')[0];\r\n\r\n  // Look through the plural rules map to find which `pluralRule` is\r\n  // appropriate for our current `locale`.\r\n  for (var pluralRule in I18n.pluralRulesMap) {\r\n    if (Object.prototype.hasOwnProperty.call(I18n.pluralRulesMap, pluralRule)) {\r\n      var languages = I18n.pluralRulesMap[pluralRule];\r\n      for (var i = 0; i < languages.length; i++) {\r\n        if (languages[i] === locale || languages[i] === localeShort) {\r\n          return pluralRule\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Map of plural rules to languages where those rules apply.\r\n *\r\n * Note: These groups are named for the most dominant or recognisable language\r\n * that uses each system. The groupings do not imply that the languages are\r\n * related to one another. Many languages have evolved the same systems\r\n * independently of one another.\r\n *\r\n * Code to support more languages can be found in the i18n spike:\r\n * {@link https://github.com/alphagov/govuk-frontend/blob/spike-i18n-support/src/govuk/i18n.mjs}\r\n *\r\n * Languages currently supported:\r\n *\r\n * Arabic: Arabic (ar)\r\n * Chinese: Burmese (my), Chinese (zh), Indonesian (id), Japanese (ja),\r\n *   Javanese (jv), Korean (ko), Malay (ms), Thai (th), Vietnamese (vi)\r\n * French: Armenian (hy), Bangla (bn), French (fr), Gujarati (gu), Hindi (hi),\r\n *   Persian Farsi (fa), Punjabi (pa), Zulu (zu)\r\n * German: Afrikaans (af), Albanian (sq), Azerbaijani (az), Basque (eu),\r\n *   Bulgarian (bg), Catalan (ca), Danish (da), Dutch (nl), English (en),\r\n *   Estonian (et), Finnish (fi), Georgian (ka), German (de), Greek (el),\r\n *   Hungarian (hu), Luxembourgish (lb), Norwegian (no), Somali (so),\r\n *   Swahili (sw), Swedish (sv), Tamil (ta), Telugu (te), Turkish (tr),\r\n *   Urdu (ur)\r\n * Irish: Irish Gaelic (ga)\r\n * Russian: Russian (ru), Ukrainian (uk)\r\n * Scottish: Scottish Gaelic (gd)\r\n * Spanish: European Portuguese (pt-PT), Italian (it), Spanish (es)\r\n * Welsh: Welsh (cy)\r\n *\r\n * @type {Object<PluralRuleName, string[]>}\r\n */\r\nI18n.pluralRulesMap = {\r\n  arabic: ['ar'],\r\n  chinese: ['my', 'zh', 'id', 'ja', 'jv', 'ko', 'ms', 'th', 'vi'],\r\n  french: ['hy', 'bn', 'fr', 'gu', 'hi', 'fa', 'pa', 'zu'],\r\n  german: [\r\n    'af', 'sq', 'az', 'eu', 'bg', 'ca', 'da', 'nl', 'en', 'et', 'fi', 'ka',\r\n    'de', 'el', 'hu', 'lb', 'no', 'so', 'sw', 'sv', 'ta', 'te', 'tr', 'ur'\r\n  ],\r\n  irish: ['ga'],\r\n  russian: ['ru', 'uk'],\r\n  scottish: ['gd'],\r\n  spanish: ['pt-PT', 'it', 'es'],\r\n  welsh: ['cy']\r\n};\r\n\r\n/**\r\n * Different pluralisation rule sets\r\n *\r\n * Returns the appropriate suffix for the plural form associated with `n`.\r\n * Possible suffixes: 'zero', 'one', 'two', 'few', 'many', 'other' (the actual\r\n * meaning of each differs per locale). 'other' should always exist, even in\r\n * languages without plurals, such as Chinese.\r\n * {@link https://cldr.unicode.org/index/cldr-spec/plural-rules}\r\n *\r\n * The count must be a positive integer. Negative numbers and decimals aren't accounted for\r\n *\r\n * @type {Object<string, function(number): PluralRule>}\r\n */\r\nI18n.pluralRules = {\r\n  arabic: function (n) {\r\n    if (n === 0) { return 'zero' }\r\n    if (n === 1) { return 'one' }\r\n    if (n === 2) { return 'two' }\r\n    if (n % 100 >= 3 && n % 100 <= 10) { return 'few' }\r\n    if (n % 100 >= 11 && n % 100 <= 99) { return 'many' }\r\n    return 'other'\r\n  },\r\n  chinese: function () {\r\n    return 'other'\r\n  },\r\n  french: function (n) {\r\n    return n === 0 || n === 1 ? 'one' : 'other'\r\n  },\r\n  german: function (n) {\r\n    return n === 1 ? 'one' : 'other'\r\n  },\r\n  irish: function (n) {\r\n    if (n === 1) { return 'one' }\r\n    if (n === 2) { return 'two' }\r\n    if (n >= 3 && n <= 6) { return 'few' }\r\n    if (n >= 7 && n <= 10) { return 'many' }\r\n    return 'other'\r\n  },\r\n  russian: function (n) {\r\n    var lastTwo = n % 100;\r\n    var last = lastTwo % 10;\r\n    if (last === 1 && lastTwo !== 11) { return 'one' }\r\n    if (last >= 2 && last <= 4 && !(lastTwo >= 12 && lastTwo <= 14)) { return 'few' }\r\n    if (last === 0 || (last >= 5 && last <= 9) || (lastTwo >= 11 && lastTwo <= 14)) { return 'many' }\r\n    // Note: The 'other' suffix is only used by decimal numbers in Russian.\r\n    // We don't anticipate it being used, but it's here for consistency.\r\n    return 'other'\r\n  },\r\n  scottish: function (n) {\r\n    if (n === 1 || n === 11) { return 'one' }\r\n    if (n === 2 || n === 12) { return 'two' }\r\n    if ((n >= 3 && n <= 10) || (n >= 13 && n <= 19)) { return 'few' }\r\n    return 'other'\r\n  },\r\n  spanish: function (n) {\r\n    if (n === 1) { return 'one' }\r\n    if (n % 1000000 === 0 && n !== 0) { return 'many' }\r\n    return 'other'\r\n  },\r\n  welsh: function (n) {\r\n    if (n === 0) { return 'zero' }\r\n    if (n === 1) { return 'one' }\r\n    if (n === 2) { return 'two' }\r\n    if (n === 3) { return 'few' }\r\n    if (n === 6) { return 'many' }\r\n    return 'other'\r\n  }\r\n};\r\n\r\n/**\r\n * Supported languages for plural rules\r\n *\r\n * @typedef {'arabic' | 'chinese' | 'french' | 'german' | 'irish' | 'russian' | 'scottish' | 'spanish' | 'welsh'} PluralRuleName\r\n */\r\n\r\n/**\r\n * Plural rule category mnemonic tags\r\n *\r\n * @typedef {'zero' | 'one' | 'two' | 'few' | 'many' | 'other'} PluralRule\r\n */\r\n\r\n/**\r\n * Translated message by plural rule they correspond to.\r\n *\r\n * Allows to group pluralised messages under a single key when passing\r\n * translations to a component's constructor\r\n *\r\n * @typedef {object} TranslationPluralForms\r\n * @property {string} [other] - General plural form\r\n * @property {string} [zero] - Plural form used with 0\r\n * @property {string} [one] - Plural form used with 1\r\n * @property {string} [two] - Plural form used with 2\r\n * @property {string} [few] - Plural form used for a few\r\n * @property {string} [many] - Plural form used for many\r\n */\r\n\r\n/**\r\n * Translated messages (flattened)\r\n *\r\n * @private\r\n * @typedef {Object<string, string> | {}} TranslationsFlattened\r\n */\r\n\r\n(function(undefined) {\r\n\r\n// Detection from https://github.com/Financial-Times/polyfill-service/blob/master/packages/polyfill-library/polyfills/Object/defineProperty/detect.js\r\nvar detect = (\r\n  // In IE8, defineProperty could only act on DOM elements, so full support\r\n  // for the feature requires the ability to set a property on an arbitrary object\r\n  'defineProperty' in Object && (function() {\r\n  \ttry {\r\n  \t\tvar a = {};\r\n  \t\tObject.defineProperty(a, 'test', {value:42});\r\n  \t\treturn true;\r\n  \t} catch(e) {\r\n  \t\treturn false\r\n  \t}\r\n  }())\r\n);\r\n\r\nif (detect) return\r\n\r\n// Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Object.defineProperty&flags=always\r\n(function (nativeDefineProperty) {\r\n\r\n\tvar supportsAccessors = Object.prototype.hasOwnProperty('__defineGetter__');\r\n\tvar ERR_ACCESSORS_NOT_SUPPORTED = 'Getters & setters cannot be defined on this javascript engine';\r\n\tvar ERR_VALUE_ACCESSORS = 'A property cannot both have accessors and be writable or have a value';\r\n\r\n\tObject.defineProperty = function defineProperty(object, property, descriptor) {\r\n\r\n\t\t// Where native support exists, assume it\r\n\t\tif (nativeDefineProperty && (object === window || object === document || object === Element.prototype || object instanceof Element)) {\r\n\t\t\treturn nativeDefineProperty(object, property, descriptor);\r\n\t\t}\r\n\r\n\t\tif (object === null || !(object instanceof Object || typeof object === 'object')) {\r\n\t\t\tthrow new TypeError('Object.defineProperty called on non-object');\r\n\t\t}\r\n\r\n\t\tif (!(descriptor instanceof Object)) {\r\n\t\t\tthrow new TypeError('Property description must be an object');\r\n\t\t}\r\n\r\n\t\tvar propertyString = String(property);\r\n\t\tvar hasValueOrWritable = 'value' in descriptor || 'writable' in descriptor;\r\n\t\tvar getterType = 'get' in descriptor && typeof descriptor.get;\r\n\t\tvar setterType = 'set' in descriptor && typeof descriptor.set;\r\n\r\n\t\t// handle descriptor.get\r\n\t\tif (getterType) {\r\n\t\t\tif (getterType !== 'function') {\r\n\t\t\t\tthrow new TypeError('Getter must be a function');\r\n\t\t\t}\r\n\t\t\tif (!supportsAccessors) {\r\n\t\t\t\tthrow new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);\r\n\t\t\t}\r\n\t\t\tif (hasValueOrWritable) {\r\n\t\t\t\tthrow new TypeError(ERR_VALUE_ACCESSORS);\r\n\t\t\t}\r\n\t\t\tObject.__defineGetter__.call(object, propertyString, descriptor.get);\r\n\t\t} else {\r\n\t\t\tobject[propertyString] = descriptor.value;\r\n\t\t}\r\n\r\n\t\t// handle descriptor.set\r\n\t\tif (setterType) {\r\n\t\t\tif (setterType !== 'function') {\r\n\t\t\t\tthrow new TypeError('Setter must be a function');\r\n\t\t\t}\r\n\t\t\tif (!supportsAccessors) {\r\n\t\t\t\tthrow new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);\r\n\t\t\t}\r\n\t\t\tif (hasValueOrWritable) {\r\n\t\t\t\tthrow new TypeError(ERR_VALUE_ACCESSORS);\r\n\t\t\t}\r\n\t\t\tObject.__defineSetter__.call(object, propertyString, descriptor.set);\r\n\t\t}\r\n\r\n\t\t// OK to define value unconditionally - if a getter has been specified as well, an error would be thrown above\r\n\t\tif ('value' in descriptor) {\r\n\t\t\tobject[propertyString] = descriptor.value;\r\n\t\t}\r\n\r\n\t\treturn object;\r\n\t};\r\n}(Object.defineProperty));\r\n})\r\n.call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n  // Detection from https://github.com/Financial-Times/polyfill-service/blob/master/packages/polyfill-library/polyfills/Function/prototype/bind/detect.js\r\n  var detect = 'bind' in Function.prototype;\r\n\r\n  if (detect) return\r\n\r\n  // Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Function.prototype.bind&flags=always\r\n  Object.defineProperty(Function.prototype, 'bind', {\r\n      value: function bind(that) { // .length is 1\r\n          // add necessary es5-shim utilities\r\n          var $Array = Array;\r\n          var $Object = Object;\r\n          var ObjectPrototype = $Object.prototype;\r\n          var ArrayPrototype = $Array.prototype;\r\n          var Empty = function Empty() {};\r\n          var to_string = ObjectPrototype.toString;\r\n          var hasToStringTag = typeof Symbol === 'function' && typeof Symbol.toStringTag === 'symbol';\r\n          var isCallable; /* inlined from https://npmjs.com/is-callable */ var fnToStr = Function.prototype.toString, tryFunctionObject = function tryFunctionObject(value) { try { fnToStr.call(value); return true; } catch (e) { return false; } }, fnClass = '[object Function]', genClass = '[object GeneratorFunction]'; isCallable = function isCallable(value) { if (typeof value !== 'function') { return false; } if (hasToStringTag) { return tryFunctionObject(value); } var strClass = to_string.call(value); return strClass === fnClass || strClass === genClass; };\r\n          var array_slice = ArrayPrototype.slice;\r\n          var array_concat = ArrayPrototype.concat;\r\n          var array_push = ArrayPrototype.push;\r\n          var max = Math.max;\r\n          // /add necessary es5-shim utilities\r\n\r\n          // 1. Let Target be the this value.\r\n          var target = this;\r\n          // 2. If IsCallable(Target) is false, throw a TypeError exception.\r\n          if (!isCallable(target)) {\r\n              throw new TypeError('Function.prototype.bind called on incompatible ' + target);\r\n          }\r\n          // 3. Let A be a new (possibly empty) internal list of all of the\r\n          //   argument values provided after thisArg (arg1, arg2 etc), in order.\r\n          // XXX slicedArgs will stand in for \"A\" if used\r\n          var args = array_slice.call(arguments, 1); // for normal call\r\n          // 4. Let F be a new native ECMAScript object.\r\n          // 11. Set the [[Prototype]] internal property of F to the standard\r\n          //   built-in Function prototype object as specified in 15.3.3.1.\r\n          // 12. Set the [[Call]] internal property of F as described in\r\n          //   15.3.4.5.1.\r\n          // 13. Set the [[Construct]] internal property of F as described in\r\n          //   15.3.4.5.2.\r\n          // 14. Set the [[HasInstance]] internal property of F as described in\r\n          //   15.3.4.5.3.\r\n          var bound;\r\n          var binder = function () {\r\n\r\n              if (this instanceof bound) {\r\n                  // 15.3.4.5.2 [[Construct]]\r\n                  // When the [[Construct]] internal method of a function object,\r\n                  // F that was created using the bind function is called with a\r\n                  // list of arguments ExtraArgs, the following steps are taken:\r\n                  // 1. Let target be the value of F's [[TargetFunction]]\r\n                  //   internal property.\r\n                  // 2. If target has no [[Construct]] internal method, a\r\n                  //   TypeError exception is thrown.\r\n                  // 3. Let boundArgs be the value of F's [[BoundArgs]] internal\r\n                  //   property.\r\n                  // 4. Let args be a new list containing the same values as the\r\n                  //   list boundArgs in the same order followed by the same\r\n                  //   values as the list ExtraArgs in the same order.\r\n                  // 5. Return the result of calling the [[Construct]] internal\r\n                  //   method of target providing args as the arguments.\r\n\r\n                  var result = target.apply(\r\n                      this,\r\n                      array_concat.call(args, array_slice.call(arguments))\r\n                  );\r\n                  if ($Object(result) === result) {\r\n                      return result;\r\n                  }\r\n                  return this;\r\n\r\n              } else {\r\n                  // 15.3.4.5.1 [[Call]]\r\n                  // When the [[Call]] internal method of a function object, F,\r\n                  // which was created using the bind function is called with a\r\n                  // this value and a list of arguments ExtraArgs, the following\r\n                  // steps are taken:\r\n                  // 1. Let boundArgs be the value of F's [[BoundArgs]] internal\r\n                  //   property.\r\n                  // 2. Let boundThis be the value of F's [[BoundThis]] internal\r\n                  //   property.\r\n                  // 3. Let target be the value of F's [[TargetFunction]] internal\r\n                  //   property.\r\n                  // 4. Let args be a new list containing the same values as the\r\n                  //   list boundArgs in the same order followed by the same\r\n                  //   values as the list ExtraArgs in the same order.\r\n                  // 5. Return the result of calling the [[Call]] internal method\r\n                  //   of target providing boundThis as the this value and\r\n                  //   providing args as the arguments.\r\n\r\n                  // equiv: target.call(this, ...boundArgs, ...args)\r\n                  return target.apply(\r\n                      that,\r\n                      array_concat.call(args, array_slice.call(arguments))\r\n                  );\r\n\r\n              }\r\n\r\n          };\r\n\r\n          // 15. If the [[Class]] internal property of Target is \"Function\", then\r\n          //     a. Let L be the length property of Target minus the length of A.\r\n          //     b. Set the length own property of F to either 0 or L, whichever is\r\n          //       larger.\r\n          // 16. Else set the length own property of F to 0.\r\n\r\n          var boundLength = max(0, target.length - args.length);\r\n\r\n          // 17. Set the attributes of the length own property of F to the values\r\n          //   specified in 15.3.5.1.\r\n          var boundArgs = [];\r\n          for (var i = 0; i < boundLength; i++) {\r\n              array_push.call(boundArgs, '$' + i);\r\n          }\r\n\r\n          // XXX Build a dynamic function with desired amount of arguments is the only\r\n          // way to set the length property of a function.\r\n          // In environments where Content Security Policies enabled (Chrome extensions,\r\n          // for ex.) all use of eval or Function costructor throws an exception.\r\n          // However in all of these environments Function.prototype.bind exists\r\n          // and so this code will never be executed.\r\n          bound = Function('binder', 'return function (' + boundArgs.join(',') + '){ return binder.apply(this, arguments); }')(binder);\r\n\r\n          if (target.prototype) {\r\n              Empty.prototype = target.prototype;\r\n              bound.prototype = new Empty();\r\n              // Clean up dangling references.\r\n              Empty.prototype = null;\r\n          }\r\n\r\n          // TODO\r\n          // 18. Set the [[Extensible]] internal property of F to true.\r\n\r\n          // TODO\r\n          // 19. Let thrower be the [[ThrowTypeError]] function Object (13.2.3).\r\n          // 20. Call the [[DefineOwnProperty]] internal method of F with\r\n          //   arguments \"caller\", PropertyDescriptor {[[Get]]: thrower, [[Set]]:\r\n          //   thrower, [[Enumerable]]: false, [[Configurable]]: false}, and\r\n          //   false.\r\n          // 21. Call the [[DefineOwnProperty]] internal method of F with\r\n          //   arguments \"arguments\", PropertyDescriptor {[[Get]]: thrower,\r\n          //   [[Set]]: thrower, [[Enumerable]]: false, [[Configurable]]: false},\r\n          //   and false.\r\n\r\n          // TODO\r\n          // NOTE Function objects created using Function.prototype.bind do not\r\n          // have a prototype property or the [[Code]], [[FormalParameters]], and\r\n          // [[Scope]] internal properties.\r\n          // XXX can't delete prototype in pure-js.\r\n\r\n          // 22. Return F.\r\n          return bound;\r\n      }\r\n  });\r\n})\r\n.call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n    // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-service/master/packages/polyfill-library/polyfills/DOMTokenList/detect.js\r\n    var detect = (\r\n      'DOMTokenList' in this && (function (x) {\r\n        return 'classList' in x ? !x.classList.toggle('x', false) && !x.className : true;\r\n      })(document.createElement('x'))\r\n    );\r\n\r\n    if (detect) return\r\n\r\n    // Polyfill from https://raw.githubusercontent.com/Financial-Times/polyfill-service/master/packages/polyfill-library/polyfills/DOMTokenList/polyfill.js\r\n    (function (global) {\r\n      var nativeImpl = \"DOMTokenList\" in global && global.DOMTokenList;\r\n\r\n      if (\r\n          !nativeImpl ||\r\n          (\r\n            !!document.createElementNS &&\r\n            !!document.createElementNS('http://www.w3.org/2000/svg', 'svg') &&\r\n            !(document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\").classList instanceof DOMTokenList)\r\n          )\r\n        ) {\r\n        global.DOMTokenList = (function() { // eslint-disable-line no-unused-vars\r\n          var dpSupport = true;\r\n          var defineGetter = function (object, name, fn, configurable) {\r\n            if (Object.defineProperty)\r\n              Object.defineProperty(object, name, {\r\n                configurable: false === dpSupport ? true : !!configurable,\r\n                get: fn\r\n              });\r\n\r\n            else object.__defineGetter__(name, fn);\r\n          };\r\n\r\n          /** Ensure the browser allows Object.defineProperty to be used on native JavaScript objects. */\r\n          try {\r\n            defineGetter({}, \"support\");\r\n          }\r\n          catch (e) {\r\n            dpSupport = false;\r\n          }\r\n\r\n\r\n          var _DOMTokenList = function (el, prop) {\r\n            var that = this;\r\n            var tokens = [];\r\n            var tokenMap = {};\r\n            var length = 0;\r\n            var maxLength = 0;\r\n            var addIndexGetter = function (i) {\r\n              defineGetter(that, i, function () {\r\n                preop();\r\n                return tokens[i];\r\n              }, false);\r\n\r\n            };\r\n            var reindex = function () {\r\n\r\n              /** Define getter functions for array-like access to the tokenList's contents. */\r\n              if (length >= maxLength)\r\n                for (; maxLength < length; ++maxLength) {\r\n                  addIndexGetter(maxLength);\r\n                }\r\n            };\r\n\r\n            /** Helper function called at the start of each class method. Internal use only. */\r\n            var preop = function () {\r\n              var error;\r\n              var i;\r\n              var args = arguments;\r\n              var rSpace = /\\s+/;\r\n\r\n              /** Validate the token/s passed to an instance method, if any. */\r\n              if (args.length)\r\n                for (i = 0; i < args.length; ++i)\r\n                  if (rSpace.test(args[i])) {\r\n                    error = new SyntaxError('String \"' + args[i] + '\" ' + \"contains\" + ' an invalid character');\r\n                    error.code = 5;\r\n                    error.name = \"InvalidCharacterError\";\r\n                    throw error;\r\n                  }\r\n\r\n\r\n              /** Split the new value apart by whitespace*/\r\n              if (typeof el[prop] === \"object\") {\r\n                tokens = (\"\" + el[prop].baseVal).replace(/^\\s+|\\s+$/g, \"\").split(rSpace);\r\n              } else {\r\n                tokens = (\"\" + el[prop]).replace(/^\\s+|\\s+$/g, \"\").split(rSpace);\r\n              }\r\n\r\n              /** Avoid treating blank strings as single-item token lists */\r\n              if (\"\" === tokens[0]) tokens = [];\r\n\r\n              /** Repopulate the internal token lists */\r\n              tokenMap = {};\r\n              for (i = 0; i < tokens.length; ++i)\r\n                tokenMap[tokens[i]] = true;\r\n              length = tokens.length;\r\n              reindex();\r\n            };\r\n\r\n            /** Populate our internal token list if the targeted attribute of the subject element isn't empty. */\r\n            preop();\r\n\r\n            /** Return the number of tokens in the underlying string. Read-only. */\r\n            defineGetter(that, \"length\", function () {\r\n              preop();\r\n              return length;\r\n            });\r\n\r\n            /** Override the default toString/toLocaleString methods to return a space-delimited list of tokens when typecast. */\r\n            that.toLocaleString =\r\n              that.toString = function () {\r\n                preop();\r\n                return tokens.join(\" \");\r\n              };\r\n\r\n            that.item = function (idx) {\r\n              preop();\r\n              return tokens[idx];\r\n            };\r\n\r\n            that.contains = function (token) {\r\n              preop();\r\n              return !!tokenMap[token];\r\n            };\r\n\r\n            that.add = function () {\r\n              preop.apply(that, args = arguments);\r\n\r\n              for (var args, token, i = 0, l = args.length; i < l; ++i) {\r\n                token = args[i];\r\n                if (!tokenMap[token]) {\r\n                  tokens.push(token);\r\n                  tokenMap[token] = true;\r\n                }\r\n              }\r\n\r\n              /** Update the targeted attribute of the attached element if the token list's changed. */\r\n              if (length !== tokens.length) {\r\n                length = tokens.length >>> 0;\r\n                if (typeof el[prop] === \"object\") {\r\n                  el[prop].baseVal = tokens.join(\" \");\r\n                } else {\r\n                  el[prop] = tokens.join(\" \");\r\n                }\r\n                reindex();\r\n              }\r\n            };\r\n\r\n            that.remove = function () {\r\n              preop.apply(that, args = arguments);\r\n\r\n              /** Build a hash of token names to compare against when recollecting our token list. */\r\n              for (var args, ignore = {}, i = 0, t = []; i < args.length; ++i) {\r\n                ignore[args[i]] = true;\r\n                delete tokenMap[args[i]];\r\n              }\r\n\r\n              /** Run through our tokens list and reassign only those that aren't defined in the hash declared above. */\r\n              for (i = 0; i < tokens.length; ++i)\r\n                if (!ignore[tokens[i]]) t.push(tokens[i]);\r\n\r\n              tokens = t;\r\n              length = t.length >>> 0;\r\n\r\n              /** Update the targeted attribute of the attached element. */\r\n              if (typeof el[prop] === \"object\") {\r\n                el[prop].baseVal = tokens.join(\" \");\r\n              } else {\r\n                el[prop] = tokens.join(\" \");\r\n              }\r\n              reindex();\r\n            };\r\n\r\n            that.toggle = function (token, force) {\r\n              preop.apply(that, [token]);\r\n\r\n              /** Token state's being forced. */\r\n              if (undefined !== force) {\r\n                if (force) {\r\n                  that.add(token);\r\n                  return true;\r\n                } else {\r\n                  that.remove(token);\r\n                  return false;\r\n                }\r\n              }\r\n\r\n              /** Token already exists in tokenList. Remove it, and return FALSE. */\r\n              if (tokenMap[token]) {\r\n                that.remove(token);\r\n                return false;\r\n              }\r\n\r\n              /** Otherwise, add the token and return TRUE. */\r\n              that.add(token);\r\n              return true;\r\n            };\r\n\r\n            return that;\r\n          };\r\n\r\n          return _DOMTokenList;\r\n        }());\r\n      }\r\n\r\n      // Add second argument to native DOMTokenList.toggle() if necessary\r\n      (function () {\r\n        var e = document.createElement('span');\r\n        if (!('classList' in e)) return;\r\n        e.classList.toggle('x', false);\r\n        if (!e.classList.contains('x')) return;\r\n        e.classList.constructor.prototype.toggle = function toggle(token /*, force*/) {\r\n          var force = arguments[1];\r\n          if (force === undefined) {\r\n            var add = !this.contains(token);\r\n            this[add ? 'add' : 'remove'](token);\r\n            return add;\r\n          }\r\n          force = !!force;\r\n          this[force ? 'add' : 'remove'](token);\r\n          return force;\r\n        };\r\n      }());\r\n\r\n      // Add multiple arguments to native DOMTokenList.add() if necessary\r\n      (function () {\r\n        var e = document.createElement('span');\r\n        if (!('classList' in e)) return;\r\n        e.classList.add('a', 'b');\r\n        if (e.classList.contains('b')) return;\r\n        var native = e.classList.constructor.prototype.add;\r\n        e.classList.constructor.prototype.add = function () {\r\n          var args = arguments;\r\n          var l = arguments.length;\r\n          for (var i = 0; i < l; i++) {\r\n            native.call(this, args[i]);\r\n          }\r\n        };\r\n      }());\r\n\r\n      // Add multiple arguments to native DOMTokenList.remove() if necessary\r\n      (function () {\r\n        var e = document.createElement('span');\r\n        if (!('classList' in e)) return;\r\n        e.classList.add('a');\r\n        e.classList.add('b');\r\n        e.classList.remove('a', 'b');\r\n        if (!e.classList.contains('b')) return;\r\n        var native = e.classList.constructor.prototype.remove;\r\n        e.classList.constructor.prototype.remove = function () {\r\n          var args = arguments;\r\n          var l = arguments.length;\r\n          for (var i = 0; i < l; i++) {\r\n            native.call(this, args[i]);\r\n          }\r\n        };\r\n      }());\r\n\r\n    }(this));\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n// Detection from https://github.com/Financial-Times/polyfill-service/blob/master/packages/polyfill-library/polyfills/Document/detect.js\r\nvar detect = (\"Document\" in this);\r\n\r\nif (detect) return\r\n\r\n// Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Document&flags=always\r\nif ((typeof WorkerGlobalScope === \"undefined\") && (typeof importScripts !== \"function\")) {\r\n\r\n\tif (this.HTMLDocument) { // IE8\r\n\r\n\t\t// HTMLDocument is an extension of Document.  If the browser has HTMLDocument but not Document, the former will suffice as an alias for the latter.\r\n\t\tthis.Document = this.HTMLDocument;\r\n\r\n\t} else {\r\n\r\n\t\t// Create an empty function to act as the missing constructor for the document object, attach the document object as its prototype.  The function needs to be anonymous else it is hoisted and causes the feature detect to prematurely pass, preventing the assignments below being made.\r\n\t\tthis.Document = this.HTMLDocument = document.constructor = (new Function('return function Document() {}')());\r\n\t\tthis.Document.prototype = document;\r\n\t}\r\n}\r\n\r\n\r\n})\r\n.call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n// Detection from https://github.com/Financial-Times/polyfill-service/blob/master/packages/polyfill-library/polyfills/Element/detect.js\r\nvar detect = ('Element' in this && 'HTMLElement' in this);\r\n\r\nif (detect) return\r\n\r\n// Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Element&flags=always\r\n(function () {\r\n\r\n\t// IE8\r\n\tif (window.Element && !window.HTMLElement) {\r\n\t\twindow.HTMLElement = window.Element;\r\n\t\treturn;\r\n\t}\r\n\r\n\t// create Element constructor\r\n\twindow.Element = window.HTMLElement = new Function('return function Element() {}')();\r\n\r\n\t// generate sandboxed iframe\r\n\tvar vbody = document.appendChild(document.createElement('body'));\r\n\tvar frame = vbody.appendChild(document.createElement('iframe'));\r\n\r\n\t// use sandboxed iframe to replicate Element functionality\r\n\tvar frameDocument = frame.contentWindow.document;\r\n\tvar prototype = Element.prototype = frameDocument.appendChild(frameDocument.createElement('*'));\r\n\tvar cache = {};\r\n\r\n\t// polyfill Element.prototype on an element\r\n\tvar shiv = function (element, deep) {\r\n\t\tvar\r\n\t\tchildNodes = element.childNodes || [],\r\n\t\tindex = -1,\r\n\t\tkey, value, childNode;\r\n\r\n\t\tif (element.nodeType === 1 && element.constructor !== Element) {\r\n\t\t\telement.constructor = Element;\r\n\r\n\t\t\tfor (key in cache) {\r\n\t\t\t\tvalue = cache[key];\r\n\t\t\t\telement[key] = value;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\twhile (childNode = deep && childNodes[++index]) {\r\n\t\t\tshiv(childNode, deep);\r\n\t\t}\r\n\r\n\t\treturn element;\r\n\t};\r\n\r\n\tvar elements = document.getElementsByTagName('*');\r\n\tvar nativeCreateElement = document.createElement;\r\n\tvar interval;\r\n\tvar loopLimit = 100;\r\n\r\n\tprototype.attachEvent('onpropertychange', function (event) {\r\n\t\tvar\r\n\t\tpropertyName = event.propertyName,\r\n\t\tnonValue = !cache.hasOwnProperty(propertyName),\r\n\t\tnewValue = prototype[propertyName],\r\n\t\toldValue = cache[propertyName],\r\n\t\tindex = -1,\r\n\t\telement;\r\n\r\n\t\twhile (element = elements[++index]) {\r\n\t\t\tif (element.nodeType === 1) {\r\n\t\t\t\tif (nonValue || element[propertyName] === oldValue) {\r\n\t\t\t\t\telement[propertyName] = newValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcache[propertyName] = newValue;\r\n\t});\r\n\r\n\tprototype.constructor = Element;\r\n\r\n\tif (!prototype.hasAttribute) {\r\n\t\t// <Element>.hasAttribute\r\n\t\tprototype.hasAttribute = function hasAttribute(name) {\r\n\t\t\treturn this.getAttribute(name) !== null;\r\n\t\t};\r\n\t}\r\n\r\n\t// Apply Element prototype to the pre-existing DOM as soon as the body element appears.\r\n\tfunction bodyCheck() {\r\n\t\tif (!(loopLimit--)) clearTimeout(interval);\r\n\t\tif (document.body && !document.body.prototype && /(complete|interactive)/.test(document.readyState)) {\r\n\t\t\tshiv(document, true);\r\n\t\t\tif (interval && document.body.prototype) clearTimeout(interval);\r\n\t\t\treturn (!!document.body.prototype);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tif (!bodyCheck()) {\r\n\t\tdocument.onreadystatechange = bodyCheck;\r\n\t\tinterval = setInterval(bodyCheck, 25);\r\n\t}\r\n\r\n\t// Apply to any new elements created after load\r\n\tdocument.createElement = function createElement(nodeName) {\r\n\t\tvar element = nativeCreateElement(String(nodeName).toLowerCase());\r\n\t\treturn shiv(element);\r\n\t};\r\n\r\n\t// remove sandboxed iframe\r\n\tdocument.removeChild(vbody);\r\n}());\r\n\r\n})\r\n.call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n    // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-service/8717a9e04ac7aff99b4980fbedead98036b0929a/packages/polyfill-library/polyfills/Element/prototype/classList/detect.js\r\n    var detect = (\r\n      'document' in this && \"classList\" in document.documentElement && 'Element' in this && 'classList' in Element.prototype && (function () {\r\n        var e = document.createElement('span');\r\n        e.classList.add('a', 'b');\r\n        return e.classList.contains('b');\r\n      }())\r\n    );\r\n\r\n    if (detect) return\r\n\r\n    // Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Element.prototype.classList&flags=always\r\n    (function (global) {\r\n      var dpSupport = true;\r\n      var defineGetter = function (object, name, fn, configurable) {\r\n        if (Object.defineProperty)\r\n          Object.defineProperty(object, name, {\r\n            configurable: false === dpSupport ? true : !!configurable,\r\n            get: fn\r\n          });\r\n\r\n        else object.__defineGetter__(name, fn);\r\n      };\r\n      /** Ensure the browser allows Object.defineProperty to be used on native JavaScript objects. */\r\n      try {\r\n        defineGetter({}, \"support\");\r\n      }\r\n      catch (e) {\r\n        dpSupport = false;\r\n      }\r\n      /** Polyfills a property with a DOMTokenList */\r\n      var addProp = function (o, name, attr) {\r\n\r\n        defineGetter(o.prototype, name, function () {\r\n          var tokenList;\r\n\r\n          var THIS = this,\r\n\r\n          /** Prevent this from firing twice for some reason. What the hell, IE. */\r\n          gibberishProperty = \"__defineGetter__\" + \"DEFINE_PROPERTY\" + name;\r\n          if(THIS[gibberishProperty]) return tokenList;\r\n          THIS[gibberishProperty] = true;\r\n\r\n          /**\r\n           * IE8 can't define properties on native JavaScript objects, so we'll use a dumb hack instead.\r\n           *\r\n           * What this is doing is creating a dummy element (\"reflection\") inside a detached phantom node (\"mirror\")\r\n           * that serves as the target of Object.defineProperty instead. While we could simply use the subject HTML\r\n           * element instead, this would conflict with element types which use indexed properties (such as forms and\r\n           * select lists).\r\n           */\r\n          if (false === dpSupport) {\r\n\r\n            var visage;\r\n            var mirror = addProp.mirror || document.createElement(\"div\");\r\n            var reflections = mirror.childNodes;\r\n            var l = reflections.length;\r\n\r\n            for (var i = 0; i < l; ++i)\r\n              if (reflections[i]._R === THIS) {\r\n                visage = reflections[i];\r\n                break;\r\n              }\r\n\r\n            /** Couldn't find an element's reflection inside the mirror. Materialise one. */\r\n            visage || (visage = mirror.appendChild(document.createElement(\"div\")));\r\n\r\n            tokenList = DOMTokenList.call(visage, THIS, attr);\r\n          } else tokenList = new DOMTokenList(THIS, attr);\r\n\r\n          defineGetter(THIS, name, function () {\r\n            return tokenList;\r\n          });\r\n          delete THIS[gibberishProperty];\r\n\r\n          return tokenList;\r\n        }, true);\r\n      };\r\n\r\n      addProp(global.Element, \"classList\", \"className\");\r\n      addProp(global.HTMLElement, \"classList\", \"className\");\r\n      addProp(global.HTMLLinkElement, \"relList\", \"rel\");\r\n      addProp(global.HTMLAnchorElement, \"relList\", \"rel\");\r\n      addProp(global.HTMLAreaElement, \"relList\", \"rel\");\r\n    }(this));\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n    // Detection from https://github.com/mdn/content/blob/cf607d68522cd35ee7670782d3ee3a361eaef2e4/files/en-us/web/javascript/reference/global_objects/string/trim/index.md#polyfill\r\n    var detect = ('trim' in String.prototype);\r\n    \r\n    if (detect) return\r\n\r\n    // Polyfill from https://github.com/mdn/content/blob/cf607d68522cd35ee7670782d3ee3a361eaef2e4/files/en-us/web/javascript/reference/global_objects/string/trim/index.md#polyfill\r\n    String.prototype.trim = function () {\r\n        return this.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\r\n    };\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n  // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-library/13cf7c340974d128d557580b5e2dafcd1b1192d1/polyfills/Element/prototype/dataset/detect.js\r\n  var detect = (function(){\r\n    if (!document.documentElement.dataset) {\r\n      return false;\r\n    }\r\n    var el = document.createElement('div');\r\n    el.setAttribute(\"data-a-b\", \"c\");\r\n    return el.dataset && el.dataset.aB == \"c\";\r\n  }());\r\n\r\n  if (detect) return\r\n\r\n  // Polyfill derived from  https://raw.githubusercontent.com/Financial-Times/polyfill-library/13cf7c340974d128d557580b5e2dafcd1b1192d1/polyfills/Element/prototype/dataset/polyfill.js\r\n  Object.defineProperty(Element.prototype, 'dataset', {\r\n    get: function() {\r\n      var element = this;\r\n      var attributes = this.attributes;\r\n      var map = {};\r\n  \r\n      for (var i = 0; i < attributes.length; i++) {\r\n        var attribute = attributes[i];\r\n  \r\n        // This regex has been edited from the original polyfill, to add\r\n        // support for period (.) separators in data-* attribute names. These\r\n        // are allowed in the HTML spec, but were not covered by the original\r\n        // polyfill's regex. We use periods in our i18n implementation.\r\n        if (attribute && attribute.name && (/^data-\\w[.\\w-]*$/).test(attribute.name)) {\r\n          var name = attribute.name;\r\n          var value = attribute.value;\r\n  \r\n          var propName = name.substr(5).replace(/-./g, function (prop) {\r\n            return prop.charAt(1).toUpperCase();\r\n          });\r\n          \r\n          // If this browser supports __defineGetter__ and __defineSetter__,\r\n          // continue using defineProperty. If not (like IE 8 and below), we use\r\n          // a hacky fallback which at least gives an object in the right format\r\n          if ('__defineGetter__' in Object.prototype && '__defineSetter__' in Object.prototype) {\r\n            Object.defineProperty(map, propName, {\r\n              enumerable: true,\r\n              get: function() {\r\n                return this.value;\r\n              }.bind({value: value || ''}),\r\n              set: function setter(name, value) {\r\n                if (typeof value !== 'undefined') {\r\n                  this.setAttribute(name, value);\r\n                } else {\r\n                  this.removeAttribute(name);\r\n                }\r\n              }.bind(element, name)\r\n            });\r\n          } else {\r\n            map[propName] = value;\r\n          }\r\n\r\n        }\r\n      }\r\n  \r\n      return map;\r\n    }\r\n  });\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n/**\r\n * Normalise string\r\n *\r\n * 'If it looks like a duck, and it quacks like a duck…' 🦆\r\n *\r\n * If the passed value looks like a boolean or a number, convert it to a boolean\r\n * or number.\r\n *\r\n * Designed to be used to convert config passed via data attributes (which are\r\n * always strings) into something sensible.\r\n *\r\n * @param {string} value - The value to normalise\r\n * @returns {string | boolean | number | undefined} Normalised data\r\n */\r\nfunction normaliseString (value) {\r\n  if (typeof value !== 'string') {\r\n    return value\r\n  }\r\n\r\n  var trimmedValue = value.trim();\r\n\r\n  if (trimmedValue === 'true') {\r\n    return true\r\n  }\r\n\r\n  if (trimmedValue === 'false') {\r\n    return false\r\n  }\r\n\r\n  // Empty / whitespace-only strings are considered finite so we need to check\r\n  // the length of the trimmed string as well\r\n  if (trimmedValue.length > 0 && isFinite(trimmedValue)) {\r\n    return Number(trimmedValue)\r\n  }\r\n\r\n  return value\r\n}\r\n\r\n/**\r\n * Normalise dataset\r\n *\r\n * Loop over an object and normalise each value using normaliseData function\r\n *\r\n * @param {DOMStringMap} dataset - HTML element dataset\r\n * @returns {Object<string, string | boolean | number | undefined>} Normalised dataset\r\n */\r\nfunction normaliseDataset (dataset) {\r\n  var out = {};\r\n\r\n  for (var key in dataset) {\r\n    out[key] = normaliseString(dataset[key]);\r\n  }\r\n\r\n  return out\r\n}\r\n\r\n/**\r\n * @constant\r\n * @type {AccordionTranslations}\r\n * @see Default value for {@link AccordionConfig.i18n}\r\n * @default\r\n */\r\nvar ACCORDION_TRANSLATIONS = {\r\n  hideAllSections: 'Hide all sections',\r\n  hideSection: 'Hide',\r\n  hideSectionAriaLabel: 'Hide this section',\r\n  showAllSections: 'Show all sections',\r\n  showSection: 'Show',\r\n  showSectionAriaLabel: 'Show this section'\r\n};\r\n\r\n/**\r\n * Accordion component\r\n *\r\n * This allows a collection of sections to be collapsed by default, showing only\r\n * their headers. Sections can be expanded or collapsed individually by clicking\r\n * their headers. A \"Show all sections\" button is also added to the top of the\r\n * accordion, which switches to \"Hide all sections\" when all the sections are\r\n * expanded.\r\n *\r\n * The state of each section is saved to the DOM via the `aria-expanded`\r\n * attribute, which also provides accessibility.\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for accordion\r\n * @param {AccordionConfig} [config] - Accordion config\r\n */\r\nfunction Accordion ($module, config) {\r\n  this.$module = $module;\r\n  this.$sections = $module.querySelectorAll('.govuk-accordion__section');\r\n  this.browserSupportsSessionStorage = helper.checkForSessionStorage();\r\n\r\n  var defaultConfig = {\r\n    i18n: ACCORDION_TRANSLATIONS\r\n  };\r\n  this.config = mergeConfigs(\r\n    defaultConfig,\r\n    config || {},\r\n    normaliseDataset($module.dataset)\r\n  );\r\n  this.i18n = new I18n(extractConfigByNamespace(this.config, 'i18n'));\r\n\r\n  this.controlsClass = 'govuk-accordion__controls';\r\n  this.showAllClass = 'govuk-accordion__show-all';\r\n  this.showAllTextClass = 'govuk-accordion__show-all-text';\r\n\r\n  this.sectionExpandedClass = 'govuk-accordion__section--expanded';\r\n  this.sectionButtonClass = 'govuk-accordion__section-button';\r\n  this.sectionHeaderClass = 'govuk-accordion__section-header';\r\n  this.sectionHeadingClass = 'govuk-accordion__section-heading';\r\n  this.sectionHeadingTextClass = 'govuk-accordion__section-heading-text';\r\n  this.sectionHeadingTextFocusClass = 'govuk-accordion__section-heading-text-focus';\r\n\r\n  this.sectionShowHideToggleClass = 'govuk-accordion__section-toggle';\r\n  this.sectionShowHideToggleFocusClass = 'govuk-accordion__section-toggle-focus';\r\n  this.sectionShowHideTextClass = 'govuk-accordion__section-toggle-text';\r\n  this.upChevronIconClass = 'govuk-accordion-nav__chevron';\r\n  this.downChevronIconClass = 'govuk-accordion-nav__chevron--down';\r\n\r\n  this.sectionSummaryClass = 'govuk-accordion__section-summary';\r\n  this.sectionSummaryFocusClass = 'govuk-accordion__section-summary-focus';\r\n}\r\n\r\n// Initialize component\r\nAccordion.prototype.init = function () {\r\n  // Check for module\r\n  if (!this.$module) {\r\n    return\r\n  }\r\n\r\n  this.initControls();\r\n  this.initSectionHeaders();\r\n\r\n  // See if \"Show all sections\" button text should be updated\r\n  var areAllSectionsOpen = this.checkIfAllSectionsOpen();\r\n  this.updateShowAllButton(areAllSectionsOpen);\r\n};\r\n\r\n// Initialise controls and set attributes\r\nAccordion.prototype.initControls = function () {\r\n  // Create \"Show all\" button and set attributes\r\n  this.$showAllButton = document.createElement('button');\r\n  this.$showAllButton.setAttribute('type', 'button');\r\n  this.$showAllButton.setAttribute('class', this.showAllClass);\r\n  this.$showAllButton.setAttribute('aria-expanded', 'false');\r\n\r\n  // Create icon, add to element\r\n  var $icon = document.createElement('span');\r\n  $icon.classList.add(this.upChevronIconClass);\r\n  this.$showAllButton.appendChild($icon);\r\n\r\n  // Create control wrapper and add controls to it\r\n  var $accordionControls = document.createElement('div');\r\n  $accordionControls.setAttribute('class', this.controlsClass);\r\n  $accordionControls.appendChild(this.$showAllButton);\r\n  this.$module.insertBefore($accordionControls, this.$module.firstChild);\r\n\r\n  // Build additional wrapper for Show all toggle text and place after icon\r\n  var $wrappershowAllText = document.createElement('span');\r\n  $wrappershowAllText.classList.add(this.showAllTextClass);\r\n  this.$showAllButton.appendChild($wrappershowAllText);\r\n\r\n  // Handle click events on the show/hide all button\r\n  this.$showAllButton.addEventListener('click', this.onShowOrHideAllToggle.bind(this));\r\n};\r\n\r\n// Initialise section headers\r\nAccordion.prototype.initSectionHeaders = function () {\r\n  // Loop through section headers\r\n  nodeListForEach(this.$sections, function ($section, i) {\r\n    // Set header attributes\r\n    var $header = $section.querySelector('.' + this.sectionHeaderClass);\r\n    this.constructHeaderMarkup($header, i);\r\n    this.setExpanded(this.isExpanded($section), $section);\r\n\r\n    // Handle events\r\n    $header.addEventListener('click', this.onSectionToggle.bind(this, $section));\r\n\r\n    // See if there is any state stored in sessionStorage and set the sections to\r\n    // open or closed.\r\n    this.setInitialState($section);\r\n  }.bind(this));\r\n};\r\n\r\nAccordion.prototype.constructHeaderMarkup = function ($headerWrapper, index) {\r\n  var $span = $headerWrapper.querySelector('.' + this.sectionButtonClass);\r\n  var $heading = $headerWrapper.querySelector('.' + this.sectionHeadingClass);\r\n  var $summary = $headerWrapper.querySelector('.' + this.sectionSummaryClass);\r\n\r\n  // Create a button element that will replace the '.govuk-accordion__section-button' span\r\n  var $button = document.createElement('button');\r\n  $button.setAttribute('type', 'button');\r\n  $button.setAttribute('aria-controls', this.$module.id + '-content-' + (index + 1));\r\n\r\n  // Copy all attributes (https://developer.mozilla.org/en-US/docs/Web/API/Element/attributes) from $span to $button\r\n  for (var i = 0; i < $span.attributes.length; i++) {\r\n    var attr = $span.attributes.item(i);\r\n    // Add all attributes but not ID as this is being added to\r\n    // the section heading ($headingText)\r\n    if (attr.nodeName !== 'id') {\r\n      $button.setAttribute(attr.nodeName, attr.nodeValue);\r\n    }\r\n  }\r\n\r\n  // Create container for heading text so it can be styled\r\n  var $headingText = document.createElement('span');\r\n  $headingText.classList.add(this.sectionHeadingTextClass);\r\n  // Copy the span ID to the heading text to allow it to be referenced by `aria-labelledby` on the\r\n  // hidden content area without \"Show this section\"\r\n  $headingText.id = $span.id;\r\n\r\n  // Create an inner heading text container to limit the width of the focus state\r\n  var $headingTextFocus = document.createElement('span');\r\n  $headingTextFocus.classList.add(this.sectionHeadingTextFocusClass);\r\n  $headingText.appendChild($headingTextFocus);\r\n  // span could contain HTML elements (see https://www.w3.org/TR/2011/WD-html5-20110525/content-models.html#phrasing-content)\r\n  $headingTextFocus.innerHTML = $span.innerHTML;\r\n\r\n  // Create container for show / hide icons and text.\r\n  var $showToggle = document.createElement('span');\r\n  $showToggle.classList.add(this.sectionShowHideToggleClass);\r\n  // Tell Google not to index the 'show' text as part of the heading\r\n  // For the snippet to work with JavaScript, it must be added before adding the page element to the\r\n  // page's DOM. See https://developers.google.com/search/docs/advanced/robots/robots_meta_tag#data-nosnippet-attr\r\n  $showToggle.setAttribute('data-nosnippet', '');\r\n  // Create an inner container to limit the width of the focus state\r\n  var $showToggleFocus = document.createElement('span');\r\n  $showToggleFocus.classList.add(this.sectionShowHideToggleFocusClass);\r\n  $showToggle.appendChild($showToggleFocus);\r\n  // Create wrapper for the show / hide text. Append text after the show/hide icon\r\n  var $showToggleText = document.createElement('span');\r\n  var $icon = document.createElement('span');\r\n  $icon.classList.add(this.upChevronIconClass);\r\n  $showToggleFocus.appendChild($icon);\r\n  $showToggleText.classList.add(this.sectionShowHideTextClass);\r\n  $showToggleFocus.appendChild($showToggleText);\r\n\r\n  // Append elements to the button:\r\n  // 1. Heading text\r\n  // 2. Punctuation\r\n  // 3. (Optional: Summary line followed by punctuation)\r\n  // 4. Show / hide toggle\r\n  $button.appendChild($headingText);\r\n  $button.appendChild(this.getButtonPunctuationEl());\r\n\r\n  // If summary content exists add to DOM in correct order\r\n  if (typeof ($summary) !== 'undefined' && $summary !== null) {\r\n    // Create a new `span` element and copy the summary line content from the original `div` to the\r\n    // new `span`\r\n    // This is because the summary line text is now inside a button element, which can only contain\r\n    // phrasing content\r\n    var $summarySpan = document.createElement('span');\r\n    // Create an inner summary container to limit the width of the summary focus state\r\n    var $summarySpanFocus = document.createElement('span');\r\n    $summarySpanFocus.classList.add(this.sectionSummaryFocusClass);\r\n    $summarySpan.appendChild($summarySpanFocus);\r\n\r\n    // Get original attributes, and pass them to the replacement\r\n    for (var j = 0, l = $summary.attributes.length; j < l; ++j) {\r\n      var nodeName = $summary.attributes.item(j).nodeName;\r\n      var nodeValue = $summary.attributes.item(j).nodeValue;\r\n      $summarySpan.setAttribute(nodeName, nodeValue);\r\n    }\r\n\r\n    // Copy original contents of summary to the new summary span\r\n    $summarySpanFocus.innerHTML = $summary.innerHTML;\r\n\r\n    // Replace the original summary `div` with the new summary `span`\r\n    $summary.parentNode.replaceChild($summarySpan, $summary);\r\n\r\n    $button.appendChild($summarySpan);\r\n    $button.appendChild(this.getButtonPunctuationEl());\r\n  }\r\n\r\n  $button.appendChild($showToggle);\r\n\r\n  $heading.removeChild($span);\r\n  $heading.appendChild($button);\r\n};\r\n\r\n// When section toggled, set and store state\r\nAccordion.prototype.onSectionToggle = function ($section) {\r\n  var expanded = this.isExpanded($section);\r\n  this.setExpanded(!expanded, $section);\r\n\r\n  // Store the state in sessionStorage when a change is triggered\r\n  this.storeState($section);\r\n};\r\n\r\n// When Open/Close All toggled, set and store state\r\nAccordion.prototype.onShowOrHideAllToggle = function () {\r\n  var $module = this;\r\n  var $sections = this.$sections;\r\n  var nowExpanded = !this.checkIfAllSectionsOpen();\r\n\r\n  nodeListForEach($sections, function ($section) {\r\n    $module.setExpanded(nowExpanded, $section);\r\n    // Store the state in sessionStorage when a change is triggered\r\n    $module.storeState($section);\r\n  });\r\n\r\n  $module.updateShowAllButton(nowExpanded);\r\n};\r\n\r\n// Set section attributes when opened/closed\r\nAccordion.prototype.setExpanded = function (expanded, $section) {\r\n  var $icon = $section.querySelector('.' + this.upChevronIconClass);\r\n  var $showHideText = $section.querySelector('.' + this.sectionShowHideTextClass);\r\n  var $button = $section.querySelector('.' + this.sectionButtonClass);\r\n  var newButtonText = expanded\r\n    ? this.i18n.t('hideSection')\r\n    : this.i18n.t('showSection');\r\n\r\n  $showHideText.innerText = newButtonText;\r\n  $button.setAttribute('aria-expanded', expanded);\r\n\r\n  // Update aria-label combining\r\n  var $header = $section.querySelector('.' + this.sectionHeadingTextClass);\r\n  var ariaLabelParts = [$header.innerText.trim()];\r\n\r\n  var $summary = $section.querySelector('.' + this.sectionSummaryClass);\r\n  if ($summary) {\r\n    ariaLabelParts.push($summary.innerText.trim());\r\n  }\r\n\r\n  var ariaLabelMessage = expanded\r\n    ? this.i18n.t('hideSectionAriaLabel')\r\n    : this.i18n.t('showSectionAriaLabel');\r\n  ariaLabelParts.push(ariaLabelMessage);\r\n\r\n  /*\r\n   * Join with a comma to add pause for assistive technology.\r\n   * Example: [heading]Section A ,[pause] Show this section.\r\n   * https://accessibility.blog.gov.uk/2017/12/18/what-working-on-gov-uk-navigation-taught-us-about-accessibility/\r\n   */\r\n  $button.setAttribute('aria-label', ariaLabelParts.join(' , '));\r\n\r\n  // Swap icon, change class\r\n  if (expanded) {\r\n    $section.classList.add(this.sectionExpandedClass);\r\n    $icon.classList.remove(this.downChevronIconClass);\r\n  } else {\r\n    $section.classList.remove(this.sectionExpandedClass);\r\n    $icon.classList.add(this.downChevronIconClass);\r\n  }\r\n\r\n  // See if \"Show all sections\" button text should be updated\r\n  var areAllSectionsOpen = this.checkIfAllSectionsOpen();\r\n  this.updateShowAllButton(areAllSectionsOpen);\r\n};\r\n\r\n// Get state of section\r\nAccordion.prototype.isExpanded = function ($section) {\r\n  return $section.classList.contains(this.sectionExpandedClass)\r\n};\r\n\r\n// Check if all sections are open\r\nAccordion.prototype.checkIfAllSectionsOpen = function () {\r\n  // Get a count of all the Accordion sections\r\n  var sectionsCount = this.$sections.length;\r\n  // Get a count of all Accordion sections that are expanded\r\n  var expandedSectionCount = this.$module.querySelectorAll('.' + this.sectionExpandedClass).length;\r\n  var areAllSectionsOpen = sectionsCount === expandedSectionCount;\r\n\r\n  return areAllSectionsOpen\r\n};\r\n\r\n// Update \"Show all sections\" button\r\nAccordion.prototype.updateShowAllButton = function (expanded) {\r\n  var $showAllIcon = this.$showAllButton.querySelector('.' + this.upChevronIconClass);\r\n  var $showAllText = this.$showAllButton.querySelector('.' + this.showAllTextClass);\r\n  var newButtonText = expanded\r\n    ? this.i18n.t('hideAllSections')\r\n    : this.i18n.t('showAllSections');\r\n  this.$showAllButton.setAttribute('aria-expanded', expanded);\r\n  $showAllText.innerText = newButtonText;\r\n\r\n  // Swap icon, toggle class\r\n  if (expanded) {\r\n    $showAllIcon.classList.remove(this.downChevronIconClass);\r\n  } else {\r\n    $showAllIcon.classList.add(this.downChevronIconClass);\r\n  }\r\n};\r\n\r\n// Check for `window.sessionStorage`, and that it actually works.\r\nvar helper = {\r\n  checkForSessionStorage: function () {\r\n    var testString = 'this is the test string';\r\n    var result;\r\n    try {\r\n      window.sessionStorage.setItem(testString, testString);\r\n      result = window.sessionStorage.getItem(testString) === testString.toString();\r\n      window.sessionStorage.removeItem(testString);\r\n      return result\r\n    } catch (exception) {\r\n      return false\r\n    }\r\n  }\r\n};\r\n\r\n// Set the state of the accordions in sessionStorage\r\nAccordion.prototype.storeState = function ($section) {\r\n  if (this.browserSupportsSessionStorage) {\r\n    // We need a unique way of identifying each content in the Accordion. Since\r\n    // an `#id` should be unique and an `id` is required for `aria-` attributes\r\n    // `id` can be safely used.\r\n    var $button = $section.querySelector('.' + this.sectionButtonClass);\r\n\r\n    if ($button) {\r\n      var contentId = $button.getAttribute('aria-controls');\r\n      var contentState = $button.getAttribute('aria-expanded');\r\n\r\n      // Only set the state when both `contentId` and `contentState` are taken from the DOM.\r\n      if (contentId && contentState) {\r\n        window.sessionStorage.setItem(contentId, contentState);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n// Read the state of the accordions from sessionStorage\r\nAccordion.prototype.setInitialState = function ($section) {\r\n  if (this.browserSupportsSessionStorage) {\r\n    var $button = $section.querySelector('.' + this.sectionButtonClass);\r\n\r\n    if ($button) {\r\n      var contentId = $button.getAttribute('aria-controls');\r\n      var contentState = contentId ? window.sessionStorage.getItem(contentId) : null;\r\n\r\n      if (contentState !== null) {\r\n        this.setExpanded(contentState === 'true', $section);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Create an element to improve semantics of the section button with punctuation\r\n *\r\n * @returns {HTMLSpanElement} DOM element\r\n *\r\n * Adding punctuation to the button can also improve its general semantics by dividing its contents\r\n * into thematic chunks.\r\n * See https://github.com/alphagov/govuk-frontend/issues/2327#issuecomment-922957442\r\n */\r\nAccordion.prototype.getButtonPunctuationEl = function () {\r\n  var $punctuationEl = document.createElement('span');\r\n  $punctuationEl.classList.add('govuk-visually-hidden', 'govuk-accordion__section-heading-divider');\r\n  $punctuationEl.innerHTML = ', ';\r\n  return $punctuationEl\r\n};\r\n\r\n/**\r\n * Accordion config\r\n *\r\n * @typedef {object} AccordionConfig\r\n * @property {AccordionTranslations} [i18n = ACCORDION_TRANSLATIONS] - See constant {@link ACCORDION_TRANSLATIONS}\r\n */\r\n\r\n/**\r\n * Accordion translations\r\n *\r\n * @typedef {object} AccordionTranslations\r\n *\r\n * Messages used by the component for the labels of its buttons. This includes\r\n * the visible text shown on screen, and text to help assistive technology users\r\n * for the buttons toggling each section.\r\n * @property {string} [hideAllSections] - The text content for the 'Hide all\r\n * sections' button, used when at least one section is expanded.\r\n * @property {string} [hideSection] - The text content for the 'Hide'\r\n * button, used when a section is expanded.\r\n * @property {string} [hideSectionAriaLabel] - The text content appended to the\r\n * 'Hide' button's accessible name when a section is expanded.\r\n * @property {string} [showAllSections] - The text content for the 'Show all\r\n * sections' button, used when all sections are collapsed.\r\n * @property {string} [showSection] - The text content for the 'Show'\r\n * button, used when a section is collapsed.\r\n * @property {string} [showSectionAriaLabel] - The text content appended to the\r\n * 'Show' button's accessible name when a section is expanded.\r\n */\r\n\r\n(function(undefined) {\r\n\r\n// Detection from https://github.com/Financial-Times/polyfill-service/blob/master/packages/polyfill-library/polyfills/Window/detect.js\r\nvar detect = ('Window' in this);\r\n\r\nif (detect) return\r\n\r\n// Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Window&flags=always\r\nif ((typeof WorkerGlobalScope === \"undefined\") && (typeof importScripts !== \"function\")) {\r\n\t(function (global) {\r\n\t\tif (global.constructor) {\r\n\t\t\tglobal.Window = global.constructor;\r\n\t\t} else {\r\n\t\t\t(global.Window = global.constructor = new Function('return function Window() {}')()).prototype = this;\r\n\t\t}\r\n\t}(this));\r\n}\r\n\r\n})\r\n.call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n// Detection from https://github.com/Financial-Times/polyfill-service/blob/master/packages/polyfill-library/polyfills/Event/detect.js\r\nvar detect = (\r\n  (function(global) {\r\n\r\n  \tif (!('Event' in global)) return false;\r\n  \tif (typeof global.Event === 'function') return true;\r\n\r\n  \ttry {\r\n\r\n  \t\t// In IE 9-11, the Event object exists but cannot be instantiated\r\n  \t\tnew Event('click');\r\n  \t\treturn true;\r\n  \t} catch(e) {\r\n  \t\treturn false;\r\n  \t}\r\n  }(this))\r\n);\r\n\r\nif (detect) return\r\n\r\n// Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Event&flags=always\r\n(function () {\r\n\tvar unlistenableWindowEvents = {\r\n\t\tclick: 1,\r\n\t\tdblclick: 1,\r\n\t\tkeyup: 1,\r\n\t\tkeypress: 1,\r\n\t\tkeydown: 1,\r\n\t\tmousedown: 1,\r\n\t\tmouseup: 1,\r\n\t\tmousemove: 1,\r\n\t\tmouseover: 1,\r\n\t\tmouseenter: 1,\r\n\t\tmouseleave: 1,\r\n\t\tmouseout: 1,\r\n\t\tstorage: 1,\r\n\t\tstoragecommit: 1,\r\n\t\ttextinput: 1\r\n\t};\r\n\r\n\t// This polyfill depends on availability of `document` so will not run in a worker\r\n\t// However, we asssume there are no browsers with worker support that lack proper\r\n\t// support for `Event` within the worker\r\n\tif (typeof document === 'undefined' || typeof window === 'undefined') return;\r\n\r\n\tfunction indexOf(array, element) {\r\n\t\tvar\r\n\t\tindex = -1,\r\n\t\tlength = array.length;\r\n\r\n\t\twhile (++index < length) {\r\n\t\t\tif (index in array && array[index] === element) {\r\n\t\t\t\treturn index;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn -1;\r\n\t}\r\n\r\n\tvar existingProto = (window.Event && window.Event.prototype) || null;\r\n\twindow.Event = Window.prototype.Event = function Event(type, eventInitDict) {\r\n\t\tif (!type) {\r\n\t\t\tthrow new Error('Not enough arguments');\r\n\t\t}\r\n\r\n\t\tvar event;\r\n\t\t// Shortcut if browser supports createEvent\r\n\t\tif ('createEvent' in document) {\r\n\t\t\tevent = document.createEvent('Event');\r\n\t\t\tvar bubbles = eventInitDict && eventInitDict.bubbles !== undefined ? eventInitDict.bubbles : false;\r\n\t\t\tvar cancelable = eventInitDict && eventInitDict.cancelable !== undefined ? eventInitDict.cancelable : false;\r\n\r\n\t\t\tevent.initEvent(type, bubbles, cancelable);\r\n\r\n\t\t\treturn event;\r\n\t\t}\r\n\r\n\t\tevent = document.createEventObject();\r\n\r\n\t\tevent.type = type;\r\n\t\tevent.bubbles = eventInitDict && eventInitDict.bubbles !== undefined ? eventInitDict.bubbles : false;\r\n\t\tevent.cancelable = eventInitDict && eventInitDict.cancelable !== undefined ? eventInitDict.cancelable : false;\r\n\r\n\t\treturn event;\r\n\t};\r\n\tif (existingProto) {\r\n\t\tObject.defineProperty(window.Event, 'prototype', {\r\n\t\t\tconfigurable: false,\r\n\t\t\tenumerable: false,\r\n\t\t\twritable: true,\r\n\t\t\tvalue: existingProto\r\n\t\t});\r\n\t}\r\n\r\n\tif (!('createEvent' in document)) {\r\n\t\twindow.addEventListener = Window.prototype.addEventListener = Document.prototype.addEventListener = Element.prototype.addEventListener = function addEventListener() {\r\n\t\t\tvar\r\n\t\t\telement = this,\r\n\t\t\ttype = arguments[0],\r\n\t\t\tlistener = arguments[1];\r\n\r\n\t\t\tif (element === window && type in unlistenableWindowEvents) {\r\n\t\t\t\tthrow new Error('In IE8 the event: ' + type + ' is not available on the window object. Please see https://github.com/Financial-Times/polyfill-service/issues/317 for more information.');\r\n\t\t\t}\r\n\r\n\t\t\tif (!element._events) {\r\n\t\t\t\telement._events = {};\r\n\t\t\t}\r\n\r\n\t\t\tif (!element._events[type]) {\r\n\t\t\t\telement._events[type] = function (event) {\r\n\t\t\t\t\tvar\r\n\t\t\t\t\tlist = element._events[event.type].list,\r\n\t\t\t\t\tevents = list.slice(),\r\n\t\t\t\t\tindex = -1,\r\n\t\t\t\t\tlength = events.length,\r\n\t\t\t\t\teventElement;\r\n\r\n\t\t\t\t\tevent.preventDefault = function preventDefault() {\r\n\t\t\t\t\t\tif (event.cancelable !== false) {\r\n\t\t\t\t\t\t\tevent.returnValue = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tevent.stopPropagation = function stopPropagation() {\r\n\t\t\t\t\t\tevent.cancelBubble = true;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tevent.stopImmediatePropagation = function stopImmediatePropagation() {\r\n\t\t\t\t\t\tevent.cancelBubble = true;\r\n\t\t\t\t\t\tevent.cancelImmediate = true;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tevent.currentTarget = element;\r\n\t\t\t\t\tevent.relatedTarget = event.fromElement || null;\r\n\t\t\t\t\tevent.target = event.target || event.srcElement || element;\r\n\t\t\t\t\tevent.timeStamp = new Date().getTime();\r\n\r\n\t\t\t\t\tif (event.clientX) {\r\n\t\t\t\t\t\tevent.pageX = event.clientX + document.documentElement.scrollLeft;\r\n\t\t\t\t\t\tevent.pageY = event.clientY + document.documentElement.scrollTop;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\twhile (++index < length && !event.cancelImmediate) {\r\n\t\t\t\t\t\tif (index in events) {\r\n\t\t\t\t\t\t\teventElement = events[index];\r\n\r\n\t\t\t\t\t\t\tif (indexOf(list, eventElement) !== -1 && typeof eventElement === 'function') {\r\n\t\t\t\t\t\t\t\teventElement.call(element, event);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\telement._events[type].list = [];\r\n\r\n\t\t\t\tif (element.attachEvent) {\r\n\t\t\t\t\telement.attachEvent('on' + type, element._events[type]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\telement._events[type].list.push(listener);\r\n\t\t};\r\n\r\n\t\twindow.removeEventListener = Window.prototype.removeEventListener = Document.prototype.removeEventListener = Element.prototype.removeEventListener = function removeEventListener() {\r\n\t\t\tvar\r\n\t\t\telement = this,\r\n\t\t\ttype = arguments[0],\r\n\t\t\tlistener = arguments[1],\r\n\t\t\tindex;\r\n\r\n\t\t\tif (element._events && element._events[type] && element._events[type].list) {\r\n\t\t\t\tindex = indexOf(element._events[type].list, listener);\r\n\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\telement._events[type].list.splice(index, 1);\r\n\r\n\t\t\t\t\tif (!element._events[type].list.length) {\r\n\t\t\t\t\t\tif (element.detachEvent) {\r\n\t\t\t\t\t\t\telement.detachEvent('on' + type, element._events[type]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdelete element._events[type];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\twindow.dispatchEvent = Window.prototype.dispatchEvent = Document.prototype.dispatchEvent = Element.prototype.dispatchEvent = function dispatchEvent(event) {\r\n\t\t\tif (!arguments.length) {\r\n\t\t\t\tthrow new Error('Not enough arguments');\r\n\t\t\t}\r\n\r\n\t\t\tif (!event || typeof event.type !== 'string') {\r\n\t\t\t\tthrow new Error('DOM Events Exception 0');\r\n\t\t\t}\r\n\r\n\t\t\tvar element = this, type = event.type;\r\n\r\n\t\t\ttry {\r\n\t\t\t\tif (!event.bubbles) {\r\n\t\t\t\t\tevent.cancelBubble = true;\r\n\r\n\t\t\t\t\tvar cancelBubbleEvent = function (event) {\r\n\t\t\t\t\t\tevent.cancelBubble = true;\r\n\r\n\t\t\t\t\t\t(element || window).detachEvent('on' + type, cancelBubbleEvent);\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tthis.attachEvent('on' + type, cancelBubbleEvent);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.fireEvent('on' + type, event);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tevent.target = element;\r\n\r\n\t\t\t\tdo {\r\n\t\t\t\t\tevent.currentTarget = element;\r\n\r\n\t\t\t\t\tif ('_events' in element && typeof element._events[type] === 'function') {\r\n\t\t\t\t\t\telement._events[type].call(element, event);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (typeof element['on' + type] === 'function') {\r\n\t\t\t\t\t\telement['on' + type].call(element, event);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telement = element.nodeType === 9 ? element.parentWindow : element.parentNode;\r\n\t\t\t\t} while (element && !event.cancelBubble);\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\t// Add the DOMContentLoaded Event\r\n\t\tdocument.attachEvent('onreadystatechange', function() {\r\n\t\t\tif (document.readyState === 'complete') {\r\n\t\t\t\tdocument.dispatchEvent(new Event('DOMContentLoaded', {\r\n\t\t\t\t\tbubbles: true\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}());\r\n\r\n})\r\n.call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\nvar KEY_SPACE = 32;\r\nvar DEBOUNCE_TIMEOUT_IN_SECONDS = 1;\r\n\r\n/**\r\n * JavaScript enhancements for the Button component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - The element this component controls\r\n * @param {ButtonConfig} config - Button config\r\n */\r\nfunction Button ($module, config) {\r\n  if (!$module) {\r\n    return this\r\n  }\r\n\r\n  this.$module = $module;\r\n  this.debounceFormSubmitTimer = null;\r\n\r\n  var defaultConfig = {\r\n    preventDoubleClick: false\r\n  };\r\n  this.config = mergeConfigs(\r\n    defaultConfig,\r\n    config || {},\r\n    normaliseDataset($module.dataset)\r\n  );\r\n}\r\n\r\n/**\r\n * Initialise component\r\n */\r\nButton.prototype.init = function () {\r\n  if (!this.$module) {\r\n    return\r\n  }\r\n\r\n  this.$module.addEventListener('keydown', this.handleKeyDown);\r\n  this.$module.addEventListener('click', this.debounce.bind(this));\r\n};\r\n\r\n/**\r\n * Trigger a click event when the space key is pressed\r\n *\r\n * Some screen readers tell users they can activate things with the 'button'\r\n * role, so we need to match the functionality of native HTML buttons\r\n *\r\n * See https://github.com/alphagov/govuk_elements/pull/272#issuecomment-233028270\r\n *\r\n * @param {KeyboardEvent} event\r\n */\r\nButton.prototype.handleKeyDown = function (event) {\r\n  var target = event.target;\r\n\r\n  if (target.getAttribute('role') === 'button' && event.keyCode === KEY_SPACE) {\r\n    event.preventDefault(); // prevent the page from scrolling\r\n    target.click();\r\n  }\r\n};\r\n\r\n/**\r\n * Debounce double-clicks\r\n *\r\n * If the click quickly succeeds a previous click then nothing will happen. This\r\n * stops people accidentally causing multiple form submissions by double\r\n * clicking buttons.\r\n *\r\n * @param {MouseEvent} event\r\n * @returns {undefined | false} - Returns undefined, or false when debounced\r\n */\r\nButton.prototype.debounce = function (event) {\r\n  // Check the button that was clicked has preventDoubleClick enabled\r\n  if (!this.config.preventDoubleClick) {\r\n    return\r\n  }\r\n\r\n  // If the timer is still running, prevent the click from submitting the form\r\n  if (this.debounceFormSubmitTimer) {\r\n    event.preventDefault();\r\n    return false\r\n  }\r\n\r\n  this.debounceFormSubmitTimer = setTimeout(function () {\r\n    this.debounceFormSubmitTimer = null;\r\n  }.bind(this), DEBOUNCE_TIMEOUT_IN_SECONDS * 1000);\r\n};\r\n\r\n/**\r\n * Button config\r\n *\r\n * @typedef {object} ButtonConfig\r\n * @property {boolean} [preventDoubleClick = false] -\r\n *  Prevent accidental double clicks on submit buttons from submitting forms\r\n *  multiple times.\r\n */\r\n\r\n/**\r\n * JavaScript 'polyfill' for HTML5's <details> and <summary> elements\r\n * and 'shim' to add accessiblity enhancements for all browsers\r\n *\r\n * http://caniuse.com/#feat=details\r\n */\r\n\r\nvar KEY_ENTER = 13;\r\nvar KEY_SPACE$1 = 32;\r\n\r\n/**\r\n * Details component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for details\r\n */\r\nfunction Details ($module) {\r\n  this.$module = $module;\r\n}\r\n\r\nDetails.prototype.init = function () {\r\n  if (!this.$module) {\r\n    return\r\n  }\r\n\r\n  // If there is native details support, we want to avoid running code to polyfill native behaviour.\r\n  var hasNativeDetails = typeof this.$module.open === 'boolean';\r\n\r\n  if (hasNativeDetails) {\r\n    return\r\n  }\r\n\r\n  this.polyfillDetails();\r\n};\r\n\r\nDetails.prototype.polyfillDetails = function () {\r\n  var $module = this.$module;\r\n\r\n  // Save shortcuts to the inner summary and content elements\r\n  var $summary = this.$summary = $module.getElementsByTagName('summary').item(0);\r\n  var $content = this.$content = $module.getElementsByTagName('div').item(0);\r\n\r\n  // If <details> doesn't have a <summary> and a <div> representing the content\r\n  // it means the required HTML structure is not met so the script will stop\r\n  if (!$summary || !$content) {\r\n    return\r\n  }\r\n\r\n  // If the content doesn't have an ID, assign it one now\r\n  // which we'll need for the summary's aria-controls assignment\r\n  if (!$content.id) {\r\n    $content.id = 'details-content-' + generateUniqueID();\r\n  }\r\n\r\n  // Add ARIA role=\"group\" to details\r\n  $module.setAttribute('role', 'group');\r\n\r\n  // Add role=button to summary\r\n  $summary.setAttribute('role', 'button');\r\n\r\n  // Add aria-controls\r\n  $summary.setAttribute('aria-controls', $content.id);\r\n\r\n  // Set tabIndex so the summary is keyboard accessible for non-native elements\r\n  //\r\n  // We have to use the camelcase `tabIndex` property as there is a bug in IE6/IE7 when we set the correct attribute lowercase:\r\n  // See http://web.archive.org/web/20170120194036/http://www.saliences.com/browserBugs/tabIndex.html for more information.\r\n  $summary.tabIndex = 0;\r\n\r\n  // Detect initial open state\r\n  if (this.$module.hasAttribute('open')) {\r\n    $summary.setAttribute('aria-expanded', 'true');\r\n  } else {\r\n    $summary.setAttribute('aria-expanded', 'false');\r\n    $content.style.display = 'none';\r\n  }\r\n\r\n  // Bind an event to handle summary elements\r\n  this.polyfillHandleInputs($summary, this.polyfillSetAttributes.bind(this));\r\n};\r\n\r\n/**\r\n * Define a statechange function that updates aria-expanded and style.display\r\n *\r\n * @returns {boolean} Returns true\r\n */\r\nDetails.prototype.polyfillSetAttributes = function () {\r\n  if (this.$module.hasAttribute('open')) {\r\n    this.$module.removeAttribute('open');\r\n    this.$summary.setAttribute('aria-expanded', 'false');\r\n    this.$content.style.display = 'none';\r\n  } else {\r\n    this.$module.setAttribute('open', 'open');\r\n    this.$summary.setAttribute('aria-expanded', 'true');\r\n    this.$content.style.display = '';\r\n  }\r\n\r\n  return true\r\n};\r\n\r\n/**\r\n * Handle cross-modal click events\r\n *\r\n * @param {object} node - element\r\n * @param {polyfillHandleInputsCallback} callback - function\r\n */\r\nDetails.prototype.polyfillHandleInputs = function (node, callback) {\r\n  node.addEventListener('keypress', function (event) {\r\n    var target = event.target;\r\n    // When the key gets pressed - check if it is enter or space\r\n    if (event.keyCode === KEY_ENTER || event.keyCode === KEY_SPACE$1) {\r\n      if (target.nodeName.toLowerCase() === 'summary') {\r\n        // Prevent space from scrolling the page\r\n        // and enter from submitting a form\r\n        event.preventDefault();\r\n        // Click to let the click event do all the necessary action\r\n        if (target.click) {\r\n          target.click();\r\n        } else {\r\n          // except Safari 5.1 and under don't support .click() here\r\n          callback(event);\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  // Prevent keyup to prevent clicking twice in Firefox when using space key\r\n  node.addEventListener('keyup', function (event) {\r\n    var target = event.target;\r\n    if (event.keyCode === KEY_SPACE$1) {\r\n      if (target.nodeName.toLowerCase() === 'summary') {\r\n        event.preventDefault();\r\n      }\r\n    }\r\n  });\r\n\r\n  node.addEventListener('click', callback);\r\n};\r\n\r\n/**\r\n * @callback polyfillHandleInputsCallback\r\n * @param {KeyboardEvent} event - Keyboard event\r\n * @returns {undefined}\r\n */\r\n\r\n(function(undefined) {\r\n\r\n    // Detection from https://github.com/Financial-Times/polyfill-library/blob/v3.111.0/polyfills/Date/now/detect.js\r\n    var detect = ('Date' in self && 'now' in self.Date && 'getTime' in self.Date.prototype);\r\n\r\n    if (detect) return\r\n\r\n    // Polyfill from https://polyfill.io/v3/polyfill.js?version=3.111.0&features=Date.now&flags=always\r\n    Date.now = function () {\r\n        return new Date().getTime();\r\n    };\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n  // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-service/1f3c09b402f65bf6e393f933a15ba63f1b86ef1f/packages/polyfill-library/polyfills/Element/prototype/matches/detect.js\r\n  var detect = (\r\n    'document' in this && \"matches\" in document.documentElement\r\n  );\r\n\r\n  if (detect) return\r\n\r\n  // Polyfill from https://raw.githubusercontent.com/Financial-Times/polyfill-service/1f3c09b402f65bf6e393f933a15ba63f1b86ef1f/packages/polyfill-library/polyfills/Element/prototype/matches/polyfill.js\r\n  Element.prototype.matches = Element.prototype.webkitMatchesSelector || Element.prototype.oMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.mozMatchesSelector || function matches(selector) {\r\n    var element = this;\r\n    var elements = (element.document || element.ownerDocument).querySelectorAll(selector);\r\n    var index = 0;\r\n\r\n    while (elements[index] && elements[index] !== element) {\r\n      ++index;\r\n    }\r\n\r\n    return !!elements[index];\r\n  };\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n  // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-service/1f3c09b402f65bf6e393f933a15ba63f1b86ef1f/packages/polyfill-library/polyfills/Element/prototype/closest/detect.js\r\n  var detect = (\r\n    'document' in this && \"closest\" in document.documentElement\r\n  );\r\n\r\n  if (detect) return\r\n\r\n  // Polyfill from https://raw.githubusercontent.com/Financial-Times/polyfill-service/1f3c09b402f65bf6e393f933a15ba63f1b86ef1f/packages/polyfill-library/polyfills/Element/prototype/closest/polyfill.js\r\n  Element.prototype.closest = function closest(selector) {\r\n    var node = this;\r\n\r\n    while (node) {\r\n      if (node.matches(selector)) return node;\r\n      else node = 'SVGElement' in window && node instanceof SVGElement ? node.parentNode : node.parentElement;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n/**\r\n * Returns the value of the given attribute closest to the given element (including itself)\r\n *\r\n * @param {HTMLElement} $element - The element to start walking the DOM tree up\r\n * @param {string} attributeName - The name of the attribute\r\n * @returns {string | undefined} Attribute value\r\n */\r\nfunction closestAttributeValue ($element, attributeName) {\r\n  var closestElementWithAttribute = $element.closest('[' + attributeName + ']');\r\n  if (closestElementWithAttribute) {\r\n    return closestElementWithAttribute.getAttribute(attributeName)\r\n  }\r\n}\r\n\r\n/**\r\n * @constant\r\n * @type {CharacterCountTranslations}\r\n * @see Default value for {@link CharacterCountConfig.i18n}\r\n * @default\r\n */\r\nvar CHARACTER_COUNT_TRANSLATIONS = {\r\n  // Characters\r\n  charactersUnderLimit: {\r\n    one: 'You have %{count} character remaining',\r\n    other: 'You have %{count} characters remaining'\r\n  },\r\n  charactersAtLimit: 'You have 0 characters remaining',\r\n  charactersOverLimit: {\r\n    one: 'You have %{count} character too many',\r\n    other: 'You have %{count} characters too many'\r\n  },\r\n  // Words\r\n  wordsUnderLimit: {\r\n    one: 'You have %{count} word remaining',\r\n    other: 'You have %{count} words remaining'\r\n  },\r\n  wordsAtLimit: 'You have 0 words remaining',\r\n  wordsOverLimit: {\r\n    one: 'You have %{count} word too many',\r\n    other: 'You have %{count} words too many'\r\n  },\r\n  textareaDescription: {\r\n    other: ''\r\n  }\r\n};\r\n\r\n/**\r\n * JavaScript enhancements for the CharacterCount component\r\n *\r\n * Tracks the number of characters or words in the `.govuk-js-character-count`\r\n * `<textarea>` inside the element. Displays a message with the remaining number\r\n * of characters/words available, or the number of characters/words in excess.\r\n *\r\n * You can configure the message to only appear after a certain percentage\r\n * of the available characters/words has been entered.\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - The element this component controls\r\n * @param {CharacterCountConfig} [config] - Character count config\r\n */\r\nfunction CharacterCount ($module, config) {\r\n  if (!$module) {\r\n    return this\r\n  }\r\n\r\n  var defaultConfig = {\r\n    threshold: 0,\r\n    i18n: CHARACTER_COUNT_TRANSLATIONS\r\n  };\r\n\r\n  // Read config set using dataset ('data-' values)\r\n  var datasetConfig = normaliseDataset($module.dataset);\r\n\r\n  // To ensure data-attributes take complete precedence, even if they change the\r\n  // type of count, we need to reset the `maxlength` and `maxwords` from the\r\n  // JavaScript config.\r\n  //\r\n  // We can't mutate `config`, though, as it may be shared across multiple\r\n  // components inside `initAll`.\r\n  var configOverrides = {};\r\n  if ('maxwords' in datasetConfig || 'maxlength' in datasetConfig) {\r\n    configOverrides = {\r\n      maxlength: false,\r\n      maxwords: false\r\n    };\r\n  }\r\n\r\n  this.config = mergeConfigs(\r\n    defaultConfig,\r\n    config || {},\r\n    configOverrides,\r\n    datasetConfig\r\n  );\r\n\r\n  this.i18n = new I18n(extractConfigByNamespace(this.config, 'i18n'), {\r\n    // Read the fallback if necessary rather than have it set in the defaults\r\n    locale: closestAttributeValue($module, 'lang')\r\n  });\r\n\r\n  // Determine the limit attribute (characters or words)\r\n  if (this.config.maxwords) {\r\n    this.maxLength = this.config.maxwords;\r\n  } else if (this.config.maxlength) {\r\n    this.maxLength = this.config.maxlength;\r\n  } else {\r\n    return\r\n  }\r\n\r\n  this.$module = $module;\r\n  this.$textarea = $module.querySelector('.govuk-js-character-count');\r\n  this.$visibleCountMessage = null;\r\n  this.$screenReaderCountMessage = null;\r\n  this.lastInputTimestamp = null;\r\n}\r\n\r\n/**\r\n * Initialise component\r\n */\r\nCharacterCount.prototype.init = function () {\r\n  // Check that required elements are present\r\n  if (!this.$textarea) {\r\n    return\r\n  }\r\n\r\n  var $textarea = this.$textarea;\r\n  var $textareaDescription = document.getElementById($textarea.id + '-info');\r\n\r\n  // Inject a decription for the textarea if none is present already\r\n  // for when the component was rendered with no maxlength, maxwords\r\n  // nor custom textareaDescriptionText\r\n  if ($textareaDescription.innerText.match(/^\\s*$/)) {\r\n    $textareaDescription.innerText = this.i18n.t('textareaDescription', { count: this.maxLength });\r\n  }\r\n\r\n  // Move the textarea description to be immediately after the textarea\r\n  // Kept for backwards compatibility\r\n  $textarea.insertAdjacentElement('afterend', $textareaDescription);\r\n\r\n  // Create the *screen reader* specific live-updating counter\r\n  // This doesn't need any styling classes, as it is never visible\r\n  var $screenReaderCountMessage = document.createElement('div');\r\n  $screenReaderCountMessage.className = 'govuk-character-count__sr-status govuk-visually-hidden';\r\n  $screenReaderCountMessage.setAttribute('aria-live', 'polite');\r\n  this.$screenReaderCountMessage = $screenReaderCountMessage;\r\n  $textareaDescription.insertAdjacentElement('afterend', $screenReaderCountMessage);\r\n\r\n  // Create our live-updating counter element, copying the classes from the\r\n  // textarea description for backwards compatibility as these may have been\r\n  // configured\r\n  var $visibleCountMessage = document.createElement('div');\r\n  $visibleCountMessage.className = $textareaDescription.className;\r\n  $visibleCountMessage.classList.add('govuk-character-count__status');\r\n  $visibleCountMessage.setAttribute('aria-hidden', 'true');\r\n  this.$visibleCountMessage = $visibleCountMessage;\r\n  $textareaDescription.insertAdjacentElement('afterend', $visibleCountMessage);\r\n\r\n  // Hide the textarea description\r\n  $textareaDescription.classList.add('govuk-visually-hidden');\r\n\r\n  // Remove hard limit if set\r\n  $textarea.removeAttribute('maxlength');\r\n\r\n  this.bindChangeEvents();\r\n\r\n  // When the page is restored after navigating 'back' in some browsers the\r\n  // state of the character count is not restored until *after* the\r\n  // DOMContentLoaded event is fired, so we need to manually update it after the\r\n  // pageshow event in browsers that support it.\r\n  if ('onpageshow' in window) {\r\n    window.addEventListener('pageshow', this.updateCountMessage.bind(this));\r\n  } else {\r\n    window.addEventListener('DOMContentLoaded', this.updateCountMessage.bind(this));\r\n  }\r\n  this.updateCountMessage();\r\n};\r\n\r\n/**\r\n * Bind change events\r\n *\r\n * Set up event listeners on the $textarea so that the count messages update\r\n * when the user types.\r\n */\r\nCharacterCount.prototype.bindChangeEvents = function () {\r\n  var $textarea = this.$textarea;\r\n  $textarea.addEventListener('keyup', this.handleKeyUp.bind(this));\r\n\r\n  // Bind focus/blur events to start/stop polling\r\n  $textarea.addEventListener('focus', this.handleFocus.bind(this));\r\n  $textarea.addEventListener('blur', this.handleBlur.bind(this));\r\n};\r\n\r\n/**\r\n * Handle key up event\r\n *\r\n * Update the visible character counter and keep track of when the last update\r\n * happened for each keypress\r\n */\r\nCharacterCount.prototype.handleKeyUp = function () {\r\n  this.updateVisibleCountMessage();\r\n  this.lastInputTimestamp = Date.now();\r\n};\r\n\r\n/**\r\n * Handle focus event\r\n *\r\n * Speech recognition software such as Dragon NaturallySpeaking will modify the\r\n * fields by directly changing its `value`. These changes don't trigger events\r\n * in JavaScript, so we need to poll to handle when and if they occur.\r\n *\r\n * Once the keyup event hasn't been detected for at least 1000 ms (1s), check if\r\n * the textarea value has changed and update the count message if it has.\r\n *\r\n * This is so that the update triggered by the manual comparison doesn't\r\n * conflict with debounced KeyboardEvent updates.\r\n */\r\nCharacterCount.prototype.handleFocus = function () {\r\n  this.valueChecker = setInterval(function () {\r\n    if (!this.lastInputTimestamp || (Date.now() - 500) >= this.lastInputTimestamp) {\r\n      this.updateIfValueChanged();\r\n    }\r\n  }.bind(this), 1000);\r\n};\r\n\r\n/**\r\n * Handle blur event\r\n *\r\n * Stop checking the textarea value once the textarea no longer has focus\r\n */\r\nCharacterCount.prototype.handleBlur = function () {\r\n  // Cancel value checking on blur\r\n  clearInterval(this.valueChecker);\r\n};\r\n\r\n/**\r\n * Update count message if textarea value has changed\r\n */\r\nCharacterCount.prototype.updateIfValueChanged = function () {\r\n  if (!this.$textarea.oldValue) this.$textarea.oldValue = '';\r\n  if (this.$textarea.value !== this.$textarea.oldValue) {\r\n    this.$textarea.oldValue = this.$textarea.value;\r\n    this.updateCountMessage();\r\n  }\r\n};\r\n\r\n/**\r\n * Update count message\r\n *\r\n * Helper function to update both the visible and screen reader-specific\r\n * counters simultaneously (e.g. on init)\r\n */\r\nCharacterCount.prototype.updateCountMessage = function () {\r\n  this.updateVisibleCountMessage();\r\n  this.updateScreenReaderCountMessage();\r\n};\r\n\r\n/**\r\n * Update visible count message\r\n */\r\nCharacterCount.prototype.updateVisibleCountMessage = function () {\r\n  var $textarea = this.$textarea;\r\n  var $visibleCountMessage = this.$visibleCountMessage;\r\n  var remainingNumber = this.maxLength - this.count($textarea.value);\r\n\r\n  // If input is over the threshold, remove the disabled class which renders the\r\n  // counter invisible.\r\n  if (this.isOverThreshold()) {\r\n    $visibleCountMessage.classList.remove('govuk-character-count__message--disabled');\r\n  } else {\r\n    $visibleCountMessage.classList.add('govuk-character-count__message--disabled');\r\n  }\r\n\r\n  // Update styles\r\n  if (remainingNumber < 0) {\r\n    $textarea.classList.add('govuk-textarea--error');\r\n    $visibleCountMessage.classList.remove('govuk-hint');\r\n    $visibleCountMessage.classList.add('govuk-error-message');\r\n  } else {\r\n    $textarea.classList.remove('govuk-textarea--error');\r\n    $visibleCountMessage.classList.remove('govuk-error-message');\r\n    $visibleCountMessage.classList.add('govuk-hint');\r\n  }\r\n\r\n  // Update message\r\n  $visibleCountMessage.innerText = this.getCountMessage();\r\n};\r\n\r\n/**\r\n * Update screen reader count message\r\n */\r\nCharacterCount.prototype.updateScreenReaderCountMessage = function () {\r\n  var $screenReaderCountMessage = this.$screenReaderCountMessage;\r\n\r\n  // If over the threshold, remove the aria-hidden attribute, allowing screen\r\n  // readers to announce the content of the element.\r\n  if (this.isOverThreshold()) {\r\n    $screenReaderCountMessage.removeAttribute('aria-hidden');\r\n  } else {\r\n    $screenReaderCountMessage.setAttribute('aria-hidden', true);\r\n  }\r\n\r\n  // Update message\r\n  $screenReaderCountMessage.innerText = this.getCountMessage();\r\n};\r\n\r\n/**\r\n * Count the number of characters (or words, if `config.maxwords` is set)\r\n * in the given text\r\n *\r\n * @param {string} text - The text to count the characters of\r\n * @returns {number} the number of characters (or words) in the text\r\n */\r\nCharacterCount.prototype.count = function (text) {\r\n  if (this.config.maxwords) {\r\n    var tokens = text.match(/\\S+/g) || []; // Matches consecutive non-whitespace chars\r\n    return tokens.length\r\n  } else {\r\n    return text.length\r\n  }\r\n};\r\n\r\n/**\r\n * Get count message\r\n *\r\n * @returns {string} Status message\r\n */\r\nCharacterCount.prototype.getCountMessage = function () {\r\n  var remainingNumber = this.maxLength - this.count(this.$textarea.value);\r\n\r\n  var countType = this.config.maxwords ? 'words' : 'characters';\r\n  return this.formatCountMessage(remainingNumber, countType)\r\n};\r\n\r\n/**\r\n * Formats the message shown to users according to what's counted\r\n * and how many remain\r\n *\r\n * @param {number} remainingNumber - The number of words/characaters remaining\r\n * @param {string} countType - \"words\" or \"characters\"\r\n * @returns {string} Status message\r\n */\r\nCharacterCount.prototype.formatCountMessage = function (remainingNumber, countType) {\r\n  if (remainingNumber === 0) {\r\n    return this.i18n.t(countType + 'AtLimit')\r\n  }\r\n\r\n  var translationKeySuffix = remainingNumber < 0 ? 'OverLimit' : 'UnderLimit';\r\n\r\n  return this.i18n.t(countType + translationKeySuffix, { count: Math.abs(remainingNumber) })\r\n};\r\n\r\n/**\r\n * Check if count is over threshold\r\n *\r\n * Checks whether the value is over the configured threshold for the input.\r\n * If there is no configured threshold, it is set to 0 and this function will\r\n * always return true.\r\n *\r\n * @returns {boolean} true if the current count is over the config.threshold\r\n *   (or no threshold is set)\r\n */\r\nCharacterCount.prototype.isOverThreshold = function () {\r\n  // No threshold means we're always above threshold so save some computation\r\n  if (!this.config.threshold) {\r\n    return true\r\n  }\r\n\r\n  var $textarea = this.$textarea;\r\n\r\n  // Determine the remaining number of characters/words\r\n  var currentLength = this.count($textarea.value);\r\n  var maxLength = this.maxLength;\r\n\r\n  var thresholdValue = maxLength * this.config.threshold / 100;\r\n\r\n  return (thresholdValue <= currentLength)\r\n};\r\n\r\n/**\r\n * Character count config\r\n *\r\n * @typedef {CharacterCountConfigWithMaxLength | CharacterCountConfigWithMaxWords} CharacterCountConfig\r\n */\r\n\r\n/**\r\n * Character count config (with maximum number of characters)\r\n *\r\n * @typedef {object} CharacterCountConfigWithMaxLength\r\n * @property {number} [maxlength] - The maximum number of characters.\r\n *  If maxwords is provided, the maxlength option will be ignored.\r\n * @property {number} [threshold = 0] - The percentage value of the limit at\r\n *  which point the count message is displayed. If this attribute is set, the\r\n *  count message will be hidden by default.\r\n * @property {CharacterCountTranslations} [i18n = CHARACTER_COUNT_TRANSLATIONS] - See constant {@link CHARACTER_COUNT_TRANSLATIONS}\r\n */\r\n\r\n/**\r\n * Character count config (with maximum number of words)\r\n *\r\n * @typedef {object} CharacterCountConfigWithMaxWords\r\n * @property {number} [maxwords] - The maximum number of words. If maxwords is\r\n *  provided, the maxlength option will be ignored.\r\n * @property {number} [threshold = 0] - The percentage value of the limit at\r\n *  which point the count message is displayed. If this attribute is set, the\r\n *  count message will be hidden by default.\r\n * @property {CharacterCountTranslations} [i18n = CHARACTER_COUNT_TRANSLATIONS] - See constant {@link CHARACTER_COUNT_TRANSLATIONS}\r\n */\r\n\r\n/**\r\n * Character count translations\r\n *\r\n * @typedef {object} CharacterCountTranslations\r\n *\r\n * Messages shown to users as they type. It provides feedback on how many words\r\n * or characters they have remaining or if they are over the limit. This also\r\n * includes a message used as an accessible description for the textarea.\r\n * @property {TranslationPluralForms} [charactersUnderLimit] - Message displayed\r\n *   when the number of characters is under the configured maximum, `maxlength`.\r\n *   This message is displayed visually and through assistive technologies. The\r\n *   component will replace the `%{count}` placeholder with the number of\r\n *   remaining characters. This is a [pluralised list of\r\n *   messages](https://frontend.design-system.service.gov.uk/localise-govuk-frontend).\r\n * @property {string} [charactersAtLimit] - Message displayed when the number of\r\n *   characters reaches the configured maximum, `maxlength`. This message is\r\n *   displayed visually and through assistive technologies.\r\n * @property {TranslationPluralForms} [charactersOverLimit] - Message displayed\r\n *   when the number of characters is over the configured maximum, `maxlength`.\r\n *   This message is displayed visually and through assistive technologies. The\r\n *   component will replace the `%{count}` placeholder with the number of\r\n *   remaining characters. This is a [pluralised list of\r\n *   messages](https://frontend.design-system.service.gov.uk/localise-govuk-frontend).\r\n * @property {TranslationPluralForms} [wordsUnderLimit] - Message displayed when\r\n *   the number of words is under the configured maximum, `maxlength`. This\r\n *   message is displayed visually and through assistive technologies. The\r\n *   component will replace the `%{count}` placeholder with the number of\r\n *   remaining words. This is a [pluralised list of\r\n *   messages](https://frontend.design-system.service.gov.uk/localise-govuk-frontend).\r\n * @property {string} [wordsAtLimit] - Message displayed when the number of\r\n *   words reaches the configured maximum, `maxlength`. This message is\r\n *   displayed visually and through assistive technologies.\r\n * @property {TranslationPluralForms} [wordsOverLimit] - Message displayed when\r\n *   the number of words is over the configured maximum, `maxlength`. This\r\n *   message is displayed visually and through assistive technologies. The\r\n *   component will replace the `%{count}` placeholder with the number of\r\n *   remaining words. This is a [pluralised list of\r\n *   messages](https://frontend.design-system.service.gov.uk/localise-govuk-frontend).\r\n * @property {TranslationPluralForms} [textareaDescription] - Message made\r\n *   available to assistive technologies, if none is already present in the\r\n *   HTML, to describe that the component accepts only a limited amount of\r\n *   content. It is visible on the page when JavaScript is unavailable. The\r\n *   component will replace the `%{count}` placeholder with the value of the\r\n *   `maxlength` or `maxwords` parameter.\r\n */\r\n\r\n/**\r\n * @typedef {import('../../i18n.mjs').TranslationPluralForms} TranslationPluralForms\r\n */\r\n\r\n/**\r\n * Checkboxes component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for checkboxes\r\n */\r\nfunction Checkboxes ($module) {\r\n  this.$module = $module;\r\n  this.$inputs = $module.querySelectorAll('input[type=\"checkbox\"]');\r\n}\r\n\r\n/**\r\n * Initialise Checkboxes\r\n *\r\n * Checkboxes can be associated with a 'conditionally revealed' content block –\r\n * for example, a checkbox for 'Phone' could reveal an additional form field for\r\n * the user to enter their phone number.\r\n *\r\n * These associations are made using a `data-aria-controls` attribute, which is\r\n * promoted to an aria-controls attribute during initialisation.\r\n *\r\n * We also need to restore the state of any conditional reveals on the page (for\r\n * example if the user has navigated back), and set up event handlers to keep\r\n * the reveal in sync with the checkbox state.\r\n */\r\nCheckboxes.prototype.init = function () {\r\n  var $module = this.$module;\r\n  var $inputs = this.$inputs;\r\n\r\n  nodeListForEach($inputs, function ($input) {\r\n    var target = $input.getAttribute('data-aria-controls');\r\n\r\n    // Skip checkboxes without data-aria-controls attributes, or where the\r\n    // target element does not exist.\r\n    if (!target || !document.getElementById(target)) {\r\n      return\r\n    }\r\n\r\n    // Promote the data-aria-controls attribute to a aria-controls attribute\r\n    // so that the relationship is exposed in the AOM\r\n    $input.setAttribute('aria-controls', target);\r\n    $input.removeAttribute('data-aria-controls');\r\n  });\r\n\r\n  // When the page is restored after navigating 'back' in some browsers the\r\n  // state of form controls is not restored until *after* the DOMContentLoaded\r\n  // event is fired, so we need to sync after the pageshow event in browsers\r\n  // that support it.\r\n  if ('onpageshow' in window) {\r\n    window.addEventListener('pageshow', this.syncAllConditionalReveals.bind(this));\r\n  } else {\r\n    window.addEventListener('DOMContentLoaded', this.syncAllConditionalReveals.bind(this));\r\n  }\r\n\r\n  // Although we've set up handlers to sync state on the pageshow or\r\n  // DOMContentLoaded event, init could be called after those events have fired,\r\n  // for example if they are added to the page dynamically, so sync now too.\r\n  this.syncAllConditionalReveals();\r\n\r\n  $module.addEventListener('click', this.handleClick.bind(this));\r\n};\r\n\r\n/**\r\n * Sync the conditional reveal states for all inputs in this $module.\r\n */\r\nCheckboxes.prototype.syncAllConditionalReveals = function () {\r\n  nodeListForEach(this.$inputs, this.syncConditionalRevealWithInputState.bind(this));\r\n};\r\n\r\n/**\r\n * Sync conditional reveal with the input state\r\n *\r\n * Synchronise the visibility of the conditional reveal, and its accessible\r\n * state, with the input's checked state.\r\n *\r\n * @param {HTMLInputElement} $input - Checkbox input\r\n */\r\nCheckboxes.prototype.syncConditionalRevealWithInputState = function ($input) {\r\n  var $target = document.getElementById($input.getAttribute('aria-controls'));\r\n\r\n  if ($target && $target.classList.contains('govuk-checkboxes__conditional')) {\r\n    var inputIsChecked = $input.checked;\r\n\r\n    $input.setAttribute('aria-expanded', inputIsChecked);\r\n    $target.classList.toggle('govuk-checkboxes__conditional--hidden', !inputIsChecked);\r\n  }\r\n};\r\n\r\n/**\r\n * Uncheck other checkboxes\r\n *\r\n * Find any other checkbox inputs with the same name value, and uncheck them.\r\n * This is useful for when a “None of these\" checkbox is checked.\r\n */\r\nCheckboxes.prototype.unCheckAllInputsExcept = function ($input) {\r\n  var allInputsWithSameName = document.querySelectorAll('input[type=\"checkbox\"][name=\"' + $input.name + '\"]');\r\n\r\n  nodeListForEach(allInputsWithSameName, function ($inputWithSameName) {\r\n    var hasSameFormOwner = ($input.form === $inputWithSameName.form);\r\n    if (hasSameFormOwner && $inputWithSameName !== $input) {\r\n      $inputWithSameName.checked = false;\r\n      this.syncConditionalRevealWithInputState($inputWithSameName);\r\n    }\r\n  }.bind(this));\r\n};\r\n\r\n/**\r\n * Uncheck exclusive inputs\r\n *\r\n * Find any checkbox inputs with the same name value and the 'exclusive' behaviour,\r\n * and uncheck them. This helps prevent someone checking both a regular checkbox and a\r\n * \"None of these\" checkbox in the same fieldset.\r\n */\r\nCheckboxes.prototype.unCheckExclusiveInputs = function ($input) {\r\n  var allInputsWithSameNameAndExclusiveBehaviour = document.querySelectorAll(\r\n    'input[data-behaviour=\"exclusive\"][type=\"checkbox\"][name=\"' + $input.name + '\"]'\r\n  );\r\n\r\n  nodeListForEach(allInputsWithSameNameAndExclusiveBehaviour, function ($exclusiveInput) {\r\n    var hasSameFormOwner = ($input.form === $exclusiveInput.form);\r\n    if (hasSameFormOwner) {\r\n      $exclusiveInput.checked = false;\r\n      this.syncConditionalRevealWithInputState($exclusiveInput);\r\n    }\r\n  }.bind(this));\r\n};\r\n\r\n/**\r\n * Click event handler\r\n *\r\n * Handle a click within the $module – if the click occurred on a checkbox, sync\r\n * the state of any associated conditional reveal with the checkbox state.\r\n *\r\n * @param {MouseEvent} event - Click event\r\n */\r\nCheckboxes.prototype.handleClick = function (event) {\r\n  var $target = event.target;\r\n\r\n  // Ignore clicks on things that aren't checkbox inputs\r\n  if ($target.type !== 'checkbox') {\r\n    return\r\n  }\r\n\r\n  // If the checkbox conditionally-reveals some content, sync the state\r\n  var hasAriaControls = $target.getAttribute('aria-controls');\r\n  if (hasAriaControls) {\r\n    this.syncConditionalRevealWithInputState($target);\r\n  }\r\n\r\n  // No further behaviour needed for unchecking\r\n  if (!$target.checked) {\r\n    return\r\n  }\r\n\r\n  // Handle 'exclusive' checkbox behaviour (ie \"None of these\")\r\n  var hasBehaviourExclusive = ($target.getAttribute('data-behaviour') === 'exclusive');\r\n  if (hasBehaviourExclusive) {\r\n    this.unCheckAllInputsExcept($target);\r\n  } else {\r\n    this.unCheckExclusiveInputs($target);\r\n  }\r\n};\r\n\r\n/**\r\n * JavaScript enhancements for the ErrorSummary\r\n *\r\n * Takes focus on initialisation for accessible announcement, unless disabled in configuration.\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - The element this component controls\r\n * @param {ErrorSummaryConfig} config - Error summary config\r\n */\r\nfunction ErrorSummary ($module, config) {\r\n  // Some consuming code may not be passing a module,\r\n  // for example if they initialise the component\r\n  // on their own by directly passing the result\r\n  // of `document.querySelector`.\r\n  // To avoid breaking further JavaScript initialisation\r\n  // we need to safeguard against this so things keep\r\n  // working the same now we read the elements data attributes\r\n  if (!$module) {\r\n    // Little safety in case code gets ported as-is\r\n    // into and ES6 class constructor, where the return value matters\r\n    return this\r\n  }\r\n\r\n  this.$module = $module;\r\n\r\n  var defaultConfig = {\r\n    disableAutoFocus: false\r\n  };\r\n  this.config = mergeConfigs(\r\n    defaultConfig,\r\n    config || {},\r\n    normaliseDataset($module.dataset)\r\n  );\r\n}\r\n\r\nErrorSummary.prototype.init = function () {\r\n  var $module = this.$module;\r\n  if (!$module) {\r\n    return\r\n  }\r\n\r\n  this.setFocus();\r\n  $module.addEventListener('click', this.handleClick.bind(this));\r\n};\r\n\r\n/**\r\n * Focus the error summary\r\n */\r\nErrorSummary.prototype.setFocus = function () {\r\n  var $module = this.$module;\r\n\r\n  if (this.config.disableAutoFocus) {\r\n    return\r\n  }\r\n\r\n  // Set tabindex to -1 to make the element programmatically focusable, but\r\n  // remove it on blur as the error summary doesn't need to be focused again.\r\n  $module.setAttribute('tabindex', '-1');\r\n\r\n  $module.addEventListener('blur', function () {\r\n    $module.removeAttribute('tabindex');\r\n  });\r\n\r\n  $module.focus();\r\n};\r\n\r\n/**\r\n * Click event handler\r\n *\r\n * @param {MouseEvent} event - Click event\r\n */\r\nErrorSummary.prototype.handleClick = function (event) {\r\n  var target = event.target;\r\n  if (this.focusTarget(target)) {\r\n    event.preventDefault();\r\n  }\r\n};\r\n\r\n/**\r\n * Focus the target element\r\n *\r\n * By default, the browser will scroll the target into view. Because our labels\r\n * or legends appear above the input, this means the user will be presented with\r\n * an input without any context, as the label or legend will be off the top of\r\n * the screen.\r\n *\r\n * Manually handling the click event, scrolling the question into view and then\r\n * focussing the element solves this.\r\n *\r\n * This also results in the label and/or legend being announced correctly in\r\n * NVDA (as tested in 2018.3.2) - without this only the field type is announced\r\n * (e.g. \"Edit, has autocomplete\").\r\n *\r\n * @param {HTMLElement} $target - Event target\r\n * @returns {boolean} True if the target was able to be focussed\r\n */\r\nErrorSummary.prototype.focusTarget = function ($target) {\r\n  // If the element that was clicked was not a link, return early\r\n  if ($target.tagName !== 'A' || $target.href === false) {\r\n    return false\r\n  }\r\n\r\n  var inputId = this.getFragmentFromUrl($target.href);\r\n  var $input = document.getElementById(inputId);\r\n  if (!$input) {\r\n    return false\r\n  }\r\n\r\n  var $legendOrLabel = this.getAssociatedLegendOrLabel($input);\r\n  if (!$legendOrLabel) {\r\n    return false\r\n  }\r\n\r\n  // Scroll the legend or label into view *before* calling focus on the input to\r\n  // avoid extra scrolling in browsers that don't support `preventScroll` (which\r\n  // at time of writing is most of them...)\r\n  $legendOrLabel.scrollIntoView();\r\n  $input.focus({ preventScroll: true });\r\n\r\n  return true\r\n};\r\n\r\n/**\r\n * Get fragment from URL\r\n *\r\n * Extract the fragment (everything after the hash) from a URL, but not including\r\n * the hash.\r\n *\r\n * @param {string} url - URL\r\n * @returns {string} Fragment from URL, without the hash\r\n */\r\nErrorSummary.prototype.getFragmentFromUrl = function (url) {\r\n  if (url.indexOf('#') === -1) {\r\n    return false\r\n  }\r\n\r\n  return url.split('#').pop()\r\n};\r\n\r\n/**\r\n * Get associated legend or label\r\n *\r\n * Returns the first element that exists from this list:\r\n *\r\n * - The `<legend>` associated with the closest `<fieldset>` ancestor, as long\r\n *   as the top of it is no more than half a viewport height away from the\r\n *   bottom of the input\r\n * - The first `<label>` that is associated with the input using for=\"inputId\"\r\n * - The closest parent `<label>`\r\n *\r\n * @param {HTMLElement} $input - The input\r\n * @returns {HTMLElement} Associated legend or label, or null if no associated\r\n *                        legend or label can be found\r\n */\r\nErrorSummary.prototype.getAssociatedLegendOrLabel = function ($input) {\r\n  var $fieldset = $input.closest('fieldset');\r\n\r\n  if ($fieldset) {\r\n    var legends = $fieldset.getElementsByTagName('legend');\r\n\r\n    if (legends.length) {\r\n      var $candidateLegend = legends[0];\r\n\r\n      // If the input type is radio or checkbox, always use the legend if there\r\n      // is one.\r\n      if ($input.type === 'checkbox' || $input.type === 'radio') {\r\n        return $candidateLegend\r\n      }\r\n\r\n      // For other input types, only scroll to the fieldset’s legend (instead of\r\n      // the label associated with the input) if the input would end up in the\r\n      // top half of the screen.\r\n      //\r\n      // This should avoid situations where the input either ends up off the\r\n      // screen, or obscured by a software keyboard.\r\n      var legendTop = $candidateLegend.getBoundingClientRect().top;\r\n      var inputRect = $input.getBoundingClientRect();\r\n\r\n      // If the browser doesn't support Element.getBoundingClientRect().height\r\n      // or window.innerHeight (like IE8), bail and just link to the label.\r\n      if (inputRect.height && window.innerHeight) {\r\n        var inputBottom = inputRect.top + inputRect.height;\r\n\r\n        if (inputBottom - legendTop < window.innerHeight / 2) {\r\n          return $candidateLegend\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return document.querySelector(\"label[for='\" + $input.getAttribute('id') + \"']\") ||\r\n    $input.closest('label')\r\n};\r\n\r\n/**\r\n * Error summary config\r\n *\r\n * @typedef {object} ErrorSummaryConfig\r\n * @property {boolean} [disableAutoFocus = false] -\r\n *  If set to `true` the error summary will not be focussed when the page loads.\r\n */\r\n\r\n/**\r\n * Notification Banner component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for notification banner\r\n * @param {NotificationBannerConfig} config - Notification banner config\r\n */\r\nfunction NotificationBanner ($module, config) {\r\n  this.$module = $module;\r\n\r\n  var defaultConfig = {\r\n    disableAutoFocus: false\r\n  };\r\n  this.config = mergeConfigs(\r\n    defaultConfig,\r\n    config || {},\r\n    normaliseDataset($module.dataset)\r\n  );\r\n}\r\n\r\n/**\r\n * Initialise the component\r\n */\r\nNotificationBanner.prototype.init = function () {\r\n  var $module = this.$module;\r\n  // Check for module\r\n  if (!$module) {\r\n    return\r\n  }\r\n\r\n  this.setFocus();\r\n};\r\n\r\n/**\r\n * Focus the element\r\n *\r\n * If `role=\"alert\"` is set, focus the element to help some assistive technologies\r\n * prioritise announcing it.\r\n *\r\n * You can turn off the auto-focus functionality by setting `data-disable-auto-focus=\"true\"` in the\r\n * component HTML. You might wish to do this based on user research findings, or to avoid a clash\r\n * with another element which should be focused when the page loads.\r\n */\r\nNotificationBanner.prototype.setFocus = function () {\r\n  var $module = this.$module;\r\n\r\n  if (this.config.disableAutoFocus) {\r\n    return\r\n  }\r\n\r\n  if ($module.getAttribute('role') !== 'alert') {\r\n    return\r\n  }\r\n\r\n  // Set tabindex to -1 to make the element focusable with JavaScript.\r\n  // Remove the tabindex on blur as the component doesn't need to be focusable after the page has\r\n  // loaded.\r\n  if (!$module.getAttribute('tabindex')) {\r\n    $module.setAttribute('tabindex', '-1');\r\n\r\n    $module.addEventListener('blur', function () {\r\n      $module.removeAttribute('tabindex');\r\n    });\r\n  }\r\n\r\n  $module.focus();\r\n};\r\n\r\n/**\r\n * Notification banner config\r\n *\r\n * @typedef {object} NotificationBannerConfig\r\n * @property {boolean} [disableAutoFocus = false] -\r\n *   If set to `true` the notification banner will not be focussed when the page\r\n *   loads. This only applies if the component has a `role` of `alert` – in\r\n *   other cases the component will not be focused on page load, regardless of\r\n *   this option.\r\n */\r\n\r\n/**\r\n * Header component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for header\r\n */\r\nfunction Header ($module) {\r\n  this.$module = $module;\r\n  this.$menuButton = $module && $module.querySelector('.govuk-js-header-toggle');\r\n  this.$menu = this.$menuButton && $module.querySelector(\r\n    '#' + this.$menuButton.getAttribute('aria-controls')\r\n  );\r\n\r\n  // Save the opened/closed state for the nav in memory so that we can\r\n  // accurately maintain state when the screen is changed from small to\r\n  // big and back to small\r\n  this.menuIsOpen = false;\r\n\r\n  // A global const for storing a matchMedia instance which we'll use to\r\n  // detect when a screen size change happens. We set this later during the\r\n  // init function and rely on it being null if the feature isn't available\r\n  // to initially apply hidden attributes\r\n  this.mql = null;\r\n}\r\n\r\n/**\r\n * Initialise header\r\n *\r\n * Check for the presence of the header, menu and menu button – if any are\r\n * missing then there's nothing to do so return early.\r\n * Feature sniff for and apply a matchMedia for desktop which will\r\n * trigger a state sync if the browser viewport moves between states. If\r\n * matchMedia isn't available, hide the menu button and present the \"no js\"\r\n * version of the menu to the user.\r\n */\r\nHeader.prototype.init = function () {\r\n  if (!this.$module || !this.$menuButton || !this.$menu) {\r\n    return\r\n  }\r\n\r\n  if ('matchMedia' in window) {\r\n    // Set the matchMedia to the govuk-frontend desktop breakpoint\r\n    this.mql = window.matchMedia('(min-width: 48.0625em)');\r\n\r\n    if ('addEventListener' in this.mql) {\r\n      this.mql.addEventListener('change', this.syncState.bind(this));\r\n    } else {\r\n      // addListener is a deprecated function, however addEventListener\r\n      // isn't supported by IE or Safari. We therefore add this in as\r\n      // a fallback for those browsers\r\n      this.mql.addListener(this.syncState.bind(this));\r\n    }\r\n\r\n    this.syncState();\r\n    this.$menuButton.addEventListener('click', this.handleMenuButtonClick.bind(this));\r\n  } else {\r\n    this.$menuButton.setAttribute('hidden', '');\r\n  }\r\n};\r\n\r\n/**\r\n * Sync menu state\r\n *\r\n * Uses the global variable menuIsOpen to correctly set the accessible and\r\n * visual states of the menu and the menu button.\r\n * Additionally will force the menu to be visible and the menu button to be\r\n * hidden if the matchMedia is triggered to desktop.\r\n */\r\nHeader.prototype.syncState = function () {\r\n  if (this.mql.matches) {\r\n    this.$menu.removeAttribute('hidden');\r\n    this.$menuButton.setAttribute('hidden', '');\r\n  } else {\r\n    this.$menuButton.removeAttribute('hidden');\r\n    this.$menuButton.setAttribute('aria-expanded', this.menuIsOpen);\r\n\r\n    if (this.menuIsOpen) {\r\n      this.$menu.removeAttribute('hidden');\r\n    } else {\r\n      this.$menu.setAttribute('hidden', '');\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Handle menu button click\r\n *\r\n * When the menu button is clicked, change the visibility of the menu and then\r\n * sync the accessibility state and menu button state\r\n */\r\nHeader.prototype.handleMenuButtonClick = function () {\r\n  this.menuIsOpen = !this.menuIsOpen;\r\n  this.syncState();\r\n};\r\n\r\n/**\r\n * Radios component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for radios\r\n */\r\nfunction Radios ($module) {\r\n  this.$module = $module;\r\n  this.$inputs = $module.querySelectorAll('input[type=\"radio\"]');\r\n}\r\n\r\n/**\r\n * Initialise Radios\r\n *\r\n * Radios can be associated with a 'conditionally revealed' content block – for\r\n * example, a radio for 'Phone' could reveal an additional form field for the\r\n * user to enter their phone number.\r\n *\r\n * These associations are made using a `data-aria-controls` attribute, which is\r\n * promoted to an aria-controls attribute during initialisation.\r\n *\r\n * We also need to restore the state of any conditional reveals on the page (for\r\n * example if the user has navigated back), and set up event handlers to keep\r\n * the reveal in sync with the radio state.\r\n */\r\nRadios.prototype.init = function () {\r\n  var $module = this.$module;\r\n  var $inputs = this.$inputs;\r\n\r\n  nodeListForEach($inputs, function ($input) {\r\n    var target = $input.getAttribute('data-aria-controls');\r\n\r\n    // Skip radios without data-aria-controls attributes, or where the\r\n    // target element does not exist.\r\n    if (!target || !document.getElementById(target)) {\r\n      return\r\n    }\r\n\r\n    // Promote the data-aria-controls attribute to a aria-controls attribute\r\n    // so that the relationship is exposed in the AOM\r\n    $input.setAttribute('aria-controls', target);\r\n    $input.removeAttribute('data-aria-controls');\r\n  });\r\n\r\n  // When the page is restored after navigating 'back' in some browsers the\r\n  // state of form controls is not restored until *after* the DOMContentLoaded\r\n  // event is fired, so we need to sync after the pageshow event in browsers\r\n  // that support it.\r\n  if ('onpageshow' in window) {\r\n    window.addEventListener('pageshow', this.syncAllConditionalReveals.bind(this));\r\n  } else {\r\n    window.addEventListener('DOMContentLoaded', this.syncAllConditionalReveals.bind(this));\r\n  }\r\n\r\n  // Although we've set up handlers to sync state on the pageshow or\r\n  // DOMContentLoaded event, init could be called after those events have fired,\r\n  // for example if they are added to the page dynamically, so sync now too.\r\n  this.syncAllConditionalReveals();\r\n\r\n  // Handle events\r\n  $module.addEventListener('click', this.handleClick.bind(this));\r\n};\r\n\r\n/**\r\n * Sync the conditional reveal states for all inputs in this $module.\r\n */\r\nRadios.prototype.syncAllConditionalReveals = function () {\r\n  nodeListForEach(this.$inputs, this.syncConditionalRevealWithInputState.bind(this));\r\n};\r\n\r\n/**\r\n * Sync conditional reveal with the input state\r\n *\r\n * Synchronise the visibility of the conditional reveal, and its accessible\r\n * state, with the input's checked state.\r\n *\r\n * @param {HTMLInputElement} $input - Radio input\r\n */\r\nRadios.prototype.syncConditionalRevealWithInputState = function ($input) {\r\n  var $target = document.getElementById($input.getAttribute('aria-controls'));\r\n\r\n  if ($target && $target.classList.contains('govuk-radios__conditional')) {\r\n    var inputIsChecked = $input.checked;\r\n\r\n    $input.setAttribute('aria-expanded', inputIsChecked);\r\n    $target.classList.toggle('govuk-radios__conditional--hidden', !inputIsChecked);\r\n  }\r\n};\r\n\r\n/**\r\n * Click event handler\r\n *\r\n * Handle a click within the $module – if the click occurred on a radio, sync\r\n * the state of the conditional reveal for all radio buttons in the same form\r\n * with the same name (because checking one radio could have un-checked a radio\r\n * in another $module)\r\n *\r\n * @param {MouseEvent} event - Click event\r\n */\r\nRadios.prototype.handleClick = function (event) {\r\n  var $clickedInput = event.target;\r\n\r\n  // Ignore clicks on things that aren't radio buttons\r\n  if ($clickedInput.type !== 'radio') {\r\n    return\r\n  }\r\n\r\n  // We only need to consider radios with conditional reveals, which will have\r\n  // aria-controls attributes.\r\n  var $allInputs = document.querySelectorAll('input[type=\"radio\"][aria-controls]');\r\n\r\n  nodeListForEach($allInputs, function ($input) {\r\n    var hasSameFormOwner = ($input.form === $clickedInput.form);\r\n    var hasSameName = ($input.name === $clickedInput.name);\r\n\r\n    if (hasSameName && hasSameFormOwner) {\r\n      this.syncConditionalRevealWithInputState($input);\r\n    }\r\n  }.bind(this));\r\n};\r\n\r\n/**\r\n * Skip link component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for skip link\r\n */\r\nfunction SkipLink ($module) {\r\n  this.$module = $module;\r\n  this.$linkedElement = null;\r\n  this.linkedElementListener = false;\r\n}\r\n\r\n/**\r\n * Initialise the component\r\n */\r\nSkipLink.prototype.init = function () {\r\n  // Check for module\r\n  if (!this.$module) {\r\n    return\r\n  }\r\n\r\n  // Check for linked element\r\n  this.$linkedElement = this.getLinkedElement();\r\n  if (!this.$linkedElement) {\r\n    return\r\n  }\r\n\r\n  this.$module.addEventListener('click', this.focusLinkedElement.bind(this));\r\n};\r\n\r\n/**\r\n * Get linked element\r\n *\r\n * @returns {HTMLElement} $linkedElement - DOM element linked to from the skip link\r\n */\r\nSkipLink.prototype.getLinkedElement = function () {\r\n  var linkedElementId = this.getFragmentFromUrl();\r\n\r\n  if (!linkedElementId) {\r\n    return false\r\n  }\r\n\r\n  return document.getElementById(linkedElementId)\r\n};\r\n\r\n/**\r\n * Focus the linked element\r\n *\r\n * Set tabindex and helper CSS class. Set listener to remove them on blur.\r\n */\r\nSkipLink.prototype.focusLinkedElement = function () {\r\n  var $linkedElement = this.$linkedElement;\r\n\r\n  if (!$linkedElement.getAttribute('tabindex')) {\r\n    // Set the element tabindex to -1 so it can be focused with JavaScript.\r\n    $linkedElement.setAttribute('tabindex', '-1');\r\n    $linkedElement.classList.add('govuk-skip-link-focused-element');\r\n\r\n    // Add listener for blur on the focused element (unless the listener has previously been added)\r\n    if (!this.linkedElementListener) {\r\n      this.$linkedElement.addEventListener('blur', this.removeFocusProperties.bind(this));\r\n      this.linkedElementListener = true;\r\n    }\r\n  }\r\n  $linkedElement.focus();\r\n};\r\n\r\n/**\r\n * Remove the tabindex that makes the linked element focusable because the element only needs to be\r\n * focusable until it has received programmatic focus and a screen reader has announced it.\r\n *\r\n * Remove the CSS class that removes the native focus styles.\r\n */\r\nSkipLink.prototype.removeFocusProperties = function () {\r\n  this.$linkedElement.removeAttribute('tabindex');\r\n  this.$linkedElement.classList.remove('govuk-skip-link-focused-element');\r\n};\r\n\r\n/**\r\n * Get fragment from URL\r\n *\r\n * Extract the fragment (everything after the hash symbol) from a URL, but not including\r\n * the symbol.\r\n *\r\n * @returns {string} Fragment from URL, without the hash symbol\r\n */\r\nSkipLink.prototype.getFragmentFromUrl = function () {\r\n  // Bail if the anchor link doesn't have a hash\r\n  if (!this.$module.hash) {\r\n    return false\r\n  }\r\n\r\n  return this.$module.hash.split('#').pop()\r\n};\r\n\r\n(function(undefined) {\r\n\r\n    // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-library/master/polyfills/Element/prototype/nextElementSibling/detect.js\r\n    var detect = (\r\n      'document' in this && \"nextElementSibling\" in document.documentElement\r\n    );\r\n\r\n    if (detect) return\r\n\r\n    // Polyfill from https://raw.githubusercontent.com/Financial-Times/polyfill-library/master/polyfills/Element/prototype/nextElementSibling/polyfill.js\r\n    Object.defineProperty(Element.prototype, \"nextElementSibling\", {\r\n      get: function(){\r\n        var el = this.nextSibling;\r\n        while (el && el.nodeType !== 1) { el = el.nextSibling; }\r\n        return el;\r\n      }\r\n    });\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n    // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-library/master/polyfills/Element/prototype/previousElementSibling/detect.js\r\n    var detect = (\r\n      'document' in this && \"previousElementSibling\" in document.documentElement\r\n    );\r\n\r\n    if (detect) return\r\n\r\n    // Polyfill from https://raw.githubusercontent.com/Financial-Times/polyfill-library/master/polyfills/Element/prototype/previousElementSibling/polyfill.js\r\n    Object.defineProperty(Element.prototype, 'previousElementSibling', {\r\n      get: function(){\r\n        var el = this.previousSibling;\r\n        while (el && el.nodeType !== 1) { el = el.previousSibling; }\r\n        return el;\r\n      }\r\n    });\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n/**\r\n * Tabs component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for tabs\r\n */\r\nfunction Tabs ($module) {\r\n  this.$module = $module;\r\n  this.$tabs = $module.querySelectorAll('.govuk-tabs__tab');\r\n\r\n  this.keys = { left: 37, right: 39, up: 38, down: 40 };\r\n  this.jsHiddenClass = 'govuk-tabs__panel--hidden';\r\n}\r\n\r\nTabs.prototype.init = function () {\r\n  if (typeof window.matchMedia === 'function') {\r\n    this.setupResponsiveChecks();\r\n  } else {\r\n    this.setup();\r\n  }\r\n};\r\n\r\nTabs.prototype.setupResponsiveChecks = function () {\r\n  this.mql = window.matchMedia('(min-width: 40.0625em)');\r\n  this.mql.addListener(this.checkMode.bind(this));\r\n  this.checkMode();\r\n};\r\n\r\nTabs.prototype.checkMode = function () {\r\n  if (this.mql.matches) {\r\n    this.setup();\r\n  } else {\r\n    this.teardown();\r\n  }\r\n};\r\n\r\nTabs.prototype.setup = function () {\r\n  var $module = this.$module;\r\n  var $tabs = this.$tabs;\r\n  var $tabList = $module.querySelector('.govuk-tabs__list');\r\n  var $tabListItems = $module.querySelectorAll('.govuk-tabs__list-item');\r\n\r\n  if (!$tabs || !$tabList || !$tabListItems) {\r\n    return\r\n  }\r\n\r\n  $tabList.setAttribute('role', 'tablist');\r\n\r\n  nodeListForEach($tabListItems, function ($item) {\r\n    $item.setAttribute('role', 'presentation');\r\n  });\r\n\r\n  nodeListForEach($tabs, function ($tab) {\r\n    // Set HTML attributes\r\n    this.setAttributes($tab);\r\n\r\n    // Save bounded functions to use when removing event listeners during teardown\r\n    $tab.boundTabClick = this.onTabClick.bind(this);\r\n    $tab.boundTabKeydown = this.onTabKeydown.bind(this);\r\n\r\n    // Handle events\r\n    $tab.addEventListener('click', $tab.boundTabClick, true);\r\n    $tab.addEventListener('keydown', $tab.boundTabKeydown, true);\r\n\r\n    // Remove old active panels\r\n    this.hideTab($tab);\r\n  }.bind(this));\r\n\r\n  // Show either the active tab according to the URL's hash or the first tab\r\n  var $activeTab = this.getTab(window.location.hash) || this.$tabs[0];\r\n  this.showTab($activeTab);\r\n\r\n  // Handle hashchange events\r\n  $module.boundOnHashChange = this.onHashChange.bind(this);\r\n  window.addEventListener('hashchange', $module.boundOnHashChange, true);\r\n};\r\n\r\nTabs.prototype.teardown = function () {\r\n  var $module = this.$module;\r\n  var $tabs = this.$tabs;\r\n  var $tabList = $module.querySelector('.govuk-tabs__list');\r\n  var $tabListItems = $module.querySelectorAll('.govuk-tabs__list-item');\r\n\r\n  if (!$tabs || !$tabList || !$tabListItems) {\r\n    return\r\n  }\r\n\r\n  $tabList.removeAttribute('role');\r\n\r\n  nodeListForEach($tabListItems, function ($item) {\r\n    $item.removeAttribute('role', 'presentation');\r\n  });\r\n\r\n  nodeListForEach($tabs, function ($tab) {\r\n    // Remove events\r\n    $tab.removeEventListener('click', $tab.boundTabClick, true);\r\n    $tab.removeEventListener('keydown', $tab.boundTabKeydown, true);\r\n\r\n    // Unset HTML attributes\r\n    this.unsetAttributes($tab);\r\n  }.bind(this));\r\n\r\n  // Remove hashchange event handler\r\n  window.removeEventListener('hashchange', $module.boundOnHashChange, true);\r\n};\r\n\r\nTabs.prototype.onHashChange = function (e) {\r\n  var hash = window.location.hash;\r\n  var $tabWithHash = this.getTab(hash);\r\n  if (!$tabWithHash) {\r\n    return\r\n  }\r\n\r\n  // Prevent changing the hash\r\n  if (this.changingHash) {\r\n    this.changingHash = false;\r\n    return\r\n  }\r\n\r\n  // Show either the active tab according to the URL's hash or the first tab\r\n  var $previousTab = this.getCurrentTab();\r\n\r\n  this.hideTab($previousTab);\r\n  this.showTab($tabWithHash);\r\n  $tabWithHash.focus();\r\n};\r\n\r\nTabs.prototype.hideTab = function ($tab) {\r\n  this.unhighlightTab($tab);\r\n  this.hidePanel($tab);\r\n};\r\n\r\nTabs.prototype.showTab = function ($tab) {\r\n  this.highlightTab($tab);\r\n  this.showPanel($tab);\r\n};\r\n\r\nTabs.prototype.getTab = function (hash) {\r\n  return this.$module.querySelector('.govuk-tabs__tab[href=\"' + hash + '\"]')\r\n};\r\n\r\nTabs.prototype.setAttributes = function ($tab) {\r\n  // set tab attributes\r\n  var panelId = this.getHref($tab).slice(1);\r\n  $tab.setAttribute('id', 'tab_' + panelId);\r\n  $tab.setAttribute('role', 'tab');\r\n  $tab.setAttribute('aria-controls', panelId);\r\n  $tab.setAttribute('aria-selected', 'false');\r\n  $tab.setAttribute('tabindex', '-1');\r\n\r\n  // set panel attributes\r\n  var $panel = this.getPanel($tab);\r\n  $panel.setAttribute('role', 'tabpanel');\r\n  $panel.setAttribute('aria-labelledby', $tab.id);\r\n  $panel.classList.add(this.jsHiddenClass);\r\n};\r\n\r\nTabs.prototype.unsetAttributes = function ($tab) {\r\n  // unset tab attributes\r\n  $tab.removeAttribute('id');\r\n  $tab.removeAttribute('role');\r\n  $tab.removeAttribute('aria-controls');\r\n  $tab.removeAttribute('aria-selected');\r\n  $tab.removeAttribute('tabindex');\r\n\r\n  // unset panel attributes\r\n  var $panel = this.getPanel($tab);\r\n  $panel.removeAttribute('role');\r\n  $panel.removeAttribute('aria-labelledby');\r\n  $panel.classList.remove(this.jsHiddenClass);\r\n};\r\n\r\nTabs.prototype.onTabClick = function (e) {\r\n  if (!e.target.classList.contains('govuk-tabs__tab')) {\r\n  // Allow events on child DOM elements to bubble up to tab parent\r\n    return false\r\n  }\r\n  e.preventDefault();\r\n  var $newTab = e.target;\r\n  var $currentTab = this.getCurrentTab();\r\n  this.hideTab($currentTab);\r\n  this.showTab($newTab);\r\n  this.createHistoryEntry($newTab);\r\n};\r\n\r\nTabs.prototype.createHistoryEntry = function ($tab) {\r\n  var $panel = this.getPanel($tab);\r\n\r\n  // Save and restore the id\r\n  // so the page doesn't jump when a user clicks a tab (which changes the hash)\r\n  var id = $panel.id;\r\n  $panel.id = '';\r\n  this.changingHash = true;\r\n  window.location.hash = this.getHref($tab).slice(1);\r\n  $panel.id = id;\r\n};\r\n\r\nTabs.prototype.onTabKeydown = function (e) {\r\n  switch (e.keyCode) {\r\n    case this.keys.left:\r\n    case this.keys.up:\r\n      this.activatePreviousTab();\r\n      e.preventDefault();\r\n      break\r\n    case this.keys.right:\r\n    case this.keys.down:\r\n      this.activateNextTab();\r\n      e.preventDefault();\r\n      break\r\n  }\r\n};\r\n\r\nTabs.prototype.activateNextTab = function () {\r\n  var currentTab = this.getCurrentTab();\r\n  var nextTabListItem = currentTab.parentNode.nextElementSibling;\r\n  if (nextTabListItem) {\r\n    var nextTab = nextTabListItem.querySelector('.govuk-tabs__tab');\r\n  }\r\n  if (nextTab) {\r\n    this.hideTab(currentTab);\r\n    this.showTab(nextTab);\r\n    nextTab.focus();\r\n    this.createHistoryEntry(nextTab);\r\n  }\r\n};\r\n\r\nTabs.prototype.activatePreviousTab = function () {\r\n  var currentTab = this.getCurrentTab();\r\n  var previousTabListItem = currentTab.parentNode.previousElementSibling;\r\n  if (previousTabListItem) {\r\n    var previousTab = previousTabListItem.querySelector('.govuk-tabs__tab');\r\n  }\r\n  if (previousTab) {\r\n    this.hideTab(currentTab);\r\n    this.showTab(previousTab);\r\n    previousTab.focus();\r\n    this.createHistoryEntry(previousTab);\r\n  }\r\n};\r\n\r\nTabs.prototype.getPanel = function ($tab) {\r\n  var $panel = this.$module.querySelector(this.getHref($tab));\r\n  return $panel\r\n};\r\n\r\nTabs.prototype.showPanel = function ($tab) {\r\n  var $panel = this.getPanel($tab);\r\n  $panel.classList.remove(this.jsHiddenClass);\r\n};\r\n\r\nTabs.prototype.hidePanel = function (tab) {\r\n  var $panel = this.getPanel(tab);\r\n  $panel.classList.add(this.jsHiddenClass);\r\n};\r\n\r\nTabs.prototype.unhighlightTab = function ($tab) {\r\n  $tab.setAttribute('aria-selected', 'false');\r\n  $tab.parentNode.classList.remove('govuk-tabs__list-item--selected');\r\n  $tab.setAttribute('tabindex', '-1');\r\n};\r\n\r\nTabs.prototype.highlightTab = function ($tab) {\r\n  $tab.setAttribute('aria-selected', 'true');\r\n  $tab.parentNode.classList.add('govuk-tabs__list-item--selected');\r\n  $tab.setAttribute('tabindex', '0');\r\n};\r\n\r\nTabs.prototype.getCurrentTab = function () {\r\n  return this.$module.querySelector('.govuk-tabs__list-item--selected .govuk-tabs__tab')\r\n};\r\n\r\n// this is because IE doesn't always return the actual value but a relative full path\r\n// should be a utility function most prob\r\n// http://labs.thesedays.com/blog/2010/01/08/getting-the-href-value-with-jquery-in-ie/\r\nTabs.prototype.getHref = function ($tab) {\r\n  var href = $tab.getAttribute('href');\r\n  var hash = href.slice(href.indexOf('#'), href.length);\r\n  return hash\r\n};\r\n\r\n/**\r\n * Initialise all components\r\n *\r\n * Use the `data-module` attributes to find, instantiate and init all of the\r\n * components provided as part of GOV.UK Frontend.\r\n *\r\n * @param {Config} [config] - Config for all components\r\n */\r\nfunction initAll (config) {\r\n  config = typeof config !== 'undefined' ? config : {};\r\n\r\n  // Allow the user to initialise GOV.UK Frontend in only certain sections of the page\r\n  // Defaults to the entire document if nothing is set.\r\n  var $scope = typeof config.scope !== 'undefined' ? config.scope : document;\r\n\r\n  var $accordions = $scope.querySelectorAll('[data-module=\"govuk-accordion\"]');\r\n  nodeListForEach($accordions, function ($accordion) {\r\n    new Accordion($accordion, config.accordion).init();\r\n  });\r\n\r\n  var $buttons = $scope.querySelectorAll('[data-module=\"govuk-button\"]');\r\n  nodeListForEach($buttons, function ($button) {\r\n    new Button($button, config.button).init();\r\n  });\r\n\r\n  var $characterCounts = $scope.querySelectorAll('[data-module=\"govuk-character-count\"]');\r\n  nodeListForEach($characterCounts, function ($characterCount) {\r\n    new CharacterCount($characterCount, config.characterCount).init();\r\n  });\r\n\r\n  var $checkboxes = $scope.querySelectorAll('[data-module=\"govuk-checkboxes\"]');\r\n  nodeListForEach($checkboxes, function ($checkbox) {\r\n    new Checkboxes($checkbox).init();\r\n  });\r\n\r\n  var $details = $scope.querySelectorAll('[data-module=\"govuk-details\"]');\r\n  nodeListForEach($details, function ($detail) {\r\n    new Details($detail).init();\r\n  });\r\n\r\n  // Find first error summary module to enhance.\r\n  var $errorSummary = $scope.querySelector('[data-module=\"govuk-error-summary\"]');\r\n  if ($errorSummary) {\r\n    new ErrorSummary($errorSummary, config.errorSummary).init();\r\n  }\r\n\r\n  // Find first header module to enhance.\r\n  var $header = $scope.querySelector('[data-module=\"govuk-header\"]');\r\n  if ($header) {\r\n    new Header($header).init();\r\n  }\r\n\r\n  var $notificationBanners = $scope.querySelectorAll('[data-module=\"govuk-notification-banner\"]');\r\n  nodeListForEach($notificationBanners, function ($notificationBanner) {\r\n    new NotificationBanner($notificationBanner, config.notificationBanner).init();\r\n  });\r\n\r\n  var $radios = $scope.querySelectorAll('[data-module=\"govuk-radios\"]');\r\n  nodeListForEach($radios, function ($radio) {\r\n    new Radios($radio).init();\r\n  });\r\n\r\n  // Find first skip link module to enhance.\r\n  var $skipLink = $scope.querySelector('[data-module=\"govuk-skip-link\"]');\r\n  new SkipLink($skipLink).init();\r\n\r\n  var $tabs = $scope.querySelectorAll('[data-module=\"govuk-tabs\"]');\r\n  nodeListForEach($tabs, function ($tabs) {\r\n    new Tabs($tabs).init();\r\n  });\r\n}\r\n\r\n/**\r\n * Config for all components\r\n *\r\n * @typedef {object} Config\r\n * @property {HTMLElement} [scope=document] - Scope to query for components\r\n * @property {import('./components/accordion/accordion.mjs').AccordionConfig} [accordion] - Accordion config\r\n * @property {import('./components/button/button.mjs').ButtonConfig} [button] - Button config\r\n * @property {import('./components/character-count/character-count.mjs').CharacterCountConfig} [characterCount] - Character Count config\r\n * @property {import('./components/error-summary/error-summary.mjs').ErrorSummaryConfig} [errorSummary] - Error Summary config\r\n * @property {import('./components/notification-banner/notification-banner.mjs').NotificationBannerConfig} [notificationBanner] - Notification Banner config\r\n */\r\n\r\nexports.initAll = initAll;\r\nexports.Accordion = Accordion;\r\nexports.Button = Button;\r\nexports.Details = Details;\r\nexports.CharacterCount = CharacterCount;\r\nexports.Checkboxes = Checkboxes;\r\nexports.ErrorSummary = ErrorSummary;\r\nexports.Header = Header;\r\nexports.NotificationBanner = NotificationBanner;\r\nexports.Radios = Radios;\r\nexports.SkipLink = SkipLink;\r\nexports.Tabs = Tabs;\r\n\r\n})));\r\n\r\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImdvdnVrLTQuNC4xLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGpzIGNvbXBvbmVudHMgaGF2ZSBiZWVuIHNuYWZmbGVkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2FscGhhZ292L2dvdnVrLWRlc2lnbi1zeXN0ZW0vYmxvYi9tYWluL3NyYy9qYXZhc2NyaXB0cy9jb21wb25lbnRzL1xuaW1wb3J0IENvb2tpZUJhbm5lciBmcm9tICcuL2NvbXBvbmVudHMvY29va2llLWJhbm5lci5qcyc7XG5pbXBvcnQgeyBnZXRDb25zZW50Q29va2llLCBpc1ZhbGlkQ29uc2VudENvb2tpZSB9IGZyb20gJy4vY29tcG9uZW50cy9jb29raWUtZnVuY3Rpb25zLmpzJztcbmltcG9ydCBBbmFseXRpY3MgZnJvbSAnLi9jb21wb25lbnRzL2FuYWx5dGljcy5qcyc7XG5pbXBvcnQgQ29va2llc1BhZ2UgZnJvbSAnLi9jb21wb25lbnRzL2Nvb2tpZXMtcGFnZS5qcyc7XG4vLyBJbml0aWFsaXNlIGNvb2tpZSBiYW5uZXJcbnZhciAkY29va2llQmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbW9kdWxlPVwiZ292dWstY29va2llLWJhbm5lclwiXScpO1xubmV3IENvb2tpZUJhbm5lcigkY29va2llQmFubmVyKS5pbml0KCk7XG4vLyBJbml0aWFsaXNlIGFuYWx5dGljcyBpZiBjb25zZW50IGlzIGdpdmVuXG52YXIgdXNlckNvbnNlbnQgPSBnZXRDb25zZW50Q29va2llKCk7XG5pZiAodXNlckNvbnNlbnQgJiYgaXNWYWxpZENvbnNlbnRDb29raWUodXNlckNvbnNlbnQpICYmIHVzZXJDb25zZW50LmFuYWx5dGljcykge1xuICAgIEFuYWx5dGljcygpO1xufVxuLy90b2RvOiBtb3ZlIHRoaXMgaW50byBzY3JpcHRzIHNlY3Rpb24gb24gY29va2llIHBhZ2Vcbi8vIEluaXRpYWxpc2UgY29va2llIHBhZ2VcbnZhciAkY29va2llc1BhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1tb2R1bGU9XCJhcHAtY29va2llcy1wYWdlXCJdJyk7XG5uZXcgQ29va2llc1BhZ2UoJGNvb2tpZXNQYWdlKS5pbml0KCk7XG5jb25zdCBiYWNrTGlua3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmFwcC1iYWNrLWxpbmtcIik7XG5iYWNrTGlua3MuZm9yRWFjaCgobGluaykgPT4ge1xuICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgd2luZG93Lmhpc3RvcnkuYmFjaygpO1xuICAgIH0pO1xufSk7XG5jb25zdCBidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3Blbi1jbG9zZS1maWx0ZXJzJyk7XG5idXR0b24gPT09IG51bGwgfHwgYnV0dG9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiBoYW5kbGVDbGljayhldmVudCkge1xuICAgIC8vdG9kbzogdXBkYXRlIHRvIHRzIDI/XG4gICAgY29uc3QgZmlsdGVyQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmaWx0ZXJzXCIpO1xuICAgIGlmIChmaWx0ZXJCdXR0b24uc3R5bGUuZGlzcGxheSA9PT0gXCJub25lXCIpIHtcbiAgICAgICAgZmlsdGVyQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmaWx0ZXJCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIH1cbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGY4O2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKemIzVnlZMlZ6SWpwYkltRndjQzUwY3lKZExDSnVZVzFsY3lJNlcxMHNJbTFoY0hCcGJtZHpJam9pUVVGQlFTdzRTRUZCT0VnN1FVRlJPVWdzVDBGQlR5eFpRVUZaTEUxQlFVMHNLMEpCUVN0Q0xFTkJRVUU3UVVGRGVFUXNUMEZCVHl4RlFVRkZMR2RDUVVGblFpeEZRVUZGTEc5Q1FVRnZRaXhGUVVGRkxFMUJRVTBzYTBOQlFXdERMRU5CUVVFN1FVRkRla1lzVDBGQlR5eFRRVUZUTEUxQlFVMHNNa0pCUVRKQ0xFTkJRVUU3UVVGRGFrUXNUMEZCVHl4WFFVRlhMRTFCUVUwc09FSkJRVGhDTEVOQlFVRTdRVUZGZEVRc01rSkJRVEpDTzBGQlF6TkNMRWxCUVVrc1lVRkJZU3hIUVVGSExGRkJRVkVzUTBGQlF5eGhRVUZoTEVOQlFVTXNjVU5CUVhGRExFTkJRVU1zUTBGQlFUdEJRVU5xUml4SlFVRkpMRmxCUVZrc1EwRkJReXhoUVVGaExFTkJRVU1zUTBGQlF5eEpRVUZKTEVWQlFVVXNRMEZCUVR0QlFVVjBReXd5UTBGQk1rTTdRVUZETTBNc1NVRkJTU3hYUVVGWExFZEJRVWNzWjBKQlFXZENMRVZCUVVVc1EwRkJRVHRCUVVOd1F5eEpRVUZKTEZkQlFWY3NTVUZCU1N4dlFrRkJiMElzUTBGQlF5eFhRVUZYTEVOQlFVTXNTVUZCU1N4WFFVRlhMRU5CUVVNc1UwRkJVeXhGUVVGRk8wbEJRek5GTEZOQlFWTXNSVUZCUlN4RFFVRkJPME5CUTJRN1FVRkZSQ3h4UkVGQmNVUTdRVUZEY2tRc2VVSkJRWGxDTzBGQlEzcENMRWxCUVVrc1dVRkJXU3hIUVVGSExGRkJRVkVzUTBGQlF5eGhRVUZoTEVOQlFVTXNhME5CUVd0RExFTkJRVU1zUTBGQlFUdEJRVU0zUlN4SlFVRkpMRmRCUVZjc1EwRkJReXhaUVVGWkxFTkJRVU1zUTBGQlF5eEpRVUZKTEVWQlFVVXNRMEZCUVR0QlFVVndReXhOUVVGTkxGTkJRVk1zUjBGQlJ5eFJRVUZSTEVOQlFVTXNaMEpCUVdkQ0xFTkJRVU1zWjBKQlFXZENMRU5CUVVNc1EwRkJRenRCUVVNNVJDeFRRVUZUTEVOQlFVTXNUMEZCVHl4RFFVRkRMRU5CUVVNc1NVRkJkVUlzUlVGQlJTeEZRVUZGTzBsQlF6RkRMRWxCUVVrc1EwRkJReXhuUWtGQlowSXNRMEZCUXl4UFFVRlBMRVZCUVVVc1IwRkJSeXhGUVVGRk8xRkJRMmhETEUxQlFVMHNRMEZCUXl4UFFVRlBMRU5CUVVNc1NVRkJTU3hGUVVGRkxFTkJRVU03U1VGRE1VSXNRMEZCUXl4RFFVRkRMRU5CUVVNN1FVRkRVQ3hEUVVGRExFTkJRVU1zUTBGQlF6dEJRVVZJTEUxQlFVMHNUVUZCVFN4SFFVRkhMRkZCUVZFc1EwRkJReXhqUVVGakxFTkJRVU1zYjBKQlFXOUNMRU5CUVVNc1EwRkJRenRCUVVNM1JDeE5RVUZOTEdGQlFVNHNUVUZCVFN4MVFrRkJUaXhOUVVGTkxFTkJRVVVzWjBKQlFXZENMRU5CUVVNc1QwRkJUeXhGUVVGRkxGTkJRVk1zVjBGQlZ5eERRVUZETEV0QlFVczdTVUZEZUVRc2RVSkJRWFZDTzBsQlEzWkNMRTFCUVUwc1dVRkJXU3hIUVVGSExGRkJRVkVzUTBGQlF5eGpRVUZqTEVOQlFVTXNVMEZCVXl4RFFVRXdRaXhEUVVGRE8wbEJRMnBHTEVsQlFVa3NXVUZCV1N4RFFVRkRMRXRCUVVzc1EwRkJReXhQUVVGUExFdEJRVXNzVFVGQlRTeEZRVUZGTzFGQlEzWkRMRmxCUVZrc1EwRkJReXhMUVVGTExFTkJRVU1zVDBGQlR5eEhRVUZITEU5QlFVOHNRMEZCUXp0TFFVTjRRenRUUVVGTk8xRkJRMGdzV1VGQldTeERRVUZETEV0QlFVc3NRMEZCUXl4UFFVRlBMRWRCUVVjc1RVRkJUU3hEUVVGRE8wdEJRM1pETzBGQlEwd3NRMEZCUXl4RFFVRkRMRU5CUVVNaUxDSm1hV3hsSWpvaVlYQndMbXB6SWl3aWMyOTFjbU5sYzBOdmJuUmxiblFpT2xzaUx5OGdhbk1nWTI5dGNHOXVaVzUwY3lCb1lYWmxJR0psWlc0Z2MyNWhabVpzWldRZ1puSnZiU0JvZEhSd2N6b3ZMMmRwZEdoMVlpNWpiMjB2WVd4d2FHRm5iM1l2WjI5MmRXc3RaR1Z6YVdkdUxYTjVjM1JsYlM5aWJHOWlMMjFoYVc0dmMzSmpMMnBoZG1GelkzSnBjSFJ6TDJOdmJYQnZibVZ1ZEhNdlhISmNibHh5WEc1a1pXTnNZWEpsSUdkc2IySmhiQ0I3WEhKY2JpQWdJQ0JwYm5SbGNtWmhZMlVnVjJsdVpHOTNJSHRjY2x4dUlDQWdJQ0FnSUNCSFJGTmZRMDlPVTBWT1ZGOURUMDlMU1VWZlZrVlNVMGxQVGpvZ1lXNTVPMXh5WEc0Z0lDQWdmVnh5WEc1OVhISmNibHh5WEc1cGJYQnZjblFnUTI5dmEybGxRbUZ1Ym1WeUlHWnliMjBnSnk0dlkyOXRjRzl1Wlc1MGN5OWpiMjlyYVdVdFltRnVibVZ5TG1wekoxeHlYRzVwYlhCdmNuUWdleUJuWlhSRGIyNXpaVzUwUTI5dmEybGxMQ0JwYzFaaGJHbGtRMjl1YzJWdWRFTnZiMnRwWlNCOUlHWnliMjBnSnk0dlkyOXRjRzl1Wlc1MGN5OWpiMjlyYVdVdFpuVnVZM1JwYjI1ekxtcHpKMXh5WEc1cGJYQnZjblFnUVc1aGJIbDBhV056SUdaeWIyMGdKeTR2WTI5dGNHOXVaVzUwY3k5aGJtRnNlWFJwWTNNdWFuTW5YSEpjYm1sdGNHOXlkQ0JEYjI5cmFXVnpVR0ZuWlNCbWNtOXRJQ2N1TDJOdmJYQnZibVZ1ZEhNdlkyOXZhMmxsY3kxd1lXZGxMbXB6SjF4eVhHNWNjbHh1THk4Z1NXNXBkR2xoYkdselpTQmpiMjlyYVdVZ1ltRnVibVZ5WEhKY2JuWmhjaUFrWTI5dmEybGxRbUZ1Ym1WeUlEMGdaRzlqZFcxbGJuUXVjWFZsY25sVFpXeGxZM1J2Y2lnblcyUmhkR0V0Ylc5a2RXeGxQVndpWjI5MmRXc3RZMjl2YTJsbExXSmhibTVsY2x3aVhTY3BYSEpjYm01bGR5QkRiMjlyYVdWQ1lXNXVaWElvSkdOdmIydHBaVUpoYm01bGNpa3VhVzVwZENncFhISmNibHh5WEc0dkx5QkpibWwwYVdGc2FYTmxJR0Z1WVd4NWRHbGpjeUJwWmlCamIyNXpaVzUwSUdseklHZHBkbVZ1WEhKY2JuWmhjaUIxYzJWeVEyOXVjMlZ1ZENBOUlHZGxkRU52Ym5ObGJuUkRiMjlyYVdVb0tWeHlYRzVwWmlBb2RYTmxja052Ym5ObGJuUWdKaVlnYVhOV1lXeHBaRU52Ym5ObGJuUkRiMjlyYVdVb2RYTmxja052Ym5ObGJuUXBJQ1ltSUhWelpYSkRiMjV6Wlc1MExtRnVZV3g1ZEdsamN5a2dlMXh5WEc0Z0lDQWdRVzVoYkhsMGFXTnpLQ2xjY2x4dWZWeHlYRzVjY2x4dUx5OTBiMlJ2T2lCdGIzWmxJSFJvYVhNZ2FXNTBieUJ6WTNKcGNIUnpJSE5sWTNScGIyNGdiMjRnWTI5dmEybGxJSEJoWjJWY2NseHVMeThnU1c1cGRHbGhiR2x6WlNCamIyOXJhV1VnY0dGblpWeHlYRzUyWVhJZ0pHTnZiMnRwWlhOUVlXZGxJRDBnWkc5amRXMWxiblF1Y1hWbGNubFRaV3hsWTNSdmNpZ25XMlJoZEdFdGJXOWtkV3hsUFZ3aVlYQndMV052YjJ0cFpYTXRjR0ZuWlZ3aVhTY3BYSEpjYm01bGR5QkRiMjlyYVdWelVHRm5aU2drWTI5dmEybGxjMUJoWjJVcExtbHVhWFFvS1Z4eVhHNWNjbHh1WTI5dWMzUWdZbUZqYTB4cGJtdHpJRDBnWkc5amRXMWxiblF1Y1hWbGNubFRaV3hsWTNSdmNrRnNiQ2hjSWk1aGNIQXRZbUZqYXkxc2FXNXJYQ0lwTzF4eVhHNWlZV05yVEdsdWEzTXVabTl5UldGamFDZ29iR2x1YXpvZ1NGUk5URUZ1WTJodmNrVnNaVzFsYm5RcElEMCtJSHRjY2x4dUlDQWdJR3hwYm1zdVlXUmtSWFpsYm5STWFYTjBaVzVsY2loY0ltTnNhV05yWENJc0lDZ3BJRDArSUh0Y2NseHVJQ0FnSUNBZ0lDQjNhVzVrYjNjdWFHbHpkRzl5ZVM1aVlXTnJLQ2s3WEhKY2JpQWdJQ0I5S1R0Y2NseHVmU2s3WEhKY2JseHlYRzVqYjI1emRDQmlkWFIwYjI0Z1BTQmtiMk4xYldWdWRDNW5aWFJGYkdWdFpXNTBRbmxKWkNnbmIzQmxiaTFqYkc5elpTMW1hV3gwWlhKekp5azdYSEpjYm1KMWRIUnZiajh1WVdSa1JYWmxiblJNYVhOMFpXNWxjaWduWTJ4cFkyc25MQ0JtZFc1amRHbHZiaUJvWVc1a2JHVkRiR2xqYXlobGRtVnVkQ2tnZTF4eVhHNGdJQ0FnTHk5MGIyUnZPaUIxY0dSaGRHVWdkRzhnZEhNZ01qOWNjbHh1SUNBZ0lHTnZibk4wSUdacGJIUmxja0oxZEhSdmJpQTlJR1J2WTNWdFpXNTBMbWRsZEVWc1pXMWxiblJDZVVsa0tGd2labWxzZEdWeWMxd2lLU0JoY3lCSVZFMU1SR2wyUld4bGJXVnVkQ0I4SUc1MWJHdzdYSEpjYmlBZ0lDQnBaaUFvWm1sc2RHVnlRblYwZEc5dUxuTjBlV3hsTG1ScGMzQnNZWGtnUFQwOUlGd2libTl1WlZ3aUtTQjdYSEpjYmlBZ0lDQWdJQ0FnWm1sc2RHVnlRblYwZEc5dUxuTjBlV3hsTG1ScGMzQnNZWGtnUFNCY0ltSnNiMk5yWENJN1hISmNiaUFnSUNCOUlHVnNjMlVnZTF4eVhHNGdJQ0FnSUNBZ0lHWnBiSFJsY2tKMWRIUnZiaTV6ZEhsc1pTNWthWE53YkdGNUlEMGdYQ0p1YjI1bFhDSTdYSEpjYmlBZ0lDQjlYSEpjYm4wcE8xeHlYRzRpWFgwPVxuIiwiKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcclxuXHR0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBmYWN0b3J5KGV4cG9ydHMpIDpcclxuXHR0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoJ0dPVlVLRnJvbnRlbmQnLCBbJ2V4cG9ydHMnXSwgZmFjdG9yeSkgOlxyXG5cdChmYWN0b3J5KChnbG9iYWwuR09WVUtGcm9udGVuZCA9IHt9KSkpO1xyXG59KHRoaXMsIChmdW5jdGlvbiAoZXhwb3J0cykgeyAndXNlIHN0cmljdCc7XHJcblxyXG4vKipcclxuICogQ29tbW9uIGhlbHBlcnMgd2hpY2ggZG8gbm90IHJlcXVpcmUgcG9seWZpbGwuXHJcbiAqXHJcbiAqIElNUE9SVEFOVDogSWYgYSBoZWxwZXIgcmVxdWlyZSBhIHBvbHlmaWxsLCBwbGVhc2UgaXNvbGF0ZSBpdCBpbiBpdHMgb3duIG1vZHVsZVxyXG4gKiBzbyB0aGF0IHRoZSBwb2x5ZmlsbCBjYW4gYmUgcHJvcGVybHkgdHJlZS1zaGFrZW4gYW5kIGRvZXMgbm90IGJ1cmRlblxyXG4gKiB0aGUgY29tcG9uZW50cyB0aGF0IGRvIG5vdCBuZWVkIHRoYXQgaGVscGVyXHJcbiAqXHJcbiAqIEBtb2R1bGUgY29tbW9uL2luZGV4XHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIFRPRE86IElkZWFsbHkgdGhpcyB3b3VsZCBiZSBhIE5vZGVMaXN0LnByb3RvdHlwZS5mb3JFYWNoIHBvbHlmaWxsXHJcbiAqIFRoaXMgc2VlbXMgdG8gZmFpbCBpbiBJRTgsIHJlcXVpcmVzIG1vcmUgaW52ZXN0aWdhdGlvbi5cclxuICogU2VlOiBodHRwczovL2dpdGh1Yi5jb20vaW1hZ2l0YW1hL25vZGVsaXN0LWZvcmVhY2gtcG9seWZpbGxcclxuICpcclxuICogQHBhcmFtIHtOb2RlTGlzdE9mPEVsZW1lbnQ+fSBub2RlcyAtIE5vZGVMaXN0IGZyb20gcXVlcnlTZWxlY3RvckFsbCgpXHJcbiAqIEBwYXJhbSB7bm9kZUxpc3RJdGVyYXRvcn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiB0byBydW4gZm9yIGVhY2ggbm9kZVxyXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxyXG4gKi9cclxuZnVuY3Rpb24gbm9kZUxpc3RGb3JFYWNoIChub2RlcywgY2FsbGJhY2spIHtcclxuICBpZiAod2luZG93Lk5vZGVMaXN0LnByb3RvdHlwZS5mb3JFYWNoKSB7XHJcbiAgICByZXR1cm4gbm9kZXMuZm9yRWFjaChjYWxsYmFjaylcclxuICB9XHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgY2FsbGJhY2suY2FsbCh3aW5kb3csIG5vZGVzW2ldLCBpLCBub2Rlcyk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVXNlZCB0byBnZW5lcmF0ZSBhIHVuaXF1ZSBzdHJpbmcsIGFsbG93cyBtdWx0aXBsZSBpbnN0YW5jZXMgb2YgdGhlIGNvbXBvbmVudFxyXG4gKiB3aXRob3V0IHRoZW0gY29uZmxpY3Rpbmcgd2l0aCBlYWNoIG90aGVyLlxyXG4gKiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvODgwOTQ3MlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBVbmlxdWUgSURcclxuICovXHJcbmZ1bmN0aW9uIGdlbmVyYXRlVW5pcXVlSUQgKCkge1xyXG4gIHZhciBkID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcbiAgaWYgKHR5cGVvZiB3aW5kb3cucGVyZm9ybWFuY2UgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiB3aW5kb3cucGVyZm9ybWFuY2Uubm93ID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICBkICs9IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKTsgLy8gdXNlIGhpZ2gtcHJlY2lzaW9uIHRpbWVyIGlmIGF2YWlsYWJsZVxyXG4gIH1cclxuICByZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykge1xyXG4gICAgdmFyIHIgPSAoZCArIE1hdGgucmFuZG9tKCkgKiAxNikgJSAxNiB8IDA7XHJcbiAgICBkID0gTWF0aC5mbG9vcihkIC8gMTYpO1xyXG4gICAgcmV0dXJuIChjID09PSAneCcgPyByIDogKHIgJiAweDMgfCAweDgpKS50b1N0cmluZygxNilcclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogQ29uZmlnIGZsYXR0ZW5pbmcgZnVuY3Rpb25cclxuICpcclxuICogVGFrZXMgYW55IG51bWJlciBvZiBvYmplY3RzLCBmbGF0dGVucyB0aGVtIGludG8gbmFtZXNwYWNlZCBrZXktdmFsdWUgcGFpcnMsXHJcbiAqIChlLmcuIHsnaTE4bi5zaG93U2VjdGlvbic6ICdTaG93IHNlY3Rpb24nfSkgYW5kIGNvbWJpbmVzIHRoZW0gdG9nZXRoZXIsIHdpdGhcclxuICogZ3JlYXRlc3QgcHJpb3JpdHkgb24gdGhlIExBU1QgaXRlbSBwYXNzZWQgaW4uXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtvYmplY3R9IEEgZmxhdHRlbmVkIG9iamVjdCBvZiBrZXktdmFsdWUgcGFpcnMuXHJcbiAqL1xyXG5mdW5jdGlvbiBtZXJnZUNvbmZpZ3MgKC8qIGNvbmZpZ09iamVjdDEsIGNvbmZpZ09iamVjdDIsIC4uLmNvbmZpZ09iamVjdHMgKi8pIHtcclxuICAvKipcclxuICAgKiBGdW5jdGlvbiB0byB0YWtlIG5lc3RlZCBvYmplY3RzIGFuZCBmbGF0dGVuIHRoZW0gdG8gYSBkb3Qtc2VwYXJhdGVkIGtleWVkXHJcbiAgICogb2JqZWN0LiBEb2luZyB0aGlzIG1lYW5zIHdlIGRvbid0IG5lZWQgdG8gZG8gYW55IGRlZXAvcmVjdXJzaXZlIG1lcmdpbmcgb2ZcclxuICAgKiBlYWNoIG9mIG91ciBvYmplY3RzLCBub3IgdHJhbnNmb3JtIG91ciBkYXRhc2V0IGZyb20gYSBmbGF0IGxpc3QgaW50byBhXHJcbiAgICogbmVzdGVkIG9iamVjdC5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWdPYmplY3QgLSBEZWVwbHkgbmVzdGVkIG9iamVjdFxyXG4gICAqIEByZXR1cm5zIHtvYmplY3R9IEZsYXR0ZW5lZCBvYmplY3Qgd2l0aCBkb3Qtc2VwYXJhdGVkIGtleXNcclxuICAgKi9cclxuICB2YXIgZmxhdHRlbk9iamVjdCA9IGZ1bmN0aW9uIChjb25maWdPYmplY3QpIHtcclxuICAgIC8vIFByZXBhcmUgYW4gZW1wdHkgcmV0dXJuIG9iamVjdFxyXG4gICAgdmFyIGZsYXR0ZW5lZE9iamVjdCA9IHt9O1xyXG5cclxuICAgIC8vIE91ciBmbGF0dGVuaW5nIGZ1bmN0aW9uLCB0aGlzIGlzIGNhbGxlZCByZWN1cnNpdmVseSBmb3IgZWFjaCBsZXZlbCBvZlxyXG4gICAgLy8gZGVwdGggaW4gdGhlIG9iamVjdC4gQXQgZWFjaCBsZXZlbCB3ZSBwcmVwZW5kIHRoZSBwcmV2aW91cyBsZXZlbCBuYW1lcyB0b1xyXG4gICAgLy8gdGhlIGtleSB1c2luZyBgcHJlZml4YC5cclxuICAgIHZhciBmbGF0dGVuTG9vcCA9IGZ1bmN0aW9uIChvYmosIHByZWZpeCkge1xyXG4gICAgICAvLyBMb29wIHRocm91Z2gga2V5cy4uLlxyXG4gICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHRoaXMgaXMgYSBwcm90b3R5cGljYWwga2V5L3ZhbHVlLFxyXG4gICAgICAgIC8vIGlmIGl0IGlzLCBza2lwIGl0LlxyXG4gICAgICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgICAgY29udGludWVcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHZhbHVlID0gb2JqW2tleV07XHJcbiAgICAgICAgdmFyIHByZWZpeGVkS2V5ID0gcHJlZml4ID8gcHJlZml4ICsgJy4nICsga2V5IDoga2V5O1xyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAvLyBJZiB0aGUgdmFsdWUgaXMgYSBuZXN0ZWQgb2JqZWN0LCByZWN1cnNlIG92ZXIgdGhhdCB0b29cclxuICAgICAgICAgIGZsYXR0ZW5Mb29wKHZhbHVlLCBwcmVmaXhlZEtleSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vIE90aGVyd2lzZSwgYWRkIHRoaXMgdmFsdWUgdG8gb3VyIHJldHVybiBvYmplY3RcclxuICAgICAgICAgIGZsYXR0ZW5lZE9iamVjdFtwcmVmaXhlZEtleV0gPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gS2ljayBvZmYgdGhlIHJlY3Vyc2l2ZSBsb29wXHJcbiAgICBmbGF0dGVuTG9vcChjb25maWdPYmplY3QpO1xyXG4gICAgcmV0dXJuIGZsYXR0ZW5lZE9iamVjdFxyXG4gIH07XHJcblxyXG4gIC8vIFN0YXJ0IHdpdGggYW4gZW1wdHkgb2JqZWN0IGFzIG91ciBiYXNlXHJcbiAgdmFyIGZvcm1hdHRlZENvbmZpZ09iamVjdCA9IHt9O1xyXG5cclxuICAvLyBMb29wIHRocm91Z2ggZWFjaCBvZiB0aGUgcmVtYWluaW5nIHBhc3NlZCBvYmplY3RzIGFuZCBwdXNoIHRoZWlyIGtleXNcclxuICAvLyBvbmUtYnktb25lIGludG8gY29uZmlnT2JqZWN0LiBBbnkgZHVwbGljYXRlIGtleXMgd2lsbCBvdmVycmlkZSB0aGUgZXhpc3RpbmdcclxuICAvLyBrZXkgd2l0aCB0aGUgbmV3IHZhbHVlLlxyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICB2YXIgb2JqID0gZmxhdHRlbk9iamVjdChhcmd1bWVudHNbaV0pO1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgIGZvcm1hdHRlZENvbmZpZ09iamVjdFtrZXldID0gb2JqW2tleV07XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiBmb3JtYXR0ZWRDb25maWdPYmplY3RcclxufVxyXG5cclxuLyoqXHJcbiAqIEV4dHJhY3RzIGtleXMgc3RhcnRpbmcgd2l0aCBhIHBhcnRpY3VsYXIgbmFtZXNwYWNlIGZyb20gYSBmbGF0dGVuZWQgY29uZmlnXHJcbiAqIG9iamVjdCwgcmVtb3ZpbmcgdGhlIG5hbWVzcGFjZSBpbiB0aGUgcHJvY2Vzcy5cclxuICpcclxuICogQHBhcmFtIHtvYmplY3R9IGNvbmZpZ09iamVjdCAtIFRoZSBvYmplY3QgdG8gZXh0cmFjdCBrZXktdmFsdWUgcGFpcnMgZnJvbS5cclxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWVzcGFjZSAtIFRoZSBuYW1lc3BhY2UgdG8gZmlsdGVyIGtleXMgd2l0aC5cclxuICogQHJldHVybnMge29iamVjdH0gRmxhdHRlbmVkIG9iamVjdCB3aXRoIGRvdC1zZXBhcmF0ZWQga2V5IG5hbWVzcGFjZSByZW1vdmVkXHJcbiAqL1xyXG5mdW5jdGlvbiBleHRyYWN0Q29uZmlnQnlOYW1lc3BhY2UgKGNvbmZpZ09iamVjdCwgbmFtZXNwYWNlKSB7XHJcbiAgLy8gQ2hlY2sgd2UgaGF2ZSB3aGF0IHdlIG5lZWRcclxuICBpZiAoIWNvbmZpZ09iamVjdCB8fCB0eXBlb2YgY29uZmlnT2JqZWN0ICE9PSAnb2JqZWN0Jykge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdQcm92aWRlIGEgYGNvbmZpZ09iamVjdGAgb2YgdHlwZSBcIm9iamVjdFwiLicpXHJcbiAgfVxyXG4gIGlmICghbmFtZXNwYWNlIHx8IHR5cGVvZiBuYW1lc3BhY2UgIT09ICdzdHJpbmcnKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Byb3ZpZGUgYSBgbmFtZXNwYWNlYCBvZiB0eXBlIFwic3RyaW5nXCIgdG8gZmlsdGVyIHRoZSBgY29uZmlnT2JqZWN0YCBieS4nKVxyXG4gIH1cclxuICB2YXIgbmV3T2JqZWN0ID0ge307XHJcbiAgZm9yICh2YXIga2V5IGluIGNvbmZpZ09iamVjdCkge1xyXG4gICAgLy8gU3BsaXQgdGhlIGtleSBpbnRvIHBhcnRzLCB1c2luZyAuIGFzIG91ciBuYW1lc3BhY2Ugc2VwYXJhdG9yXHJcbiAgICB2YXIga2V5UGFydHMgPSBrZXkuc3BsaXQoJy4nKTtcclxuICAgIC8vIENoZWNrIGlmIHRoZSBmaXJzdCBuYW1lc3BhY2UgbWF0Y2hlcyB0aGUgY29uZmlndXJlZCBuYW1lc3BhY2VcclxuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoY29uZmlnT2JqZWN0LCBrZXkpICYmIGtleVBhcnRzWzBdID09PSBuYW1lc3BhY2UpIHtcclxuICAgICAgLy8gUmVtb3ZlIHRoZSBmaXJzdCBpdGVtICh0aGUgbmFtZXNwYWNlKSBmcm9tIHRoZSBwYXJ0cyBhcnJheSxcclxuICAgICAgLy8gYnV0IG9ubHkgaWYgdGhlcmUgaXMgbW9yZSB0aGFuIG9uZSBwYXJ0ICh3ZSBkb24ndCB3YW50IGJsYW5rIGtleXMhKVxyXG4gICAgICBpZiAoa2V5UGFydHMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgIGtleVBhcnRzLnNoaWZ0KCk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gSm9pbiB0aGUgcmVtYWluaW5nIHBhcnRzIGJhY2sgdG9nZXRoZXJcclxuICAgICAgdmFyIG5ld0tleSA9IGtleVBhcnRzLmpvaW4oJy4nKTtcclxuICAgICAgLy8gQWRkIHRoZW0gdG8gb3VyIG5ldyBvYmplY3RcclxuICAgICAgbmV3T2JqZWN0W25ld0tleV0gPSBjb25maWdPYmplY3Rba2V5XTtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIG5ld09iamVjdFxyXG59XHJcblxyXG4vKipcclxuICogQGNhbGxiYWNrIG5vZGVMaXN0SXRlcmF0b3JcclxuICogQHBhcmFtIHtFbGVtZW50fSB2YWx1ZSAtIFRoZSBjdXJyZW50IG5vZGUgYmVpbmcgaXRlcmF0ZWQgb25cclxuICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IC0gVGhlIGN1cnJlbnQgaW5kZXggaW4gdGhlIGl0ZXJhdGlvblxyXG4gKiBAcGFyYW0ge05vZGVMaXN0T2Y8RWxlbWVudD59IG5vZGVzIC0gTm9kZUxpc3QgZnJvbSBxdWVyeVNlbGVjdG9yQWxsKClcclxuICogQHJldHVybnMge3VuZGVmaW5lZH1cclxuICovXHJcblxyXG4vKipcclxuICogSW50ZXJuYWwgc3VwcG9ydCBmb3Igc2VsZWN0aW5nIG1lc3NhZ2VzIHRvIHJlbmRlciwgd2l0aCBwbGFjZWhvbGRlclxyXG4gKiBpbnRlcnBvbGF0aW9uIGFuZCBsb2NhbGUtYXdhcmUgbnVtYmVyIGZvcm1hdHRpbmcgYW5kIHBsdXJhbGlzYXRpb25cclxuICpcclxuICogQGNsYXNzXHJcbiAqIEBwcml2YXRlXHJcbiAqIEBwYXJhbSB7VHJhbnNsYXRpb25zRmxhdHRlbmVkfSB0cmFuc2xhdGlvbnMgLSBLZXktdmFsdWUgcGFpcnMgb2YgdGhlIHRyYW5zbGF0aW9uIHN0cmluZ3MgdG8gdXNlLlxyXG4gKiBAcGFyYW0ge29iamVjdH0gW2NvbmZpZ10gLSBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSBmdW5jdGlvbi5cclxuICogQHBhcmFtIHtzdHJpbmd9IGNvbmZpZy5sb2NhbGUgLSBBbiBvdmVycmlkaW5nIGxvY2FsZSBmb3IgdGhlIFBsdXJhbFJ1bGVzIGZ1bmN0aW9uYWxpdHkuXHJcbiAqL1xyXG5mdW5jdGlvbiBJMThuICh0cmFuc2xhdGlvbnMsIGNvbmZpZykge1xyXG4gIC8vIE1ha2UgbGlzdCBvZiB0cmFuc2xhdGlvbnMgYXZhaWxhYmxlIHRocm91Z2hvdXQgZnVuY3Rpb25cclxuICB0aGlzLnRyYW5zbGF0aW9ucyA9IHRyYW5zbGF0aW9ucyB8fCB7fTtcclxuXHJcbiAgLy8gVGhlIGxvY2FsZSB0byB1c2UgZm9yIFBsdXJhbFJ1bGVzIGFuZCBOdW1iZXJGb3JtYXRcclxuICB0aGlzLmxvY2FsZSA9IChjb25maWcgJiYgY29uZmlnLmxvY2FsZSkgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmxhbmcgfHwgJ2VuJztcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoZSBtb3N0IHVzZWQgZnVuY3Rpb24gLSB0YWtlcyB0aGUga2V5IGZvciBhIGdpdmVuIHBpZWNlIG9mIFVJIHRleHQgYW5kXHJcbiAqIHJldHVybnMgdGhlIGFwcHJvcHJpYXRlIHN0cmluZy5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IGxvb2t1cEtleSAtIFRoZSBsb29rdXAga2V5IG9mIHRoZSBzdHJpbmcgdG8gdXNlLlxyXG4gKiBAcGFyYW0ge29iamVjdH0gb3B0aW9ucyAtIEFueSBvcHRpb25zIHBhc3NlZCB3aXRoIHRoZSB0cmFuc2xhdGlvbiBzdHJpbmcsIGUuZzogZm9yIHN0cmluZyBpbnRlcnBvbGF0aW9uLlxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgYXBwcm9wcmlhdGUgdHJhbnNsYXRpb24gc3RyaW5nLlxyXG4gKi9cclxuSTE4bi5wcm90b3R5cGUudCA9IGZ1bmN0aW9uIChsb29rdXBLZXksIG9wdGlvbnMpIHtcclxuICBpZiAoIWxvb2t1cEtleSkge1xyXG4gICAgLy8gUHJpbnQgYSBjb25zb2xlIGVycm9yIGlmIG5vIGxvb2t1cCBrZXkgaGFzIGJlZW4gcHJvdmlkZWRcclxuICAgIHRocm93IG5ldyBFcnJvcignaTE4bjogbG9va3VwIGtleSBtaXNzaW5nJylcclxuICB9XHJcblxyXG4gIC8vIElmIHRoZSBgY291bnRgIG9wdGlvbiBpcyBzZXQsIGRldGVybWluZSB3aGljaCBwbHVyYWwgc3VmZml4IGlzIG5lZWRlZCBhbmRcclxuICAvLyBjaGFuZ2UgdGhlIGxvb2t1cEtleSB0byBtYXRjaC4gV2UgY2hlY2sgdG8gc2VlIGlmIGl0J3MgdW5kZWZpbmVkIGluc3RlYWQgb2ZcclxuICAvLyBmYWxzeSwgYXMgdGhpcyBjb3VsZCBsZWdpdGltYXRlbHkgYmUgMC5cclxuICBpZiAob3B0aW9ucyAmJiB0eXBlb2Ygb3B0aW9ucy5jb3VudCAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgIC8vIEdldCB0aGUgcGx1cmFsIHN1ZmZpeFxyXG4gICAgbG9va3VwS2V5ID0gbG9va3VwS2V5ICsgJy4nICsgdGhpcy5nZXRQbHVyYWxTdWZmaXgobG9va3VwS2V5LCBvcHRpb25zLmNvdW50KTtcclxuICB9XHJcblxyXG4gIGlmIChsb29rdXBLZXkgaW4gdGhpcy50cmFuc2xhdGlvbnMpIHtcclxuICAgIC8vIEZldGNoIHRoZSB0cmFuc2xhdGlvbiBzdHJpbmcgZm9yIHRoYXQgbG9va3VwIGtleVxyXG4gICAgdmFyIHRyYW5zbGF0aW9uU3RyaW5nID0gdGhpcy50cmFuc2xhdGlvbnNbbG9va3VwS2V5XTtcclxuXHJcbiAgICAvLyBDaGVjayBmb3IgJHt9IHBsYWNlaG9sZGVycyBpbiB0aGUgdHJhbnNsYXRpb24gc3RyaW5nXHJcbiAgICBpZiAodHJhbnNsYXRpb25TdHJpbmcubWF0Y2goLyV7KC5cXFMrKX0vKSkge1xyXG4gICAgICBpZiAoIW9wdGlvbnMpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2kxOG46IGNhbm5vdCByZXBsYWNlIHBsYWNlaG9sZGVycyBpbiBzdHJpbmcgaWYgbm8gb3B0aW9uIGRhdGEgcHJvdmlkZWQnKVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gdGhpcy5yZXBsYWNlUGxhY2Vob2xkZXJzKHRyYW5zbGF0aW9uU3RyaW5nLCBvcHRpb25zKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIHRyYW5zbGF0aW9uU3RyaW5nXHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIC8vIElmIHRoZSBrZXkgd2Fzbid0IGZvdW5kIGluIG91ciB0cmFuc2xhdGlvbnMgb2JqZWN0LFxyXG4gICAgLy8gcmV0dXJuIHRoZSBsb29rdXAga2V5IGl0c2VsZiBhcyB0aGUgZmFsbGJhY2tcclxuICAgIHJldHVybiBsb29rdXBLZXlcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogVGFrZXMgYSB0cmFuc2xhdGlvbiBzdHJpbmcgd2l0aCBwbGFjZWhvbGRlcnMsIGFuZCByZXBsYWNlcyB0aGUgcGxhY2Vob2xkZXJzXHJcbiAqIHdpdGggdGhlIHByb3ZpZGVkIGRhdGFcclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IHRyYW5zbGF0aW9uU3RyaW5nIC0gVGhlIHRyYW5zbGF0aW9uIHN0cmluZ1xyXG4gKiBAcGFyYW0ge29iamVjdH0gb3B0aW9ucyAtIEFueSBvcHRpb25zIHBhc3NlZCB3aXRoIHRoZSB0cmFuc2xhdGlvbiBzdHJpbmcsIGUuZzogZm9yIHN0cmluZyBpbnRlcnBvbGF0aW9uLlxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgdHJhbnNsYXRpb24gc3RyaW5nIHRvIG91dHB1dCwgd2l0aCAke30gcGxhY2Vob2xkZXJzIHJlcGxhY2VkXHJcbiAqL1xyXG5JMThuLnByb3RvdHlwZS5yZXBsYWNlUGxhY2Vob2xkZXJzID0gZnVuY3Rpb24gKHRyYW5zbGF0aW9uU3RyaW5nLCBvcHRpb25zKSB7XHJcbiAgdmFyIGZvcm1hdHRlcjtcclxuXHJcbiAgaWYgKHRoaXMuaGFzSW50bE51bWJlckZvcm1hdFN1cHBvcnQoKSkge1xyXG4gICAgZm9ybWF0dGVyID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KHRoaXMubG9jYWxlKTtcclxuICB9XHJcblxyXG4gIHJldHVybiB0cmFuc2xhdGlvblN0cmluZy5yZXBsYWNlKC8leyguXFxTKyl9L2csIGZ1bmN0aW9uIChwbGFjZWhvbGRlcldpdGhCcmFjZXMsIHBsYWNlaG9sZGVyS2V5KSB7XHJcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9wdGlvbnMsIHBsYWNlaG9sZGVyS2V5KSkge1xyXG4gICAgICB2YXIgcGxhY2Vob2xkZXJWYWx1ZSA9IG9wdGlvbnNbcGxhY2Vob2xkZXJLZXldO1xyXG5cclxuICAgICAgLy8gSWYgYSB1c2VyIGhhcyBwYXNzZWQgYGZhbHNlYCBhcyB0aGUgdmFsdWUgZm9yIHRoZSBwbGFjZWhvbGRlclxyXG4gICAgICAvLyB0cmVhdCBpdCBhcyB0aG91Z2ggdGhlIHZhbHVlIHNob3VsZCBub3QgYmUgZGlzcGxheWVkXHJcbiAgICAgIGlmIChwbGFjZWhvbGRlclZhbHVlID09PSBmYWxzZSkge1xyXG4gICAgICAgIHJldHVybiAnJ1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBJZiB0aGUgcGxhY2Vob2xkZXIncyB2YWx1ZSBpcyBhIG51bWJlciwgbG9jYWxpc2UgdGhlIG51bWJlciBmb3JtYXR0aW5nXHJcbiAgICAgIGlmICh0eXBlb2YgcGxhY2Vob2xkZXJWYWx1ZSA9PT0gJ251bWJlcicgJiYgZm9ybWF0dGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGZvcm1hdHRlci5mb3JtYXQocGxhY2Vob2xkZXJWYWx1ZSlcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHBsYWNlaG9sZGVyVmFsdWVcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignaTE4bjogbm8gZGF0YSBmb3VuZCB0byByZXBsYWNlICcgKyBwbGFjZWhvbGRlcldpdGhCcmFjZXMgKyAnIHBsYWNlaG9sZGVyIGluIHN0cmluZycpXHJcbiAgICB9XHJcbiAgfSlcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDaGVjayB0byBzZWUgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgSW50bCBhbmQgSW50bC5QbHVyYWxSdWxlcy5cclxuICpcclxuICogSXQgcmVxdWlyZXMgYWxsIGNvbmRpdGlvbnMgdG8gYmUgbWV0IGluIG9yZGVyIHRvIGJlIHN1cHBvcnRlZDpcclxuICogLSBUaGUgYnJvd3NlciBzdXBwb3J0cyB0aGUgSW50bCBjbGFzcyAodHJ1ZSBpbiBJRTExKVxyXG4gKiAtIFRoZSBpbXBsZW1lbnRhdGlvbiBvZiBJbnRsIHN1cHBvcnRzIFBsdXJhbFJ1bGVzIChOT1QgdHJ1ZSBpbiBJRTExKVxyXG4gKiAtIFRoZSBicm93c2VyL09TIGhhcyBwbHVyYWwgcnVsZXMgZm9yIHRoZSBjdXJyZW50IGxvY2FsZSAoYnJvd3NlciBkZXBlbmRlbnQpXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIHRydWUgaWYgYWxsIGNvbmRpdGlvbnMgYXJlIG1ldC4gUmV0dXJucyBmYWxzZSBvdGhlcndpc2UuXHJcbiAqL1xyXG5JMThuLnByb3RvdHlwZS5oYXNJbnRsUGx1cmFsUnVsZXNTdXBwb3J0ID0gZnVuY3Rpb24gKCkge1xyXG4gIHJldHVybiBCb29sZWFuKHdpbmRvdy5JbnRsICYmICgnUGx1cmFsUnVsZXMnIGluIHdpbmRvdy5JbnRsICYmIEludGwuUGx1cmFsUnVsZXMuc3VwcG9ydGVkTG9jYWxlc09mKHRoaXMubG9jYWxlKS5sZW5ndGgpKVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIENoZWNrIHRvIHNlZSBpZiB0aGUgYnJvd3NlciBzdXBwb3J0cyBJbnRsIGFuZCBJbnRsLk51bWJlckZvcm1hdC5cclxuICpcclxuICogSXQgcmVxdWlyZXMgYWxsIGNvbmRpdGlvbnMgdG8gYmUgbWV0IGluIG9yZGVyIHRvIGJlIHN1cHBvcnRlZDpcclxuICogLSBUaGUgYnJvd3NlciBzdXBwb3J0cyB0aGUgSW50bCBjbGFzcyAodHJ1ZSBpbiBJRTExKVxyXG4gKiAtIFRoZSBpbXBsZW1lbnRhdGlvbiBvZiBJbnRsIHN1cHBvcnRzIE51bWJlckZvcm1hdCAoYWxzbyB0cnVlIGluIElFMTEpXHJcbiAqIC0gVGhlIGJyb3dzZXIvT1MgaGFzIG51bWJlciBmb3JtYXR0aW5nIHJ1bGVzIGZvciB0aGUgY3VycmVudCBsb2NhbGUgKGJyb3dzZXIgZGVwZW5kZW50KVxyXG4gKlxyXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIGlmIGFsbCBjb25kaXRpb25zIGFyZSBtZXQuIFJldHVybnMgZmFsc2Ugb3RoZXJ3aXNlLlxyXG4gKi9cclxuSTE4bi5wcm90b3R5cGUuaGFzSW50bE51bWJlckZvcm1hdFN1cHBvcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgcmV0dXJuIEJvb2xlYW4od2luZG93LkludGwgJiYgKCdOdW1iZXJGb3JtYXQnIGluIHdpbmRvdy5JbnRsICYmIEludGwuTnVtYmVyRm9ybWF0LnN1cHBvcnRlZExvY2FsZXNPZih0aGlzLmxvY2FsZSkubGVuZ3RoKSlcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgdGhlIGFwcHJvcHJpYXRlIHN1ZmZpeCBmb3IgdGhlIHBsdXJhbCBmb3JtLlxyXG4gKlxyXG4gKiBVc2VzIEludGwuUGx1cmFsUnVsZXMgKG9yIG91ciBvd24gZmFsbGJhY2sgaW1wbGVtZW50YXRpb24pIHRvIGdldCB0aGVcclxuICogJ3ByZWZlcnJlZCcgZm9ybSB0byB1c2UgZm9yIHRoZSBnaXZlbiBjb3VudC5cclxuICpcclxuICogQ2hlY2tzIHRoYXQgYSB0cmFuc2xhdGlvbiBoYXMgYmVlbiBwcm92aWRlZCBmb3IgdGhhdCBwbHVyYWwgZm9ybSDigJMgaWYgaXRcclxuICogaGFzbid0LCBpdCdsbCBmYWxsIGJhY2sgdG8gdGhlICdvdGhlcicgcGx1cmFsIGZvcm0gKHVubGVzcyB0aGF0IGRvZXNuJ3QgZXhpc3RcclxuICogZWl0aGVyLCBpbiB3aGljaCBjYXNlIGFuIGVycm9yIHdpbGwgYmUgdGhyb3duKVxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbG9va3VwS2V5IC0gVGhlIGxvb2t1cCBrZXkgb2YgdGhlIHN0cmluZyB0byB1c2UuXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBjb3VudCAtIE51bWJlciB1c2VkIHRvIGRldGVybWluZSB3aGljaCBwbHVyYWxpc2F0aW9uIHRvIHVzZS5cclxuICogQHJldHVybnMge1BsdXJhbFJ1bGV9IFRoZSBzdWZmaXggYXNzb2NpYXRlZCB3aXRoIHRoZSBjb3JyZWN0IHBsdXJhbGlzYXRpb24gZm9yIHRoaXMgbG9jYWxlLlxyXG4gKi9cclxuSTE4bi5wcm90b3R5cGUuZ2V0UGx1cmFsU3VmZml4ID0gZnVuY3Rpb24gKGxvb2t1cEtleSwgY291bnQpIHtcclxuICAvLyBWYWxpZGF0ZSB0aGF0IHRoZSBudW1iZXIgaXMgYWN0dWFsbHkgYSBudW1iZXIuXHJcbiAgLy9cclxuICAvLyBOdW1iZXIoY291bnQpIHdpbGwgdHVybiBhbnl0aGluZyB0aGF0IGNhbid0IGJlIGNvbnZlcnRlZCB0byBhIE51bWJlciB0eXBlXHJcbiAgLy8gaW50byAnTmFOJy4gaXNGaW5pdGUgZmlsdGVycyBvdXQgTmFOLCBhcyBpdCBpc24ndCBhIGZpbml0ZSBudW1iZXIuXHJcbiAgY291bnQgPSBOdW1iZXIoY291bnQpO1xyXG4gIGlmICghaXNGaW5pdGUoY291bnQpKSB7IHJldHVybiAnb3RoZXInIH1cclxuXHJcbiAgdmFyIHByZWZlcnJlZEZvcm07XHJcblxyXG4gIC8vIENoZWNrIHRvIHZlcmlmeSB0aGF0IGFsbCB0aGUgcmVxdWlyZW1lbnRzIGZvciBJbnRsLlBsdXJhbFJ1bGVzIGFyZSBtZXQuXHJcbiAgLy8gSWYgc28sIHdlIGNhbiB1c2UgdGhhdCBpbnN0ZWFkIG9mIG91ciBjdXN0b20gaW1wbGVtZW50YXRpb24uIE90aGVyd2lzZSxcclxuICAvLyB1c2UgdGhlIGhhcmRjb2RlZCBmYWxsYmFjay5cclxuICBpZiAodGhpcy5oYXNJbnRsUGx1cmFsUnVsZXNTdXBwb3J0KCkpIHtcclxuICAgIHByZWZlcnJlZEZvcm0gPSBuZXcgSW50bC5QbHVyYWxSdWxlcyh0aGlzLmxvY2FsZSkuc2VsZWN0KGNvdW50KTtcclxuICB9IGVsc2Uge1xyXG4gICAgcHJlZmVycmVkRm9ybSA9IHRoaXMuc2VsZWN0UGx1cmFsRm9ybVVzaW5nRmFsbGJhY2tSdWxlcyhjb3VudCk7XHJcbiAgfVxyXG5cclxuICAvLyBVc2UgdGhlIGNvcnJlY3QgcGx1cmFsIGZvcm0gaWYgcHJvdmlkZWRcclxuICBpZiAobG9va3VwS2V5ICsgJy4nICsgcHJlZmVycmVkRm9ybSBpbiB0aGlzLnRyYW5zbGF0aW9ucykge1xyXG4gICAgcmV0dXJuIHByZWZlcnJlZEZvcm1cclxuICAvLyBGYWxsIGJhY2sgdG8gYG90aGVyYCBpZiB0aGUgcGx1cmFsIGZvcm0gaXMgbWlzc2luZywgYnV0IGxvZyBhIHdhcm5pbmdcclxuICAvLyB0byB0aGUgY29uc29sZVxyXG4gIH0gZWxzZSBpZiAobG9va3VwS2V5ICsgJy5vdGhlcicgaW4gdGhpcy50cmFuc2xhdGlvbnMpIHtcclxuICAgIGlmIChjb25zb2xlICYmICd3YXJuJyBpbiBjb25zb2xlKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignaTE4bjogTWlzc2luZyBwbHVyYWwgZm9ybSBcIi4nICsgcHJlZmVycmVkRm9ybSArICdcIiBmb3IgXCInICtcclxuICAgICAgICB0aGlzLmxvY2FsZSArICdcIiBsb2NhbGUuIEZhbGxpbmcgYmFjayB0byBcIi5vdGhlclwiLicpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAnb3RoZXInXHJcbiAgLy8gSWYgdGhlIHJlcXVpcmVkIGBvdGhlcmAgcGx1cmFsIGZvcm0gaXMgbWlzc2luZywgYWxsIHdlIGNhbiBkbyBpcyBlcnJvclxyXG4gIH0gZWxzZSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgICdpMThuOiBQbHVyYWwgZm9ybSBcIi5vdGhlclwiIGlzIHJlcXVpcmVkIGZvciBcIicgKyB0aGlzLmxvY2FsZSArICdcIiBsb2NhbGUnXHJcbiAgICApXHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldCB0aGUgcGx1cmFsIGZvcm0gdXNpbmcgb3VyIGZhbGxiYWNrIGltcGxlbWVudGF0aW9uXHJcbiAqXHJcbiAqIFRoaXMgaXMgc3BsaXQgb3V0IGludG8gYSBzZXBhcmF0ZSBmdW5jdGlvbiB0byBtYWtlIGl0IGVhc2llciB0byB0ZXN0IHRoZVxyXG4gKiBmYWxsYmFjayBiZWhhdmlvdXIgaW4gYW4gZW52aXJvbm1lbnQgd2hlcmUgSW50bC5QbHVyYWxSdWxlcyBleGlzdHMuXHJcbiAqXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBjb3VudCAtIE51bWJlciB1c2VkIHRvIGRldGVybWluZSB3aGljaCBwbHVyYWxpc2F0aW9uIHRvIHVzZS5cclxuICogQHJldHVybnMge1BsdXJhbFJ1bGV9IFRoZSBwbHVyYWxpc2F0aW9uIGZvcm0gZm9yIGNvdW50IGluIHRoaXMgbG9jYWxlLlxyXG4gKi9cclxuSTE4bi5wcm90b3R5cGUuc2VsZWN0UGx1cmFsRm9ybVVzaW5nRmFsbGJhY2tSdWxlcyA9IGZ1bmN0aW9uIChjb3VudCkge1xyXG4gIC8vIEN1cnJlbnRseSBvdXIgY3VzdG9tIGNvZGUgY2FuIG9ubHkgaGFuZGxlIHBvc2l0aXZlIGludGVnZXJzLCBzbyBsZXQnc1xyXG4gIC8vIG1ha2Ugc3VyZSBvdXIgbnVtYmVyIGlzIG9uZSBvZiB0aG9zZS5cclxuICBjb3VudCA9IE1hdGguYWJzKE1hdGguZmxvb3IoY291bnQpKTtcclxuXHJcbiAgdmFyIHJ1bGVzZXQgPSB0aGlzLmdldFBsdXJhbFJ1bGVzRm9yTG9jYWxlKCk7XHJcblxyXG4gIGlmIChydWxlc2V0KSB7XHJcbiAgICByZXR1cm4gSTE4bi5wbHVyYWxSdWxlc1tydWxlc2V0XShjb3VudClcclxuICB9XHJcblxyXG4gIHJldHVybiAnb3RoZXInXHJcbn07XHJcblxyXG4vKipcclxuICogV29yayBvdXQgd2hpY2ggcGx1cmFsaXNhdGlvbiBydWxlcyB0byB1c2UgZm9yIHRoZSBjdXJyZW50IGxvY2FsZVxyXG4gKlxyXG4gKiBUaGUgbG9jYWxlIG1heSBpbmNsdWRlIGEgcmVnaW9uYWwgaW5kaWNhdG9yIChzdWNoIGFzIGVuLUdCKSwgYnV0IHdlIGRvbid0XHJcbiAqIHVzdWFsbHkgY2FyZSBhYm91dCB0aGlzIHBhcnQsIGFzIHBsdXJhbGlzYXRpb24gcnVsZXMgYXJlIHVzdWFsbHkgdGhlIHNhbWVcclxuICogcmVnYXJkbGVzcyBvZiByZWdpb24uIFRoZXJlIGFyZSBleGNlcHRpb25zLCBob3dldmVyLCAoZS5nLiBQb3J0dWd1ZXNlKSBzb1xyXG4gKiB0aGlzIHNlYXJjaGVzIGJ5IGJvdGggdGhlIGZ1bGwgYW5kIHNob3J0ZW5lZCBsb2NhbGUgY29kZXMsIGp1c3QgdG8gYmUgc3VyZS5cclxuICpcclxuICogQHJldHVybnMge1BsdXJhbFJ1bGVOYW1lIHwgdW5kZWZpbmVkfSBUaGUgbmFtZSBvZiB0aGUgcGx1cmFsaXNhdGlvbiBydWxlIHRvIHVzZSAoYSBrZXkgZm9yIG9uZVxyXG4gKiAgIG9mIHRoZSBmdW5jdGlvbnMgaW4gdGhpcy5wbHVyYWxSdWxlcylcclxuICovXHJcbkkxOG4ucHJvdG90eXBlLmdldFBsdXJhbFJ1bGVzRm9yTG9jYWxlID0gZnVuY3Rpb24gKCkge1xyXG4gIHZhciBsb2NhbGUgPSB0aGlzLmxvY2FsZTtcclxuICB2YXIgbG9jYWxlU2hvcnQgPSBsb2NhbGUuc3BsaXQoJy0nKVswXTtcclxuXHJcbiAgLy8gTG9vayB0aHJvdWdoIHRoZSBwbHVyYWwgcnVsZXMgbWFwIHRvIGZpbmQgd2hpY2ggYHBsdXJhbFJ1bGVgIGlzXHJcbiAgLy8gYXBwcm9wcmlhdGUgZm9yIG91ciBjdXJyZW50IGBsb2NhbGVgLlxyXG4gIGZvciAodmFyIHBsdXJhbFJ1bGUgaW4gSTE4bi5wbHVyYWxSdWxlc01hcCkge1xyXG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChJMThuLnBsdXJhbFJ1bGVzTWFwLCBwbHVyYWxSdWxlKSkge1xyXG4gICAgICB2YXIgbGFuZ3VhZ2VzID0gSTE4bi5wbHVyYWxSdWxlc01hcFtwbHVyYWxSdWxlXTtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsYW5ndWFnZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAobGFuZ3VhZ2VzW2ldID09PSBsb2NhbGUgfHwgbGFuZ3VhZ2VzW2ldID09PSBsb2NhbGVTaG9ydCkge1xyXG4gICAgICAgICAgcmV0dXJuIHBsdXJhbFJ1bGVcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogTWFwIG9mIHBsdXJhbCBydWxlcyB0byBsYW5ndWFnZXMgd2hlcmUgdGhvc2UgcnVsZXMgYXBwbHkuXHJcbiAqXHJcbiAqIE5vdGU6IFRoZXNlIGdyb3VwcyBhcmUgbmFtZWQgZm9yIHRoZSBtb3N0IGRvbWluYW50IG9yIHJlY29nbmlzYWJsZSBsYW5ndWFnZVxyXG4gKiB0aGF0IHVzZXMgZWFjaCBzeXN0ZW0uIFRoZSBncm91cGluZ3MgZG8gbm90IGltcGx5IHRoYXQgdGhlIGxhbmd1YWdlcyBhcmVcclxuICogcmVsYXRlZCB0byBvbmUgYW5vdGhlci4gTWFueSBsYW5ndWFnZXMgaGF2ZSBldm9sdmVkIHRoZSBzYW1lIHN5c3RlbXNcclxuICogaW5kZXBlbmRlbnRseSBvZiBvbmUgYW5vdGhlci5cclxuICpcclxuICogQ29kZSB0byBzdXBwb3J0IG1vcmUgbGFuZ3VhZ2VzIGNhbiBiZSBmb3VuZCBpbiB0aGUgaTE4biBzcGlrZTpcclxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9hbHBoYWdvdi9nb3Z1ay1mcm9udGVuZC9ibG9iL3NwaWtlLWkxOG4tc3VwcG9ydC9zcmMvZ292dWsvaTE4bi5tanN9XHJcbiAqXHJcbiAqIExhbmd1YWdlcyBjdXJyZW50bHkgc3VwcG9ydGVkOlxyXG4gKlxyXG4gKiBBcmFiaWM6IEFyYWJpYyAoYXIpXHJcbiAqIENoaW5lc2U6IEJ1cm1lc2UgKG15KSwgQ2hpbmVzZSAoemgpLCBJbmRvbmVzaWFuIChpZCksIEphcGFuZXNlIChqYSksXHJcbiAqICAgSmF2YW5lc2UgKGp2KSwgS29yZWFuIChrbyksIE1hbGF5IChtcyksIFRoYWkgKHRoKSwgVmlldG5hbWVzZSAodmkpXHJcbiAqIEZyZW5jaDogQXJtZW5pYW4gKGh5KSwgQmFuZ2xhIChibiksIEZyZW5jaCAoZnIpLCBHdWphcmF0aSAoZ3UpLCBIaW5kaSAoaGkpLFxyXG4gKiAgIFBlcnNpYW4gRmFyc2kgKGZhKSwgUHVuamFiaSAocGEpLCBadWx1ICh6dSlcclxuICogR2VybWFuOiBBZnJpa2FhbnMgKGFmKSwgQWxiYW5pYW4gKHNxKSwgQXplcmJhaWphbmkgKGF6KSwgQmFzcXVlIChldSksXHJcbiAqICAgQnVsZ2FyaWFuIChiZyksIENhdGFsYW4gKGNhKSwgRGFuaXNoIChkYSksIER1dGNoIChubCksIEVuZ2xpc2ggKGVuKSxcclxuICogICBFc3RvbmlhbiAoZXQpLCBGaW5uaXNoIChmaSksIEdlb3JnaWFuIChrYSksIEdlcm1hbiAoZGUpLCBHcmVlayAoZWwpLFxyXG4gKiAgIEh1bmdhcmlhbiAoaHUpLCBMdXhlbWJvdXJnaXNoIChsYiksIE5vcndlZ2lhbiAobm8pLCBTb21hbGkgKHNvKSxcclxuICogICBTd2FoaWxpIChzdyksIFN3ZWRpc2ggKHN2KSwgVGFtaWwgKHRhKSwgVGVsdWd1ICh0ZSksIFR1cmtpc2ggKHRyKSxcclxuICogICBVcmR1ICh1cilcclxuICogSXJpc2g6IElyaXNoIEdhZWxpYyAoZ2EpXHJcbiAqIFJ1c3NpYW46IFJ1c3NpYW4gKHJ1KSwgVWtyYWluaWFuICh1aylcclxuICogU2NvdHRpc2g6IFNjb3R0aXNoIEdhZWxpYyAoZ2QpXHJcbiAqIFNwYW5pc2g6IEV1cm9wZWFuIFBvcnR1Z3Vlc2UgKHB0LVBUKSwgSXRhbGlhbiAoaXQpLCBTcGFuaXNoIChlcylcclxuICogV2Vsc2g6IFdlbHNoIChjeSlcclxuICpcclxuICogQHR5cGUge09iamVjdDxQbHVyYWxSdWxlTmFtZSwgc3RyaW5nW10+fVxyXG4gKi9cclxuSTE4bi5wbHVyYWxSdWxlc01hcCA9IHtcclxuICBhcmFiaWM6IFsnYXInXSxcclxuICBjaGluZXNlOiBbJ215JywgJ3poJywgJ2lkJywgJ2phJywgJ2p2JywgJ2tvJywgJ21zJywgJ3RoJywgJ3ZpJ10sXHJcbiAgZnJlbmNoOiBbJ2h5JywgJ2JuJywgJ2ZyJywgJ2d1JywgJ2hpJywgJ2ZhJywgJ3BhJywgJ3p1J10sXHJcbiAgZ2VybWFuOiBbXHJcbiAgICAnYWYnLCAnc3EnLCAnYXonLCAnZXUnLCAnYmcnLCAnY2EnLCAnZGEnLCAnbmwnLCAnZW4nLCAnZXQnLCAnZmknLCAna2EnLFxyXG4gICAgJ2RlJywgJ2VsJywgJ2h1JywgJ2xiJywgJ25vJywgJ3NvJywgJ3N3JywgJ3N2JywgJ3RhJywgJ3RlJywgJ3RyJywgJ3VyJ1xyXG4gIF0sXHJcbiAgaXJpc2g6IFsnZ2EnXSxcclxuICBydXNzaWFuOiBbJ3J1JywgJ3VrJ10sXHJcbiAgc2NvdHRpc2g6IFsnZ2QnXSxcclxuICBzcGFuaXNoOiBbJ3B0LVBUJywgJ2l0JywgJ2VzJ10sXHJcbiAgd2Vsc2g6IFsnY3knXVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIERpZmZlcmVudCBwbHVyYWxpc2F0aW9uIHJ1bGUgc2V0c1xyXG4gKlxyXG4gKiBSZXR1cm5zIHRoZSBhcHByb3ByaWF0ZSBzdWZmaXggZm9yIHRoZSBwbHVyYWwgZm9ybSBhc3NvY2lhdGVkIHdpdGggYG5gLlxyXG4gKiBQb3NzaWJsZSBzdWZmaXhlczogJ3plcm8nLCAnb25lJywgJ3R3bycsICdmZXcnLCAnbWFueScsICdvdGhlcicgKHRoZSBhY3R1YWxcclxuICogbWVhbmluZyBvZiBlYWNoIGRpZmZlcnMgcGVyIGxvY2FsZSkuICdvdGhlcicgc2hvdWxkIGFsd2F5cyBleGlzdCwgZXZlbiBpblxyXG4gKiBsYW5ndWFnZXMgd2l0aG91dCBwbHVyYWxzLCBzdWNoIGFzIENoaW5lc2UuXHJcbiAqIHtAbGluayBodHRwczovL2NsZHIudW5pY29kZS5vcmcvaW5kZXgvY2xkci1zcGVjL3BsdXJhbC1ydWxlc31cclxuICpcclxuICogVGhlIGNvdW50IG11c3QgYmUgYSBwb3NpdGl2ZSBpbnRlZ2VyLiBOZWdhdGl2ZSBudW1iZXJzIGFuZCBkZWNpbWFscyBhcmVuJ3QgYWNjb3VudGVkIGZvclxyXG4gKlxyXG4gKiBAdHlwZSB7T2JqZWN0PHN0cmluZywgZnVuY3Rpb24obnVtYmVyKTogUGx1cmFsUnVsZT59XHJcbiAqL1xyXG5JMThuLnBsdXJhbFJ1bGVzID0ge1xyXG4gIGFyYWJpYzogZnVuY3Rpb24gKG4pIHtcclxuICAgIGlmIChuID09PSAwKSB7IHJldHVybiAnemVybycgfVxyXG4gICAgaWYgKG4gPT09IDEpIHsgcmV0dXJuICdvbmUnIH1cclxuICAgIGlmIChuID09PSAyKSB7IHJldHVybiAndHdvJyB9XHJcbiAgICBpZiAobiAlIDEwMCA+PSAzICYmIG4gJSAxMDAgPD0gMTApIHsgcmV0dXJuICdmZXcnIH1cclxuICAgIGlmIChuICUgMTAwID49IDExICYmIG4gJSAxMDAgPD0gOTkpIHsgcmV0dXJuICdtYW55JyB9XHJcbiAgICByZXR1cm4gJ290aGVyJ1xyXG4gIH0sXHJcbiAgY2hpbmVzZTogZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuICdvdGhlcidcclxuICB9LFxyXG4gIGZyZW5jaDogZnVuY3Rpb24gKG4pIHtcclxuICAgIHJldHVybiBuID09PSAwIHx8IG4gPT09IDEgPyAnb25lJyA6ICdvdGhlcidcclxuICB9LFxyXG4gIGdlcm1hbjogZnVuY3Rpb24gKG4pIHtcclxuICAgIHJldHVybiBuID09PSAxID8gJ29uZScgOiAnb3RoZXInXHJcbiAgfSxcclxuICBpcmlzaDogZnVuY3Rpb24gKG4pIHtcclxuICAgIGlmIChuID09PSAxKSB7IHJldHVybiAnb25lJyB9XHJcbiAgICBpZiAobiA9PT0gMikgeyByZXR1cm4gJ3R3bycgfVxyXG4gICAgaWYgKG4gPj0gMyAmJiBuIDw9IDYpIHsgcmV0dXJuICdmZXcnIH1cclxuICAgIGlmIChuID49IDcgJiYgbiA8PSAxMCkgeyByZXR1cm4gJ21hbnknIH1cclxuICAgIHJldHVybiAnb3RoZXInXHJcbiAgfSxcclxuICBydXNzaWFuOiBmdW5jdGlvbiAobikge1xyXG4gICAgdmFyIGxhc3RUd28gPSBuICUgMTAwO1xyXG4gICAgdmFyIGxhc3QgPSBsYXN0VHdvICUgMTA7XHJcbiAgICBpZiAobGFzdCA9PT0gMSAmJiBsYXN0VHdvICE9PSAxMSkgeyByZXR1cm4gJ29uZScgfVxyXG4gICAgaWYgKGxhc3QgPj0gMiAmJiBsYXN0IDw9IDQgJiYgIShsYXN0VHdvID49IDEyICYmIGxhc3RUd28gPD0gMTQpKSB7IHJldHVybiAnZmV3JyB9XHJcbiAgICBpZiAobGFzdCA9PT0gMCB8fCAobGFzdCA+PSA1ICYmIGxhc3QgPD0gOSkgfHwgKGxhc3RUd28gPj0gMTEgJiYgbGFzdFR3byA8PSAxNCkpIHsgcmV0dXJuICdtYW55JyB9XHJcbiAgICAvLyBOb3RlOiBUaGUgJ290aGVyJyBzdWZmaXggaXMgb25seSB1c2VkIGJ5IGRlY2ltYWwgbnVtYmVycyBpbiBSdXNzaWFuLlxyXG4gICAgLy8gV2UgZG9uJ3QgYW50aWNpcGF0ZSBpdCBiZWluZyB1c2VkLCBidXQgaXQncyBoZXJlIGZvciBjb25zaXN0ZW5jeS5cclxuICAgIHJldHVybiAnb3RoZXInXHJcbiAgfSxcclxuICBzY290dGlzaDogZnVuY3Rpb24gKG4pIHtcclxuICAgIGlmIChuID09PSAxIHx8IG4gPT09IDExKSB7IHJldHVybiAnb25lJyB9XHJcbiAgICBpZiAobiA9PT0gMiB8fCBuID09PSAxMikgeyByZXR1cm4gJ3R3bycgfVxyXG4gICAgaWYgKChuID49IDMgJiYgbiA8PSAxMCkgfHwgKG4gPj0gMTMgJiYgbiA8PSAxOSkpIHsgcmV0dXJuICdmZXcnIH1cclxuICAgIHJldHVybiAnb3RoZXInXHJcbiAgfSxcclxuICBzcGFuaXNoOiBmdW5jdGlvbiAobikge1xyXG4gICAgaWYgKG4gPT09IDEpIHsgcmV0dXJuICdvbmUnIH1cclxuICAgIGlmIChuICUgMTAwMDAwMCA9PT0gMCAmJiBuICE9PSAwKSB7IHJldHVybiAnbWFueScgfVxyXG4gICAgcmV0dXJuICdvdGhlcidcclxuICB9LFxyXG4gIHdlbHNoOiBmdW5jdGlvbiAobikge1xyXG4gICAgaWYgKG4gPT09IDApIHsgcmV0dXJuICd6ZXJvJyB9XHJcbiAgICBpZiAobiA9PT0gMSkgeyByZXR1cm4gJ29uZScgfVxyXG4gICAgaWYgKG4gPT09IDIpIHsgcmV0dXJuICd0d28nIH1cclxuICAgIGlmIChuID09PSAzKSB7IHJldHVybiAnZmV3JyB9XHJcbiAgICBpZiAobiA9PT0gNikgeyByZXR1cm4gJ21hbnknIH1cclxuICAgIHJldHVybiAnb3RoZXInXHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFN1cHBvcnRlZCBsYW5ndWFnZXMgZm9yIHBsdXJhbCBydWxlc1xyXG4gKlxyXG4gKiBAdHlwZWRlZiB7J2FyYWJpYycgfCAnY2hpbmVzZScgfCAnZnJlbmNoJyB8ICdnZXJtYW4nIHwgJ2lyaXNoJyB8ICdydXNzaWFuJyB8ICdzY290dGlzaCcgfCAnc3BhbmlzaCcgfCAnd2Vsc2gnfSBQbHVyYWxSdWxlTmFtZVxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBQbHVyYWwgcnVsZSBjYXRlZ29yeSBtbmVtb25pYyB0YWdzXHJcbiAqXHJcbiAqIEB0eXBlZGVmIHsnemVybycgfCAnb25lJyB8ICd0d28nIHwgJ2ZldycgfCAnbWFueScgfCAnb3RoZXInfSBQbHVyYWxSdWxlXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIFRyYW5zbGF0ZWQgbWVzc2FnZSBieSBwbHVyYWwgcnVsZSB0aGV5IGNvcnJlc3BvbmQgdG8uXHJcbiAqXHJcbiAqIEFsbG93cyB0byBncm91cCBwbHVyYWxpc2VkIG1lc3NhZ2VzIHVuZGVyIGEgc2luZ2xlIGtleSB3aGVuIHBhc3NpbmdcclxuICogdHJhbnNsYXRpb25zIHRvIGEgY29tcG9uZW50J3MgY29uc3RydWN0b3JcclxuICpcclxuICogQHR5cGVkZWYge29iamVjdH0gVHJhbnNsYXRpb25QbHVyYWxGb3Jtc1xyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW290aGVyXSAtIEdlbmVyYWwgcGx1cmFsIGZvcm1cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IFt6ZXJvXSAtIFBsdXJhbCBmb3JtIHVzZWQgd2l0aCAwXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbb25lXSAtIFBsdXJhbCBmb3JtIHVzZWQgd2l0aCAxXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbdHdvXSAtIFBsdXJhbCBmb3JtIHVzZWQgd2l0aCAyXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbZmV3XSAtIFBsdXJhbCBmb3JtIHVzZWQgZm9yIGEgZmV3XHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbbWFueV0gLSBQbHVyYWwgZm9ybSB1c2VkIGZvciBtYW55XHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIFRyYW5zbGF0ZWQgbWVzc2FnZXMgKGZsYXR0ZW5lZClcclxuICpcclxuICogQHByaXZhdGVcclxuICogQHR5cGVkZWYge09iamVjdDxzdHJpbmcsIHN0cmluZz4gfCB7fX0gVHJhbnNsYXRpb25zRmxhdHRlbmVkXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG5cclxuLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlL2Jsb2IvbWFzdGVyL3BhY2thZ2VzL3BvbHlmaWxsLWxpYnJhcnkvcG9seWZpbGxzL09iamVjdC9kZWZpbmVQcm9wZXJ0eS9kZXRlY3QuanNcclxudmFyIGRldGVjdCA9IChcclxuICAvLyBJbiBJRTgsIGRlZmluZVByb3BlcnR5IGNvdWxkIG9ubHkgYWN0IG9uIERPTSBlbGVtZW50cywgc28gZnVsbCBzdXBwb3J0XHJcbiAgLy8gZm9yIHRoZSBmZWF0dXJlIHJlcXVpcmVzIHRoZSBhYmlsaXR5IHRvIHNldCBhIHByb3BlcnR5IG9uIGFuIGFyYml0cmFyeSBvYmplY3RcclxuICAnZGVmaW5lUHJvcGVydHknIGluIE9iamVjdCAmJiAoZnVuY3Rpb24oKSB7XHJcbiAgXHR0cnkge1xyXG4gIFx0XHR2YXIgYSA9IHt9O1xyXG4gIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoYSwgJ3Rlc3QnLCB7dmFsdWU6NDJ9KTtcclxuICBcdFx0cmV0dXJuIHRydWU7XHJcbiAgXHR9IGNhdGNoKGUpIHtcclxuICBcdFx0cmV0dXJuIGZhbHNlXHJcbiAgXHR9XHJcbiAgfSgpKVxyXG4pO1xyXG5cclxuaWYgKGRldGVjdCkgcmV0dXJuXHJcblxyXG4vLyBQb2x5ZmlsbCBmcm9tIGh0dHBzOi8vY2RuLnBvbHlmaWxsLmlvL3YyL3BvbHlmaWxsLmpzP2ZlYXR1cmVzPU9iamVjdC5kZWZpbmVQcm9wZXJ0eSZmbGFncz1hbHdheXNcclxuKGZ1bmN0aW9uIChuYXRpdmVEZWZpbmVQcm9wZXJ0eSkge1xyXG5cclxuXHR2YXIgc3VwcG9ydHNBY2Nlc3NvcnMgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5KCdfX2RlZmluZUdldHRlcl9fJyk7XHJcblx0dmFyIEVSUl9BQ0NFU1NPUlNfTk9UX1NVUFBPUlRFRCA9ICdHZXR0ZXJzICYgc2V0dGVycyBjYW5ub3QgYmUgZGVmaW5lZCBvbiB0aGlzIGphdmFzY3JpcHQgZW5naW5lJztcclxuXHR2YXIgRVJSX1ZBTFVFX0FDQ0VTU09SUyA9ICdBIHByb3BlcnR5IGNhbm5vdCBib3RoIGhhdmUgYWNjZXNzb3JzIGFuZCBiZSB3cml0YWJsZSBvciBoYXZlIGEgdmFsdWUnO1xyXG5cclxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShvYmplY3QsIHByb3BlcnR5LCBkZXNjcmlwdG9yKSB7XHJcblxyXG5cdFx0Ly8gV2hlcmUgbmF0aXZlIHN1cHBvcnQgZXhpc3RzLCBhc3N1bWUgaXRcclxuXHRcdGlmIChuYXRpdmVEZWZpbmVQcm9wZXJ0eSAmJiAob2JqZWN0ID09PSB3aW5kb3cgfHwgb2JqZWN0ID09PSBkb2N1bWVudCB8fCBvYmplY3QgPT09IEVsZW1lbnQucHJvdG90eXBlIHx8IG9iamVjdCBpbnN0YW5jZW9mIEVsZW1lbnQpKSB7XHJcblx0XHRcdHJldHVybiBuYXRpdmVEZWZpbmVQcm9wZXJ0eShvYmplY3QsIHByb3BlcnR5LCBkZXNjcmlwdG9yKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAob2JqZWN0ID09PSBudWxsIHx8ICEob2JqZWN0IGluc3RhbmNlb2YgT2JqZWN0IHx8IHR5cGVvZiBvYmplY3QgPT09ICdvYmplY3QnKSkge1xyXG5cdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKCdPYmplY3QuZGVmaW5lUHJvcGVydHkgY2FsbGVkIG9uIG5vbi1vYmplY3QnKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIShkZXNjcmlwdG9yIGluc3RhbmNlb2YgT2JqZWN0KSkge1xyXG5cdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKCdQcm9wZXJ0eSBkZXNjcmlwdGlvbiBtdXN0IGJlIGFuIG9iamVjdCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBwcm9wZXJ0eVN0cmluZyA9IFN0cmluZyhwcm9wZXJ0eSk7XHJcblx0XHR2YXIgaGFzVmFsdWVPcldyaXRhYmxlID0gJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yIHx8ICd3cml0YWJsZScgaW4gZGVzY3JpcHRvcjtcclxuXHRcdHZhciBnZXR0ZXJUeXBlID0gJ2dldCcgaW4gZGVzY3JpcHRvciAmJiB0eXBlb2YgZGVzY3JpcHRvci5nZXQ7XHJcblx0XHR2YXIgc2V0dGVyVHlwZSA9ICdzZXQnIGluIGRlc2NyaXB0b3IgJiYgdHlwZW9mIGRlc2NyaXB0b3Iuc2V0O1xyXG5cclxuXHRcdC8vIGhhbmRsZSBkZXNjcmlwdG9yLmdldFxyXG5cdFx0aWYgKGdldHRlclR5cGUpIHtcclxuXHRcdFx0aWYgKGdldHRlclR5cGUgIT09ICdmdW5jdGlvbicpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKCdHZXR0ZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKCFzdXBwb3J0c0FjY2Vzc29ycykge1xyXG5cdFx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoRVJSX0FDQ0VTU09SU19OT1RfU1VQUE9SVEVEKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoaGFzVmFsdWVPcldyaXRhYmxlKSB7XHJcblx0XHRcdFx0dGhyb3cgbmV3IFR5cGVFcnJvcihFUlJfVkFMVUVfQUNDRVNTT1JTKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRPYmplY3QuX19kZWZpbmVHZXR0ZXJfXy5jYWxsKG9iamVjdCwgcHJvcGVydHlTdHJpbmcsIGRlc2NyaXB0b3IuZ2V0KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdG9iamVjdFtwcm9wZXJ0eVN0cmluZ10gPSBkZXNjcmlwdG9yLnZhbHVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGhhbmRsZSBkZXNjcmlwdG9yLnNldFxyXG5cdFx0aWYgKHNldHRlclR5cGUpIHtcclxuXHRcdFx0aWYgKHNldHRlclR5cGUgIT09ICdmdW5jdGlvbicpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKCdTZXR0ZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKCFzdXBwb3J0c0FjY2Vzc29ycykge1xyXG5cdFx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoRVJSX0FDQ0VTU09SU19OT1RfU1VQUE9SVEVEKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoaGFzVmFsdWVPcldyaXRhYmxlKSB7XHJcblx0XHRcdFx0dGhyb3cgbmV3IFR5cGVFcnJvcihFUlJfVkFMVUVfQUNDRVNTT1JTKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRPYmplY3QuX19kZWZpbmVTZXR0ZXJfXy5jYWxsKG9iamVjdCwgcHJvcGVydHlTdHJpbmcsIGRlc2NyaXB0b3Iuc2V0KTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBPSyB0byBkZWZpbmUgdmFsdWUgdW5jb25kaXRpb25hbGx5IC0gaWYgYSBnZXR0ZXIgaGFzIGJlZW4gc3BlY2lmaWVkIGFzIHdlbGwsIGFuIGVycm9yIHdvdWxkIGJlIHRocm93biBhYm92ZVxyXG5cdFx0aWYgKCd2YWx1ZScgaW4gZGVzY3JpcHRvcikge1xyXG5cdFx0XHRvYmplY3RbcHJvcGVydHlTdHJpbmddID0gZGVzY3JpcHRvci52YWx1ZTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gb2JqZWN0O1xyXG5cdH07XHJcbn0oT2JqZWN0LmRlZmluZVByb3BlcnR5KSk7XHJcbn0pXHJcbi5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG4gIC8vIERldGVjdGlvbiBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtc2VydmljZS9ibG9iL21hc3Rlci9wYWNrYWdlcy9wb2x5ZmlsbC1saWJyYXJ5L3BvbHlmaWxscy9GdW5jdGlvbi9wcm90b3R5cGUvYmluZC9kZXRlY3QuanNcclxuICB2YXIgZGV0ZWN0ID0gJ2JpbmQnIGluIEZ1bmN0aW9uLnByb3RvdHlwZTtcclxuXHJcbiAgaWYgKGRldGVjdCkgcmV0dXJuXHJcblxyXG4gIC8vIFBvbHlmaWxsIGZyb20gaHR0cHM6Ly9jZG4ucG9seWZpbGwuaW8vdjIvcG9seWZpbGwuanM/ZmVhdHVyZXM9RnVuY3Rpb24ucHJvdG90eXBlLmJpbmQmZmxhZ3M9YWx3YXlzXHJcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZ1bmN0aW9uLnByb3RvdHlwZSwgJ2JpbmQnLCB7XHJcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBiaW5kKHRoYXQpIHsgLy8gLmxlbmd0aCBpcyAxXHJcbiAgICAgICAgICAvLyBhZGQgbmVjZXNzYXJ5IGVzNS1zaGltIHV0aWxpdGllc1xyXG4gICAgICAgICAgdmFyICRBcnJheSA9IEFycmF5O1xyXG4gICAgICAgICAgdmFyICRPYmplY3QgPSBPYmplY3Q7XHJcbiAgICAgICAgICB2YXIgT2JqZWN0UHJvdG90eXBlID0gJE9iamVjdC5wcm90b3R5cGU7XHJcbiAgICAgICAgICB2YXIgQXJyYXlQcm90b3R5cGUgPSAkQXJyYXkucHJvdG90eXBlO1xyXG4gICAgICAgICAgdmFyIEVtcHR5ID0gZnVuY3Rpb24gRW1wdHkoKSB7fTtcclxuICAgICAgICAgIHZhciB0b19zdHJpbmcgPSBPYmplY3RQcm90b3R5cGUudG9TdHJpbmc7XHJcbiAgICAgICAgICB2YXIgaGFzVG9TdHJpbmdUYWcgPSB0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBTeW1ib2wudG9TdHJpbmdUYWcgPT09ICdzeW1ib2wnO1xyXG4gICAgICAgICAgdmFyIGlzQ2FsbGFibGU7IC8qIGlubGluZWQgZnJvbSBodHRwczovL25wbWpzLmNvbS9pcy1jYWxsYWJsZSAqLyB2YXIgZm5Ub1N0ciA9IEZ1bmN0aW9uLnByb3RvdHlwZS50b1N0cmluZywgdHJ5RnVuY3Rpb25PYmplY3QgPSBmdW5jdGlvbiB0cnlGdW5jdGlvbk9iamVjdCh2YWx1ZSkgeyB0cnkgeyBmblRvU3RyLmNhbGwodmFsdWUpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfSwgZm5DbGFzcyA9ICdbb2JqZWN0IEZ1bmN0aW9uXScsIGdlbkNsYXNzID0gJ1tvYmplY3QgR2VuZXJhdG9yRnVuY3Rpb25dJzsgaXNDYWxsYWJsZSA9IGZ1bmN0aW9uIGlzQ2FsbGFibGUodmFsdWUpIHsgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ2Z1bmN0aW9uJykgeyByZXR1cm4gZmFsc2U7IH0gaWYgKGhhc1RvU3RyaW5nVGFnKSB7IHJldHVybiB0cnlGdW5jdGlvbk9iamVjdCh2YWx1ZSk7IH0gdmFyIHN0ckNsYXNzID0gdG9fc3RyaW5nLmNhbGwodmFsdWUpOyByZXR1cm4gc3RyQ2xhc3MgPT09IGZuQ2xhc3MgfHwgc3RyQ2xhc3MgPT09IGdlbkNsYXNzOyB9O1xyXG4gICAgICAgICAgdmFyIGFycmF5X3NsaWNlID0gQXJyYXlQcm90b3R5cGUuc2xpY2U7XHJcbiAgICAgICAgICB2YXIgYXJyYXlfY29uY2F0ID0gQXJyYXlQcm90b3R5cGUuY29uY2F0O1xyXG4gICAgICAgICAgdmFyIGFycmF5X3B1c2ggPSBBcnJheVByb3RvdHlwZS5wdXNoO1xyXG4gICAgICAgICAgdmFyIG1heCA9IE1hdGgubWF4O1xyXG4gICAgICAgICAgLy8gL2FkZCBuZWNlc3NhcnkgZXM1LXNoaW0gdXRpbGl0aWVzXHJcblxyXG4gICAgICAgICAgLy8gMS4gTGV0IFRhcmdldCBiZSB0aGUgdGhpcyB2YWx1ZS5cclxuICAgICAgICAgIHZhciB0YXJnZXQgPSB0aGlzO1xyXG4gICAgICAgICAgLy8gMi4gSWYgSXNDYWxsYWJsZShUYXJnZXQpIGlzIGZhbHNlLCB0aHJvdyBhIFR5cGVFcnJvciBleGNlcHRpb24uXHJcbiAgICAgICAgICBpZiAoIWlzQ2FsbGFibGUodGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Z1bmN0aW9uLnByb3RvdHlwZS5iaW5kIGNhbGxlZCBvbiBpbmNvbXBhdGlibGUgJyArIHRhcmdldCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAvLyAzLiBMZXQgQSBiZSBhIG5ldyAocG9zc2libHkgZW1wdHkpIGludGVybmFsIGxpc3Qgb2YgYWxsIG9mIHRoZVxyXG4gICAgICAgICAgLy8gICBhcmd1bWVudCB2YWx1ZXMgcHJvdmlkZWQgYWZ0ZXIgdGhpc0FyZyAoYXJnMSwgYXJnMiBldGMpLCBpbiBvcmRlci5cclxuICAgICAgICAgIC8vIFhYWCBzbGljZWRBcmdzIHdpbGwgc3RhbmQgaW4gZm9yIFwiQVwiIGlmIHVzZWRcclxuICAgICAgICAgIHZhciBhcmdzID0gYXJyYXlfc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOyAvLyBmb3Igbm9ybWFsIGNhbGxcclxuICAgICAgICAgIC8vIDQuIExldCBGIGJlIGEgbmV3IG5hdGl2ZSBFQ01BU2NyaXB0IG9iamVjdC5cclxuICAgICAgICAgIC8vIDExLiBTZXQgdGhlIFtbUHJvdG90eXBlXV0gaW50ZXJuYWwgcHJvcGVydHkgb2YgRiB0byB0aGUgc3RhbmRhcmRcclxuICAgICAgICAgIC8vICAgYnVpbHQtaW4gRnVuY3Rpb24gcHJvdG90eXBlIG9iamVjdCBhcyBzcGVjaWZpZWQgaW4gMTUuMy4zLjEuXHJcbiAgICAgICAgICAvLyAxMi4gU2V0IHRoZSBbW0NhbGxdXSBpbnRlcm5hbCBwcm9wZXJ0eSBvZiBGIGFzIGRlc2NyaWJlZCBpblxyXG4gICAgICAgICAgLy8gICAxNS4zLjQuNS4xLlxyXG4gICAgICAgICAgLy8gMTMuIFNldCB0aGUgW1tDb25zdHJ1Y3RdXSBpbnRlcm5hbCBwcm9wZXJ0eSBvZiBGIGFzIGRlc2NyaWJlZCBpblxyXG4gICAgICAgICAgLy8gICAxNS4zLjQuNS4yLlxyXG4gICAgICAgICAgLy8gMTQuIFNldCB0aGUgW1tIYXNJbnN0YW5jZV1dIGludGVybmFsIHByb3BlcnR5IG9mIEYgYXMgZGVzY3JpYmVkIGluXHJcbiAgICAgICAgICAvLyAgIDE1LjMuNC41LjMuXHJcbiAgICAgICAgICB2YXIgYm91bmQ7XHJcbiAgICAgICAgICB2YXIgYmluZGVyID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIGJvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgIC8vIDE1LjMuNC41LjIgW1tDb25zdHJ1Y3RdXVxyXG4gICAgICAgICAgICAgICAgICAvLyBXaGVuIHRoZSBbW0NvbnN0cnVjdF1dIGludGVybmFsIG1ldGhvZCBvZiBhIGZ1bmN0aW9uIG9iamVjdCxcclxuICAgICAgICAgICAgICAgICAgLy8gRiB0aGF0IHdhcyBjcmVhdGVkIHVzaW5nIHRoZSBiaW5kIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aXRoIGFcclxuICAgICAgICAgICAgICAgICAgLy8gbGlzdCBvZiBhcmd1bWVudHMgRXh0cmFBcmdzLCB0aGUgZm9sbG93aW5nIHN0ZXBzIGFyZSB0YWtlbjpcclxuICAgICAgICAgICAgICAgICAgLy8gMS4gTGV0IHRhcmdldCBiZSB0aGUgdmFsdWUgb2YgRidzIFtbVGFyZ2V0RnVuY3Rpb25dXVxyXG4gICAgICAgICAgICAgICAgICAvLyAgIGludGVybmFsIHByb3BlcnR5LlxyXG4gICAgICAgICAgICAgICAgICAvLyAyLiBJZiB0YXJnZXQgaGFzIG5vIFtbQ29uc3RydWN0XV0gaW50ZXJuYWwgbWV0aG9kLCBhXHJcbiAgICAgICAgICAgICAgICAgIC8vICAgVHlwZUVycm9yIGV4Y2VwdGlvbiBpcyB0aHJvd24uXHJcbiAgICAgICAgICAgICAgICAgIC8vIDMuIExldCBib3VuZEFyZ3MgYmUgdGhlIHZhbHVlIG9mIEYncyBbW0JvdW5kQXJnc11dIGludGVybmFsXHJcbiAgICAgICAgICAgICAgICAgIC8vICAgcHJvcGVydHkuXHJcbiAgICAgICAgICAgICAgICAgIC8vIDQuIExldCBhcmdzIGJlIGEgbmV3IGxpc3QgY29udGFpbmluZyB0aGUgc2FtZSB2YWx1ZXMgYXMgdGhlXHJcbiAgICAgICAgICAgICAgICAgIC8vICAgbGlzdCBib3VuZEFyZ3MgaW4gdGhlIHNhbWUgb3JkZXIgZm9sbG93ZWQgYnkgdGhlIHNhbWVcclxuICAgICAgICAgICAgICAgICAgLy8gICB2YWx1ZXMgYXMgdGhlIGxpc3QgRXh0cmFBcmdzIGluIHRoZSBzYW1lIG9yZGVyLlxyXG4gICAgICAgICAgICAgICAgICAvLyA1LiBSZXR1cm4gdGhlIHJlc3VsdCBvZiBjYWxsaW5nIHRoZSBbW0NvbnN0cnVjdF1dIGludGVybmFsXHJcbiAgICAgICAgICAgICAgICAgIC8vICAgbWV0aG9kIG9mIHRhcmdldCBwcm92aWRpbmcgYXJncyBhcyB0aGUgYXJndW1lbnRzLlxyXG5cclxuICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRhcmdldC5hcHBseShcclxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICBhcnJheV9jb25jYXQuY2FsbChhcmdzLCBhcnJheV9zbGljZS5jYWxsKGFyZ3VtZW50cykpXHJcbiAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgIGlmICgkT2JqZWN0KHJlc3VsdCkgPT09IHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgLy8gMTUuMy40LjUuMSBbW0NhbGxdXVxyXG4gICAgICAgICAgICAgICAgICAvLyBXaGVuIHRoZSBbW0NhbGxdXSBpbnRlcm5hbCBtZXRob2Qgb2YgYSBmdW5jdGlvbiBvYmplY3QsIEYsXHJcbiAgICAgICAgICAgICAgICAgIC8vIHdoaWNoIHdhcyBjcmVhdGVkIHVzaW5nIHRoZSBiaW5kIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aXRoIGFcclxuICAgICAgICAgICAgICAgICAgLy8gdGhpcyB2YWx1ZSBhbmQgYSBsaXN0IG9mIGFyZ3VtZW50cyBFeHRyYUFyZ3MsIHRoZSBmb2xsb3dpbmdcclxuICAgICAgICAgICAgICAgICAgLy8gc3RlcHMgYXJlIHRha2VuOlxyXG4gICAgICAgICAgICAgICAgICAvLyAxLiBMZXQgYm91bmRBcmdzIGJlIHRoZSB2YWx1ZSBvZiBGJ3MgW1tCb3VuZEFyZ3NdXSBpbnRlcm5hbFxyXG4gICAgICAgICAgICAgICAgICAvLyAgIHByb3BlcnR5LlxyXG4gICAgICAgICAgICAgICAgICAvLyAyLiBMZXQgYm91bmRUaGlzIGJlIHRoZSB2YWx1ZSBvZiBGJ3MgW1tCb3VuZFRoaXNdXSBpbnRlcm5hbFxyXG4gICAgICAgICAgICAgICAgICAvLyAgIHByb3BlcnR5LlxyXG4gICAgICAgICAgICAgICAgICAvLyAzLiBMZXQgdGFyZ2V0IGJlIHRoZSB2YWx1ZSBvZiBGJ3MgW1tUYXJnZXRGdW5jdGlvbl1dIGludGVybmFsXHJcbiAgICAgICAgICAgICAgICAgIC8vICAgcHJvcGVydHkuXHJcbiAgICAgICAgICAgICAgICAgIC8vIDQuIExldCBhcmdzIGJlIGEgbmV3IGxpc3QgY29udGFpbmluZyB0aGUgc2FtZSB2YWx1ZXMgYXMgdGhlXHJcbiAgICAgICAgICAgICAgICAgIC8vICAgbGlzdCBib3VuZEFyZ3MgaW4gdGhlIHNhbWUgb3JkZXIgZm9sbG93ZWQgYnkgdGhlIHNhbWVcclxuICAgICAgICAgICAgICAgICAgLy8gICB2YWx1ZXMgYXMgdGhlIGxpc3QgRXh0cmFBcmdzIGluIHRoZSBzYW1lIG9yZGVyLlxyXG4gICAgICAgICAgICAgICAgICAvLyA1LiBSZXR1cm4gdGhlIHJlc3VsdCBvZiBjYWxsaW5nIHRoZSBbW0NhbGxdXSBpbnRlcm5hbCBtZXRob2RcclxuICAgICAgICAgICAgICAgICAgLy8gICBvZiB0YXJnZXQgcHJvdmlkaW5nIGJvdW5kVGhpcyBhcyB0aGUgdGhpcyB2YWx1ZSBhbmRcclxuICAgICAgICAgICAgICAgICAgLy8gICBwcm92aWRpbmcgYXJncyBhcyB0aGUgYXJndW1lbnRzLlxyXG5cclxuICAgICAgICAgICAgICAgICAgLy8gZXF1aXY6IHRhcmdldC5jYWxsKHRoaXMsIC4uLmJvdW5kQXJncywgLi4uYXJncylcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5hcHBseShcclxuICAgICAgICAgICAgICAgICAgICAgIHRoYXQsXHJcbiAgICAgICAgICAgICAgICAgICAgICBhcnJheV9jb25jYXQuY2FsbChhcmdzLCBhcnJheV9zbGljZS5jYWxsKGFyZ3VtZW50cykpXHJcbiAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIC8vIDE1LiBJZiB0aGUgW1tDbGFzc11dIGludGVybmFsIHByb3BlcnR5IG9mIFRhcmdldCBpcyBcIkZ1bmN0aW9uXCIsIHRoZW5cclxuICAgICAgICAgIC8vICAgICBhLiBMZXQgTCBiZSB0aGUgbGVuZ3RoIHByb3BlcnR5IG9mIFRhcmdldCBtaW51cyB0aGUgbGVuZ3RoIG9mIEEuXHJcbiAgICAgICAgICAvLyAgICAgYi4gU2V0IHRoZSBsZW5ndGggb3duIHByb3BlcnR5IG9mIEYgdG8gZWl0aGVyIDAgb3IgTCwgd2hpY2hldmVyIGlzXHJcbiAgICAgICAgICAvLyAgICAgICBsYXJnZXIuXHJcbiAgICAgICAgICAvLyAxNi4gRWxzZSBzZXQgdGhlIGxlbmd0aCBvd24gcHJvcGVydHkgb2YgRiB0byAwLlxyXG5cclxuICAgICAgICAgIHZhciBib3VuZExlbmd0aCA9IG1heCgwLCB0YXJnZXQubGVuZ3RoIC0gYXJncy5sZW5ndGgpO1xyXG5cclxuICAgICAgICAgIC8vIDE3LiBTZXQgdGhlIGF0dHJpYnV0ZXMgb2YgdGhlIGxlbmd0aCBvd24gcHJvcGVydHkgb2YgRiB0byB0aGUgdmFsdWVzXHJcbiAgICAgICAgICAvLyAgIHNwZWNpZmllZCBpbiAxNS4zLjUuMS5cclxuICAgICAgICAgIHZhciBib3VuZEFyZ3MgPSBbXTtcclxuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYm91bmRMZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgIGFycmF5X3B1c2guY2FsbChib3VuZEFyZ3MsICckJyArIGkpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIFhYWCBCdWlsZCBhIGR5bmFtaWMgZnVuY3Rpb24gd2l0aCBkZXNpcmVkIGFtb3VudCBvZiBhcmd1bWVudHMgaXMgdGhlIG9ubHlcclxuICAgICAgICAgIC8vIHdheSB0byBzZXQgdGhlIGxlbmd0aCBwcm9wZXJ0eSBvZiBhIGZ1bmN0aW9uLlxyXG4gICAgICAgICAgLy8gSW4gZW52aXJvbm1lbnRzIHdoZXJlIENvbnRlbnQgU2VjdXJpdHkgUG9saWNpZXMgZW5hYmxlZCAoQ2hyb21lIGV4dGVuc2lvbnMsXHJcbiAgICAgICAgICAvLyBmb3IgZXguKSBhbGwgdXNlIG9mIGV2YWwgb3IgRnVuY3Rpb24gY29zdHJ1Y3RvciB0aHJvd3MgYW4gZXhjZXB0aW9uLlxyXG4gICAgICAgICAgLy8gSG93ZXZlciBpbiBhbGwgb2YgdGhlc2UgZW52aXJvbm1lbnRzIEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kIGV4aXN0c1xyXG4gICAgICAgICAgLy8gYW5kIHNvIHRoaXMgY29kZSB3aWxsIG5ldmVyIGJlIGV4ZWN1dGVkLlxyXG4gICAgICAgICAgYm91bmQgPSBGdW5jdGlvbignYmluZGVyJywgJ3JldHVybiBmdW5jdGlvbiAoJyArIGJvdW5kQXJncy5qb2luKCcsJykgKyAnKXsgcmV0dXJuIGJpbmRlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9JykoYmluZGVyKTtcclxuXHJcbiAgICAgICAgICBpZiAodGFyZ2V0LnByb3RvdHlwZSkge1xyXG4gICAgICAgICAgICAgIEVtcHR5LnByb3RvdHlwZSA9IHRhcmdldC5wcm90b3R5cGU7XHJcbiAgICAgICAgICAgICAgYm91bmQucHJvdG90eXBlID0gbmV3IEVtcHR5KCk7XHJcbiAgICAgICAgICAgICAgLy8gQ2xlYW4gdXAgZGFuZ2xpbmcgcmVmZXJlbmNlcy5cclxuICAgICAgICAgICAgICBFbXB0eS5wcm90b3R5cGUgPSBudWxsO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIFRPRE9cclxuICAgICAgICAgIC8vIDE4LiBTZXQgdGhlIFtbRXh0ZW5zaWJsZV1dIGludGVybmFsIHByb3BlcnR5IG9mIEYgdG8gdHJ1ZS5cclxuXHJcbiAgICAgICAgICAvLyBUT0RPXHJcbiAgICAgICAgICAvLyAxOS4gTGV0IHRocm93ZXIgYmUgdGhlIFtbVGhyb3dUeXBlRXJyb3JdXSBmdW5jdGlvbiBPYmplY3QgKDEzLjIuMykuXHJcbiAgICAgICAgICAvLyAyMC4gQ2FsbCB0aGUgW1tEZWZpbmVPd25Qcm9wZXJ0eV1dIGludGVybmFsIG1ldGhvZCBvZiBGIHdpdGhcclxuICAgICAgICAgIC8vICAgYXJndW1lbnRzIFwiY2FsbGVyXCIsIFByb3BlcnR5RGVzY3JpcHRvciB7W1tHZXRdXTogdGhyb3dlciwgW1tTZXRdXTpcclxuICAgICAgICAgIC8vICAgdGhyb3dlciwgW1tFbnVtZXJhYmxlXV06IGZhbHNlLCBbW0NvbmZpZ3VyYWJsZV1dOiBmYWxzZX0sIGFuZFxyXG4gICAgICAgICAgLy8gICBmYWxzZS5cclxuICAgICAgICAgIC8vIDIxLiBDYWxsIHRoZSBbW0RlZmluZU93blByb3BlcnR5XV0gaW50ZXJuYWwgbWV0aG9kIG9mIEYgd2l0aFxyXG4gICAgICAgICAgLy8gICBhcmd1bWVudHMgXCJhcmd1bWVudHNcIiwgUHJvcGVydHlEZXNjcmlwdG9yIHtbW0dldF1dOiB0aHJvd2VyLFxyXG4gICAgICAgICAgLy8gICBbW1NldF1dOiB0aHJvd2VyLCBbW0VudW1lcmFibGVdXTogZmFsc2UsIFtbQ29uZmlndXJhYmxlXV06IGZhbHNlfSxcclxuICAgICAgICAgIC8vICAgYW5kIGZhbHNlLlxyXG5cclxuICAgICAgICAgIC8vIFRPRE9cclxuICAgICAgICAgIC8vIE5PVEUgRnVuY3Rpb24gb2JqZWN0cyBjcmVhdGVkIHVzaW5nIEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kIGRvIG5vdFxyXG4gICAgICAgICAgLy8gaGF2ZSBhIHByb3RvdHlwZSBwcm9wZXJ0eSBvciB0aGUgW1tDb2RlXV0sIFtbRm9ybWFsUGFyYW1ldGVyc11dLCBhbmRcclxuICAgICAgICAgIC8vIFtbU2NvcGVdXSBpbnRlcm5hbCBwcm9wZXJ0aWVzLlxyXG4gICAgICAgICAgLy8gWFhYIGNhbid0IGRlbGV0ZSBwcm90b3R5cGUgaW4gcHVyZS1qcy5cclxuXHJcbiAgICAgICAgICAvLyAyMi4gUmV0dXJuIEYuXHJcbiAgICAgICAgICByZXR1cm4gYm91bmQ7XHJcbiAgICAgIH1cclxuICB9KTtcclxufSlcclxuLmNhbGwoJ29iamVjdCcgPT09IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93IHx8ICdvYmplY3QnID09PSB0eXBlb2Ygc2VsZiAmJiBzZWxmIHx8ICdvYmplY3QnID09PSB0eXBlb2YgZ2xvYmFsICYmIGdsb2JhbCB8fCB7fSk7XHJcblxyXG4oZnVuY3Rpb24odW5kZWZpbmVkKSB7XHJcblxyXG4gICAgLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlL21hc3Rlci9wYWNrYWdlcy9wb2x5ZmlsbC1saWJyYXJ5L3BvbHlmaWxscy9ET01Ub2tlbkxpc3QvZGV0ZWN0LmpzXHJcbiAgICB2YXIgZGV0ZWN0ID0gKFxyXG4gICAgICAnRE9NVG9rZW5MaXN0JyBpbiB0aGlzICYmIChmdW5jdGlvbiAoeCkge1xyXG4gICAgICAgIHJldHVybiAnY2xhc3NMaXN0JyBpbiB4ID8gIXguY2xhc3NMaXN0LnRvZ2dsZSgneCcsIGZhbHNlKSAmJiAheC5jbGFzc05hbWUgOiB0cnVlO1xyXG4gICAgICB9KShkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd4JykpXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChkZXRlY3QpIHJldHVyblxyXG5cclxuICAgIC8vIFBvbHlmaWxsIGZyb20gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlL21hc3Rlci9wYWNrYWdlcy9wb2x5ZmlsbC1saWJyYXJ5L3BvbHlmaWxscy9ET01Ub2tlbkxpc3QvcG9seWZpbGwuanNcclxuICAgIChmdW5jdGlvbiAoZ2xvYmFsKSB7XHJcbiAgICAgIHZhciBuYXRpdmVJbXBsID0gXCJET01Ub2tlbkxpc3RcIiBpbiBnbG9iYWwgJiYgZ2xvYmFsLkRPTVRva2VuTGlzdDtcclxuXHJcbiAgICAgIGlmIChcclxuICAgICAgICAgICFuYXRpdmVJbXBsIHx8XHJcbiAgICAgICAgICAoXHJcbiAgICAgICAgICAgICEhZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TICYmXHJcbiAgICAgICAgICAgICEhZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKSAmJlxyXG4gICAgICAgICAgICAhKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsIFwic3ZnXCIpLmNsYXNzTGlzdCBpbnN0YW5jZW9mIERPTVRva2VuTGlzdClcclxuICAgICAgICAgIClcclxuICAgICAgICApIHtcclxuICAgICAgICBnbG9iYWwuRE9NVG9rZW5MaXN0ID0gKGZ1bmN0aW9uKCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzXHJcbiAgICAgICAgICB2YXIgZHBTdXBwb3J0ID0gdHJ1ZTtcclxuICAgICAgICAgIHZhciBkZWZpbmVHZXR0ZXIgPSBmdW5jdGlvbiAob2JqZWN0LCBuYW1lLCBmbiwgY29uZmlndXJhYmxlKSB7XHJcbiAgICAgICAgICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpXHJcbiAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iamVjdCwgbmFtZSwge1xyXG4gICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSA9PT0gZHBTdXBwb3J0ID8gdHJ1ZSA6ICEhY29uZmlndXJhYmxlLFxyXG4gICAgICAgICAgICAgICAgZ2V0OiBmblxyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgZWxzZSBvYmplY3QuX19kZWZpbmVHZXR0ZXJfXyhuYW1lLCBmbik7XHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIC8qKiBFbnN1cmUgdGhlIGJyb3dzZXIgYWxsb3dzIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSB0byBiZSB1c2VkIG9uIG5hdGl2ZSBKYXZhU2NyaXB0IG9iamVjdHMuICovXHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBkZWZpbmVHZXR0ZXIoe30sIFwic3VwcG9ydFwiKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGRwU3VwcG9ydCA9IGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICB2YXIgX0RPTVRva2VuTGlzdCA9IGZ1bmN0aW9uIChlbCwgcHJvcCkge1xyXG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciB0b2tlbnMgPSBbXTtcclxuICAgICAgICAgICAgdmFyIHRva2VuTWFwID0ge307XHJcbiAgICAgICAgICAgIHZhciBsZW5ndGggPSAwO1xyXG4gICAgICAgICAgICB2YXIgbWF4TGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgdmFyIGFkZEluZGV4R2V0dGVyID0gZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgICBkZWZpbmVHZXR0ZXIodGhhdCwgaSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcHJlb3AoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbnNbaV07XHJcbiAgICAgICAgICAgICAgfSwgZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdmFyIHJlaW5kZXggPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgIC8qKiBEZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgYXJyYXktbGlrZSBhY2Nlc3MgdG8gdGhlIHRva2VuTGlzdCdzIGNvbnRlbnRzLiAqL1xyXG4gICAgICAgICAgICAgIGlmIChsZW5ndGggPj0gbWF4TGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgZm9yICg7IG1heExlbmd0aCA8IGxlbmd0aDsgKyttYXhMZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgYWRkSW5kZXhHZXR0ZXIobWF4TGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIC8qKiBIZWxwZXIgZnVuY3Rpb24gY2FsbGVkIGF0IHRoZSBzdGFydCBvZiBlYWNoIGNsYXNzIG1ldGhvZC4gSW50ZXJuYWwgdXNlIG9ubHkuICovXHJcbiAgICAgICAgICAgIHZhciBwcmVvcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICB2YXIgZXJyb3I7XHJcbiAgICAgICAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICAgICAgICAgICAgdmFyIHJTcGFjZSA9IC9cXHMrLztcclxuXHJcbiAgICAgICAgICAgICAgLyoqIFZhbGlkYXRlIHRoZSB0b2tlbi9zIHBhc3NlZCB0byBhbiBpbnN0YW5jZSBtZXRob2QsIGlmIGFueS4gKi9cclxuICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGgpXHJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7ICsraSlcclxuICAgICAgICAgICAgICAgICAgaWYgKHJTcGFjZS50ZXN0KGFyZ3NbaV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBuZXcgU3ludGF4RXJyb3IoJ1N0cmluZyBcIicgKyBhcmdzW2ldICsgJ1wiICcgKyBcImNvbnRhaW5zXCIgKyAnIGFuIGludmFsaWQgY2hhcmFjdGVyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IuY29kZSA9IDU7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IubmFtZSA9IFwiSW52YWxpZENoYXJhY3RlckVycm9yXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICAgIC8qKiBTcGxpdCB0aGUgbmV3IHZhbHVlIGFwYXJ0IGJ5IHdoaXRlc3BhY2UqL1xyXG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgZWxbcHJvcF0gPT09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgIHRva2VucyA9IChcIlwiICsgZWxbcHJvcF0uYmFzZVZhbCkucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgXCJcIikuc3BsaXQoclNwYWNlKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdG9rZW5zID0gKFwiXCIgKyBlbFtwcm9wXSkucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgXCJcIikuc3BsaXQoclNwYWNlKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8qKiBBdm9pZCB0cmVhdGluZyBibGFuayBzdHJpbmdzIGFzIHNpbmdsZS1pdGVtIHRva2VuIGxpc3RzICovXHJcbiAgICAgICAgICAgICAgaWYgKFwiXCIgPT09IHRva2Vuc1swXSkgdG9rZW5zID0gW107XHJcblxyXG4gICAgICAgICAgICAgIC8qKiBSZXBvcHVsYXRlIHRoZSBpbnRlcm5hbCB0b2tlbiBsaXN0cyAqL1xyXG4gICAgICAgICAgICAgIHRva2VuTWFwID0ge307XHJcbiAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHRva2Vucy5sZW5ndGg7ICsraSlcclxuICAgICAgICAgICAgICAgIHRva2VuTWFwW3Rva2Vuc1tpXV0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgIGxlbmd0aCA9IHRva2Vucy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgcmVpbmRleCgpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgLyoqIFBvcHVsYXRlIG91ciBpbnRlcm5hbCB0b2tlbiBsaXN0IGlmIHRoZSB0YXJnZXRlZCBhdHRyaWJ1dGUgb2YgdGhlIHN1YmplY3QgZWxlbWVudCBpc24ndCBlbXB0eS4gKi9cclxuICAgICAgICAgICAgcHJlb3AoKTtcclxuXHJcbiAgICAgICAgICAgIC8qKiBSZXR1cm4gdGhlIG51bWJlciBvZiB0b2tlbnMgaW4gdGhlIHVuZGVybHlpbmcgc3RyaW5nLiBSZWFkLW9ubHkuICovXHJcbiAgICAgICAgICAgIGRlZmluZUdldHRlcih0aGF0LCBcImxlbmd0aFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgcHJlb3AoKTtcclxuICAgICAgICAgICAgICByZXR1cm4gbGVuZ3RoO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8qKiBPdmVycmlkZSB0aGUgZGVmYXVsdCB0b1N0cmluZy90b0xvY2FsZVN0cmluZyBtZXRob2RzIHRvIHJldHVybiBhIHNwYWNlLWRlbGltaXRlZCBsaXN0IG9mIHRva2VucyB3aGVuIHR5cGVjYXN0LiAqL1xyXG4gICAgICAgICAgICB0aGF0LnRvTG9jYWxlU3RyaW5nID1cclxuICAgICAgICAgICAgICB0aGF0LnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcHJlb3AoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbnMuam9pbihcIiBcIik7XHJcbiAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRoYXQuaXRlbSA9IGZ1bmN0aW9uIChpZHgpIHtcclxuICAgICAgICAgICAgICBwcmVvcCgpO1xyXG4gICAgICAgICAgICAgIHJldHVybiB0b2tlbnNbaWR4XTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRoYXQuY29udGFpbnMgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgICAgICAgICAgICBwcmVvcCgpO1xyXG4gICAgICAgICAgICAgIHJldHVybiAhIXRva2VuTWFwW3Rva2VuXTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRoYXQuYWRkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgIHByZW9wLmFwcGx5KHRoYXQsIGFyZ3MgPSBhcmd1bWVudHMpO1xyXG5cclxuICAgICAgICAgICAgICBmb3IgKHZhciBhcmdzLCB0b2tlbiwgaSA9IDAsIGwgPSBhcmdzLmxlbmd0aDsgaSA8IGw7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdG9rZW4gPSBhcmdzW2ldO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0b2tlbk1hcFt0b2tlbl0pIHtcclxuICAgICAgICAgICAgICAgICAgdG9rZW5zLnB1c2godG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgICB0b2tlbk1hcFt0b2tlbl0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLyoqIFVwZGF0ZSB0aGUgdGFyZ2V0ZWQgYXR0cmlidXRlIG9mIHRoZSBhdHRhY2hlZCBlbGVtZW50IGlmIHRoZSB0b2tlbiBsaXN0J3MgY2hhbmdlZC4gKi9cclxuICAgICAgICAgICAgICBpZiAobGVuZ3RoICE9PSB0b2tlbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBsZW5ndGggPSB0b2tlbnMubGVuZ3RoID4+PiAwO1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlbFtwcm9wXSA9PT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICAgICAgICBlbFtwcm9wXS5iYXNlVmFsID0gdG9rZW5zLmpvaW4oXCIgXCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgZWxbcHJvcF0gPSB0b2tlbnMuam9pbihcIiBcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZWluZGV4KCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdGhhdC5yZW1vdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgcHJlb3AuYXBwbHkodGhhdCwgYXJncyA9IGFyZ3VtZW50cyk7XHJcblxyXG4gICAgICAgICAgICAgIC8qKiBCdWlsZCBhIGhhc2ggb2YgdG9rZW4gbmFtZXMgdG8gY29tcGFyZSBhZ2FpbnN0IHdoZW4gcmVjb2xsZWN0aW5nIG91ciB0b2tlbiBsaXN0LiAqL1xyXG4gICAgICAgICAgICAgIGZvciAodmFyIGFyZ3MsIGlnbm9yZSA9IHt9LCBpID0gMCwgdCA9IFtdOyBpIDwgYXJncy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgaWdub3JlW2FyZ3NbaV1dID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0b2tlbk1hcFthcmdzW2ldXTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8qKiBSdW4gdGhyb3VnaCBvdXIgdG9rZW5zIGxpc3QgYW5kIHJlYXNzaWduIG9ubHkgdGhvc2UgdGhhdCBhcmVuJ3QgZGVmaW5lZCBpbiB0aGUgaGFzaCBkZWNsYXJlZCBhYm92ZS4gKi9cclxuICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aDsgKytpKVxyXG4gICAgICAgICAgICAgICAgaWYgKCFpZ25vcmVbdG9rZW5zW2ldXSkgdC5wdXNoKHRva2Vuc1tpXSk7XHJcblxyXG4gICAgICAgICAgICAgIHRva2VucyA9IHQ7XHJcbiAgICAgICAgICAgICAgbGVuZ3RoID0gdC5sZW5ndGggPj4+IDA7XHJcblxyXG4gICAgICAgICAgICAgIC8qKiBVcGRhdGUgdGhlIHRhcmdldGVkIGF0dHJpYnV0ZSBvZiB0aGUgYXR0YWNoZWQgZWxlbWVudC4gKi9cclxuICAgICAgICAgICAgICBpZiAodHlwZW9mIGVsW3Byb3BdID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICBlbFtwcm9wXS5iYXNlVmFsID0gdG9rZW5zLmpvaW4oXCIgXCIpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBlbFtwcm9wXSA9IHRva2Vucy5qb2luKFwiIFwiKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgcmVpbmRleCgpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdGhhdC50b2dnbGUgPSBmdW5jdGlvbiAodG9rZW4sIGZvcmNlKSB7XHJcbiAgICAgICAgICAgICAgcHJlb3AuYXBwbHkodGhhdCwgW3Rva2VuXSk7XHJcblxyXG4gICAgICAgICAgICAgIC8qKiBUb2tlbiBzdGF0ZSdzIGJlaW5nIGZvcmNlZC4gKi9cclxuICAgICAgICAgICAgICBpZiAodW5kZWZpbmVkICE9PSBmb3JjZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZvcmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgIHRoYXQuYWRkKHRva2VuKTtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICB0aGF0LnJlbW92ZSh0b2tlbik7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8qKiBUb2tlbiBhbHJlYWR5IGV4aXN0cyBpbiB0b2tlbkxpc3QuIFJlbW92ZSBpdCwgYW5kIHJldHVybiBGQUxTRS4gKi9cclxuICAgICAgICAgICAgICBpZiAodG9rZW5NYXBbdG9rZW5dKSB7XHJcbiAgICAgICAgICAgICAgICB0aGF0LnJlbW92ZSh0b2tlbik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAvKiogT3RoZXJ3aXNlLCBhZGQgdGhlIHRva2VuIGFuZCByZXR1cm4gVFJVRS4gKi9cclxuICAgICAgICAgICAgICB0aGF0LmFkZCh0b2tlbik7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhhdDtcclxuICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgcmV0dXJuIF9ET01Ub2tlbkxpc3Q7XHJcbiAgICAgICAgfSgpKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQWRkIHNlY29uZCBhcmd1bWVudCB0byBuYXRpdmUgRE9NVG9rZW5MaXN0LnRvZ2dsZSgpIGlmIG5lY2Vzc2FyeVxyXG4gICAgICAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgICAgIGlmICghKCdjbGFzc0xpc3QnIGluIGUpKSByZXR1cm47XHJcbiAgICAgICAgZS5jbGFzc0xpc3QudG9nZ2xlKCd4JywgZmFsc2UpO1xyXG4gICAgICAgIGlmICghZS5jbGFzc0xpc3QuY29udGFpbnMoJ3gnKSkgcmV0dXJuO1xyXG4gICAgICAgIGUuY2xhc3NMaXN0LmNvbnN0cnVjdG9yLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiB0b2dnbGUodG9rZW4gLyosIGZvcmNlKi8pIHtcclxuICAgICAgICAgIHZhciBmb3JjZSA9IGFyZ3VtZW50c1sxXTtcclxuICAgICAgICAgIGlmIChmb3JjZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHZhciBhZGQgPSAhdGhpcy5jb250YWlucyh0b2tlbik7XHJcbiAgICAgICAgICAgIHRoaXNbYWRkID8gJ2FkZCcgOiAncmVtb3ZlJ10odG9rZW4pO1xyXG4gICAgICAgICAgICByZXR1cm4gYWRkO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZm9yY2UgPSAhIWZvcmNlO1xyXG4gICAgICAgICAgdGhpc1tmb3JjZSA/ICdhZGQnIDogJ3JlbW92ZSddKHRva2VuKTtcclxuICAgICAgICAgIHJldHVybiBmb3JjZTtcclxuICAgICAgICB9O1xyXG4gICAgICB9KCkpO1xyXG5cclxuICAgICAgLy8gQWRkIG11bHRpcGxlIGFyZ3VtZW50cyB0byBuYXRpdmUgRE9NVG9rZW5MaXN0LmFkZCgpIGlmIG5lY2Vzc2FyeVxyXG4gICAgICAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgICAgIGlmICghKCdjbGFzc0xpc3QnIGluIGUpKSByZXR1cm47XHJcbiAgICAgICAgZS5jbGFzc0xpc3QuYWRkKCdhJywgJ2InKTtcclxuICAgICAgICBpZiAoZS5jbGFzc0xpc3QuY29udGFpbnMoJ2InKSkgcmV0dXJuO1xyXG4gICAgICAgIHZhciBuYXRpdmUgPSBlLmNsYXNzTGlzdC5jb25zdHJ1Y3Rvci5wcm90b3R5cGUuYWRkO1xyXG4gICAgICAgIGUuY2xhc3NMaXN0LmNvbnN0cnVjdG9yLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcclxuICAgICAgICAgIHZhciBsID0gYXJndW1lbnRzLmxlbmd0aDtcclxuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgIG5hdGl2ZS5jYWxsKHRoaXMsIGFyZ3NbaV0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0oKSk7XHJcblxyXG4gICAgICAvLyBBZGQgbXVsdGlwbGUgYXJndW1lbnRzIHRvIG5hdGl2ZSBET01Ub2tlbkxpc3QucmVtb3ZlKCkgaWYgbmVjZXNzYXJ5XHJcbiAgICAgIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgICAgaWYgKCEoJ2NsYXNzTGlzdCcgaW4gZSkpIHJldHVybjtcclxuICAgICAgICBlLmNsYXNzTGlzdC5hZGQoJ2EnKTtcclxuICAgICAgICBlLmNsYXNzTGlzdC5hZGQoJ2InKTtcclxuICAgICAgICBlLmNsYXNzTGlzdC5yZW1vdmUoJ2EnLCAnYicpO1xyXG4gICAgICAgIGlmICghZS5jbGFzc0xpc3QuY29udGFpbnMoJ2InKSkgcmV0dXJuO1xyXG4gICAgICAgIHZhciBuYXRpdmUgPSBlLmNsYXNzTGlzdC5jb25zdHJ1Y3Rvci5wcm90b3R5cGUucmVtb3ZlO1xyXG4gICAgICAgIGUuY2xhc3NMaXN0LmNvbnN0cnVjdG9yLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcclxuICAgICAgICAgIHZhciBsID0gYXJndW1lbnRzLmxlbmd0aDtcclxuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgIG5hdGl2ZS5jYWxsKHRoaXMsIGFyZ3NbaV0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0oKSk7XHJcblxyXG4gICAgfSh0aGlzKSk7XHJcblxyXG59KS5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG5cclxuLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlL2Jsb2IvbWFzdGVyL3BhY2thZ2VzL3BvbHlmaWxsLWxpYnJhcnkvcG9seWZpbGxzL0RvY3VtZW50L2RldGVjdC5qc1xyXG52YXIgZGV0ZWN0ID0gKFwiRG9jdW1lbnRcIiBpbiB0aGlzKTtcclxuXHJcbmlmIChkZXRlY3QpIHJldHVyblxyXG5cclxuLy8gUG9seWZpbGwgZnJvbSBodHRwczovL2Nkbi5wb2x5ZmlsbC5pby92Mi9wb2x5ZmlsbC5qcz9mZWF0dXJlcz1Eb2N1bWVudCZmbGFncz1hbHdheXNcclxuaWYgKCh0eXBlb2YgV29ya2VyR2xvYmFsU2NvcGUgPT09IFwidW5kZWZpbmVkXCIpICYmICh0eXBlb2YgaW1wb3J0U2NyaXB0cyAhPT0gXCJmdW5jdGlvblwiKSkge1xyXG5cclxuXHRpZiAodGhpcy5IVE1MRG9jdW1lbnQpIHsgLy8gSUU4XHJcblxyXG5cdFx0Ly8gSFRNTERvY3VtZW50IGlzIGFuIGV4dGVuc2lvbiBvZiBEb2N1bWVudC4gIElmIHRoZSBicm93c2VyIGhhcyBIVE1MRG9jdW1lbnQgYnV0IG5vdCBEb2N1bWVudCwgdGhlIGZvcm1lciB3aWxsIHN1ZmZpY2UgYXMgYW4gYWxpYXMgZm9yIHRoZSBsYXR0ZXIuXHJcblx0XHR0aGlzLkRvY3VtZW50ID0gdGhpcy5IVE1MRG9jdW1lbnQ7XHJcblxyXG5cdH0gZWxzZSB7XHJcblxyXG5cdFx0Ly8gQ3JlYXRlIGFuIGVtcHR5IGZ1bmN0aW9uIHRvIGFjdCBhcyB0aGUgbWlzc2luZyBjb25zdHJ1Y3RvciBmb3IgdGhlIGRvY3VtZW50IG9iamVjdCwgYXR0YWNoIHRoZSBkb2N1bWVudCBvYmplY3QgYXMgaXRzIHByb3RvdHlwZS4gIFRoZSBmdW5jdGlvbiBuZWVkcyB0byBiZSBhbm9ueW1vdXMgZWxzZSBpdCBpcyBob2lzdGVkIGFuZCBjYXVzZXMgdGhlIGZlYXR1cmUgZGV0ZWN0IHRvIHByZW1hdHVyZWx5IHBhc3MsIHByZXZlbnRpbmcgdGhlIGFzc2lnbm1lbnRzIGJlbG93IGJlaW5nIG1hZGUuXHJcblx0XHR0aGlzLkRvY3VtZW50ID0gdGhpcy5IVE1MRG9jdW1lbnQgPSBkb2N1bWVudC5jb25zdHJ1Y3RvciA9IChuZXcgRnVuY3Rpb24oJ3JldHVybiBmdW5jdGlvbiBEb2N1bWVudCgpIHt9JykoKSk7XHJcblx0XHR0aGlzLkRvY3VtZW50LnByb3RvdHlwZSA9IGRvY3VtZW50O1xyXG5cdH1cclxufVxyXG5cclxuXHJcbn0pXHJcbi5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG5cclxuLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlL2Jsb2IvbWFzdGVyL3BhY2thZ2VzL3BvbHlmaWxsLWxpYnJhcnkvcG9seWZpbGxzL0VsZW1lbnQvZGV0ZWN0LmpzXHJcbnZhciBkZXRlY3QgPSAoJ0VsZW1lbnQnIGluIHRoaXMgJiYgJ0hUTUxFbGVtZW50JyBpbiB0aGlzKTtcclxuXHJcbmlmIChkZXRlY3QpIHJldHVyblxyXG5cclxuLy8gUG9seWZpbGwgZnJvbSBodHRwczovL2Nkbi5wb2x5ZmlsbC5pby92Mi9wb2x5ZmlsbC5qcz9mZWF0dXJlcz1FbGVtZW50JmZsYWdzPWFsd2F5c1xyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuXHQvLyBJRThcclxuXHRpZiAod2luZG93LkVsZW1lbnQgJiYgIXdpbmRvdy5IVE1MRWxlbWVudCkge1xyXG5cdFx0d2luZG93LkhUTUxFbGVtZW50ID0gd2luZG93LkVsZW1lbnQ7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHQvLyBjcmVhdGUgRWxlbWVudCBjb25zdHJ1Y3RvclxyXG5cdHdpbmRvdy5FbGVtZW50ID0gd2luZG93LkhUTUxFbGVtZW50ID0gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gZnVuY3Rpb24gRWxlbWVudCgpIHt9JykoKTtcclxuXHJcblx0Ly8gZ2VuZXJhdGUgc2FuZGJveGVkIGlmcmFtZVxyXG5cdHZhciB2Ym9keSA9IGRvY3VtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2JvZHknKSk7XHJcblx0dmFyIGZyYW1lID0gdmJvZHkuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJykpO1xyXG5cclxuXHQvLyB1c2Ugc2FuZGJveGVkIGlmcmFtZSB0byByZXBsaWNhdGUgRWxlbWVudCBmdW5jdGlvbmFsaXR5XHJcblx0dmFyIGZyYW1lRG9jdW1lbnQgPSBmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50O1xyXG5cdHZhciBwcm90b3R5cGUgPSBFbGVtZW50LnByb3RvdHlwZSA9IGZyYW1lRG9jdW1lbnQuYXBwZW5kQ2hpbGQoZnJhbWVEb2N1bWVudC5jcmVhdGVFbGVtZW50KCcqJykpO1xyXG5cdHZhciBjYWNoZSA9IHt9O1xyXG5cclxuXHQvLyBwb2x5ZmlsbCBFbGVtZW50LnByb3RvdHlwZSBvbiBhbiBlbGVtZW50XHJcblx0dmFyIHNoaXYgPSBmdW5jdGlvbiAoZWxlbWVudCwgZGVlcCkge1xyXG5cdFx0dmFyXHJcblx0XHRjaGlsZE5vZGVzID0gZWxlbWVudC5jaGlsZE5vZGVzIHx8IFtdLFxyXG5cdFx0aW5kZXggPSAtMSxcclxuXHRcdGtleSwgdmFsdWUsIGNoaWxkTm9kZTtcclxuXHJcblx0XHRpZiAoZWxlbWVudC5ub2RlVHlwZSA9PT0gMSAmJiBlbGVtZW50LmNvbnN0cnVjdG9yICE9PSBFbGVtZW50KSB7XHJcblx0XHRcdGVsZW1lbnQuY29uc3RydWN0b3IgPSBFbGVtZW50O1xyXG5cclxuXHRcdFx0Zm9yIChrZXkgaW4gY2FjaGUpIHtcclxuXHRcdFx0XHR2YWx1ZSA9IGNhY2hlW2tleV07XHJcblx0XHRcdFx0ZWxlbWVudFtrZXldID0gdmFsdWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHR3aGlsZSAoY2hpbGROb2RlID0gZGVlcCAmJiBjaGlsZE5vZGVzWysraW5kZXhdKSB7XHJcblx0XHRcdHNoaXYoY2hpbGROb2RlLCBkZWVwKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZWxlbWVudDtcclxuXHR9O1xyXG5cclxuXHR2YXIgZWxlbWVudHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnKicpO1xyXG5cdHZhciBuYXRpdmVDcmVhdGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudDtcclxuXHR2YXIgaW50ZXJ2YWw7XHJcblx0dmFyIGxvb3BMaW1pdCA9IDEwMDtcclxuXHJcblx0cHJvdG90eXBlLmF0dGFjaEV2ZW50KCdvbnByb3BlcnR5Y2hhbmdlJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcblx0XHR2YXJcclxuXHRcdHByb3BlcnR5TmFtZSA9IGV2ZW50LnByb3BlcnR5TmFtZSxcclxuXHRcdG5vblZhbHVlID0gIWNhY2hlLmhhc093blByb3BlcnR5KHByb3BlcnR5TmFtZSksXHJcblx0XHRuZXdWYWx1ZSA9IHByb3RvdHlwZVtwcm9wZXJ0eU5hbWVdLFxyXG5cdFx0b2xkVmFsdWUgPSBjYWNoZVtwcm9wZXJ0eU5hbWVdLFxyXG5cdFx0aW5kZXggPSAtMSxcclxuXHRcdGVsZW1lbnQ7XHJcblxyXG5cdFx0d2hpbGUgKGVsZW1lbnQgPSBlbGVtZW50c1srK2luZGV4XSkge1xyXG5cdFx0XHRpZiAoZWxlbWVudC5ub2RlVHlwZSA9PT0gMSkge1xyXG5cdFx0XHRcdGlmIChub25WYWx1ZSB8fCBlbGVtZW50W3Byb3BlcnR5TmFtZV0gPT09IG9sZFZhbHVlKSB7XHJcblx0XHRcdFx0XHRlbGVtZW50W3Byb3BlcnR5TmFtZV0gPSBuZXdWYWx1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRjYWNoZVtwcm9wZXJ0eU5hbWVdID0gbmV3VmFsdWU7XHJcblx0fSk7XHJcblxyXG5cdHByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEVsZW1lbnQ7XHJcblxyXG5cdGlmICghcHJvdG90eXBlLmhhc0F0dHJpYnV0ZSkge1xyXG5cdFx0Ly8gPEVsZW1lbnQ+Lmhhc0F0dHJpYnV0ZVxyXG5cdFx0cHJvdG90eXBlLmhhc0F0dHJpYnV0ZSA9IGZ1bmN0aW9uIGhhc0F0dHJpYnV0ZShuYW1lKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLmdldEF0dHJpYnV0ZShuYW1lKSAhPT0gbnVsbDtcclxuXHRcdH07XHJcblx0fVxyXG5cclxuXHQvLyBBcHBseSBFbGVtZW50IHByb3RvdHlwZSB0byB0aGUgcHJlLWV4aXN0aW5nIERPTSBhcyBzb29uIGFzIHRoZSBib2R5IGVsZW1lbnQgYXBwZWFycy5cclxuXHRmdW5jdGlvbiBib2R5Q2hlY2soKSB7XHJcblx0XHRpZiAoIShsb29wTGltaXQtLSkpIGNsZWFyVGltZW91dChpbnRlcnZhbCk7XHJcblx0XHRpZiAoZG9jdW1lbnQuYm9keSAmJiAhZG9jdW1lbnQuYm9keS5wcm90b3R5cGUgJiYgLyhjb21wbGV0ZXxpbnRlcmFjdGl2ZSkvLnRlc3QoZG9jdW1lbnQucmVhZHlTdGF0ZSkpIHtcclxuXHRcdFx0c2hpdihkb2N1bWVudCwgdHJ1ZSk7XHJcblx0XHRcdGlmIChpbnRlcnZhbCAmJiBkb2N1bWVudC5ib2R5LnByb3RvdHlwZSkgY2xlYXJUaW1lb3V0KGludGVydmFsKTtcclxuXHRcdFx0cmV0dXJuICghIWRvY3VtZW50LmJvZHkucHJvdG90eXBlKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcblx0aWYgKCFib2R5Q2hlY2soKSkge1xyXG5cdFx0ZG9jdW1lbnQub25yZWFkeXN0YXRlY2hhbmdlID0gYm9keUNoZWNrO1xyXG5cdFx0aW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChib2R5Q2hlY2ssIDI1KTtcclxuXHR9XHJcblxyXG5cdC8vIEFwcGx5IHRvIGFueSBuZXcgZWxlbWVudHMgY3JlYXRlZCBhZnRlciBsb2FkXHJcblx0ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCA9IGZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQobm9kZU5hbWUpIHtcclxuXHRcdHZhciBlbGVtZW50ID0gbmF0aXZlQ3JlYXRlRWxlbWVudChTdHJpbmcobm9kZU5hbWUpLnRvTG93ZXJDYXNlKCkpO1xyXG5cdFx0cmV0dXJuIHNoaXYoZWxlbWVudCk7XHJcblx0fTtcclxuXHJcblx0Ly8gcmVtb3ZlIHNhbmRib3hlZCBpZnJhbWVcclxuXHRkb2N1bWVudC5yZW1vdmVDaGlsZCh2Ym9keSk7XHJcbn0oKSk7XHJcblxyXG59KVxyXG4uY2FsbCgnb2JqZWN0JyA9PT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBzZWxmICYmIHNlbGYgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBnbG9iYWwgJiYgZ2xvYmFsIHx8IHt9KTtcclxuXHJcbihmdW5jdGlvbih1bmRlZmluZWQpIHtcclxuXHJcbiAgICAvLyBEZXRlY3Rpb24gZnJvbSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLXNlcnZpY2UvODcxN2E5ZTA0YWM3YWZmOTliNDk4MGZiZWRlYWQ5ODAzNmIwOTI5YS9wYWNrYWdlcy9wb2x5ZmlsbC1saWJyYXJ5L3BvbHlmaWxscy9FbGVtZW50L3Byb3RvdHlwZS9jbGFzc0xpc3QvZGV0ZWN0LmpzXHJcbiAgICB2YXIgZGV0ZWN0ID0gKFxyXG4gICAgICAnZG9jdW1lbnQnIGluIHRoaXMgJiYgXCJjbGFzc0xpc3RcIiBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgJiYgJ0VsZW1lbnQnIGluIHRoaXMgJiYgJ2NsYXNzTGlzdCcgaW4gRWxlbWVudC5wcm90b3R5cGUgJiYgKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgICBlLmNsYXNzTGlzdC5hZGQoJ2EnLCAnYicpO1xyXG4gICAgICAgIHJldHVybiBlLmNsYXNzTGlzdC5jb250YWlucygnYicpO1xyXG4gICAgICB9KCkpXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChkZXRlY3QpIHJldHVyblxyXG5cclxuICAgIC8vIFBvbHlmaWxsIGZyb20gaHR0cHM6Ly9jZG4ucG9seWZpbGwuaW8vdjIvcG9seWZpbGwuanM/ZmVhdHVyZXM9RWxlbWVudC5wcm90b3R5cGUuY2xhc3NMaXN0JmZsYWdzPWFsd2F5c1xyXG4gICAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcclxuICAgICAgdmFyIGRwU3VwcG9ydCA9IHRydWU7XHJcbiAgICAgIHZhciBkZWZpbmVHZXR0ZXIgPSBmdW5jdGlvbiAob2JqZWN0LCBuYW1lLCBmbiwgY29uZmlndXJhYmxlKSB7XHJcbiAgICAgICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSlcclxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmplY3QsIG5hbWUsIHtcclxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSA9PT0gZHBTdXBwb3J0ID8gdHJ1ZSA6ICEhY29uZmlndXJhYmxlLFxyXG4gICAgICAgICAgICBnZXQ6IGZuXHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZWxzZSBvYmplY3QuX19kZWZpbmVHZXR0ZXJfXyhuYW1lLCBmbik7XHJcbiAgICAgIH07XHJcbiAgICAgIC8qKiBFbnN1cmUgdGhlIGJyb3dzZXIgYWxsb3dzIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSB0byBiZSB1c2VkIG9uIG5hdGl2ZSBKYXZhU2NyaXB0IG9iamVjdHMuICovXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgZGVmaW5lR2V0dGVyKHt9LCBcInN1cHBvcnRcIik7XHJcbiAgICAgIH1cclxuICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICBkcFN1cHBvcnQgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICAvKiogUG9seWZpbGxzIGEgcHJvcGVydHkgd2l0aCBhIERPTVRva2VuTGlzdCAqL1xyXG4gICAgICB2YXIgYWRkUHJvcCA9IGZ1bmN0aW9uIChvLCBuYW1lLCBhdHRyKSB7XHJcblxyXG4gICAgICAgIGRlZmluZUdldHRlcihvLnByb3RvdHlwZSwgbmFtZSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgdmFyIHRva2VuTGlzdDtcclxuXHJcbiAgICAgICAgICB2YXIgVEhJUyA9IHRoaXMsXHJcblxyXG4gICAgICAgICAgLyoqIFByZXZlbnQgdGhpcyBmcm9tIGZpcmluZyB0d2ljZSBmb3Igc29tZSByZWFzb24uIFdoYXQgdGhlIGhlbGwsIElFLiAqL1xyXG4gICAgICAgICAgZ2liYmVyaXNoUHJvcGVydHkgPSBcIl9fZGVmaW5lR2V0dGVyX19cIiArIFwiREVGSU5FX1BST1BFUlRZXCIgKyBuYW1lO1xyXG4gICAgICAgICAgaWYoVEhJU1tnaWJiZXJpc2hQcm9wZXJ0eV0pIHJldHVybiB0b2tlbkxpc3Q7XHJcbiAgICAgICAgICBUSElTW2dpYmJlcmlzaFByb3BlcnR5XSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgKiBJRTggY2FuJ3QgZGVmaW5lIHByb3BlcnRpZXMgb24gbmF0aXZlIEphdmFTY3JpcHQgb2JqZWN0cywgc28gd2UnbGwgdXNlIGEgZHVtYiBoYWNrIGluc3RlYWQuXHJcbiAgICAgICAgICAgKlxyXG4gICAgICAgICAgICogV2hhdCB0aGlzIGlzIGRvaW5nIGlzIGNyZWF0aW5nIGEgZHVtbXkgZWxlbWVudCAoXCJyZWZsZWN0aW9uXCIpIGluc2lkZSBhIGRldGFjaGVkIHBoYW50b20gbm9kZSAoXCJtaXJyb3JcIilcclxuICAgICAgICAgICAqIHRoYXQgc2VydmVzIGFzIHRoZSB0YXJnZXQgb2YgT2JqZWN0LmRlZmluZVByb3BlcnR5IGluc3RlYWQuIFdoaWxlIHdlIGNvdWxkIHNpbXBseSB1c2UgdGhlIHN1YmplY3QgSFRNTFxyXG4gICAgICAgICAgICogZWxlbWVudCBpbnN0ZWFkLCB0aGlzIHdvdWxkIGNvbmZsaWN0IHdpdGggZWxlbWVudCB0eXBlcyB3aGljaCB1c2UgaW5kZXhlZCBwcm9wZXJ0aWVzIChzdWNoIGFzIGZvcm1zIGFuZFxyXG4gICAgICAgICAgICogc2VsZWN0IGxpc3RzKS5cclxuICAgICAgICAgICAqL1xyXG4gICAgICAgICAgaWYgKGZhbHNlID09PSBkcFN1cHBvcnQpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciB2aXNhZ2U7XHJcbiAgICAgICAgICAgIHZhciBtaXJyb3IgPSBhZGRQcm9wLm1pcnJvciB8fCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICB2YXIgcmVmbGVjdGlvbnMgPSBtaXJyb3IuY2hpbGROb2RlcztcclxuICAgICAgICAgICAgdmFyIGwgPSByZWZsZWN0aW9ucy5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGw7ICsraSlcclxuICAgICAgICAgICAgICBpZiAocmVmbGVjdGlvbnNbaV0uX1IgPT09IFRISVMpIHtcclxuICAgICAgICAgICAgICAgIHZpc2FnZSA9IHJlZmxlY3Rpb25zW2ldO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLyoqIENvdWxkbid0IGZpbmQgYW4gZWxlbWVudCdzIHJlZmxlY3Rpb24gaW5zaWRlIHRoZSBtaXJyb3IuIE1hdGVyaWFsaXNlIG9uZS4gKi9cclxuICAgICAgICAgICAgdmlzYWdlIHx8ICh2aXNhZ2UgPSBtaXJyb3IuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSkpO1xyXG5cclxuICAgICAgICAgICAgdG9rZW5MaXN0ID0gRE9NVG9rZW5MaXN0LmNhbGwodmlzYWdlLCBUSElTLCBhdHRyKTtcclxuICAgICAgICAgIH0gZWxzZSB0b2tlbkxpc3QgPSBuZXcgRE9NVG9rZW5MaXN0KFRISVMsIGF0dHIpO1xyXG5cclxuICAgICAgICAgIGRlZmluZUdldHRlcihUSElTLCBuYW1lLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0b2tlbkxpc3Q7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGRlbGV0ZSBUSElTW2dpYmJlcmlzaFByb3BlcnR5XTtcclxuXHJcbiAgICAgICAgICByZXR1cm4gdG9rZW5MaXN0O1xyXG4gICAgICAgIH0sIHRydWUpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgYWRkUHJvcChnbG9iYWwuRWxlbWVudCwgXCJjbGFzc0xpc3RcIiwgXCJjbGFzc05hbWVcIik7XHJcbiAgICAgIGFkZFByb3AoZ2xvYmFsLkhUTUxFbGVtZW50LCBcImNsYXNzTGlzdFwiLCBcImNsYXNzTmFtZVwiKTtcclxuICAgICAgYWRkUHJvcChnbG9iYWwuSFRNTExpbmtFbGVtZW50LCBcInJlbExpc3RcIiwgXCJyZWxcIik7XHJcbiAgICAgIGFkZFByb3AoZ2xvYmFsLkhUTUxBbmNob3JFbGVtZW50LCBcInJlbExpc3RcIiwgXCJyZWxcIik7XHJcbiAgICAgIGFkZFByb3AoZ2xvYmFsLkhUTUxBcmVhRWxlbWVudCwgXCJyZWxMaXN0XCIsIFwicmVsXCIpO1xyXG4gICAgfSh0aGlzKSk7XHJcblxyXG59KS5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG5cclxuICAgIC8vIERldGVjdGlvbiBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9tZG4vY29udGVudC9ibG9iL2NmNjA3ZDY4NTIyY2QzNWVlNzY3MDc4MmQzZWUzYTM2MWVhZWYyZTQvZmlsZXMvZW4tdXMvd2ViL2phdmFzY3JpcHQvcmVmZXJlbmNlL2dsb2JhbF9vYmplY3RzL3N0cmluZy90cmltL2luZGV4Lm1kI3BvbHlmaWxsXHJcbiAgICB2YXIgZGV0ZWN0ID0gKCd0cmltJyBpbiBTdHJpbmcucHJvdG90eXBlKTtcclxuICAgIFxyXG4gICAgaWYgKGRldGVjdCkgcmV0dXJuXHJcblxyXG4gICAgLy8gUG9seWZpbGwgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vbWRuL2NvbnRlbnQvYmxvYi9jZjYwN2Q2ODUyMmNkMzVlZTc2NzA3ODJkM2VlM2EzNjFlYWVmMmU0L2ZpbGVzL2VuLXVzL3dlYi9qYXZhc2NyaXB0L3JlZmVyZW5jZS9nbG9iYWxfb2JqZWN0cy9zdHJpbmcvdHJpbS9pbmRleC5tZCNwb2x5ZmlsbFxyXG4gICAgU3RyaW5nLnByb3RvdHlwZS50cmltID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlcGxhY2UoL15bXFxzXFx1RkVGRlxceEEwXSt8W1xcc1xcdUZFRkZcXHhBMF0rJC9nLCAnJyk7XHJcbiAgICB9O1xyXG5cclxufSkuY2FsbCgnb2JqZWN0JyA9PT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBzZWxmICYmIHNlbGYgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBnbG9iYWwgJiYgZ2xvYmFsIHx8IHt9KTtcclxuXHJcbihmdW5jdGlvbih1bmRlZmluZWQpIHtcclxuXHJcbiAgLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1saWJyYXJ5LzEzY2Y3YzM0MDk3NGQxMjhkNTU3NTgwYjVlMmRhZmNkMWIxMTkyZDEvcG9seWZpbGxzL0VsZW1lbnQvcHJvdG90eXBlL2RhdGFzZXQvZGV0ZWN0LmpzXHJcbiAgdmFyIGRldGVjdCA9IChmdW5jdGlvbigpe1xyXG4gICAgaWYgKCFkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZGF0YXNldCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGVsLnNldEF0dHJpYnV0ZShcImRhdGEtYS1iXCIsIFwiY1wiKTtcclxuICAgIHJldHVybiBlbC5kYXRhc2V0ICYmIGVsLmRhdGFzZXQuYUIgPT0gXCJjXCI7XHJcbiAgfSgpKTtcclxuXHJcbiAgaWYgKGRldGVjdCkgcmV0dXJuXHJcblxyXG4gIC8vIFBvbHlmaWxsIGRlcml2ZWQgZnJvbSAgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1saWJyYXJ5LzEzY2Y3YzM0MDk3NGQxMjhkNTU3NTgwYjVlMmRhZmNkMWIxMTkyZDEvcG9seWZpbGxzL0VsZW1lbnQvcHJvdG90eXBlL2RhdGFzZXQvcG9seWZpbGwuanNcclxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRWxlbWVudC5wcm90b3R5cGUsICdkYXRhc2V0Jywge1xyXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzO1xyXG4gICAgICB2YXIgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcztcclxuICAgICAgdmFyIG1hcCA9IHt9O1xyXG4gIFxyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgYXR0cmlidXRlID0gYXR0cmlidXRlc1tpXTtcclxuICBcclxuICAgICAgICAvLyBUaGlzIHJlZ2V4IGhhcyBiZWVuIGVkaXRlZCBmcm9tIHRoZSBvcmlnaW5hbCBwb2x5ZmlsbCwgdG8gYWRkXHJcbiAgICAgICAgLy8gc3VwcG9ydCBmb3IgcGVyaW9kICguKSBzZXBhcmF0b3JzIGluIGRhdGEtKiBhdHRyaWJ1dGUgbmFtZXMuIFRoZXNlXHJcbiAgICAgICAgLy8gYXJlIGFsbG93ZWQgaW4gdGhlIEhUTUwgc3BlYywgYnV0IHdlcmUgbm90IGNvdmVyZWQgYnkgdGhlIG9yaWdpbmFsXHJcbiAgICAgICAgLy8gcG9seWZpbGwncyByZWdleC4gV2UgdXNlIHBlcmlvZHMgaW4gb3VyIGkxOG4gaW1wbGVtZW50YXRpb24uXHJcbiAgICAgICAgaWYgKGF0dHJpYnV0ZSAmJiBhdHRyaWJ1dGUubmFtZSAmJiAoL15kYXRhLVxcd1suXFx3LV0qJC8pLnRlc3QoYXR0cmlidXRlLm5hbWUpKSB7XHJcbiAgICAgICAgICB2YXIgbmFtZSA9IGF0dHJpYnV0ZS5uYW1lO1xyXG4gICAgICAgICAgdmFyIHZhbHVlID0gYXR0cmlidXRlLnZhbHVlO1xyXG4gIFxyXG4gICAgICAgICAgdmFyIHByb3BOYW1lID0gbmFtZS5zdWJzdHIoNSkucmVwbGFjZSgvLS4vZywgZnVuY3Rpb24gKHByb3ApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHByb3AuY2hhckF0KDEpLnRvVXBwZXJDYXNlKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gSWYgdGhpcyBicm93c2VyIHN1cHBvcnRzIF9fZGVmaW5lR2V0dGVyX18gYW5kIF9fZGVmaW5lU2V0dGVyX18sXHJcbiAgICAgICAgICAvLyBjb250aW51ZSB1c2luZyBkZWZpbmVQcm9wZXJ0eS4gSWYgbm90IChsaWtlIElFIDggYW5kIGJlbG93KSwgd2UgdXNlXHJcbiAgICAgICAgICAvLyBhIGhhY2t5IGZhbGxiYWNrIHdoaWNoIGF0IGxlYXN0IGdpdmVzIGFuIG9iamVjdCBpbiB0aGUgcmlnaHQgZm9ybWF0XHJcbiAgICAgICAgICBpZiAoJ19fZGVmaW5lR2V0dGVyX18nIGluIE9iamVjdC5wcm90b3R5cGUgJiYgJ19fZGVmaW5lU2V0dGVyX18nIGluIE9iamVjdC5wcm90b3R5cGUpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1hcCwgcHJvcE5hbWUsIHtcclxuICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTtcclxuICAgICAgICAgICAgICB9LmJpbmQoe3ZhbHVlOiB2YWx1ZSB8fCAnJ30pLFxyXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0dGVyKG5hbWUsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZShuYW1lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9LmJpbmQoZWxlbWVudCwgbmFtZSlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBtYXBbcHJvcE5hbWVdID0gdmFsdWU7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gIFxyXG4gICAgICByZXR1cm4gbWFwO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxufSkuY2FsbCgnb2JqZWN0JyA9PT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBzZWxmICYmIHNlbGYgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBnbG9iYWwgJiYgZ2xvYmFsIHx8IHt9KTtcclxuXHJcbi8qKlxyXG4gKiBOb3JtYWxpc2Ugc3RyaW5nXHJcbiAqXHJcbiAqICdJZiBpdCBsb29rcyBsaWtlIGEgZHVjaywgYW5kIGl0IHF1YWNrcyBsaWtlIGEgZHVja+KApicg8J+mhlxyXG4gKlxyXG4gKiBJZiB0aGUgcGFzc2VkIHZhbHVlIGxvb2tzIGxpa2UgYSBib29sZWFuIG9yIGEgbnVtYmVyLCBjb252ZXJ0IGl0IHRvIGEgYm9vbGVhblxyXG4gKiBvciBudW1iZXIuXHJcbiAqXHJcbiAqIERlc2lnbmVkIHRvIGJlIHVzZWQgdG8gY29udmVydCBjb25maWcgcGFzc2VkIHZpYSBkYXRhIGF0dHJpYnV0ZXMgKHdoaWNoIGFyZVxyXG4gKiBhbHdheXMgc3RyaW5ncykgaW50byBzb21ldGhpbmcgc2Vuc2libGUuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIFRoZSB2YWx1ZSB0byBub3JtYWxpc2VcclxuICogQHJldHVybnMge3N0cmluZyB8IGJvb2xlYW4gfCBudW1iZXIgfCB1bmRlZmluZWR9IE5vcm1hbGlzZWQgZGF0YVxyXG4gKi9cclxuZnVuY3Rpb24gbm9ybWFsaXNlU3RyaW5nICh2YWx1ZSkge1xyXG4gIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XHJcbiAgICByZXR1cm4gdmFsdWVcclxuICB9XHJcblxyXG4gIHZhciB0cmltbWVkVmFsdWUgPSB2YWx1ZS50cmltKCk7XHJcblxyXG4gIGlmICh0cmltbWVkVmFsdWUgPT09ICd0cnVlJykge1xyXG4gICAgcmV0dXJuIHRydWVcclxuICB9XHJcblxyXG4gIGlmICh0cmltbWVkVmFsdWUgPT09ICdmYWxzZScpIHtcclxuICAgIHJldHVybiBmYWxzZVxyXG4gIH1cclxuXHJcbiAgLy8gRW1wdHkgLyB3aGl0ZXNwYWNlLW9ubHkgc3RyaW5ncyBhcmUgY29uc2lkZXJlZCBmaW5pdGUgc28gd2UgbmVlZCB0byBjaGVja1xyXG4gIC8vIHRoZSBsZW5ndGggb2YgdGhlIHRyaW1tZWQgc3RyaW5nIGFzIHdlbGxcclxuICBpZiAodHJpbW1lZFZhbHVlLmxlbmd0aCA+IDAgJiYgaXNGaW5pdGUodHJpbW1lZFZhbHVlKSkge1xyXG4gICAgcmV0dXJuIE51bWJlcih0cmltbWVkVmFsdWUpXHJcbiAgfVxyXG5cclxuICByZXR1cm4gdmFsdWVcclxufVxyXG5cclxuLyoqXHJcbiAqIE5vcm1hbGlzZSBkYXRhc2V0XHJcbiAqXHJcbiAqIExvb3Agb3ZlciBhbiBvYmplY3QgYW5kIG5vcm1hbGlzZSBlYWNoIHZhbHVlIHVzaW5nIG5vcm1hbGlzZURhdGEgZnVuY3Rpb25cclxuICpcclxuICogQHBhcmFtIHtET01TdHJpbmdNYXB9IGRhdGFzZXQgLSBIVE1MIGVsZW1lbnQgZGF0YXNldFxyXG4gKiBAcmV0dXJucyB7T2JqZWN0PHN0cmluZywgc3RyaW5nIHwgYm9vbGVhbiB8IG51bWJlciB8IHVuZGVmaW5lZD59IE5vcm1hbGlzZWQgZGF0YXNldFxyXG4gKi9cclxuZnVuY3Rpb24gbm9ybWFsaXNlRGF0YXNldCAoZGF0YXNldCkge1xyXG4gIHZhciBvdXQgPSB7fTtcclxuXHJcbiAgZm9yICh2YXIga2V5IGluIGRhdGFzZXQpIHtcclxuICAgIG91dFtrZXldID0gbm9ybWFsaXNlU3RyaW5nKGRhdGFzZXRba2V5XSk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gb3V0XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RhbnRcclxuICogQHR5cGUge0FjY29yZGlvblRyYW5zbGF0aW9uc31cclxuICogQHNlZSBEZWZhdWx0IHZhbHVlIGZvciB7QGxpbmsgQWNjb3JkaW9uQ29uZmlnLmkxOG59XHJcbiAqIEBkZWZhdWx0XHJcbiAqL1xyXG52YXIgQUNDT1JESU9OX1RSQU5TTEFUSU9OUyA9IHtcclxuICBoaWRlQWxsU2VjdGlvbnM6ICdIaWRlIGFsbCBzZWN0aW9ucycsXHJcbiAgaGlkZVNlY3Rpb246ICdIaWRlJyxcclxuICBoaWRlU2VjdGlvbkFyaWFMYWJlbDogJ0hpZGUgdGhpcyBzZWN0aW9uJyxcclxuICBzaG93QWxsU2VjdGlvbnM6ICdTaG93IGFsbCBzZWN0aW9ucycsXHJcbiAgc2hvd1NlY3Rpb246ICdTaG93JyxcclxuICBzaG93U2VjdGlvbkFyaWFMYWJlbDogJ1Nob3cgdGhpcyBzZWN0aW9uJ1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEFjY29yZGlvbiBjb21wb25lbnRcclxuICpcclxuICogVGhpcyBhbGxvd3MgYSBjb2xsZWN0aW9uIG9mIHNlY3Rpb25zIHRvIGJlIGNvbGxhcHNlZCBieSBkZWZhdWx0LCBzaG93aW5nIG9ubHlcclxuICogdGhlaXIgaGVhZGVycy4gU2VjdGlvbnMgY2FuIGJlIGV4cGFuZGVkIG9yIGNvbGxhcHNlZCBpbmRpdmlkdWFsbHkgYnkgY2xpY2tpbmdcclxuICogdGhlaXIgaGVhZGVycy4gQSBcIlNob3cgYWxsIHNlY3Rpb25zXCIgYnV0dG9uIGlzIGFsc28gYWRkZWQgdG8gdGhlIHRvcCBvZiB0aGVcclxuICogYWNjb3JkaW9uLCB3aGljaCBzd2l0Y2hlcyB0byBcIkhpZGUgYWxsIHNlY3Rpb25zXCIgd2hlbiBhbGwgdGhlIHNlY3Rpb25zIGFyZVxyXG4gKiBleHBhbmRlZC5cclxuICpcclxuICogVGhlIHN0YXRlIG9mIGVhY2ggc2VjdGlvbiBpcyBzYXZlZCB0byB0aGUgRE9NIHZpYSB0aGUgYGFyaWEtZXhwYW5kZWRgXHJcbiAqIGF0dHJpYnV0ZSwgd2hpY2ggYWxzbyBwcm92aWRlcyBhY2Nlc3NpYmlsaXR5LlxyXG4gKlxyXG4gKiBAY2xhc3NcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gJG1vZHVsZSAtIEhUTUwgZWxlbWVudCB0byB1c2UgZm9yIGFjY29yZGlvblxyXG4gKiBAcGFyYW0ge0FjY29yZGlvbkNvbmZpZ30gW2NvbmZpZ10gLSBBY2NvcmRpb24gY29uZmlnXHJcbiAqL1xyXG5mdW5jdGlvbiBBY2NvcmRpb24gKCRtb2R1bGUsIGNvbmZpZykge1xyXG4gIHRoaXMuJG1vZHVsZSA9ICRtb2R1bGU7XHJcbiAgdGhpcy4kc2VjdGlvbnMgPSAkbW9kdWxlLnF1ZXJ5U2VsZWN0b3JBbGwoJy5nb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24nKTtcclxuICB0aGlzLmJyb3dzZXJTdXBwb3J0c1Nlc3Npb25TdG9yYWdlID0gaGVscGVyLmNoZWNrRm9yU2Vzc2lvblN0b3JhZ2UoKTtcclxuXHJcbiAgdmFyIGRlZmF1bHRDb25maWcgPSB7XHJcbiAgICBpMThuOiBBQ0NPUkRJT05fVFJBTlNMQVRJT05TXHJcbiAgfTtcclxuICB0aGlzLmNvbmZpZyA9IG1lcmdlQ29uZmlncyhcclxuICAgIGRlZmF1bHRDb25maWcsXHJcbiAgICBjb25maWcgfHwge30sXHJcbiAgICBub3JtYWxpc2VEYXRhc2V0KCRtb2R1bGUuZGF0YXNldClcclxuICApO1xyXG4gIHRoaXMuaTE4biA9IG5ldyBJMThuKGV4dHJhY3RDb25maWdCeU5hbWVzcGFjZSh0aGlzLmNvbmZpZywgJ2kxOG4nKSk7XHJcblxyXG4gIHRoaXMuY29udHJvbHNDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX2NvbnRyb2xzJztcclxuICB0aGlzLnNob3dBbGxDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3Nob3ctYWxsJztcclxuICB0aGlzLnNob3dBbGxUZXh0Q2xhc3MgPSAnZ292dWstYWNjb3JkaW9uX19zaG93LWFsbC10ZXh0JztcclxuXHJcbiAgdGhpcy5zZWN0aW9uRXhwYW5kZWRDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24tLWV4cGFuZGVkJztcclxuICB0aGlzLnNlY3Rpb25CdXR0b25DbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24tYnV0dG9uJztcclxuICB0aGlzLnNlY3Rpb25IZWFkZXJDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24taGVhZGVyJztcclxuICB0aGlzLnNlY3Rpb25IZWFkaW5nQ2xhc3MgPSAnZ292dWstYWNjb3JkaW9uX19zZWN0aW9uLWhlYWRpbmcnO1xyXG4gIHRoaXMuc2VjdGlvbkhlYWRpbmdUZXh0Q2xhc3MgPSAnZ292dWstYWNjb3JkaW9uX19zZWN0aW9uLWhlYWRpbmctdGV4dCc7XHJcbiAgdGhpcy5zZWN0aW9uSGVhZGluZ1RleHRGb2N1c0NsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi1oZWFkaW5nLXRleHQtZm9jdXMnO1xyXG5cclxuICB0aGlzLnNlY3Rpb25TaG93SGlkZVRvZ2dsZUNsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi10b2dnbGUnO1xyXG4gIHRoaXMuc2VjdGlvblNob3dIaWRlVG9nZ2xlRm9jdXNDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24tdG9nZ2xlLWZvY3VzJztcclxuICB0aGlzLnNlY3Rpb25TaG93SGlkZVRleHRDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24tdG9nZ2xlLXRleHQnO1xyXG4gIHRoaXMudXBDaGV2cm9uSWNvbkNsYXNzID0gJ2dvdnVrLWFjY29yZGlvbi1uYXZfX2NoZXZyb24nO1xyXG4gIHRoaXMuZG93bkNoZXZyb25JY29uQ2xhc3MgPSAnZ292dWstYWNjb3JkaW9uLW5hdl9fY2hldnJvbi0tZG93bic7XHJcblxyXG4gIHRoaXMuc2VjdGlvblN1bW1hcnlDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24tc3VtbWFyeSc7XHJcbiAgdGhpcy5zZWN0aW9uU3VtbWFyeUZvY3VzQ2xhc3MgPSAnZ292dWstYWNjb3JkaW9uX19zZWN0aW9uLXN1bW1hcnktZm9jdXMnO1xyXG59XHJcblxyXG4vLyBJbml0aWFsaXplIGNvbXBvbmVudFxyXG5BY2NvcmRpb24ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgLy8gQ2hlY2sgZm9yIG1vZHVsZVxyXG4gIGlmICghdGhpcy4kbW9kdWxlKSB7XHJcbiAgICByZXR1cm5cclxuICB9XHJcblxyXG4gIHRoaXMuaW5pdENvbnRyb2xzKCk7XHJcbiAgdGhpcy5pbml0U2VjdGlvbkhlYWRlcnMoKTtcclxuXHJcbiAgLy8gU2VlIGlmIFwiU2hvdyBhbGwgc2VjdGlvbnNcIiBidXR0b24gdGV4dCBzaG91bGQgYmUgdXBkYXRlZFxyXG4gIHZhciBhcmVBbGxTZWN0aW9uc09wZW4gPSB0aGlzLmNoZWNrSWZBbGxTZWN0aW9uc09wZW4oKTtcclxuICB0aGlzLnVwZGF0ZVNob3dBbGxCdXR0b24oYXJlQWxsU2VjdGlvbnNPcGVuKTtcclxufTtcclxuXHJcbi8vIEluaXRpYWxpc2UgY29udHJvbHMgYW5kIHNldCBhdHRyaWJ1dGVzXHJcbkFjY29yZGlvbi5wcm90b3R5cGUuaW5pdENvbnRyb2xzID0gZnVuY3Rpb24gKCkge1xyXG4gIC8vIENyZWF0ZSBcIlNob3cgYWxsXCIgYnV0dG9uIGFuZCBzZXQgYXR0cmlidXRlc1xyXG4gIHRoaXMuJHNob3dBbGxCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICB0aGlzLiRzaG93QWxsQnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKTtcclxuICB0aGlzLiRzaG93QWxsQnV0dG9uLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCB0aGlzLnNob3dBbGxDbGFzcyk7XHJcbiAgdGhpcy4kc2hvd0FsbEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcclxuXHJcbiAgLy8gQ3JlYXRlIGljb24sIGFkZCB0byBlbGVtZW50XHJcbiAgdmFyICRpY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICRpY29uLmNsYXNzTGlzdC5hZGQodGhpcy51cENoZXZyb25JY29uQ2xhc3MpO1xyXG4gIHRoaXMuJHNob3dBbGxCdXR0b24uYXBwZW5kQ2hpbGQoJGljb24pO1xyXG5cclxuICAvLyBDcmVhdGUgY29udHJvbCB3cmFwcGVyIGFuZCBhZGQgY29udHJvbHMgdG8gaXRcclxuICB2YXIgJGFjY29yZGlvbkNvbnRyb2xzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgJGFjY29yZGlvbkNvbnRyb2xzLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCB0aGlzLmNvbnRyb2xzQ2xhc3MpO1xyXG4gICRhY2NvcmRpb25Db250cm9scy5hcHBlbmRDaGlsZCh0aGlzLiRzaG93QWxsQnV0dG9uKTtcclxuICB0aGlzLiRtb2R1bGUuaW5zZXJ0QmVmb3JlKCRhY2NvcmRpb25Db250cm9scywgdGhpcy4kbW9kdWxlLmZpcnN0Q2hpbGQpO1xyXG5cclxuICAvLyBCdWlsZCBhZGRpdGlvbmFsIHdyYXBwZXIgZm9yIFNob3cgYWxsIHRvZ2dsZSB0ZXh0IGFuZCBwbGFjZSBhZnRlciBpY29uXHJcbiAgdmFyICR3cmFwcGVyc2hvd0FsbFRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgJHdyYXBwZXJzaG93QWxsVGV4dC5jbGFzc0xpc3QuYWRkKHRoaXMuc2hvd0FsbFRleHRDbGFzcyk7XHJcbiAgdGhpcy4kc2hvd0FsbEJ1dHRvbi5hcHBlbmRDaGlsZCgkd3JhcHBlcnNob3dBbGxUZXh0KTtcclxuXHJcbiAgLy8gSGFuZGxlIGNsaWNrIGV2ZW50cyBvbiB0aGUgc2hvdy9oaWRlIGFsbCBidXR0b25cclxuICB0aGlzLiRzaG93QWxsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vblNob3dPckhpZGVBbGxUb2dnbGUuYmluZCh0aGlzKSk7XHJcbn07XHJcblxyXG4vLyBJbml0aWFsaXNlIHNlY3Rpb24gaGVhZGVyc1xyXG5BY2NvcmRpb24ucHJvdG90eXBlLmluaXRTZWN0aW9uSGVhZGVycyA9IGZ1bmN0aW9uICgpIHtcclxuICAvLyBMb29wIHRocm91Z2ggc2VjdGlvbiBoZWFkZXJzXHJcbiAgbm9kZUxpc3RGb3JFYWNoKHRoaXMuJHNlY3Rpb25zLCBmdW5jdGlvbiAoJHNlY3Rpb24sIGkpIHtcclxuICAgIC8vIFNldCBoZWFkZXIgYXR0cmlidXRlc1xyXG4gICAgdmFyICRoZWFkZXIgPSAkc2VjdGlvbi5xdWVyeVNlbGVjdG9yKCcuJyArIHRoaXMuc2VjdGlvbkhlYWRlckNsYXNzKTtcclxuICAgIHRoaXMuY29uc3RydWN0SGVhZGVyTWFya3VwKCRoZWFkZXIsIGkpO1xyXG4gICAgdGhpcy5zZXRFeHBhbmRlZCh0aGlzLmlzRXhwYW5kZWQoJHNlY3Rpb24pLCAkc2VjdGlvbik7XHJcblxyXG4gICAgLy8gSGFuZGxlIGV2ZW50c1xyXG4gICAgJGhlYWRlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25TZWN0aW9uVG9nZ2xlLmJpbmQodGhpcywgJHNlY3Rpb24pKTtcclxuXHJcbiAgICAvLyBTZWUgaWYgdGhlcmUgaXMgYW55IHN0YXRlIHN0b3JlZCBpbiBzZXNzaW9uU3RvcmFnZSBhbmQgc2V0IHRoZSBzZWN0aW9ucyB0b1xyXG4gICAgLy8gb3BlbiBvciBjbG9zZWQuXHJcbiAgICB0aGlzLnNldEluaXRpYWxTdGF0ZSgkc2VjdGlvbik7XHJcbiAgfS5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbkFjY29yZGlvbi5wcm90b3R5cGUuY29uc3RydWN0SGVhZGVyTWFya3VwID0gZnVuY3Rpb24gKCRoZWFkZXJXcmFwcGVyLCBpbmRleCkge1xyXG4gIHZhciAkc3BhbiA9ICRoZWFkZXJXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5zZWN0aW9uQnV0dG9uQ2xhc3MpO1xyXG4gIHZhciAkaGVhZGluZyA9ICRoZWFkZXJXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5zZWN0aW9uSGVhZGluZ0NsYXNzKTtcclxuICB2YXIgJHN1bW1hcnkgPSAkaGVhZGVyV3JhcHBlci5xdWVyeVNlbGVjdG9yKCcuJyArIHRoaXMuc2VjdGlvblN1bW1hcnlDbGFzcyk7XHJcblxyXG4gIC8vIENyZWF0ZSBhIGJ1dHRvbiBlbGVtZW50IHRoYXQgd2lsbCByZXBsYWNlIHRoZSAnLmdvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi1idXR0b24nIHNwYW5cclxuICB2YXIgJGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICRidXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xyXG4gICRidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgdGhpcy4kbW9kdWxlLmlkICsgJy1jb250ZW50LScgKyAoaW5kZXggKyAxKSk7XHJcblxyXG4gIC8vIENvcHkgYWxsIGF0dHJpYnV0ZXMgKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9FbGVtZW50L2F0dHJpYnV0ZXMpIGZyb20gJHNwYW4gdG8gJGJ1dHRvblxyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgJHNwYW4uYXR0cmlidXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgdmFyIGF0dHIgPSAkc3Bhbi5hdHRyaWJ1dGVzLml0ZW0oaSk7XHJcbiAgICAvLyBBZGQgYWxsIGF0dHJpYnV0ZXMgYnV0IG5vdCBJRCBhcyB0aGlzIGlzIGJlaW5nIGFkZGVkIHRvXHJcbiAgICAvLyB0aGUgc2VjdGlvbiBoZWFkaW5nICgkaGVhZGluZ1RleHQpXHJcbiAgICBpZiAoYXR0ci5ub2RlTmFtZSAhPT0gJ2lkJykge1xyXG4gICAgICAkYnV0dG9uLnNldEF0dHJpYnV0ZShhdHRyLm5vZGVOYW1lLCBhdHRyLm5vZGVWYWx1ZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBDcmVhdGUgY29udGFpbmVyIGZvciBoZWFkaW5nIHRleHQgc28gaXQgY2FuIGJlIHN0eWxlZFxyXG4gIHZhciAkaGVhZGluZ1RleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgJGhlYWRpbmdUZXh0LmNsYXNzTGlzdC5hZGQodGhpcy5zZWN0aW9uSGVhZGluZ1RleHRDbGFzcyk7XHJcbiAgLy8gQ29weSB0aGUgc3BhbiBJRCB0byB0aGUgaGVhZGluZyB0ZXh0IHRvIGFsbG93IGl0IHRvIGJlIHJlZmVyZW5jZWQgYnkgYGFyaWEtbGFiZWxsZWRieWAgb24gdGhlXHJcbiAgLy8gaGlkZGVuIGNvbnRlbnQgYXJlYSB3aXRob3V0IFwiU2hvdyB0aGlzIHNlY3Rpb25cIlxyXG4gICRoZWFkaW5nVGV4dC5pZCA9ICRzcGFuLmlkO1xyXG5cclxuICAvLyBDcmVhdGUgYW4gaW5uZXIgaGVhZGluZyB0ZXh0IGNvbnRhaW5lciB0byBsaW1pdCB0aGUgd2lkdGggb2YgdGhlIGZvY3VzIHN0YXRlXHJcbiAgdmFyICRoZWFkaW5nVGV4dEZvY3VzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICRoZWFkaW5nVGV4dEZvY3VzLmNsYXNzTGlzdC5hZGQodGhpcy5zZWN0aW9uSGVhZGluZ1RleHRGb2N1c0NsYXNzKTtcclxuICAkaGVhZGluZ1RleHQuYXBwZW5kQ2hpbGQoJGhlYWRpbmdUZXh0Rm9jdXMpO1xyXG4gIC8vIHNwYW4gY291bGQgY29udGFpbiBIVE1MIGVsZW1lbnRzIChzZWUgaHR0cHM6Ly93d3cudzMub3JnL1RSLzIwMTEvV0QtaHRtbDUtMjAxMTA1MjUvY29udGVudC1tb2RlbHMuaHRtbCNwaHJhc2luZy1jb250ZW50KVxyXG4gICRoZWFkaW5nVGV4dEZvY3VzLmlubmVySFRNTCA9ICRzcGFuLmlubmVySFRNTDtcclxuXHJcbiAgLy8gQ3JlYXRlIGNvbnRhaW5lciBmb3Igc2hvdyAvIGhpZGUgaWNvbnMgYW5kIHRleHQuXHJcbiAgdmFyICRzaG93VG9nZ2xlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICRzaG93VG9nZ2xlLmNsYXNzTGlzdC5hZGQodGhpcy5zZWN0aW9uU2hvd0hpZGVUb2dnbGVDbGFzcyk7XHJcbiAgLy8gVGVsbCBHb29nbGUgbm90IHRvIGluZGV4IHRoZSAnc2hvdycgdGV4dCBhcyBwYXJ0IG9mIHRoZSBoZWFkaW5nXHJcbiAgLy8gRm9yIHRoZSBzbmlwcGV0IHRvIHdvcmsgd2l0aCBKYXZhU2NyaXB0LCBpdCBtdXN0IGJlIGFkZGVkIGJlZm9yZSBhZGRpbmcgdGhlIHBhZ2UgZWxlbWVudCB0byB0aGVcclxuICAvLyBwYWdlJ3MgRE9NLiBTZWUgaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vc2VhcmNoL2RvY3MvYWR2YW5jZWQvcm9ib3RzL3JvYm90c19tZXRhX3RhZyNkYXRhLW5vc25pcHBldC1hdHRyXHJcbiAgJHNob3dUb2dnbGUuc2V0QXR0cmlidXRlKCdkYXRhLW5vc25pcHBldCcsICcnKTtcclxuICAvLyBDcmVhdGUgYW4gaW5uZXIgY29udGFpbmVyIHRvIGxpbWl0IHRoZSB3aWR0aCBvZiB0aGUgZm9jdXMgc3RhdGVcclxuICB2YXIgJHNob3dUb2dnbGVGb2N1cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAkc2hvd1RvZ2dsZUZvY3VzLmNsYXNzTGlzdC5hZGQodGhpcy5zZWN0aW9uU2hvd0hpZGVUb2dnbGVGb2N1c0NsYXNzKTtcclxuICAkc2hvd1RvZ2dsZS5hcHBlbmRDaGlsZCgkc2hvd1RvZ2dsZUZvY3VzKTtcclxuICAvLyBDcmVhdGUgd3JhcHBlciBmb3IgdGhlIHNob3cgLyBoaWRlIHRleHQuIEFwcGVuZCB0ZXh0IGFmdGVyIHRoZSBzaG93L2hpZGUgaWNvblxyXG4gIHZhciAkc2hvd1RvZ2dsZVRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgdmFyICRpY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICRpY29uLmNsYXNzTGlzdC5hZGQodGhpcy51cENoZXZyb25JY29uQ2xhc3MpO1xyXG4gICRzaG93VG9nZ2xlRm9jdXMuYXBwZW5kQ2hpbGQoJGljb24pO1xyXG4gICRzaG93VG9nZ2xlVGV4dC5jbGFzc0xpc3QuYWRkKHRoaXMuc2VjdGlvblNob3dIaWRlVGV4dENsYXNzKTtcclxuICAkc2hvd1RvZ2dsZUZvY3VzLmFwcGVuZENoaWxkKCRzaG93VG9nZ2xlVGV4dCk7XHJcblxyXG4gIC8vIEFwcGVuZCBlbGVtZW50cyB0byB0aGUgYnV0dG9uOlxyXG4gIC8vIDEuIEhlYWRpbmcgdGV4dFxyXG4gIC8vIDIuIFB1bmN0dWF0aW9uXHJcbiAgLy8gMy4gKE9wdGlvbmFsOiBTdW1tYXJ5IGxpbmUgZm9sbG93ZWQgYnkgcHVuY3R1YXRpb24pXHJcbiAgLy8gNC4gU2hvdyAvIGhpZGUgdG9nZ2xlXHJcbiAgJGJ1dHRvbi5hcHBlbmRDaGlsZCgkaGVhZGluZ1RleHQpO1xyXG4gICRidXR0b24uYXBwZW5kQ2hpbGQodGhpcy5nZXRCdXR0b25QdW5jdHVhdGlvbkVsKCkpO1xyXG5cclxuICAvLyBJZiBzdW1tYXJ5IGNvbnRlbnQgZXhpc3RzIGFkZCB0byBET00gaW4gY29ycmVjdCBvcmRlclxyXG4gIGlmICh0eXBlb2YgKCRzdW1tYXJ5KSAhPT0gJ3VuZGVmaW5lZCcgJiYgJHN1bW1hcnkgIT09IG51bGwpIHtcclxuICAgIC8vIENyZWF0ZSBhIG5ldyBgc3BhbmAgZWxlbWVudCBhbmQgY29weSB0aGUgc3VtbWFyeSBsaW5lIGNvbnRlbnQgZnJvbSB0aGUgb3JpZ2luYWwgYGRpdmAgdG8gdGhlXHJcbiAgICAvLyBuZXcgYHNwYW5gXHJcbiAgICAvLyBUaGlzIGlzIGJlY2F1c2UgdGhlIHN1bW1hcnkgbGluZSB0ZXh0IGlzIG5vdyBpbnNpZGUgYSBidXR0b24gZWxlbWVudCwgd2hpY2ggY2FuIG9ubHkgY29udGFpblxyXG4gICAgLy8gcGhyYXNpbmcgY29udGVudFxyXG4gICAgdmFyICRzdW1tYXJ5U3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgIC8vIENyZWF0ZSBhbiBpbm5lciBzdW1tYXJ5IGNvbnRhaW5lciB0byBsaW1pdCB0aGUgd2lkdGggb2YgdGhlIHN1bW1hcnkgZm9jdXMgc3RhdGVcclxuICAgIHZhciAkc3VtbWFyeVNwYW5Gb2N1cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICRzdW1tYXJ5U3BhbkZvY3VzLmNsYXNzTGlzdC5hZGQodGhpcy5zZWN0aW9uU3VtbWFyeUZvY3VzQ2xhc3MpO1xyXG4gICAgJHN1bW1hcnlTcGFuLmFwcGVuZENoaWxkKCRzdW1tYXJ5U3BhbkZvY3VzKTtcclxuXHJcbiAgICAvLyBHZXQgb3JpZ2luYWwgYXR0cmlidXRlcywgYW5kIHBhc3MgdGhlbSB0byB0aGUgcmVwbGFjZW1lbnRcclxuICAgIGZvciAodmFyIGogPSAwLCBsID0gJHN1bW1hcnkuYXR0cmlidXRlcy5sZW5ndGg7IGogPCBsOyArK2opIHtcclxuICAgICAgdmFyIG5vZGVOYW1lID0gJHN1bW1hcnkuYXR0cmlidXRlcy5pdGVtKGopLm5vZGVOYW1lO1xyXG4gICAgICB2YXIgbm9kZVZhbHVlID0gJHN1bW1hcnkuYXR0cmlidXRlcy5pdGVtKGopLm5vZGVWYWx1ZTtcclxuICAgICAgJHN1bW1hcnlTcGFuLnNldEF0dHJpYnV0ZShub2RlTmFtZSwgbm9kZVZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDb3B5IG9yaWdpbmFsIGNvbnRlbnRzIG9mIHN1bW1hcnkgdG8gdGhlIG5ldyBzdW1tYXJ5IHNwYW5cclxuICAgICRzdW1tYXJ5U3BhbkZvY3VzLmlubmVySFRNTCA9ICRzdW1tYXJ5LmlubmVySFRNTDtcclxuXHJcbiAgICAvLyBSZXBsYWNlIHRoZSBvcmlnaW5hbCBzdW1tYXJ5IGBkaXZgIHdpdGggdGhlIG5ldyBzdW1tYXJ5IGBzcGFuYFxyXG4gICAgJHN1bW1hcnkucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoJHN1bW1hcnlTcGFuLCAkc3VtbWFyeSk7XHJcblxyXG4gICAgJGJ1dHRvbi5hcHBlbmRDaGlsZCgkc3VtbWFyeVNwYW4pO1xyXG4gICAgJGJ1dHRvbi5hcHBlbmRDaGlsZCh0aGlzLmdldEJ1dHRvblB1bmN0dWF0aW9uRWwoKSk7XHJcbiAgfVxyXG5cclxuICAkYnV0dG9uLmFwcGVuZENoaWxkKCRzaG93VG9nZ2xlKTtcclxuXHJcbiAgJGhlYWRpbmcucmVtb3ZlQ2hpbGQoJHNwYW4pO1xyXG4gICRoZWFkaW5nLmFwcGVuZENoaWxkKCRidXR0b24pO1xyXG59O1xyXG5cclxuLy8gV2hlbiBzZWN0aW9uIHRvZ2dsZWQsIHNldCBhbmQgc3RvcmUgc3RhdGVcclxuQWNjb3JkaW9uLnByb3RvdHlwZS5vblNlY3Rpb25Ub2dnbGUgPSBmdW5jdGlvbiAoJHNlY3Rpb24pIHtcclxuICB2YXIgZXhwYW5kZWQgPSB0aGlzLmlzRXhwYW5kZWQoJHNlY3Rpb24pO1xyXG4gIHRoaXMuc2V0RXhwYW5kZWQoIWV4cGFuZGVkLCAkc2VjdGlvbik7XHJcblxyXG4gIC8vIFN0b3JlIHRoZSBzdGF0ZSBpbiBzZXNzaW9uU3RvcmFnZSB3aGVuIGEgY2hhbmdlIGlzIHRyaWdnZXJlZFxyXG4gIHRoaXMuc3RvcmVTdGF0ZSgkc2VjdGlvbik7XHJcbn07XHJcblxyXG4vLyBXaGVuIE9wZW4vQ2xvc2UgQWxsIHRvZ2dsZWQsIHNldCBhbmQgc3RvcmUgc3RhdGVcclxuQWNjb3JkaW9uLnByb3RvdHlwZS5vblNob3dPckhpZGVBbGxUb2dnbGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICRtb2R1bGUgPSB0aGlzO1xyXG4gIHZhciAkc2VjdGlvbnMgPSB0aGlzLiRzZWN0aW9ucztcclxuICB2YXIgbm93RXhwYW5kZWQgPSAhdGhpcy5jaGVja0lmQWxsU2VjdGlvbnNPcGVuKCk7XHJcblxyXG4gIG5vZGVMaXN0Rm9yRWFjaCgkc2VjdGlvbnMsIGZ1bmN0aW9uICgkc2VjdGlvbikge1xyXG4gICAgJG1vZHVsZS5zZXRFeHBhbmRlZChub3dFeHBhbmRlZCwgJHNlY3Rpb24pO1xyXG4gICAgLy8gU3RvcmUgdGhlIHN0YXRlIGluIHNlc3Npb25TdG9yYWdlIHdoZW4gYSBjaGFuZ2UgaXMgdHJpZ2dlcmVkXHJcbiAgICAkbW9kdWxlLnN0b3JlU3RhdGUoJHNlY3Rpb24pO1xyXG4gIH0pO1xyXG5cclxuICAkbW9kdWxlLnVwZGF0ZVNob3dBbGxCdXR0b24obm93RXhwYW5kZWQpO1xyXG59O1xyXG5cclxuLy8gU2V0IHNlY3Rpb24gYXR0cmlidXRlcyB3aGVuIG9wZW5lZC9jbG9zZWRcclxuQWNjb3JkaW9uLnByb3RvdHlwZS5zZXRFeHBhbmRlZCA9IGZ1bmN0aW9uIChleHBhbmRlZCwgJHNlY3Rpb24pIHtcclxuICB2YXIgJGljb24gPSAkc2VjdGlvbi5xdWVyeVNlbGVjdG9yKCcuJyArIHRoaXMudXBDaGV2cm9uSWNvbkNsYXNzKTtcclxuICB2YXIgJHNob3dIaWRlVGV4dCA9ICRzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5zZWN0aW9uU2hvd0hpZGVUZXh0Q2xhc3MpO1xyXG4gIHZhciAkYnV0dG9uID0gJHNlY3Rpb24ucXVlcnlTZWxlY3RvcignLicgKyB0aGlzLnNlY3Rpb25CdXR0b25DbGFzcyk7XHJcbiAgdmFyIG5ld0J1dHRvblRleHQgPSBleHBhbmRlZFxyXG4gICAgPyB0aGlzLmkxOG4udCgnaGlkZVNlY3Rpb24nKVxyXG4gICAgOiB0aGlzLmkxOG4udCgnc2hvd1NlY3Rpb24nKTtcclxuXHJcbiAgJHNob3dIaWRlVGV4dC5pbm5lclRleHQgPSBuZXdCdXR0b25UZXh0O1xyXG4gICRidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgZXhwYW5kZWQpO1xyXG5cclxuICAvLyBVcGRhdGUgYXJpYS1sYWJlbCBjb21iaW5pbmdcclxuICB2YXIgJGhlYWRlciA9ICRzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5zZWN0aW9uSGVhZGluZ1RleHRDbGFzcyk7XHJcbiAgdmFyIGFyaWFMYWJlbFBhcnRzID0gWyRoZWFkZXIuaW5uZXJUZXh0LnRyaW0oKV07XHJcblxyXG4gIHZhciAkc3VtbWFyeSA9ICRzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5zZWN0aW9uU3VtbWFyeUNsYXNzKTtcclxuICBpZiAoJHN1bW1hcnkpIHtcclxuICAgIGFyaWFMYWJlbFBhcnRzLnB1c2goJHN1bW1hcnkuaW5uZXJUZXh0LnRyaW0oKSk7XHJcbiAgfVxyXG5cclxuICB2YXIgYXJpYUxhYmVsTWVzc2FnZSA9IGV4cGFuZGVkXHJcbiAgICA/IHRoaXMuaTE4bi50KCdoaWRlU2VjdGlvbkFyaWFMYWJlbCcpXHJcbiAgICA6IHRoaXMuaTE4bi50KCdzaG93U2VjdGlvbkFyaWFMYWJlbCcpO1xyXG4gIGFyaWFMYWJlbFBhcnRzLnB1c2goYXJpYUxhYmVsTWVzc2FnZSk7XHJcblxyXG4gIC8qXHJcbiAgICogSm9pbiB3aXRoIGEgY29tbWEgdG8gYWRkIHBhdXNlIGZvciBhc3Npc3RpdmUgdGVjaG5vbG9neS5cclxuICAgKiBFeGFtcGxlOiBbaGVhZGluZ11TZWN0aW9uIEEgLFtwYXVzZV0gU2hvdyB0aGlzIHNlY3Rpb24uXHJcbiAgICogaHR0cHM6Ly9hY2Nlc3NpYmlsaXR5LmJsb2cuZ292LnVrLzIwMTcvMTIvMTgvd2hhdC13b3JraW5nLW9uLWdvdi11ay1uYXZpZ2F0aW9uLXRhdWdodC11cy1hYm91dC1hY2Nlc3NpYmlsaXR5L1xyXG4gICAqL1xyXG4gICRidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgYXJpYUxhYmVsUGFydHMuam9pbignICwgJykpO1xyXG5cclxuICAvLyBTd2FwIGljb24sIGNoYW5nZSBjbGFzc1xyXG4gIGlmIChleHBhbmRlZCkge1xyXG4gICAgJHNlY3Rpb24uY2xhc3NMaXN0LmFkZCh0aGlzLnNlY3Rpb25FeHBhbmRlZENsYXNzKTtcclxuICAgICRpY29uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5kb3duQ2hldnJvbkljb25DbGFzcyk7XHJcbiAgfSBlbHNlIHtcclxuICAgICRzZWN0aW9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5zZWN0aW9uRXhwYW5kZWRDbGFzcyk7XHJcbiAgICAkaWNvbi5jbGFzc0xpc3QuYWRkKHRoaXMuZG93bkNoZXZyb25JY29uQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgLy8gU2VlIGlmIFwiU2hvdyBhbGwgc2VjdGlvbnNcIiBidXR0b24gdGV4dCBzaG91bGQgYmUgdXBkYXRlZFxyXG4gIHZhciBhcmVBbGxTZWN0aW9uc09wZW4gPSB0aGlzLmNoZWNrSWZBbGxTZWN0aW9uc09wZW4oKTtcclxuICB0aGlzLnVwZGF0ZVNob3dBbGxCdXR0b24oYXJlQWxsU2VjdGlvbnNPcGVuKTtcclxufTtcclxuXHJcbi8vIEdldCBzdGF0ZSBvZiBzZWN0aW9uXHJcbkFjY29yZGlvbi5wcm90b3R5cGUuaXNFeHBhbmRlZCA9IGZ1bmN0aW9uICgkc2VjdGlvbikge1xyXG4gIHJldHVybiAkc2VjdGlvbi5jbGFzc0xpc3QuY29udGFpbnModGhpcy5zZWN0aW9uRXhwYW5kZWRDbGFzcylcclxufTtcclxuXHJcbi8vIENoZWNrIGlmIGFsbCBzZWN0aW9ucyBhcmUgb3BlblxyXG5BY2NvcmRpb24ucHJvdG90eXBlLmNoZWNrSWZBbGxTZWN0aW9uc09wZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgLy8gR2V0IGEgY291bnQgb2YgYWxsIHRoZSBBY2NvcmRpb24gc2VjdGlvbnNcclxuICB2YXIgc2VjdGlvbnNDb3VudCA9IHRoaXMuJHNlY3Rpb25zLmxlbmd0aDtcclxuICAvLyBHZXQgYSBjb3VudCBvZiBhbGwgQWNjb3JkaW9uIHNlY3Rpb25zIHRoYXQgYXJlIGV4cGFuZGVkXHJcbiAgdmFyIGV4cGFuZGVkU2VjdGlvbkNvdW50ID0gdGhpcy4kbW9kdWxlLnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgdGhpcy5zZWN0aW9uRXhwYW5kZWRDbGFzcykubGVuZ3RoO1xyXG4gIHZhciBhcmVBbGxTZWN0aW9uc09wZW4gPSBzZWN0aW9uc0NvdW50ID09PSBleHBhbmRlZFNlY3Rpb25Db3VudDtcclxuXHJcbiAgcmV0dXJuIGFyZUFsbFNlY3Rpb25zT3BlblxyXG59O1xyXG5cclxuLy8gVXBkYXRlIFwiU2hvdyBhbGwgc2VjdGlvbnNcIiBidXR0b25cclxuQWNjb3JkaW9uLnByb3RvdHlwZS51cGRhdGVTaG93QWxsQnV0dG9uID0gZnVuY3Rpb24gKGV4cGFuZGVkKSB7XHJcbiAgdmFyICRzaG93QWxsSWNvbiA9IHRoaXMuJHNob3dBbGxCdXR0b24ucXVlcnlTZWxlY3RvcignLicgKyB0aGlzLnVwQ2hldnJvbkljb25DbGFzcyk7XHJcbiAgdmFyICRzaG93QWxsVGV4dCA9IHRoaXMuJHNob3dBbGxCdXR0b24ucXVlcnlTZWxlY3RvcignLicgKyB0aGlzLnNob3dBbGxUZXh0Q2xhc3MpO1xyXG4gIHZhciBuZXdCdXR0b25UZXh0ID0gZXhwYW5kZWRcclxuICAgID8gdGhpcy5pMThuLnQoJ2hpZGVBbGxTZWN0aW9ucycpXHJcbiAgICA6IHRoaXMuaTE4bi50KCdzaG93QWxsU2VjdGlvbnMnKTtcclxuICB0aGlzLiRzaG93QWxsQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIGV4cGFuZGVkKTtcclxuICAkc2hvd0FsbFRleHQuaW5uZXJUZXh0ID0gbmV3QnV0dG9uVGV4dDtcclxuXHJcbiAgLy8gU3dhcCBpY29uLCB0b2dnbGUgY2xhc3NcclxuICBpZiAoZXhwYW5kZWQpIHtcclxuICAgICRzaG93QWxsSWNvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuZG93bkNoZXZyb25JY29uQ2xhc3MpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAkc2hvd0FsbEljb24uY2xhc3NMaXN0LmFkZCh0aGlzLmRvd25DaGV2cm9uSWNvbkNsYXNzKTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBDaGVjayBmb3IgYHdpbmRvdy5zZXNzaW9uU3RvcmFnZWAsIGFuZCB0aGF0IGl0IGFjdHVhbGx5IHdvcmtzLlxyXG52YXIgaGVscGVyID0ge1xyXG4gIGNoZWNrRm9yU2Vzc2lvblN0b3JhZ2U6IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciB0ZXN0U3RyaW5nID0gJ3RoaXMgaXMgdGhlIHRlc3Qgc3RyaW5nJztcclxuICAgIHZhciByZXN1bHQ7XHJcbiAgICB0cnkge1xyXG4gICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSh0ZXN0U3RyaW5nLCB0ZXN0U3RyaW5nKTtcclxuICAgICAgcmVzdWx0ID0gd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0odGVzdFN0cmluZykgPT09IHRlc3RTdHJpbmcudG9TdHJpbmcoKTtcclxuICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0odGVzdFN0cmluZyk7XHJcbiAgICAgIHJldHVybiByZXN1bHRcclxuICAgIH0gY2F0Y2ggKGV4Y2VwdGlvbikge1xyXG4gICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG4vLyBTZXQgdGhlIHN0YXRlIG9mIHRoZSBhY2NvcmRpb25zIGluIHNlc3Npb25TdG9yYWdlXHJcbkFjY29yZGlvbi5wcm90b3R5cGUuc3RvcmVTdGF0ZSA9IGZ1bmN0aW9uICgkc2VjdGlvbikge1xyXG4gIGlmICh0aGlzLmJyb3dzZXJTdXBwb3J0c1Nlc3Npb25TdG9yYWdlKSB7XHJcbiAgICAvLyBXZSBuZWVkIGEgdW5pcXVlIHdheSBvZiBpZGVudGlmeWluZyBlYWNoIGNvbnRlbnQgaW4gdGhlIEFjY29yZGlvbi4gU2luY2VcclxuICAgIC8vIGFuIGAjaWRgIHNob3VsZCBiZSB1bmlxdWUgYW5kIGFuIGBpZGAgaXMgcmVxdWlyZWQgZm9yIGBhcmlhLWAgYXR0cmlidXRlc1xyXG4gICAgLy8gYGlkYCBjYW4gYmUgc2FmZWx5IHVzZWQuXHJcbiAgICB2YXIgJGJ1dHRvbiA9ICRzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5zZWN0aW9uQnV0dG9uQ2xhc3MpO1xyXG5cclxuICAgIGlmICgkYnV0dG9uKSB7XHJcbiAgICAgIHZhciBjb250ZW50SWQgPSAkYnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycpO1xyXG4gICAgICB2YXIgY29udGVudFN0YXRlID0gJGJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnKTtcclxuXHJcbiAgICAgIC8vIE9ubHkgc2V0IHRoZSBzdGF0ZSB3aGVuIGJvdGggYGNvbnRlbnRJZGAgYW5kIGBjb250ZW50U3RhdGVgIGFyZSB0YWtlbiBmcm9tIHRoZSBET00uXHJcbiAgICAgIGlmIChjb250ZW50SWQgJiYgY29udGVudFN0YXRlKSB7XHJcbiAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnNldEl0ZW0oY29udGVudElkLCBjb250ZW50U3RhdGUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gUmVhZCB0aGUgc3RhdGUgb2YgdGhlIGFjY29yZGlvbnMgZnJvbSBzZXNzaW9uU3RvcmFnZVxyXG5BY2NvcmRpb24ucHJvdG90eXBlLnNldEluaXRpYWxTdGF0ZSA9IGZ1bmN0aW9uICgkc2VjdGlvbikge1xyXG4gIGlmICh0aGlzLmJyb3dzZXJTdXBwb3J0c1Nlc3Npb25TdG9yYWdlKSB7XHJcbiAgICB2YXIgJGJ1dHRvbiA9ICRzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5zZWN0aW9uQnV0dG9uQ2xhc3MpO1xyXG5cclxuICAgIGlmICgkYnV0dG9uKSB7XHJcbiAgICAgIHZhciBjb250ZW50SWQgPSAkYnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycpO1xyXG4gICAgICB2YXIgY29udGVudFN0YXRlID0gY29udGVudElkID8gd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oY29udGVudElkKSA6IG51bGw7XHJcblxyXG4gICAgICBpZiAoY29udGVudFN0YXRlICE9PSBudWxsKSB7XHJcbiAgICAgICAgdGhpcy5zZXRFeHBhbmRlZChjb250ZW50U3RhdGUgPT09ICd0cnVlJywgJHNlY3Rpb24pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhbiBlbGVtZW50IHRvIGltcHJvdmUgc2VtYW50aWNzIG9mIHRoZSBzZWN0aW9uIGJ1dHRvbiB3aXRoIHB1bmN0dWF0aW9uXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtIVE1MU3BhbkVsZW1lbnR9IERPTSBlbGVtZW50XHJcbiAqXHJcbiAqIEFkZGluZyBwdW5jdHVhdGlvbiB0byB0aGUgYnV0dG9uIGNhbiBhbHNvIGltcHJvdmUgaXRzIGdlbmVyYWwgc2VtYW50aWNzIGJ5IGRpdmlkaW5nIGl0cyBjb250ZW50c1xyXG4gKiBpbnRvIHRoZW1hdGljIGNodW5rcy5cclxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9hbHBoYWdvdi9nb3Z1ay1mcm9udGVuZC9pc3N1ZXMvMjMyNyNpc3N1ZWNvbW1lbnQtOTIyOTU3NDQyXHJcbiAqL1xyXG5BY2NvcmRpb24ucHJvdG90eXBlLmdldEJ1dHRvblB1bmN0dWF0aW9uRWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICRwdW5jdHVhdGlvbkVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICRwdW5jdHVhdGlvbkVsLmNsYXNzTGlzdC5hZGQoJ2dvdnVrLXZpc3VhbGx5LWhpZGRlbicsICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24taGVhZGluZy1kaXZpZGVyJyk7XHJcbiAgJHB1bmN0dWF0aW9uRWwuaW5uZXJIVE1MID0gJywgJztcclxuICByZXR1cm4gJHB1bmN0dWF0aW9uRWxcclxufTtcclxuXHJcbi8qKlxyXG4gKiBBY2NvcmRpb24gY29uZmlnXHJcbiAqXHJcbiAqIEB0eXBlZGVmIHtvYmplY3R9IEFjY29yZGlvbkNvbmZpZ1xyXG4gKiBAcHJvcGVydHkge0FjY29yZGlvblRyYW5zbGF0aW9uc30gW2kxOG4gPSBBQ0NPUkRJT05fVFJBTlNMQVRJT05TXSAtIFNlZSBjb25zdGFudCB7QGxpbmsgQUNDT1JESU9OX1RSQU5TTEFUSU9OU31cclxuICovXHJcblxyXG4vKipcclxuICogQWNjb3JkaW9uIHRyYW5zbGF0aW9uc1xyXG4gKlxyXG4gKiBAdHlwZWRlZiB7b2JqZWN0fSBBY2NvcmRpb25UcmFuc2xhdGlvbnNcclxuICpcclxuICogTWVzc2FnZXMgdXNlZCBieSB0aGUgY29tcG9uZW50IGZvciB0aGUgbGFiZWxzIG9mIGl0cyBidXR0b25zLiBUaGlzIGluY2x1ZGVzXHJcbiAqIHRoZSB2aXNpYmxlIHRleHQgc2hvd24gb24gc2NyZWVuLCBhbmQgdGV4dCB0byBoZWxwIGFzc2lzdGl2ZSB0ZWNobm9sb2d5IHVzZXJzXHJcbiAqIGZvciB0aGUgYnV0dG9ucyB0b2dnbGluZyBlYWNoIHNlY3Rpb24uXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbaGlkZUFsbFNlY3Rpb25zXSAtIFRoZSB0ZXh0IGNvbnRlbnQgZm9yIHRoZSAnSGlkZSBhbGxcclxuICogc2VjdGlvbnMnIGJ1dHRvbiwgdXNlZCB3aGVuIGF0IGxlYXN0IG9uZSBzZWN0aW9uIGlzIGV4cGFuZGVkLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2hpZGVTZWN0aW9uXSAtIFRoZSB0ZXh0IGNvbnRlbnQgZm9yIHRoZSAnSGlkZSdcclxuICogYnV0dG9uLCB1c2VkIHdoZW4gYSBzZWN0aW9uIGlzIGV4cGFuZGVkLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW2hpZGVTZWN0aW9uQXJpYUxhYmVsXSAtIFRoZSB0ZXh0IGNvbnRlbnQgYXBwZW5kZWQgdG8gdGhlXHJcbiAqICdIaWRlJyBidXR0b24ncyBhY2Nlc3NpYmxlIG5hbWUgd2hlbiBhIHNlY3Rpb24gaXMgZXhwYW5kZWQuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbc2hvd0FsbFNlY3Rpb25zXSAtIFRoZSB0ZXh0IGNvbnRlbnQgZm9yIHRoZSAnU2hvdyBhbGxcclxuICogc2VjdGlvbnMnIGJ1dHRvbiwgdXNlZCB3aGVuIGFsbCBzZWN0aW9ucyBhcmUgY29sbGFwc2VkLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW3Nob3dTZWN0aW9uXSAtIFRoZSB0ZXh0IGNvbnRlbnQgZm9yIHRoZSAnU2hvdydcclxuICogYnV0dG9uLCB1c2VkIHdoZW4gYSBzZWN0aW9uIGlzIGNvbGxhcHNlZC5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IFtzaG93U2VjdGlvbkFyaWFMYWJlbF0gLSBUaGUgdGV4dCBjb250ZW50IGFwcGVuZGVkIHRvIHRoZVxyXG4gKiAnU2hvdycgYnV0dG9uJ3MgYWNjZXNzaWJsZSBuYW1lIHdoZW4gYSBzZWN0aW9uIGlzIGV4cGFuZGVkLlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbih1bmRlZmluZWQpIHtcclxuXHJcbi8vIERldGVjdGlvbiBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtc2VydmljZS9ibG9iL21hc3Rlci9wYWNrYWdlcy9wb2x5ZmlsbC1saWJyYXJ5L3BvbHlmaWxscy9XaW5kb3cvZGV0ZWN0LmpzXHJcbnZhciBkZXRlY3QgPSAoJ1dpbmRvdycgaW4gdGhpcyk7XHJcblxyXG5pZiAoZGV0ZWN0KSByZXR1cm5cclxuXHJcbi8vIFBvbHlmaWxsIGZyb20gaHR0cHM6Ly9jZG4ucG9seWZpbGwuaW8vdjIvcG9seWZpbGwuanM/ZmVhdHVyZXM9V2luZG93JmZsYWdzPWFsd2F5c1xyXG5pZiAoKHR5cGVvZiBXb3JrZXJHbG9iYWxTY29wZSA9PT0gXCJ1bmRlZmluZWRcIikgJiYgKHR5cGVvZiBpbXBvcnRTY3JpcHRzICE9PSBcImZ1bmN0aW9uXCIpKSB7XHJcblx0KGZ1bmN0aW9uIChnbG9iYWwpIHtcclxuXHRcdGlmIChnbG9iYWwuY29uc3RydWN0b3IpIHtcclxuXHRcdFx0Z2xvYmFsLldpbmRvdyA9IGdsb2JhbC5jb25zdHJ1Y3RvcjtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdChnbG9iYWwuV2luZG93ID0gZ2xvYmFsLmNvbnN0cnVjdG9yID0gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gZnVuY3Rpb24gV2luZG93KCkge30nKSgpKS5wcm90b3R5cGUgPSB0aGlzO1xyXG5cdFx0fVxyXG5cdH0odGhpcykpO1xyXG59XHJcblxyXG59KVxyXG4uY2FsbCgnb2JqZWN0JyA9PT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBzZWxmICYmIHNlbGYgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBnbG9iYWwgJiYgZ2xvYmFsIHx8IHt9KTtcclxuXHJcbihmdW5jdGlvbih1bmRlZmluZWQpIHtcclxuXHJcbi8vIERldGVjdGlvbiBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtc2VydmljZS9ibG9iL21hc3Rlci9wYWNrYWdlcy9wb2x5ZmlsbC1saWJyYXJ5L3BvbHlmaWxscy9FdmVudC9kZXRlY3QuanNcclxudmFyIGRldGVjdCA9IChcclxuICAoZnVuY3Rpb24oZ2xvYmFsKSB7XHJcblxyXG4gIFx0aWYgKCEoJ0V2ZW50JyBpbiBnbG9iYWwpKSByZXR1cm4gZmFsc2U7XHJcbiAgXHRpZiAodHlwZW9mIGdsb2JhbC5FdmVudCA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIHRydWU7XHJcblxyXG4gIFx0dHJ5IHtcclxuXHJcbiAgXHRcdC8vIEluIElFIDktMTEsIHRoZSBFdmVudCBvYmplY3QgZXhpc3RzIGJ1dCBjYW5ub3QgYmUgaW5zdGFudGlhdGVkXHJcbiAgXHRcdG5ldyBFdmVudCgnY2xpY2snKTtcclxuICBcdFx0cmV0dXJuIHRydWU7XHJcbiAgXHR9IGNhdGNoKGUpIHtcclxuICBcdFx0cmV0dXJuIGZhbHNlO1xyXG4gIFx0fVxyXG4gIH0odGhpcykpXHJcbik7XHJcblxyXG5pZiAoZGV0ZWN0KSByZXR1cm5cclxuXHJcbi8vIFBvbHlmaWxsIGZyb20gaHR0cHM6Ly9jZG4ucG9seWZpbGwuaW8vdjIvcG9seWZpbGwuanM/ZmVhdHVyZXM9RXZlbnQmZmxhZ3M9YWx3YXlzXHJcbihmdW5jdGlvbiAoKSB7XHJcblx0dmFyIHVubGlzdGVuYWJsZVdpbmRvd0V2ZW50cyA9IHtcclxuXHRcdGNsaWNrOiAxLFxyXG5cdFx0ZGJsY2xpY2s6IDEsXHJcblx0XHRrZXl1cDogMSxcclxuXHRcdGtleXByZXNzOiAxLFxyXG5cdFx0a2V5ZG93bjogMSxcclxuXHRcdG1vdXNlZG93bjogMSxcclxuXHRcdG1vdXNldXA6IDEsXHJcblx0XHRtb3VzZW1vdmU6IDEsXHJcblx0XHRtb3VzZW92ZXI6IDEsXHJcblx0XHRtb3VzZWVudGVyOiAxLFxyXG5cdFx0bW91c2VsZWF2ZTogMSxcclxuXHRcdG1vdXNlb3V0OiAxLFxyXG5cdFx0c3RvcmFnZTogMSxcclxuXHRcdHN0b3JhZ2Vjb21taXQ6IDEsXHJcblx0XHR0ZXh0aW5wdXQ6IDFcclxuXHR9O1xyXG5cclxuXHQvLyBUaGlzIHBvbHlmaWxsIGRlcGVuZHMgb24gYXZhaWxhYmlsaXR5IG9mIGBkb2N1bWVudGAgc28gd2lsbCBub3QgcnVuIGluIGEgd29ya2VyXHJcblx0Ly8gSG93ZXZlciwgd2UgYXNzc3VtZSB0aGVyZSBhcmUgbm8gYnJvd3NlcnMgd2l0aCB3b3JrZXIgc3VwcG9ydCB0aGF0IGxhY2sgcHJvcGVyXHJcblx0Ly8gc3VwcG9ydCBmb3IgYEV2ZW50YCB3aXRoaW4gdGhlIHdvcmtlclxyXG5cdGlmICh0eXBlb2YgZG9jdW1lbnQgPT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSByZXR1cm47XHJcblxyXG5cdGZ1bmN0aW9uIGluZGV4T2YoYXJyYXksIGVsZW1lbnQpIHtcclxuXHRcdHZhclxyXG5cdFx0aW5kZXggPSAtMSxcclxuXHRcdGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcclxuXHJcblx0XHR3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xyXG5cdFx0XHRpZiAoaW5kZXggaW4gYXJyYXkgJiYgYXJyYXlbaW5kZXhdID09PSBlbGVtZW50KSB7XHJcblx0XHRcdFx0cmV0dXJuIGluZGV4O1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIC0xO1xyXG5cdH1cclxuXHJcblx0dmFyIGV4aXN0aW5nUHJvdG8gPSAod2luZG93LkV2ZW50ICYmIHdpbmRvdy5FdmVudC5wcm90b3R5cGUpIHx8IG51bGw7XHJcblx0d2luZG93LkV2ZW50ID0gV2luZG93LnByb3RvdHlwZS5FdmVudCA9IGZ1bmN0aW9uIEV2ZW50KHR5cGUsIGV2ZW50SW5pdERpY3QpIHtcclxuXHRcdGlmICghdHlwZSkge1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdCBlbm91Z2ggYXJndW1lbnRzJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIGV2ZW50O1xyXG5cdFx0Ly8gU2hvcnRjdXQgaWYgYnJvd3NlciBzdXBwb3J0cyBjcmVhdGVFdmVudFxyXG5cdFx0aWYgKCdjcmVhdGVFdmVudCcgaW4gZG9jdW1lbnQpIHtcclxuXHRcdFx0ZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnQnKTtcclxuXHRcdFx0dmFyIGJ1YmJsZXMgPSBldmVudEluaXREaWN0ICYmIGV2ZW50SW5pdERpY3QuYnViYmxlcyAhPT0gdW5kZWZpbmVkID8gZXZlbnRJbml0RGljdC5idWJibGVzIDogZmFsc2U7XHJcblx0XHRcdHZhciBjYW5jZWxhYmxlID0gZXZlbnRJbml0RGljdCAmJiBldmVudEluaXREaWN0LmNhbmNlbGFibGUgIT09IHVuZGVmaW5lZCA/IGV2ZW50SW5pdERpY3QuY2FuY2VsYWJsZSA6IGZhbHNlO1xyXG5cclxuXHRcdFx0ZXZlbnQuaW5pdEV2ZW50KHR5cGUsIGJ1YmJsZXMsIGNhbmNlbGFibGUpO1xyXG5cclxuXHRcdFx0cmV0dXJuIGV2ZW50O1xyXG5cdFx0fVxyXG5cclxuXHRcdGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QoKTtcclxuXHJcblx0XHRldmVudC50eXBlID0gdHlwZTtcclxuXHRcdGV2ZW50LmJ1YmJsZXMgPSBldmVudEluaXREaWN0ICYmIGV2ZW50SW5pdERpY3QuYnViYmxlcyAhPT0gdW5kZWZpbmVkID8gZXZlbnRJbml0RGljdC5idWJibGVzIDogZmFsc2U7XHJcblx0XHRldmVudC5jYW5jZWxhYmxlID0gZXZlbnRJbml0RGljdCAmJiBldmVudEluaXREaWN0LmNhbmNlbGFibGUgIT09IHVuZGVmaW5lZCA/IGV2ZW50SW5pdERpY3QuY2FuY2VsYWJsZSA6IGZhbHNlO1xyXG5cclxuXHRcdHJldHVybiBldmVudDtcclxuXHR9O1xyXG5cdGlmIChleGlzdGluZ1Byb3RvKSB7XHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LkV2ZW50LCAncHJvdG90eXBlJywge1xyXG5cdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxyXG5cdFx0XHRlbnVtZXJhYmxlOiBmYWxzZSxcclxuXHRcdFx0d3JpdGFibGU6IHRydWUsXHJcblx0XHRcdHZhbHVlOiBleGlzdGluZ1Byb3RvXHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdGlmICghKCdjcmVhdGVFdmVudCcgaW4gZG9jdW1lbnQpKSB7XHJcblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciA9IFdpbmRvdy5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IERvY3VtZW50LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gRWxlbWVudC5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIoKSB7XHJcblx0XHRcdHZhclxyXG5cdFx0XHRlbGVtZW50ID0gdGhpcyxcclxuXHRcdFx0dHlwZSA9IGFyZ3VtZW50c1swXSxcclxuXHRcdFx0bGlzdGVuZXIgPSBhcmd1bWVudHNbMV07XHJcblxyXG5cdFx0XHRpZiAoZWxlbWVudCA9PT0gd2luZG93ICYmIHR5cGUgaW4gdW5saXN0ZW5hYmxlV2luZG93RXZlbnRzKSB7XHJcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdJbiBJRTggdGhlIGV2ZW50OiAnICsgdHlwZSArICcgaXMgbm90IGF2YWlsYWJsZSBvbiB0aGUgd2luZG93IG9iamVjdC4gUGxlYXNlIHNlZSBodHRwczovL2dpdGh1Yi5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLXNlcnZpY2UvaXNzdWVzLzMxNyBmb3IgbW9yZSBpbmZvcm1hdGlvbi4nKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCFlbGVtZW50Ll9ldmVudHMpIHtcclxuXHRcdFx0XHRlbGVtZW50Ll9ldmVudHMgPSB7fTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCFlbGVtZW50Ll9ldmVudHNbdHlwZV0pIHtcclxuXHRcdFx0XHRlbGVtZW50Ll9ldmVudHNbdHlwZV0gPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHRcdFx0XHRcdHZhclxyXG5cdFx0XHRcdFx0bGlzdCA9IGVsZW1lbnQuX2V2ZW50c1tldmVudC50eXBlXS5saXN0LFxyXG5cdFx0XHRcdFx0ZXZlbnRzID0gbGlzdC5zbGljZSgpLFxyXG5cdFx0XHRcdFx0aW5kZXggPSAtMSxcclxuXHRcdFx0XHRcdGxlbmd0aCA9IGV2ZW50cy5sZW5ndGgsXHJcblx0XHRcdFx0XHRldmVudEVsZW1lbnQ7XHJcblxyXG5cdFx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQgPSBmdW5jdGlvbiBwcmV2ZW50RGVmYXVsdCgpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGV2ZW50LmNhbmNlbGFibGUgIT09IGZhbHNlKSB7XHJcblx0XHRcdFx0XHRcdFx0ZXZlbnQucmV0dXJuVmFsdWUgPSBmYWxzZTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fTtcclxuXHJcblx0XHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24gPSBmdW5jdGlvbiBzdG9wUHJvcGFnYXRpb24oKSB7XHJcblx0XHRcdFx0XHRcdGV2ZW50LmNhbmNlbEJ1YmJsZSA9IHRydWU7XHJcblx0XHRcdFx0XHR9O1xyXG5cclxuXHRcdFx0XHRcdGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiA9IGZ1bmN0aW9uIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0ZXZlbnQuY2FuY2VsQnViYmxlID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0ZXZlbnQuY2FuY2VsSW1tZWRpYXRlID0gdHJ1ZTtcclxuXHRcdFx0XHRcdH07XHJcblxyXG5cdFx0XHRcdFx0ZXZlbnQuY3VycmVudFRhcmdldCA9IGVsZW1lbnQ7XHJcblx0XHRcdFx0XHRldmVudC5yZWxhdGVkVGFyZ2V0ID0gZXZlbnQuZnJvbUVsZW1lbnQgfHwgbnVsbDtcclxuXHRcdFx0XHRcdGV2ZW50LnRhcmdldCA9IGV2ZW50LnRhcmdldCB8fCBldmVudC5zcmNFbGVtZW50IHx8IGVsZW1lbnQ7XHJcblx0XHRcdFx0XHRldmVudC50aW1lU3RhbXAgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoZXZlbnQuY2xpZW50WCkge1xyXG5cdFx0XHRcdFx0XHRldmVudC5wYWdlWCA9IGV2ZW50LmNsaWVudFggKyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdDtcclxuXHRcdFx0XHRcdFx0ZXZlbnQucGFnZVkgPSBldmVudC5jbGllbnRZICsgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHR3aGlsZSAoKytpbmRleCA8IGxlbmd0aCAmJiAhZXZlbnQuY2FuY2VsSW1tZWRpYXRlKSB7XHJcblx0XHRcdFx0XHRcdGlmIChpbmRleCBpbiBldmVudHMpIHtcclxuXHRcdFx0XHRcdFx0XHRldmVudEVsZW1lbnQgPSBldmVudHNbaW5kZXhdO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRpZiAoaW5kZXhPZihsaXN0LCBldmVudEVsZW1lbnQpICE9PSAtMSAmJiB0eXBlb2YgZXZlbnRFbGVtZW50ID09PSAnZnVuY3Rpb24nKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRldmVudEVsZW1lbnQuY2FsbChlbGVtZW50LCBldmVudCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fTtcclxuXHJcblx0XHRcdFx0ZWxlbWVudC5fZXZlbnRzW3R5cGVdLmxpc3QgPSBbXTtcclxuXHJcblx0XHRcdFx0aWYgKGVsZW1lbnQuYXR0YWNoRXZlbnQpIHtcclxuXHRcdFx0XHRcdGVsZW1lbnQuYXR0YWNoRXZlbnQoJ29uJyArIHR5cGUsIGVsZW1lbnQuX2V2ZW50c1t0eXBlXSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRlbGVtZW50Ll9ldmVudHNbdHlwZV0ubGlzdC5wdXNoKGxpc3RlbmVyKTtcclxuXHRcdH07XHJcblxyXG5cdFx0d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBXaW5kb3cucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBEb2N1bWVudC5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IEVsZW1lbnQucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiByZW1vdmVFdmVudExpc3RlbmVyKCkge1xyXG5cdFx0XHR2YXJcclxuXHRcdFx0ZWxlbWVudCA9IHRoaXMsXHJcblx0XHRcdHR5cGUgPSBhcmd1bWVudHNbMF0sXHJcblx0XHRcdGxpc3RlbmVyID0gYXJndW1lbnRzWzFdLFxyXG5cdFx0XHRpbmRleDtcclxuXHJcblx0XHRcdGlmIChlbGVtZW50Ll9ldmVudHMgJiYgZWxlbWVudC5fZXZlbnRzW3R5cGVdICYmIGVsZW1lbnQuX2V2ZW50c1t0eXBlXS5saXN0KSB7XHJcblx0XHRcdFx0aW5kZXggPSBpbmRleE9mKGVsZW1lbnQuX2V2ZW50c1t0eXBlXS5saXN0LCBsaXN0ZW5lcik7XHJcblxyXG5cdFx0XHRcdGlmIChpbmRleCAhPT0gLTEpIHtcclxuXHRcdFx0XHRcdGVsZW1lbnQuX2V2ZW50c1t0eXBlXS5saXN0LnNwbGljZShpbmRleCwgMSk7XHJcblxyXG5cdFx0XHRcdFx0aWYgKCFlbGVtZW50Ll9ldmVudHNbdHlwZV0ubGlzdC5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGVsZW1lbnQuZGV0YWNoRXZlbnQpIHtcclxuXHRcdFx0XHRcdFx0XHRlbGVtZW50LmRldGFjaEV2ZW50KCdvbicgKyB0eXBlLCBlbGVtZW50Ll9ldmVudHNbdHlwZV0pO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGRlbGV0ZSBlbGVtZW50Ll9ldmVudHNbdHlwZV07XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cclxuXHRcdHdpbmRvdy5kaXNwYXRjaEV2ZW50ID0gV2luZG93LnByb3RvdHlwZS5kaXNwYXRjaEV2ZW50ID0gRG9jdW1lbnQucHJvdG90eXBlLmRpc3BhdGNoRXZlbnQgPSBFbGVtZW50LnByb3RvdHlwZS5kaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24gZGlzcGF0Y2hFdmVudChldmVudCkge1xyXG5cdFx0XHRpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05vdCBlbm91Z2ggYXJndW1lbnRzJyk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmICghZXZlbnQgfHwgdHlwZW9mIGV2ZW50LnR5cGUgIT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCdET00gRXZlbnRzIEV4Y2VwdGlvbiAwJyk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciBlbGVtZW50ID0gdGhpcywgdHlwZSA9IGV2ZW50LnR5cGU7XHJcblxyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGlmICghZXZlbnQuYnViYmxlcykge1xyXG5cdFx0XHRcdFx0ZXZlbnQuY2FuY2VsQnViYmxlID0gdHJ1ZTtcclxuXHJcblx0XHRcdFx0XHR2YXIgY2FuY2VsQnViYmxlRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHRcdFx0XHRcdFx0ZXZlbnQuY2FuY2VsQnViYmxlID0gdHJ1ZTtcclxuXHJcblx0XHRcdFx0XHRcdChlbGVtZW50IHx8IHdpbmRvdykuZGV0YWNoRXZlbnQoJ29uJyArIHR5cGUsIGNhbmNlbEJ1YmJsZUV2ZW50KTtcclxuXHRcdFx0XHRcdH07XHJcblxyXG5cdFx0XHRcdFx0dGhpcy5hdHRhY2hFdmVudCgnb24nICsgdHlwZSwgY2FuY2VsQnViYmxlRXZlbnQpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0dGhpcy5maXJlRXZlbnQoJ29uJyArIHR5cGUsIGV2ZW50KTtcclxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdFx0XHRldmVudC50YXJnZXQgPSBlbGVtZW50O1xyXG5cclxuXHRcdFx0XHRkbyB7XHJcblx0XHRcdFx0XHRldmVudC5jdXJyZW50VGFyZ2V0ID0gZWxlbWVudDtcclxuXHJcblx0XHRcdFx0XHRpZiAoJ19ldmVudHMnIGluIGVsZW1lbnQgJiYgdHlwZW9mIGVsZW1lbnQuX2V2ZW50c1t0eXBlXSA9PT0gJ2Z1bmN0aW9uJykge1xyXG5cdFx0XHRcdFx0XHRlbGVtZW50Ll9ldmVudHNbdHlwZV0uY2FsbChlbGVtZW50LCBldmVudCk7XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0aWYgKHR5cGVvZiBlbGVtZW50WydvbicgKyB0eXBlXSA9PT0gJ2Z1bmN0aW9uJykge1xyXG5cdFx0XHRcdFx0XHRlbGVtZW50WydvbicgKyB0eXBlXS5jYWxsKGVsZW1lbnQsIGV2ZW50KTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRlbGVtZW50ID0gZWxlbWVudC5ub2RlVHlwZSA9PT0gOSA/IGVsZW1lbnQucGFyZW50V2luZG93IDogZWxlbWVudC5wYXJlbnROb2RlO1xyXG5cdFx0XHRcdH0gd2hpbGUgKGVsZW1lbnQgJiYgIWV2ZW50LmNhbmNlbEJ1YmJsZSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fTtcclxuXHJcblx0XHQvLyBBZGQgdGhlIERPTUNvbnRlbnRMb2FkZWQgRXZlbnRcclxuXHRcdGRvY3VtZW50LmF0dGFjaEV2ZW50KCdvbnJlYWR5c3RhdGVjaGFuZ2UnLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpIHtcclxuXHRcdFx0XHRkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnRE9NQ29udGVudExvYWRlZCcsIHtcclxuXHRcdFx0XHRcdGJ1YmJsZXM6IHRydWVcclxuXHRcdFx0XHR9KSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufSgpKTtcclxuXHJcbn0pXHJcbi5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxudmFyIEtFWV9TUEFDRSA9IDMyO1xyXG52YXIgREVCT1VOQ0VfVElNRU9VVF9JTl9TRUNPTkRTID0gMTtcclxuXHJcbi8qKlxyXG4gKiBKYXZhU2NyaXB0IGVuaGFuY2VtZW50cyBmb3IgdGhlIEJ1dHRvbiBjb21wb25lbnRcclxuICpcclxuICogQGNsYXNzXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICRtb2R1bGUgLSBUaGUgZWxlbWVudCB0aGlzIGNvbXBvbmVudCBjb250cm9sc1xyXG4gKiBAcGFyYW0ge0J1dHRvbkNvbmZpZ30gY29uZmlnIC0gQnV0dG9uIGNvbmZpZ1xyXG4gKi9cclxuZnVuY3Rpb24gQnV0dG9uICgkbW9kdWxlLCBjb25maWcpIHtcclxuICBpZiAoISRtb2R1bGUpIHtcclxuICAgIHJldHVybiB0aGlzXHJcbiAgfVxyXG5cclxuICB0aGlzLiRtb2R1bGUgPSAkbW9kdWxlO1xyXG4gIHRoaXMuZGVib3VuY2VGb3JtU3VibWl0VGltZXIgPSBudWxsO1xyXG5cclxuICB2YXIgZGVmYXVsdENvbmZpZyA9IHtcclxuICAgIHByZXZlbnREb3VibGVDbGljazogZmFsc2VcclxuICB9O1xyXG4gIHRoaXMuY29uZmlnID0gbWVyZ2VDb25maWdzKFxyXG4gICAgZGVmYXVsdENvbmZpZyxcclxuICAgIGNvbmZpZyB8fCB7fSxcclxuICAgIG5vcm1hbGlzZURhdGFzZXQoJG1vZHVsZS5kYXRhc2V0KVxyXG4gICk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXNlIGNvbXBvbmVudFxyXG4gKi9cclxuQnV0dG9uLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gIGlmICghdGhpcy4kbW9kdWxlKSB7XHJcbiAgICByZXR1cm5cclxuICB9XHJcblxyXG4gIHRoaXMuJG1vZHVsZS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5oYW5kbGVLZXlEb3duKTtcclxuICB0aGlzLiRtb2R1bGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmRlYm91bmNlLmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFRyaWdnZXIgYSBjbGljayBldmVudCB3aGVuIHRoZSBzcGFjZSBrZXkgaXMgcHJlc3NlZFxyXG4gKlxyXG4gKiBTb21lIHNjcmVlbiByZWFkZXJzIHRlbGwgdXNlcnMgdGhleSBjYW4gYWN0aXZhdGUgdGhpbmdzIHdpdGggdGhlICdidXR0b24nXHJcbiAqIHJvbGUsIHNvIHdlIG5lZWQgdG8gbWF0Y2ggdGhlIGZ1bmN0aW9uYWxpdHkgb2YgbmF0aXZlIEhUTUwgYnV0dG9uc1xyXG4gKlxyXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2FscGhhZ292L2dvdnVrX2VsZW1lbnRzL3B1bGwvMjcyI2lzc3VlY29tbWVudC0yMzMwMjgyNzBcclxuICpcclxuICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBldmVudFxyXG4gKi9cclxuQnV0dG9uLnByb3RvdHlwZS5oYW5kbGVLZXlEb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDtcclxuXHJcbiAgaWYgKHRhcmdldC5nZXRBdHRyaWJ1dGUoJ3JvbGUnKSA9PT0gJ2J1dHRvbicgJiYgZXZlbnQua2V5Q29kZSA9PT0gS0VZX1NQQUNFKSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAvLyBwcmV2ZW50IHRoZSBwYWdlIGZyb20gc2Nyb2xsaW5nXHJcbiAgICB0YXJnZXQuY2xpY2soKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogRGVib3VuY2UgZG91YmxlLWNsaWNrc1xyXG4gKlxyXG4gKiBJZiB0aGUgY2xpY2sgcXVpY2tseSBzdWNjZWVkcyBhIHByZXZpb3VzIGNsaWNrIHRoZW4gbm90aGluZyB3aWxsIGhhcHBlbi4gVGhpc1xyXG4gKiBzdG9wcyBwZW9wbGUgYWNjaWRlbnRhbGx5IGNhdXNpbmcgbXVsdGlwbGUgZm9ybSBzdWJtaXNzaW9ucyBieSBkb3VibGVcclxuICogY2xpY2tpbmcgYnV0dG9ucy5cclxuICpcclxuICogQHBhcmFtIHtNb3VzZUV2ZW50fSBldmVudFxyXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkIHwgZmFsc2V9IC0gUmV0dXJucyB1bmRlZmluZWQsIG9yIGZhbHNlIHdoZW4gZGVib3VuY2VkXHJcbiAqL1xyXG5CdXR0b24ucHJvdG90eXBlLmRlYm91bmNlID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgLy8gQ2hlY2sgdGhlIGJ1dHRvbiB0aGF0IHdhcyBjbGlja2VkIGhhcyBwcmV2ZW50RG91YmxlQ2xpY2sgZW5hYmxlZFxyXG4gIGlmICghdGhpcy5jb25maWcucHJldmVudERvdWJsZUNsaWNrKSB7XHJcbiAgICByZXR1cm5cclxuICB9XHJcblxyXG4gIC8vIElmIHRoZSB0aW1lciBpcyBzdGlsbCBydW5uaW5nLCBwcmV2ZW50IHRoZSBjbGljayBmcm9tIHN1Ym1pdHRpbmcgdGhlIGZvcm1cclxuICBpZiAodGhpcy5kZWJvdW5jZUZvcm1TdWJtaXRUaW1lcikge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHJldHVybiBmYWxzZVxyXG4gIH1cclxuXHJcbiAgdGhpcy5kZWJvdW5jZUZvcm1TdWJtaXRUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5kZWJvdW5jZUZvcm1TdWJtaXRUaW1lciA9IG51bGw7XHJcbiAgfS5iaW5kKHRoaXMpLCBERUJPVU5DRV9USU1FT1VUX0lOX1NFQ09ORFMgKiAxMDAwKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBCdXR0b24gY29uZmlnXHJcbiAqXHJcbiAqIEB0eXBlZGVmIHtvYmplY3R9IEJ1dHRvbkNvbmZpZ1xyXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IFtwcmV2ZW50RG91YmxlQ2xpY2sgPSBmYWxzZV0gLVxyXG4gKiAgUHJldmVudCBhY2NpZGVudGFsIGRvdWJsZSBjbGlja3Mgb24gc3VibWl0IGJ1dHRvbnMgZnJvbSBzdWJtaXR0aW5nIGZvcm1zXHJcbiAqICBtdWx0aXBsZSB0aW1lcy5cclxuICovXHJcblxyXG4vKipcclxuICogSmF2YVNjcmlwdCAncG9seWZpbGwnIGZvciBIVE1MNSdzIDxkZXRhaWxzPiBhbmQgPHN1bW1hcnk+IGVsZW1lbnRzXHJcbiAqIGFuZCAnc2hpbScgdG8gYWRkIGFjY2Vzc2libGl0eSBlbmhhbmNlbWVudHMgZm9yIGFsbCBicm93c2Vyc1xyXG4gKlxyXG4gKiBodHRwOi8vY2FuaXVzZS5jb20vI2ZlYXQ9ZGV0YWlsc1xyXG4gKi9cclxuXHJcbnZhciBLRVlfRU5URVIgPSAxMztcclxudmFyIEtFWV9TUEFDRSQxID0gMzI7XHJcblxyXG4vKipcclxuICogRGV0YWlscyBjb21wb25lbnRcclxuICpcclxuICogQGNsYXNzXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICRtb2R1bGUgLSBIVE1MIGVsZW1lbnQgdG8gdXNlIGZvciBkZXRhaWxzXHJcbiAqL1xyXG5mdW5jdGlvbiBEZXRhaWxzICgkbW9kdWxlKSB7XHJcbiAgdGhpcy4kbW9kdWxlID0gJG1vZHVsZTtcclxufVxyXG5cclxuRGV0YWlscy5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICBpZiAoIXRoaXMuJG1vZHVsZSkge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICAvLyBJZiB0aGVyZSBpcyBuYXRpdmUgZGV0YWlscyBzdXBwb3J0LCB3ZSB3YW50IHRvIGF2b2lkIHJ1bm5pbmcgY29kZSB0byBwb2x5ZmlsbCBuYXRpdmUgYmVoYXZpb3VyLlxyXG4gIHZhciBoYXNOYXRpdmVEZXRhaWxzID0gdHlwZW9mIHRoaXMuJG1vZHVsZS5vcGVuID09PSAnYm9vbGVhbic7XHJcblxyXG4gIGlmIChoYXNOYXRpdmVEZXRhaWxzKSB7XHJcbiAgICByZXR1cm5cclxuICB9XHJcblxyXG4gIHRoaXMucG9seWZpbGxEZXRhaWxzKCk7XHJcbn07XHJcblxyXG5EZXRhaWxzLnByb3RvdHlwZS5wb2x5ZmlsbERldGFpbHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICRtb2R1bGUgPSB0aGlzLiRtb2R1bGU7XHJcblxyXG4gIC8vIFNhdmUgc2hvcnRjdXRzIHRvIHRoZSBpbm5lciBzdW1tYXJ5IGFuZCBjb250ZW50IGVsZW1lbnRzXHJcbiAgdmFyICRzdW1tYXJ5ID0gdGhpcy4kc3VtbWFyeSA9ICRtb2R1bGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3N1bW1hcnknKS5pdGVtKDApO1xyXG4gIHZhciAkY29udGVudCA9IHRoaXMuJGNvbnRlbnQgPSAkbW9kdWxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdkaXYnKS5pdGVtKDApO1xyXG5cclxuICAvLyBJZiA8ZGV0YWlscz4gZG9lc24ndCBoYXZlIGEgPHN1bW1hcnk+IGFuZCBhIDxkaXY+IHJlcHJlc2VudGluZyB0aGUgY29udGVudFxyXG4gIC8vIGl0IG1lYW5zIHRoZSByZXF1aXJlZCBIVE1MIHN0cnVjdHVyZSBpcyBub3QgbWV0IHNvIHRoZSBzY3JpcHQgd2lsbCBzdG9wXHJcbiAgaWYgKCEkc3VtbWFyeSB8fCAhJGNvbnRlbnQpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgLy8gSWYgdGhlIGNvbnRlbnQgZG9lc24ndCBoYXZlIGFuIElELCBhc3NpZ24gaXQgb25lIG5vd1xyXG4gIC8vIHdoaWNoIHdlJ2xsIG5lZWQgZm9yIHRoZSBzdW1tYXJ5J3MgYXJpYS1jb250cm9scyBhc3NpZ25tZW50XHJcbiAgaWYgKCEkY29udGVudC5pZCkge1xyXG4gICAgJGNvbnRlbnQuaWQgPSAnZGV0YWlscy1jb250ZW50LScgKyBnZW5lcmF0ZVVuaXF1ZUlEKCk7XHJcbiAgfVxyXG5cclxuICAvLyBBZGQgQVJJQSByb2xlPVwiZ3JvdXBcIiB0byBkZXRhaWxzXHJcbiAgJG1vZHVsZS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnZ3JvdXAnKTtcclxuXHJcbiAgLy8gQWRkIHJvbGU9YnV0dG9uIHRvIHN1bW1hcnlcclxuICAkc3VtbWFyeS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnYnV0dG9uJyk7XHJcblxyXG4gIC8vIEFkZCBhcmlhLWNvbnRyb2xzXHJcbiAgJHN1bW1hcnkuc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgJGNvbnRlbnQuaWQpO1xyXG5cclxuICAvLyBTZXQgdGFiSW5kZXggc28gdGhlIHN1bW1hcnkgaXMga2V5Ym9hcmQgYWNjZXNzaWJsZSBmb3Igbm9uLW5hdGl2ZSBlbGVtZW50c1xyXG4gIC8vXHJcbiAgLy8gV2UgaGF2ZSB0byB1c2UgdGhlIGNhbWVsY2FzZSBgdGFiSW5kZXhgIHByb3BlcnR5IGFzIHRoZXJlIGlzIGEgYnVnIGluIElFNi9JRTcgd2hlbiB3ZSBzZXQgdGhlIGNvcnJlY3QgYXR0cmlidXRlIGxvd2VyY2FzZTpcclxuICAvLyBTZWUgaHR0cDovL3dlYi5hcmNoaXZlLm9yZy93ZWIvMjAxNzAxMjAxOTQwMzYvaHR0cDovL3d3dy5zYWxpZW5jZXMuY29tL2Jyb3dzZXJCdWdzL3RhYkluZGV4Lmh0bWwgZm9yIG1vcmUgaW5mb3JtYXRpb24uXHJcbiAgJHN1bW1hcnkudGFiSW5kZXggPSAwO1xyXG5cclxuICAvLyBEZXRlY3QgaW5pdGlhbCBvcGVuIHN0YXRlXHJcbiAgaWYgKHRoaXMuJG1vZHVsZS5oYXNBdHRyaWJ1dGUoJ29wZW4nKSkge1xyXG4gICAgJHN1bW1hcnkuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgJHN1bW1hcnkuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XHJcbiAgICAkY29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gIH1cclxuXHJcbiAgLy8gQmluZCBhbiBldmVudCB0byBoYW5kbGUgc3VtbWFyeSBlbGVtZW50c1xyXG4gIHRoaXMucG9seWZpbGxIYW5kbGVJbnB1dHMoJHN1bW1hcnksIHRoaXMucG9seWZpbGxTZXRBdHRyaWJ1dGVzLmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIERlZmluZSBhIHN0YXRlY2hhbmdlIGZ1bmN0aW9uIHRoYXQgdXBkYXRlcyBhcmlhLWV4cGFuZGVkIGFuZCBzdHlsZS5kaXNwbGF5XHJcbiAqXHJcbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIHRydWVcclxuICovXHJcbkRldGFpbHMucHJvdG90eXBlLnBvbHlmaWxsU2V0QXR0cmlidXRlcyA9IGZ1bmN0aW9uICgpIHtcclxuICBpZiAodGhpcy4kbW9kdWxlLmhhc0F0dHJpYnV0ZSgnb3BlbicpKSB7XHJcbiAgICB0aGlzLiRtb2R1bGUucmVtb3ZlQXR0cmlidXRlKCdvcGVuJyk7XHJcbiAgICB0aGlzLiRzdW1tYXJ5LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xyXG4gICAgdGhpcy4kY29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0aGlzLiRtb2R1bGUuc2V0QXR0cmlidXRlKCdvcGVuJywgJ29wZW4nKTtcclxuICAgIHRoaXMuJHN1bW1hcnkuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcclxuICAgIHRoaXMuJGNvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICcnO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHRydWVcclxufTtcclxuXHJcbi8qKlxyXG4gKiBIYW5kbGUgY3Jvc3MtbW9kYWwgY2xpY2sgZXZlbnRzXHJcbiAqXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSBub2RlIC0gZWxlbWVudFxyXG4gKiBAcGFyYW0ge3BvbHlmaWxsSGFuZGxlSW5wdXRzQ2FsbGJhY2t9IGNhbGxiYWNrIC0gZnVuY3Rpb25cclxuICovXHJcbkRldGFpbHMucHJvdG90eXBlLnBvbHlmaWxsSGFuZGxlSW5wdXRzID0gZnVuY3Rpb24gKG5vZGUsIGNhbGxiYWNrKSB7XHJcbiAgbm9kZS5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDtcclxuICAgIC8vIFdoZW4gdGhlIGtleSBnZXRzIHByZXNzZWQgLSBjaGVjayBpZiBpdCBpcyBlbnRlciBvciBzcGFjZVxyXG4gICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IEtFWV9FTlRFUiB8fCBldmVudC5rZXlDb2RlID09PSBLRVlfU1BBQ0UkMSkge1xyXG4gICAgICBpZiAodGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdzdW1tYXJ5Jykge1xyXG4gICAgICAgIC8vIFByZXZlbnQgc3BhY2UgZnJvbSBzY3JvbGxpbmcgdGhlIHBhZ2VcclxuICAgICAgICAvLyBhbmQgZW50ZXIgZnJvbSBzdWJtaXR0aW5nIGEgZm9ybVxyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgLy8gQ2xpY2sgdG8gbGV0IHRoZSBjbGljayBldmVudCBkbyBhbGwgdGhlIG5lY2Vzc2FyeSBhY3Rpb25cclxuICAgICAgICBpZiAodGFyZ2V0LmNsaWNrKSB7XHJcbiAgICAgICAgICB0YXJnZXQuY2xpY2soKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gZXhjZXB0IFNhZmFyaSA1LjEgYW5kIHVuZGVyIGRvbid0IHN1cHBvcnQgLmNsaWNrKCkgaGVyZVxyXG4gICAgICAgICAgY2FsbGJhY2soZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAvLyBQcmV2ZW50IGtleXVwIHRvIHByZXZlbnQgY2xpY2tpbmcgdHdpY2UgaW4gRmlyZWZveCB3aGVuIHVzaW5nIHNwYWNlIGtleVxyXG4gIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgIHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQ7XHJcbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gS0VZX1NQQUNFJDEpIHtcclxuICAgICAgaWYgKHRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnc3VtbWFyeScpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjYWxsYmFjayk7XHJcbn07XHJcblxyXG4vKipcclxuICogQGNhbGxiYWNrIHBvbHlmaWxsSGFuZGxlSW5wdXRzQ2FsbGJhY2tcclxuICogQHBhcmFtIHtLZXlib2FyZEV2ZW50fSBldmVudCAtIEtleWJvYXJkIGV2ZW50XHJcbiAqIEByZXR1cm5zIHt1bmRlZmluZWR9XHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG5cclxuICAgIC8vIERldGVjdGlvbiBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtbGlicmFyeS9ibG9iL3YzLjExMS4wL3BvbHlmaWxscy9EYXRlL25vdy9kZXRlY3QuanNcclxuICAgIHZhciBkZXRlY3QgPSAoJ0RhdGUnIGluIHNlbGYgJiYgJ25vdycgaW4gc2VsZi5EYXRlICYmICdnZXRUaW1lJyBpbiBzZWxmLkRhdGUucHJvdG90eXBlKTtcclxuXHJcbiAgICBpZiAoZGV0ZWN0KSByZXR1cm5cclxuXHJcbiAgICAvLyBQb2x5ZmlsbCBmcm9tIGh0dHBzOi8vcG9seWZpbGwuaW8vdjMvcG9seWZpbGwuanM/dmVyc2lvbj0zLjExMS4wJmZlYXR1cmVzPURhdGUubm93JmZsYWdzPWFsd2F5c1xyXG4gICAgRGF0ZS5ub3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgfTtcclxuXHJcbn0pLmNhbGwoJ29iamVjdCcgPT09IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93IHx8ICdvYmplY3QnID09PSB0eXBlb2Ygc2VsZiAmJiBzZWxmIHx8ICdvYmplY3QnID09PSB0eXBlb2YgZ2xvYmFsICYmIGdsb2JhbCB8fCB7fSk7XHJcblxyXG4oZnVuY3Rpb24odW5kZWZpbmVkKSB7XHJcblxyXG4gIC8vIERldGVjdGlvbiBmcm9tIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtc2VydmljZS8xZjNjMDliNDAyZjY1YmY2ZTM5M2Y5MzNhMTViYTYzZjFiODZlZjFmL3BhY2thZ2VzL3BvbHlmaWxsLWxpYnJhcnkvcG9seWZpbGxzL0VsZW1lbnQvcHJvdG90eXBlL21hdGNoZXMvZGV0ZWN0LmpzXHJcbiAgdmFyIGRldGVjdCA9IChcclxuICAgICdkb2N1bWVudCcgaW4gdGhpcyAmJiBcIm1hdGNoZXNcIiBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnRcclxuICApO1xyXG5cclxuICBpZiAoZGV0ZWN0KSByZXR1cm5cclxuXHJcbiAgLy8gUG9seWZpbGwgZnJvbSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLXNlcnZpY2UvMWYzYzA5YjQwMmY2NWJmNmUzOTNmOTMzYTE1YmE2M2YxYjg2ZWYxZi9wYWNrYWdlcy9wb2x5ZmlsbC1saWJyYXJ5L3BvbHlmaWxscy9FbGVtZW50L3Byb3RvdHlwZS9tYXRjaGVzL3BvbHlmaWxsLmpzXHJcbiAgRWxlbWVudC5wcm90b3R5cGUubWF0Y2hlcyA9IEVsZW1lbnQucHJvdG90eXBlLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fCBFbGVtZW50LnByb3RvdHlwZS5vTWF0Y2hlc1NlbGVjdG9yIHx8IEVsZW1lbnQucHJvdG90eXBlLm1zTWF0Y2hlc1NlbGVjdG9yIHx8IEVsZW1lbnQucHJvdG90eXBlLm1vek1hdGNoZXNTZWxlY3RvciB8fCBmdW5jdGlvbiBtYXRjaGVzKHNlbGVjdG9yKSB7XHJcbiAgICB2YXIgZWxlbWVudCA9IHRoaXM7XHJcbiAgICB2YXIgZWxlbWVudHMgPSAoZWxlbWVudC5kb2N1bWVudCB8fCBlbGVtZW50Lm93bmVyRG9jdW1lbnQpLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpO1xyXG4gICAgdmFyIGluZGV4ID0gMDtcclxuXHJcbiAgICB3aGlsZSAoZWxlbWVudHNbaW5kZXhdICYmIGVsZW1lbnRzW2luZGV4XSAhPT0gZWxlbWVudCkge1xyXG4gICAgICArK2luZGV4O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAhIWVsZW1lbnRzW2luZGV4XTtcclxuICB9O1xyXG5cclxufSkuY2FsbCgnb2JqZWN0JyA9PT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBzZWxmICYmIHNlbGYgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBnbG9iYWwgJiYgZ2xvYmFsIHx8IHt9KTtcclxuXHJcbihmdW5jdGlvbih1bmRlZmluZWQpIHtcclxuXHJcbiAgLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlLzFmM2MwOWI0MDJmNjViZjZlMzkzZjkzM2ExNWJhNjNmMWI4NmVmMWYvcGFja2FnZXMvcG9seWZpbGwtbGlicmFyeS9wb2x5ZmlsbHMvRWxlbWVudC9wcm90b3R5cGUvY2xvc2VzdC9kZXRlY3QuanNcclxuICB2YXIgZGV0ZWN0ID0gKFxyXG4gICAgJ2RvY3VtZW50JyBpbiB0aGlzICYmIFwiY2xvc2VzdFwiIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudFxyXG4gICk7XHJcblxyXG4gIGlmIChkZXRlY3QpIHJldHVyblxyXG5cclxuICAvLyBQb2x5ZmlsbCBmcm9tIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtc2VydmljZS8xZjNjMDliNDAyZjY1YmY2ZTM5M2Y5MzNhMTViYTYzZjFiODZlZjFmL3BhY2thZ2VzL3BvbHlmaWxsLWxpYnJhcnkvcG9seWZpbGxzL0VsZW1lbnQvcHJvdG90eXBlL2Nsb3Nlc3QvcG9seWZpbGwuanNcclxuICBFbGVtZW50LnByb3RvdHlwZS5jbG9zZXN0ID0gZnVuY3Rpb24gY2xvc2VzdChzZWxlY3Rvcikge1xyXG4gICAgdmFyIG5vZGUgPSB0aGlzO1xyXG5cclxuICAgIHdoaWxlIChub2RlKSB7XHJcbiAgICAgIGlmIChub2RlLm1hdGNoZXMoc2VsZWN0b3IpKSByZXR1cm4gbm9kZTtcclxuICAgICAgZWxzZSBub2RlID0gJ1NWR0VsZW1lbnQnIGluIHdpbmRvdyAmJiBub2RlIGluc3RhbmNlb2YgU1ZHRWxlbWVudCA/IG5vZGUucGFyZW50Tm9kZSA6IG5vZGUucGFyZW50RWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9O1xyXG5cclxufSkuY2FsbCgnb2JqZWN0JyA9PT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBzZWxmICYmIHNlbGYgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBnbG9iYWwgJiYgZ2xvYmFsIHx8IHt9KTtcclxuXHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gYXR0cmlidXRlIGNsb3Nlc3QgdG8gdGhlIGdpdmVuIGVsZW1lbnQgKGluY2x1ZGluZyBpdHNlbGYpXHJcbiAqXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICRlbGVtZW50IC0gVGhlIGVsZW1lbnQgdG8gc3RhcnQgd2Fsa2luZyB0aGUgRE9NIHRyZWUgdXBcclxuICogQHBhcmFtIHtzdHJpbmd9IGF0dHJpYnV0ZU5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgYXR0cmlidXRlXHJcbiAqIEByZXR1cm5zIHtzdHJpbmcgfCB1bmRlZmluZWR9IEF0dHJpYnV0ZSB2YWx1ZVxyXG4gKi9cclxuZnVuY3Rpb24gY2xvc2VzdEF0dHJpYnV0ZVZhbHVlICgkZWxlbWVudCwgYXR0cmlidXRlTmFtZSkge1xyXG4gIHZhciBjbG9zZXN0RWxlbWVudFdpdGhBdHRyaWJ1dGUgPSAkZWxlbWVudC5jbG9zZXN0KCdbJyArIGF0dHJpYnV0ZU5hbWUgKyAnXScpO1xyXG4gIGlmIChjbG9zZXN0RWxlbWVudFdpdGhBdHRyaWJ1dGUpIHtcclxuICAgIHJldHVybiBjbG9zZXN0RWxlbWVudFdpdGhBdHRyaWJ1dGUuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUpXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQGNvbnN0YW50XHJcbiAqIEB0eXBlIHtDaGFyYWN0ZXJDb3VudFRyYW5zbGF0aW9uc31cclxuICogQHNlZSBEZWZhdWx0IHZhbHVlIGZvciB7QGxpbmsgQ2hhcmFjdGVyQ291bnRDb25maWcuaTE4bn1cclxuICogQGRlZmF1bHRcclxuICovXHJcbnZhciBDSEFSQUNURVJfQ09VTlRfVFJBTlNMQVRJT05TID0ge1xyXG4gIC8vIENoYXJhY3RlcnNcclxuICBjaGFyYWN0ZXJzVW5kZXJMaW1pdDoge1xyXG4gICAgb25lOiAnWW91IGhhdmUgJXtjb3VudH0gY2hhcmFjdGVyIHJlbWFpbmluZycsXHJcbiAgICBvdGhlcjogJ1lvdSBoYXZlICV7Y291bnR9IGNoYXJhY3RlcnMgcmVtYWluaW5nJ1xyXG4gIH0sXHJcbiAgY2hhcmFjdGVyc0F0TGltaXQ6ICdZb3UgaGF2ZSAwIGNoYXJhY3RlcnMgcmVtYWluaW5nJyxcclxuICBjaGFyYWN0ZXJzT3ZlckxpbWl0OiB7XHJcbiAgICBvbmU6ICdZb3UgaGF2ZSAle2NvdW50fSBjaGFyYWN0ZXIgdG9vIG1hbnknLFxyXG4gICAgb3RoZXI6ICdZb3UgaGF2ZSAle2NvdW50fSBjaGFyYWN0ZXJzIHRvbyBtYW55J1xyXG4gIH0sXHJcbiAgLy8gV29yZHNcclxuICB3b3Jkc1VuZGVyTGltaXQ6IHtcclxuICAgIG9uZTogJ1lvdSBoYXZlICV7Y291bnR9IHdvcmQgcmVtYWluaW5nJyxcclxuICAgIG90aGVyOiAnWW91IGhhdmUgJXtjb3VudH0gd29yZHMgcmVtYWluaW5nJ1xyXG4gIH0sXHJcbiAgd29yZHNBdExpbWl0OiAnWW91IGhhdmUgMCB3b3JkcyByZW1haW5pbmcnLFxyXG4gIHdvcmRzT3ZlckxpbWl0OiB7XHJcbiAgICBvbmU6ICdZb3UgaGF2ZSAle2NvdW50fSB3b3JkIHRvbyBtYW55JyxcclxuICAgIG90aGVyOiAnWW91IGhhdmUgJXtjb3VudH0gd29yZHMgdG9vIG1hbnknXHJcbiAgfSxcclxuICB0ZXh0YXJlYURlc2NyaXB0aW9uOiB7XHJcbiAgICBvdGhlcjogJydcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogSmF2YVNjcmlwdCBlbmhhbmNlbWVudHMgZm9yIHRoZSBDaGFyYWN0ZXJDb3VudCBjb21wb25lbnRcclxuICpcclxuICogVHJhY2tzIHRoZSBudW1iZXIgb2YgY2hhcmFjdGVycyBvciB3b3JkcyBpbiB0aGUgYC5nb3Z1ay1qcy1jaGFyYWN0ZXItY291bnRgXHJcbiAqIGA8dGV4dGFyZWE+YCBpbnNpZGUgdGhlIGVsZW1lbnQuIERpc3BsYXlzIGEgbWVzc2FnZSB3aXRoIHRoZSByZW1haW5pbmcgbnVtYmVyXHJcbiAqIG9mIGNoYXJhY3RlcnMvd29yZHMgYXZhaWxhYmxlLCBvciB0aGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMvd29yZHMgaW4gZXhjZXNzLlxyXG4gKlxyXG4gKiBZb3UgY2FuIGNvbmZpZ3VyZSB0aGUgbWVzc2FnZSB0byBvbmx5IGFwcGVhciBhZnRlciBhIGNlcnRhaW4gcGVyY2VudGFnZVxyXG4gKiBvZiB0aGUgYXZhaWxhYmxlIGNoYXJhY3RlcnMvd29yZHMgaGFzIGJlZW4gZW50ZXJlZC5cclxuICpcclxuICogQGNsYXNzXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICRtb2R1bGUgLSBUaGUgZWxlbWVudCB0aGlzIGNvbXBvbmVudCBjb250cm9sc1xyXG4gKiBAcGFyYW0ge0NoYXJhY3RlckNvdW50Q29uZmlnfSBbY29uZmlnXSAtIENoYXJhY3RlciBjb3VudCBjb25maWdcclxuICovXHJcbmZ1bmN0aW9uIENoYXJhY3RlckNvdW50ICgkbW9kdWxlLCBjb25maWcpIHtcclxuICBpZiAoISRtb2R1bGUpIHtcclxuICAgIHJldHVybiB0aGlzXHJcbiAgfVxyXG5cclxuICB2YXIgZGVmYXVsdENvbmZpZyA9IHtcclxuICAgIHRocmVzaG9sZDogMCxcclxuICAgIGkxOG46IENIQVJBQ1RFUl9DT1VOVF9UUkFOU0xBVElPTlNcclxuICB9O1xyXG5cclxuICAvLyBSZWFkIGNvbmZpZyBzZXQgdXNpbmcgZGF0YXNldCAoJ2RhdGEtJyB2YWx1ZXMpXHJcbiAgdmFyIGRhdGFzZXRDb25maWcgPSBub3JtYWxpc2VEYXRhc2V0KCRtb2R1bGUuZGF0YXNldCk7XHJcblxyXG4gIC8vIFRvIGVuc3VyZSBkYXRhLWF0dHJpYnV0ZXMgdGFrZSBjb21wbGV0ZSBwcmVjZWRlbmNlLCBldmVuIGlmIHRoZXkgY2hhbmdlIHRoZVxyXG4gIC8vIHR5cGUgb2YgY291bnQsIHdlIG5lZWQgdG8gcmVzZXQgdGhlIGBtYXhsZW5ndGhgIGFuZCBgbWF4d29yZHNgIGZyb20gdGhlXHJcbiAgLy8gSmF2YVNjcmlwdCBjb25maWcuXHJcbiAgLy9cclxuICAvLyBXZSBjYW4ndCBtdXRhdGUgYGNvbmZpZ2AsIHRob3VnaCwgYXMgaXQgbWF5IGJlIHNoYXJlZCBhY3Jvc3MgbXVsdGlwbGVcclxuICAvLyBjb21wb25lbnRzIGluc2lkZSBgaW5pdEFsbGAuXHJcbiAgdmFyIGNvbmZpZ092ZXJyaWRlcyA9IHt9O1xyXG4gIGlmICgnbWF4d29yZHMnIGluIGRhdGFzZXRDb25maWcgfHwgJ21heGxlbmd0aCcgaW4gZGF0YXNldENvbmZpZykge1xyXG4gICAgY29uZmlnT3ZlcnJpZGVzID0ge1xyXG4gICAgICBtYXhsZW5ndGg6IGZhbHNlLFxyXG4gICAgICBtYXh3b3JkczogZmFsc2VcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICB0aGlzLmNvbmZpZyA9IG1lcmdlQ29uZmlncyhcclxuICAgIGRlZmF1bHRDb25maWcsXHJcbiAgICBjb25maWcgfHwge30sXHJcbiAgICBjb25maWdPdmVycmlkZXMsXHJcbiAgICBkYXRhc2V0Q29uZmlnXHJcbiAgKTtcclxuXHJcbiAgdGhpcy5pMThuID0gbmV3IEkxOG4oZXh0cmFjdENvbmZpZ0J5TmFtZXNwYWNlKHRoaXMuY29uZmlnLCAnaTE4bicpLCB7XHJcbiAgICAvLyBSZWFkIHRoZSBmYWxsYmFjayBpZiBuZWNlc3NhcnkgcmF0aGVyIHRoYW4gaGF2ZSBpdCBzZXQgaW4gdGhlIGRlZmF1bHRzXHJcbiAgICBsb2NhbGU6IGNsb3Nlc3RBdHRyaWJ1dGVWYWx1ZSgkbW9kdWxlLCAnbGFuZycpXHJcbiAgfSk7XHJcblxyXG4gIC8vIERldGVybWluZSB0aGUgbGltaXQgYXR0cmlidXRlIChjaGFyYWN0ZXJzIG9yIHdvcmRzKVxyXG4gIGlmICh0aGlzLmNvbmZpZy5tYXh3b3Jkcykge1xyXG4gICAgdGhpcy5tYXhMZW5ndGggPSB0aGlzLmNvbmZpZy5tYXh3b3JkcztcclxuICB9IGVsc2UgaWYgKHRoaXMuY29uZmlnLm1heGxlbmd0aCkge1xyXG4gICAgdGhpcy5tYXhMZW5ndGggPSB0aGlzLmNvbmZpZy5tYXhsZW5ndGg7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgdGhpcy4kbW9kdWxlID0gJG1vZHVsZTtcclxuICB0aGlzLiR0ZXh0YXJlYSA9ICRtb2R1bGUucXVlcnlTZWxlY3RvcignLmdvdnVrLWpzLWNoYXJhY3Rlci1jb3VudCcpO1xyXG4gIHRoaXMuJHZpc2libGVDb3VudE1lc3NhZ2UgPSBudWxsO1xyXG4gIHRoaXMuJHNjcmVlblJlYWRlckNvdW50TWVzc2FnZSA9IG51bGw7XHJcbiAgdGhpcy5sYXN0SW5wdXRUaW1lc3RhbXAgPSBudWxsO1xyXG59XHJcblxyXG4vKipcclxuICogSW5pdGlhbGlzZSBjb21wb25lbnRcclxuICovXHJcbkNoYXJhY3RlckNvdW50LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gIC8vIENoZWNrIHRoYXQgcmVxdWlyZWQgZWxlbWVudHMgYXJlIHByZXNlbnRcclxuICBpZiAoIXRoaXMuJHRleHRhcmVhKSB7XHJcbiAgICByZXR1cm5cclxuICB9XHJcblxyXG4gIHZhciAkdGV4dGFyZWEgPSB0aGlzLiR0ZXh0YXJlYTtcclxuICB2YXIgJHRleHRhcmVhRGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgkdGV4dGFyZWEuaWQgKyAnLWluZm8nKTtcclxuXHJcbiAgLy8gSW5qZWN0IGEgZGVjcmlwdGlvbiBmb3IgdGhlIHRleHRhcmVhIGlmIG5vbmUgaXMgcHJlc2VudCBhbHJlYWR5XHJcbiAgLy8gZm9yIHdoZW4gdGhlIGNvbXBvbmVudCB3YXMgcmVuZGVyZWQgd2l0aCBubyBtYXhsZW5ndGgsIG1heHdvcmRzXHJcbiAgLy8gbm9yIGN1c3RvbSB0ZXh0YXJlYURlc2NyaXB0aW9uVGV4dFxyXG4gIGlmICgkdGV4dGFyZWFEZXNjcmlwdGlvbi5pbm5lclRleHQubWF0Y2goL15cXHMqJC8pKSB7XHJcbiAgICAkdGV4dGFyZWFEZXNjcmlwdGlvbi5pbm5lclRleHQgPSB0aGlzLmkxOG4udCgndGV4dGFyZWFEZXNjcmlwdGlvbicsIHsgY291bnQ6IHRoaXMubWF4TGVuZ3RoIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gTW92ZSB0aGUgdGV4dGFyZWEgZGVzY3JpcHRpb24gdG8gYmUgaW1tZWRpYXRlbHkgYWZ0ZXIgdGhlIHRleHRhcmVhXHJcbiAgLy8gS2VwdCBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHlcclxuICAkdGV4dGFyZWEuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmVuZCcsICR0ZXh0YXJlYURlc2NyaXB0aW9uKTtcclxuXHJcbiAgLy8gQ3JlYXRlIHRoZSAqc2NyZWVuIHJlYWRlciogc3BlY2lmaWMgbGl2ZS11cGRhdGluZyBjb3VudGVyXHJcbiAgLy8gVGhpcyBkb2Vzbid0IG5lZWQgYW55IHN0eWxpbmcgY2xhc3NlcywgYXMgaXQgaXMgbmV2ZXIgdmlzaWJsZVxyXG4gIHZhciAkc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgJHNjcmVlblJlYWRlckNvdW50TWVzc2FnZS5jbGFzc05hbWUgPSAnZ292dWstY2hhcmFjdGVyLWNvdW50X19zci1zdGF0dXMgZ292dWstdmlzdWFsbHktaGlkZGVuJztcclxuICAkc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlLnNldEF0dHJpYnV0ZSgnYXJpYS1saXZlJywgJ3BvbGl0ZScpO1xyXG4gIHRoaXMuJHNjcmVlblJlYWRlckNvdW50TWVzc2FnZSA9ICRzY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2U7XHJcbiAgJHRleHRhcmVhRGVzY3JpcHRpb24uaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmVuZCcsICRzY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2UpO1xyXG5cclxuICAvLyBDcmVhdGUgb3VyIGxpdmUtdXBkYXRpbmcgY291bnRlciBlbGVtZW50LCBjb3B5aW5nIHRoZSBjbGFzc2VzIGZyb20gdGhlXHJcbiAgLy8gdGV4dGFyZWEgZGVzY3JpcHRpb24gZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IGFzIHRoZXNlIG1heSBoYXZlIGJlZW5cclxuICAvLyBjb25maWd1cmVkXHJcbiAgdmFyICR2aXNpYmxlQ291bnRNZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgJHZpc2libGVDb3VudE1lc3NhZ2UuY2xhc3NOYW1lID0gJHRleHRhcmVhRGVzY3JpcHRpb24uY2xhc3NOYW1lO1xyXG4gICR2aXNpYmxlQ291bnRNZXNzYWdlLmNsYXNzTGlzdC5hZGQoJ2dvdnVrLWNoYXJhY3Rlci1jb3VudF9fc3RhdHVzJyk7XHJcbiAgJHZpc2libGVDb3VudE1lc3NhZ2Uuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7XHJcbiAgdGhpcy4kdmlzaWJsZUNvdW50TWVzc2FnZSA9ICR2aXNpYmxlQ291bnRNZXNzYWdlO1xyXG4gICR0ZXh0YXJlYURlc2NyaXB0aW9uLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCAkdmlzaWJsZUNvdW50TWVzc2FnZSk7XHJcblxyXG4gIC8vIEhpZGUgdGhlIHRleHRhcmVhIGRlc2NyaXB0aW9uXHJcbiAgJHRleHRhcmVhRGVzY3JpcHRpb24uY2xhc3NMaXN0LmFkZCgnZ292dWstdmlzdWFsbHktaGlkZGVuJyk7XHJcblxyXG4gIC8vIFJlbW92ZSBoYXJkIGxpbWl0IGlmIHNldFxyXG4gICR0ZXh0YXJlYS5yZW1vdmVBdHRyaWJ1dGUoJ21heGxlbmd0aCcpO1xyXG5cclxuICB0aGlzLmJpbmRDaGFuZ2VFdmVudHMoKTtcclxuXHJcbiAgLy8gV2hlbiB0aGUgcGFnZSBpcyByZXN0b3JlZCBhZnRlciBuYXZpZ2F0aW5nICdiYWNrJyBpbiBzb21lIGJyb3dzZXJzIHRoZVxyXG4gIC8vIHN0YXRlIG9mIHRoZSBjaGFyYWN0ZXIgY291bnQgaXMgbm90IHJlc3RvcmVkIHVudGlsICphZnRlciogdGhlXHJcbiAgLy8gRE9NQ29udGVudExvYWRlZCBldmVudCBpcyBmaXJlZCwgc28gd2UgbmVlZCB0byBtYW51YWxseSB1cGRhdGUgaXQgYWZ0ZXIgdGhlXHJcbiAgLy8gcGFnZXNob3cgZXZlbnQgaW4gYnJvd3NlcnMgdGhhdCBzdXBwb3J0IGl0LlxyXG4gIGlmICgnb25wYWdlc2hvdycgaW4gd2luZG93KSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncGFnZXNob3cnLCB0aGlzLnVwZGF0ZUNvdW50TWVzc2FnZS5iaW5kKHRoaXMpKTtcclxuICB9IGVsc2Uge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCB0aGlzLnVwZGF0ZUNvdW50TWVzc2FnZS5iaW5kKHRoaXMpKTtcclxuICB9XHJcbiAgdGhpcy51cGRhdGVDb3VudE1lc3NhZ2UoKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBCaW5kIGNoYW5nZSBldmVudHNcclxuICpcclxuICogU2V0IHVwIGV2ZW50IGxpc3RlbmVycyBvbiB0aGUgJHRleHRhcmVhIHNvIHRoYXQgdGhlIGNvdW50IG1lc3NhZ2VzIHVwZGF0ZVxyXG4gKiB3aGVuIHRoZSB1c2VyIHR5cGVzLlxyXG4gKi9cclxuQ2hhcmFjdGVyQ291bnQucHJvdG90eXBlLmJpbmRDaGFuZ2VFdmVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICR0ZXh0YXJlYSA9IHRoaXMuJHRleHRhcmVhO1xyXG4gICR0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuaGFuZGxlS2V5VXAuYmluZCh0aGlzKSk7XHJcblxyXG4gIC8vIEJpbmQgZm9jdXMvYmx1ciBldmVudHMgdG8gc3RhcnQvc3RvcCBwb2xsaW5nXHJcbiAgJHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdGhpcy5oYW5kbGVGb2N1cy5iaW5kKHRoaXMpKTtcclxuICAkdGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMuaGFuZGxlQmx1ci5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBIYW5kbGUga2V5IHVwIGV2ZW50XHJcbiAqXHJcbiAqIFVwZGF0ZSB0aGUgdmlzaWJsZSBjaGFyYWN0ZXIgY291bnRlciBhbmQga2VlcCB0cmFjayBvZiB3aGVuIHRoZSBsYXN0IHVwZGF0ZVxyXG4gKiBoYXBwZW5lZCBmb3IgZWFjaCBrZXlwcmVzc1xyXG4gKi9cclxuQ2hhcmFjdGVyQ291bnQucHJvdG90eXBlLmhhbmRsZUtleVVwID0gZnVuY3Rpb24gKCkge1xyXG4gIHRoaXMudXBkYXRlVmlzaWJsZUNvdW50TWVzc2FnZSgpO1xyXG4gIHRoaXMubGFzdElucHV0VGltZXN0YW1wID0gRGF0ZS5ub3coKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBIYW5kbGUgZm9jdXMgZXZlbnRcclxuICpcclxuICogU3BlZWNoIHJlY29nbml0aW9uIHNvZnR3YXJlIHN1Y2ggYXMgRHJhZ29uIE5hdHVyYWxseVNwZWFraW5nIHdpbGwgbW9kaWZ5IHRoZVxyXG4gKiBmaWVsZHMgYnkgZGlyZWN0bHkgY2hhbmdpbmcgaXRzIGB2YWx1ZWAuIFRoZXNlIGNoYW5nZXMgZG9uJ3QgdHJpZ2dlciBldmVudHNcclxuICogaW4gSmF2YVNjcmlwdCwgc28gd2UgbmVlZCB0byBwb2xsIHRvIGhhbmRsZSB3aGVuIGFuZCBpZiB0aGV5IG9jY3VyLlxyXG4gKlxyXG4gKiBPbmNlIHRoZSBrZXl1cCBldmVudCBoYXNuJ3QgYmVlbiBkZXRlY3RlZCBmb3IgYXQgbGVhc3QgMTAwMCBtcyAoMXMpLCBjaGVjayBpZlxyXG4gKiB0aGUgdGV4dGFyZWEgdmFsdWUgaGFzIGNoYW5nZWQgYW5kIHVwZGF0ZSB0aGUgY291bnQgbWVzc2FnZSBpZiBpdCBoYXMuXHJcbiAqXHJcbiAqIFRoaXMgaXMgc28gdGhhdCB0aGUgdXBkYXRlIHRyaWdnZXJlZCBieSB0aGUgbWFudWFsIGNvbXBhcmlzb24gZG9lc24ndFxyXG4gKiBjb25mbGljdCB3aXRoIGRlYm91bmNlZCBLZXlib2FyZEV2ZW50IHVwZGF0ZXMuXHJcbiAqL1xyXG5DaGFyYWN0ZXJDb3VudC5wcm90b3R5cGUuaGFuZGxlRm9jdXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdGhpcy52YWx1ZUNoZWNrZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAoIXRoaXMubGFzdElucHV0VGltZXN0YW1wIHx8IChEYXRlLm5vdygpIC0gNTAwKSA+PSB0aGlzLmxhc3RJbnB1dFRpbWVzdGFtcCkge1xyXG4gICAgICB0aGlzLnVwZGF0ZUlmVmFsdWVDaGFuZ2VkKCk7XHJcbiAgICB9XHJcbiAgfS5iaW5kKHRoaXMpLCAxMDAwKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBIYW5kbGUgYmx1ciBldmVudFxyXG4gKlxyXG4gKiBTdG9wIGNoZWNraW5nIHRoZSB0ZXh0YXJlYSB2YWx1ZSBvbmNlIHRoZSB0ZXh0YXJlYSBubyBsb25nZXIgaGFzIGZvY3VzXHJcbiAqL1xyXG5DaGFyYWN0ZXJDb3VudC5wcm90b3R5cGUuaGFuZGxlQmx1ciA9IGZ1bmN0aW9uICgpIHtcclxuICAvLyBDYW5jZWwgdmFsdWUgY2hlY2tpbmcgb24gYmx1clxyXG4gIGNsZWFySW50ZXJ2YWwodGhpcy52YWx1ZUNoZWNrZXIpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBjb3VudCBtZXNzYWdlIGlmIHRleHRhcmVhIHZhbHVlIGhhcyBjaGFuZ2VkXHJcbiAqL1xyXG5DaGFyYWN0ZXJDb3VudC5wcm90b3R5cGUudXBkYXRlSWZWYWx1ZUNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgaWYgKCF0aGlzLiR0ZXh0YXJlYS5vbGRWYWx1ZSkgdGhpcy4kdGV4dGFyZWEub2xkVmFsdWUgPSAnJztcclxuICBpZiAodGhpcy4kdGV4dGFyZWEudmFsdWUgIT09IHRoaXMuJHRleHRhcmVhLm9sZFZhbHVlKSB7XHJcbiAgICB0aGlzLiR0ZXh0YXJlYS5vbGRWYWx1ZSA9IHRoaXMuJHRleHRhcmVhLnZhbHVlO1xyXG4gICAgdGhpcy51cGRhdGVDb3VudE1lc3NhZ2UoKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogVXBkYXRlIGNvdW50IG1lc3NhZ2VcclxuICpcclxuICogSGVscGVyIGZ1bmN0aW9uIHRvIHVwZGF0ZSBib3RoIHRoZSB2aXNpYmxlIGFuZCBzY3JlZW4gcmVhZGVyLXNwZWNpZmljXHJcbiAqIGNvdW50ZXJzIHNpbXVsdGFuZW91c2x5IChlLmcuIG9uIGluaXQpXHJcbiAqL1xyXG5DaGFyYWN0ZXJDb3VudC5wcm90b3R5cGUudXBkYXRlQ291bnRNZXNzYWdlID0gZnVuY3Rpb24gKCkge1xyXG4gIHRoaXMudXBkYXRlVmlzaWJsZUNvdW50TWVzc2FnZSgpO1xyXG4gIHRoaXMudXBkYXRlU2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogVXBkYXRlIHZpc2libGUgY291bnQgbWVzc2FnZVxyXG4gKi9cclxuQ2hhcmFjdGVyQ291bnQucHJvdG90eXBlLnVwZGF0ZVZpc2libGVDb3VudE1lc3NhZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICR0ZXh0YXJlYSA9IHRoaXMuJHRleHRhcmVhO1xyXG4gIHZhciAkdmlzaWJsZUNvdW50TWVzc2FnZSA9IHRoaXMuJHZpc2libGVDb3VudE1lc3NhZ2U7XHJcbiAgdmFyIHJlbWFpbmluZ051bWJlciA9IHRoaXMubWF4TGVuZ3RoIC0gdGhpcy5jb3VudCgkdGV4dGFyZWEudmFsdWUpO1xyXG5cclxuICAvLyBJZiBpbnB1dCBpcyBvdmVyIHRoZSB0aHJlc2hvbGQsIHJlbW92ZSB0aGUgZGlzYWJsZWQgY2xhc3Mgd2hpY2ggcmVuZGVycyB0aGVcclxuICAvLyBjb3VudGVyIGludmlzaWJsZS5cclxuICBpZiAodGhpcy5pc092ZXJUaHJlc2hvbGQoKSkge1xyXG4gICAgJHZpc2libGVDb3VudE1lc3NhZ2UuY2xhc3NMaXN0LnJlbW92ZSgnZ292dWstY2hhcmFjdGVyLWNvdW50X19tZXNzYWdlLS1kaXNhYmxlZCcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAkdmlzaWJsZUNvdW50TWVzc2FnZS5jbGFzc0xpc3QuYWRkKCdnb3Z1ay1jaGFyYWN0ZXItY291bnRfX21lc3NhZ2UtLWRpc2FibGVkJyk7XHJcbiAgfVxyXG5cclxuICAvLyBVcGRhdGUgc3R5bGVzXHJcbiAgaWYgKHJlbWFpbmluZ051bWJlciA8IDApIHtcclxuICAgICR0ZXh0YXJlYS5jbGFzc0xpc3QuYWRkKCdnb3Z1ay10ZXh0YXJlYS0tZXJyb3InKTtcclxuICAgICR2aXNpYmxlQ291bnRNZXNzYWdlLmNsYXNzTGlzdC5yZW1vdmUoJ2dvdnVrLWhpbnQnKTtcclxuICAgICR2aXNpYmxlQ291bnRNZXNzYWdlLmNsYXNzTGlzdC5hZGQoJ2dvdnVrLWVycm9yLW1lc3NhZ2UnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgJHRleHRhcmVhLmNsYXNzTGlzdC5yZW1vdmUoJ2dvdnVrLXRleHRhcmVhLS1lcnJvcicpO1xyXG4gICAgJHZpc2libGVDb3VudE1lc3NhZ2UuY2xhc3NMaXN0LnJlbW92ZSgnZ292dWstZXJyb3ItbWVzc2FnZScpO1xyXG4gICAgJHZpc2libGVDb3VudE1lc3NhZ2UuY2xhc3NMaXN0LmFkZCgnZ292dWstaGludCcpO1xyXG4gIH1cclxuXHJcbiAgLy8gVXBkYXRlIG1lc3NhZ2VcclxuICAkdmlzaWJsZUNvdW50TWVzc2FnZS5pbm5lclRleHQgPSB0aGlzLmdldENvdW50TWVzc2FnZSgpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBzY3JlZW4gcmVhZGVyIGNvdW50IG1lc3NhZ2VcclxuICovXHJcbkNoYXJhY3RlckNvdW50LnByb3RvdHlwZS51cGRhdGVTY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICRzY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2UgPSB0aGlzLiRzY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2U7XHJcblxyXG4gIC8vIElmIG92ZXIgdGhlIHRocmVzaG9sZCwgcmVtb3ZlIHRoZSBhcmlhLWhpZGRlbiBhdHRyaWJ1dGUsIGFsbG93aW5nIHNjcmVlblxyXG4gIC8vIHJlYWRlcnMgdG8gYW5ub3VuY2UgdGhlIGNvbnRlbnQgb2YgdGhlIGVsZW1lbnQuXHJcbiAgaWYgKHRoaXMuaXNPdmVyVGhyZXNob2xkKCkpIHtcclxuICAgICRzY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2UucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWhpZGRlbicpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAkc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCB0cnVlKTtcclxuICB9XHJcblxyXG4gIC8vIFVwZGF0ZSBtZXNzYWdlXHJcbiAgJHNjcmVlblJlYWRlckNvdW50TWVzc2FnZS5pbm5lclRleHQgPSB0aGlzLmdldENvdW50TWVzc2FnZSgpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENvdW50IHRoZSBudW1iZXIgb2YgY2hhcmFjdGVycyAob3Igd29yZHMsIGlmIGBjb25maWcubWF4d29yZHNgIGlzIHNldClcclxuICogaW4gdGhlIGdpdmVuIHRleHRcclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IHRleHQgLSBUaGUgdGV4dCB0byBjb3VudCB0aGUgY2hhcmFjdGVycyBvZlxyXG4gKiBAcmV0dXJucyB7bnVtYmVyfSB0aGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMgKG9yIHdvcmRzKSBpbiB0aGUgdGV4dFxyXG4gKi9cclxuQ2hhcmFjdGVyQ291bnQucHJvdG90eXBlLmNvdW50ID0gZnVuY3Rpb24gKHRleHQpIHtcclxuICBpZiAodGhpcy5jb25maWcubWF4d29yZHMpIHtcclxuICAgIHZhciB0b2tlbnMgPSB0ZXh0Lm1hdGNoKC9cXFMrL2cpIHx8IFtdOyAvLyBNYXRjaGVzIGNvbnNlY3V0aXZlIG5vbi13aGl0ZXNwYWNlIGNoYXJzXHJcbiAgICByZXR1cm4gdG9rZW5zLmxlbmd0aFxyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4gdGV4dC5sZW5ndGhcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogR2V0IGNvdW50IG1lc3NhZ2VcclxuICpcclxuICogQHJldHVybnMge3N0cmluZ30gU3RhdHVzIG1lc3NhZ2VcclxuICovXHJcbkNoYXJhY3RlckNvdW50LnByb3RvdHlwZS5nZXRDb3VudE1lc3NhZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyIHJlbWFpbmluZ051bWJlciA9IHRoaXMubWF4TGVuZ3RoIC0gdGhpcy5jb3VudCh0aGlzLiR0ZXh0YXJlYS52YWx1ZSk7XHJcblxyXG4gIHZhciBjb3VudFR5cGUgPSB0aGlzLmNvbmZpZy5tYXh3b3JkcyA/ICd3b3JkcycgOiAnY2hhcmFjdGVycyc7XHJcbiAgcmV0dXJuIHRoaXMuZm9ybWF0Q291bnRNZXNzYWdlKHJlbWFpbmluZ051bWJlciwgY291bnRUeXBlKVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEZvcm1hdHMgdGhlIG1lc3NhZ2Ugc2hvd24gdG8gdXNlcnMgYWNjb3JkaW5nIHRvIHdoYXQncyBjb3VudGVkXHJcbiAqIGFuZCBob3cgbWFueSByZW1haW5cclxuICpcclxuICogQHBhcmFtIHtudW1iZXJ9IHJlbWFpbmluZ051bWJlciAtIFRoZSBudW1iZXIgb2Ygd29yZHMvY2hhcmFjYXRlcnMgcmVtYWluaW5nXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb3VudFR5cGUgLSBcIndvcmRzXCIgb3IgXCJjaGFyYWN0ZXJzXCJcclxuICogQHJldHVybnMge3N0cmluZ30gU3RhdHVzIG1lc3NhZ2VcclxuICovXHJcbkNoYXJhY3RlckNvdW50LnByb3RvdHlwZS5mb3JtYXRDb3VudE1lc3NhZ2UgPSBmdW5jdGlvbiAocmVtYWluaW5nTnVtYmVyLCBjb3VudFR5cGUpIHtcclxuICBpZiAocmVtYWluaW5nTnVtYmVyID09PSAwKSB7XHJcbiAgICByZXR1cm4gdGhpcy5pMThuLnQoY291bnRUeXBlICsgJ0F0TGltaXQnKVxyXG4gIH1cclxuXHJcbiAgdmFyIHRyYW5zbGF0aW9uS2V5U3VmZml4ID0gcmVtYWluaW5nTnVtYmVyIDwgMCA/ICdPdmVyTGltaXQnIDogJ1VuZGVyTGltaXQnO1xyXG5cclxuICByZXR1cm4gdGhpcy5pMThuLnQoY291bnRUeXBlICsgdHJhbnNsYXRpb25LZXlTdWZmaXgsIHsgY291bnQ6IE1hdGguYWJzKHJlbWFpbmluZ051bWJlcikgfSlcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiBjb3VudCBpcyBvdmVyIHRocmVzaG9sZFxyXG4gKlxyXG4gKiBDaGVja3Mgd2hldGhlciB0aGUgdmFsdWUgaXMgb3ZlciB0aGUgY29uZmlndXJlZCB0aHJlc2hvbGQgZm9yIHRoZSBpbnB1dC5cclxuICogSWYgdGhlcmUgaXMgbm8gY29uZmlndXJlZCB0aHJlc2hvbGQsIGl0IGlzIHNldCB0byAwIGFuZCB0aGlzIGZ1bmN0aW9uIHdpbGxcclxuICogYWx3YXlzIHJldHVybiB0cnVlLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpZiB0aGUgY3VycmVudCBjb3VudCBpcyBvdmVyIHRoZSBjb25maWcudGhyZXNob2xkXHJcbiAqICAgKG9yIG5vIHRocmVzaG9sZCBpcyBzZXQpXHJcbiAqL1xyXG5DaGFyYWN0ZXJDb3VudC5wcm90b3R5cGUuaXNPdmVyVGhyZXNob2xkID0gZnVuY3Rpb24gKCkge1xyXG4gIC8vIE5vIHRocmVzaG9sZCBtZWFucyB3ZSdyZSBhbHdheXMgYWJvdmUgdGhyZXNob2xkIHNvIHNhdmUgc29tZSBjb21wdXRhdGlvblxyXG4gIGlmICghdGhpcy5jb25maWcudGhyZXNob2xkKSB7XHJcbiAgICByZXR1cm4gdHJ1ZVxyXG4gIH1cclxuXHJcbiAgdmFyICR0ZXh0YXJlYSA9IHRoaXMuJHRleHRhcmVhO1xyXG5cclxuICAvLyBEZXRlcm1pbmUgdGhlIHJlbWFpbmluZyBudW1iZXIgb2YgY2hhcmFjdGVycy93b3Jkc1xyXG4gIHZhciBjdXJyZW50TGVuZ3RoID0gdGhpcy5jb3VudCgkdGV4dGFyZWEudmFsdWUpO1xyXG4gIHZhciBtYXhMZW5ndGggPSB0aGlzLm1heExlbmd0aDtcclxuXHJcbiAgdmFyIHRocmVzaG9sZFZhbHVlID0gbWF4TGVuZ3RoICogdGhpcy5jb25maWcudGhyZXNob2xkIC8gMTAwO1xyXG5cclxuICByZXR1cm4gKHRocmVzaG9sZFZhbHVlIDw9IGN1cnJlbnRMZW5ndGgpXHJcbn07XHJcblxyXG4vKipcclxuICogQ2hhcmFjdGVyIGNvdW50IGNvbmZpZ1xyXG4gKlxyXG4gKiBAdHlwZWRlZiB7Q2hhcmFjdGVyQ291bnRDb25maWdXaXRoTWF4TGVuZ3RoIHwgQ2hhcmFjdGVyQ291bnRDb25maWdXaXRoTWF4V29yZHN9IENoYXJhY3RlckNvdW50Q29uZmlnXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIENoYXJhY3RlciBjb3VudCBjb25maWcgKHdpdGggbWF4aW11bSBudW1iZXIgb2YgY2hhcmFjdGVycylcclxuICpcclxuICogQHR5cGVkZWYge29iamVjdH0gQ2hhcmFjdGVyQ291bnRDb25maWdXaXRoTWF4TGVuZ3RoXHJcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbbWF4bGVuZ3RoXSAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiBjaGFyYWN0ZXJzLlxyXG4gKiAgSWYgbWF4d29yZHMgaXMgcHJvdmlkZWQsIHRoZSBtYXhsZW5ndGggb3B0aW9uIHdpbGwgYmUgaWdub3JlZC5cclxuICogQHByb3BlcnR5IHtudW1iZXJ9IFt0aHJlc2hvbGQgPSAwXSAtIFRoZSBwZXJjZW50YWdlIHZhbHVlIG9mIHRoZSBsaW1pdCBhdFxyXG4gKiAgd2hpY2ggcG9pbnQgdGhlIGNvdW50IG1lc3NhZ2UgaXMgZGlzcGxheWVkLiBJZiB0aGlzIGF0dHJpYnV0ZSBpcyBzZXQsIHRoZVxyXG4gKiAgY291bnQgbWVzc2FnZSB3aWxsIGJlIGhpZGRlbiBieSBkZWZhdWx0LlxyXG4gKiBAcHJvcGVydHkge0NoYXJhY3RlckNvdW50VHJhbnNsYXRpb25zfSBbaTE4biA9IENIQVJBQ1RFUl9DT1VOVF9UUkFOU0xBVElPTlNdIC0gU2VlIGNvbnN0YW50IHtAbGluayBDSEFSQUNURVJfQ09VTlRfVFJBTlNMQVRJT05TfVxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBDaGFyYWN0ZXIgY291bnQgY29uZmlnICh3aXRoIG1heGltdW0gbnVtYmVyIG9mIHdvcmRzKVxyXG4gKlxyXG4gKiBAdHlwZWRlZiB7b2JqZWN0fSBDaGFyYWN0ZXJDb3VudENvbmZpZ1dpdGhNYXhXb3Jkc1xyXG4gKiBAcHJvcGVydHkge251bWJlcn0gW21heHdvcmRzXSAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiB3b3Jkcy4gSWYgbWF4d29yZHMgaXNcclxuICogIHByb3ZpZGVkLCB0aGUgbWF4bGVuZ3RoIG9wdGlvbiB3aWxsIGJlIGlnbm9yZWQuXHJcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbdGhyZXNob2xkID0gMF0gLSBUaGUgcGVyY2VudGFnZSB2YWx1ZSBvZiB0aGUgbGltaXQgYXRcclxuICogIHdoaWNoIHBvaW50IHRoZSBjb3VudCBtZXNzYWdlIGlzIGRpc3BsYXllZC4gSWYgdGhpcyBhdHRyaWJ1dGUgaXMgc2V0LCB0aGVcclxuICogIGNvdW50IG1lc3NhZ2Ugd2lsbCBiZSBoaWRkZW4gYnkgZGVmYXVsdC5cclxuICogQHByb3BlcnR5IHtDaGFyYWN0ZXJDb3VudFRyYW5zbGF0aW9uc30gW2kxOG4gPSBDSEFSQUNURVJfQ09VTlRfVFJBTlNMQVRJT05TXSAtIFNlZSBjb25zdGFudCB7QGxpbmsgQ0hBUkFDVEVSX0NPVU5UX1RSQU5TTEFUSU9OU31cclxuICovXHJcblxyXG4vKipcclxuICogQ2hhcmFjdGVyIGNvdW50IHRyYW5zbGF0aW9uc1xyXG4gKlxyXG4gKiBAdHlwZWRlZiB7b2JqZWN0fSBDaGFyYWN0ZXJDb3VudFRyYW5zbGF0aW9uc1xyXG4gKlxyXG4gKiBNZXNzYWdlcyBzaG93biB0byB1c2VycyBhcyB0aGV5IHR5cGUuIEl0IHByb3ZpZGVzIGZlZWRiYWNrIG9uIGhvdyBtYW55IHdvcmRzXHJcbiAqIG9yIGNoYXJhY3RlcnMgdGhleSBoYXZlIHJlbWFpbmluZyBvciBpZiB0aGV5IGFyZSBvdmVyIHRoZSBsaW1pdC4gVGhpcyBhbHNvXHJcbiAqIGluY2x1ZGVzIGEgbWVzc2FnZSB1c2VkIGFzIGFuIGFjY2Vzc2libGUgZGVzY3JpcHRpb24gZm9yIHRoZSB0ZXh0YXJlYS5cclxuICogQHByb3BlcnR5IHtUcmFuc2xhdGlvblBsdXJhbEZvcm1zfSBbY2hhcmFjdGVyc1VuZGVyTGltaXRdIC0gTWVzc2FnZSBkaXNwbGF5ZWRcclxuICogICB3aGVuIHRoZSBudW1iZXIgb2YgY2hhcmFjdGVycyBpcyB1bmRlciB0aGUgY29uZmlndXJlZCBtYXhpbXVtLCBgbWF4bGVuZ3RoYC5cclxuICogICBUaGlzIG1lc3NhZ2UgaXMgZGlzcGxheWVkIHZpc3VhbGx5IGFuZCB0aHJvdWdoIGFzc2lzdGl2ZSB0ZWNobm9sb2dpZXMuIFRoZVxyXG4gKiAgIGNvbXBvbmVudCB3aWxsIHJlcGxhY2UgdGhlIGAle2NvdW50fWAgcGxhY2Vob2xkZXIgd2l0aCB0aGUgbnVtYmVyIG9mXHJcbiAqICAgcmVtYWluaW5nIGNoYXJhY3RlcnMuIFRoaXMgaXMgYSBbcGx1cmFsaXNlZCBsaXN0IG9mXHJcbiAqICAgbWVzc2FnZXNdKGh0dHBzOi8vZnJvbnRlbmQuZGVzaWduLXN5c3RlbS5zZXJ2aWNlLmdvdi51ay9sb2NhbGlzZS1nb3Z1ay1mcm9udGVuZCkuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbY2hhcmFjdGVyc0F0TGltaXRdIC0gTWVzc2FnZSBkaXNwbGF5ZWQgd2hlbiB0aGUgbnVtYmVyIG9mXHJcbiAqICAgY2hhcmFjdGVycyByZWFjaGVzIHRoZSBjb25maWd1cmVkIG1heGltdW0sIGBtYXhsZW5ndGhgLiBUaGlzIG1lc3NhZ2UgaXNcclxuICogICBkaXNwbGF5ZWQgdmlzdWFsbHkgYW5kIHRocm91Z2ggYXNzaXN0aXZlIHRlY2hub2xvZ2llcy5cclxuICogQHByb3BlcnR5IHtUcmFuc2xhdGlvblBsdXJhbEZvcm1zfSBbY2hhcmFjdGVyc092ZXJMaW1pdF0gLSBNZXNzYWdlIGRpc3BsYXllZFxyXG4gKiAgIHdoZW4gdGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIGlzIG92ZXIgdGhlIGNvbmZpZ3VyZWQgbWF4aW11bSwgYG1heGxlbmd0aGAuXHJcbiAqICAgVGhpcyBtZXNzYWdlIGlzIGRpc3BsYXllZCB2aXN1YWxseSBhbmQgdGhyb3VnaCBhc3Npc3RpdmUgdGVjaG5vbG9naWVzLiBUaGVcclxuICogICBjb21wb25lbnQgd2lsbCByZXBsYWNlIHRoZSBgJXtjb3VudH1gIHBsYWNlaG9sZGVyIHdpdGggdGhlIG51bWJlciBvZlxyXG4gKiAgIHJlbWFpbmluZyBjaGFyYWN0ZXJzLiBUaGlzIGlzIGEgW3BsdXJhbGlzZWQgbGlzdCBvZlxyXG4gKiAgIG1lc3NhZ2VzXShodHRwczovL2Zyb250ZW5kLmRlc2lnbi1zeXN0ZW0uc2VydmljZS5nb3YudWsvbG9jYWxpc2UtZ292dWstZnJvbnRlbmQpLlxyXG4gKiBAcHJvcGVydHkge1RyYW5zbGF0aW9uUGx1cmFsRm9ybXN9IFt3b3Jkc1VuZGVyTGltaXRdIC0gTWVzc2FnZSBkaXNwbGF5ZWQgd2hlblxyXG4gKiAgIHRoZSBudW1iZXIgb2Ygd29yZHMgaXMgdW5kZXIgdGhlIGNvbmZpZ3VyZWQgbWF4aW11bSwgYG1heGxlbmd0aGAuIFRoaXNcclxuICogICBtZXNzYWdlIGlzIGRpc3BsYXllZCB2aXN1YWxseSBhbmQgdGhyb3VnaCBhc3Npc3RpdmUgdGVjaG5vbG9naWVzLiBUaGVcclxuICogICBjb21wb25lbnQgd2lsbCByZXBsYWNlIHRoZSBgJXtjb3VudH1gIHBsYWNlaG9sZGVyIHdpdGggdGhlIG51bWJlciBvZlxyXG4gKiAgIHJlbWFpbmluZyB3b3Jkcy4gVGhpcyBpcyBhIFtwbHVyYWxpc2VkIGxpc3Qgb2ZcclxuICogICBtZXNzYWdlc10oaHR0cHM6Ly9mcm9udGVuZC5kZXNpZ24tc3lzdGVtLnNlcnZpY2UuZ292LnVrL2xvY2FsaXNlLWdvdnVrLWZyb250ZW5kKS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IFt3b3Jkc0F0TGltaXRdIC0gTWVzc2FnZSBkaXNwbGF5ZWQgd2hlbiB0aGUgbnVtYmVyIG9mXHJcbiAqICAgd29yZHMgcmVhY2hlcyB0aGUgY29uZmlndXJlZCBtYXhpbXVtLCBgbWF4bGVuZ3RoYC4gVGhpcyBtZXNzYWdlIGlzXHJcbiAqICAgZGlzcGxheWVkIHZpc3VhbGx5IGFuZCB0aHJvdWdoIGFzc2lzdGl2ZSB0ZWNobm9sb2dpZXMuXHJcbiAqIEBwcm9wZXJ0eSB7VHJhbnNsYXRpb25QbHVyYWxGb3Jtc30gW3dvcmRzT3ZlckxpbWl0XSAtIE1lc3NhZ2UgZGlzcGxheWVkIHdoZW5cclxuICogICB0aGUgbnVtYmVyIG9mIHdvcmRzIGlzIG92ZXIgdGhlIGNvbmZpZ3VyZWQgbWF4aW11bSwgYG1heGxlbmd0aGAuIFRoaXNcclxuICogICBtZXNzYWdlIGlzIGRpc3BsYXllZCB2aXN1YWxseSBhbmQgdGhyb3VnaCBhc3Npc3RpdmUgdGVjaG5vbG9naWVzLiBUaGVcclxuICogICBjb21wb25lbnQgd2lsbCByZXBsYWNlIHRoZSBgJXtjb3VudH1gIHBsYWNlaG9sZGVyIHdpdGggdGhlIG51bWJlciBvZlxyXG4gKiAgIHJlbWFpbmluZyB3b3Jkcy4gVGhpcyBpcyBhIFtwbHVyYWxpc2VkIGxpc3Qgb2ZcclxuICogICBtZXNzYWdlc10oaHR0cHM6Ly9mcm9udGVuZC5kZXNpZ24tc3lzdGVtLnNlcnZpY2UuZ292LnVrL2xvY2FsaXNlLWdvdnVrLWZyb250ZW5kKS5cclxuICogQHByb3BlcnR5IHtUcmFuc2xhdGlvblBsdXJhbEZvcm1zfSBbdGV4dGFyZWFEZXNjcmlwdGlvbl0gLSBNZXNzYWdlIG1hZGVcclxuICogICBhdmFpbGFibGUgdG8gYXNzaXN0aXZlIHRlY2hub2xvZ2llcywgaWYgbm9uZSBpcyBhbHJlYWR5IHByZXNlbnQgaW4gdGhlXHJcbiAqICAgSFRNTCwgdG8gZGVzY3JpYmUgdGhhdCB0aGUgY29tcG9uZW50IGFjY2VwdHMgb25seSBhIGxpbWl0ZWQgYW1vdW50IG9mXHJcbiAqICAgY29udGVudC4gSXQgaXMgdmlzaWJsZSBvbiB0aGUgcGFnZSB3aGVuIEphdmFTY3JpcHQgaXMgdW5hdmFpbGFibGUuIFRoZVxyXG4gKiAgIGNvbXBvbmVudCB3aWxsIHJlcGxhY2UgdGhlIGAle2NvdW50fWAgcGxhY2Vob2xkZXIgd2l0aCB0aGUgdmFsdWUgb2YgdGhlXHJcbiAqICAgYG1heGxlbmd0aGAgb3IgYG1heHdvcmRzYCBwYXJhbWV0ZXIuXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL2kxOG4ubWpzJykuVHJhbnNsYXRpb25QbHVyYWxGb3Jtc30gVHJhbnNsYXRpb25QbHVyYWxGb3Jtc1xyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBDaGVja2JveGVzIGNvbXBvbmVudFxyXG4gKlxyXG4gKiBAY2xhc3NcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gJG1vZHVsZSAtIEhUTUwgZWxlbWVudCB0byB1c2UgZm9yIGNoZWNrYm94ZXNcclxuICovXHJcbmZ1bmN0aW9uIENoZWNrYm94ZXMgKCRtb2R1bGUpIHtcclxuICB0aGlzLiRtb2R1bGUgPSAkbW9kdWxlO1xyXG4gIHRoaXMuJGlucHV0cyA9ICRtb2R1bGUucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXNlIENoZWNrYm94ZXNcclxuICpcclxuICogQ2hlY2tib3hlcyBjYW4gYmUgYXNzb2NpYXRlZCB3aXRoIGEgJ2NvbmRpdGlvbmFsbHkgcmV2ZWFsZWQnIGNvbnRlbnQgYmxvY2sg4oCTXHJcbiAqIGZvciBleGFtcGxlLCBhIGNoZWNrYm94IGZvciAnUGhvbmUnIGNvdWxkIHJldmVhbCBhbiBhZGRpdGlvbmFsIGZvcm0gZmllbGQgZm9yXHJcbiAqIHRoZSB1c2VyIHRvIGVudGVyIHRoZWlyIHBob25lIG51bWJlci5cclxuICpcclxuICogVGhlc2UgYXNzb2NpYXRpb25zIGFyZSBtYWRlIHVzaW5nIGEgYGRhdGEtYXJpYS1jb250cm9sc2AgYXR0cmlidXRlLCB3aGljaCBpc1xyXG4gKiBwcm9tb3RlZCB0byBhbiBhcmlhLWNvbnRyb2xzIGF0dHJpYnV0ZSBkdXJpbmcgaW5pdGlhbGlzYXRpb24uXHJcbiAqXHJcbiAqIFdlIGFsc28gbmVlZCB0byByZXN0b3JlIHRoZSBzdGF0ZSBvZiBhbnkgY29uZGl0aW9uYWwgcmV2ZWFscyBvbiB0aGUgcGFnZSAoZm9yXHJcbiAqIGV4YW1wbGUgaWYgdGhlIHVzZXIgaGFzIG5hdmlnYXRlZCBiYWNrKSwgYW5kIHNldCB1cCBldmVudCBoYW5kbGVycyB0byBrZWVwXHJcbiAqIHRoZSByZXZlYWwgaW4gc3luYyB3aXRoIHRoZSBjaGVja2JveCBzdGF0ZS5cclxuICovXHJcbkNoZWNrYm94ZXMucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICRtb2R1bGUgPSB0aGlzLiRtb2R1bGU7XHJcbiAgdmFyICRpbnB1dHMgPSB0aGlzLiRpbnB1dHM7XHJcblxyXG4gIG5vZGVMaXN0Rm9yRWFjaCgkaW5wdXRzLCBmdW5jdGlvbiAoJGlucHV0KSB7XHJcbiAgICB2YXIgdGFyZ2V0ID0gJGlucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS1hcmlhLWNvbnRyb2xzJyk7XHJcblxyXG4gICAgLy8gU2tpcCBjaGVja2JveGVzIHdpdGhvdXQgZGF0YS1hcmlhLWNvbnRyb2xzIGF0dHJpYnV0ZXMsIG9yIHdoZXJlIHRoZVxyXG4gICAgLy8gdGFyZ2V0IGVsZW1lbnQgZG9lcyBub3QgZXhpc3QuXHJcbiAgICBpZiAoIXRhcmdldCB8fCAhZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0KSkge1xyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICAvLyBQcm9tb3RlIHRoZSBkYXRhLWFyaWEtY29udHJvbHMgYXR0cmlidXRlIHRvIGEgYXJpYS1jb250cm9scyBhdHRyaWJ1dGVcclxuICAgIC8vIHNvIHRoYXQgdGhlIHJlbGF0aW9uc2hpcCBpcyBleHBvc2VkIGluIHRoZSBBT01cclxuICAgICRpbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnLCB0YXJnZXQpO1xyXG4gICAgJGlucHV0LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1hcmlhLWNvbnRyb2xzJyk7XHJcbiAgfSk7XHJcblxyXG4gIC8vIFdoZW4gdGhlIHBhZ2UgaXMgcmVzdG9yZWQgYWZ0ZXIgbmF2aWdhdGluZyAnYmFjaycgaW4gc29tZSBicm93c2VycyB0aGVcclxuICAvLyBzdGF0ZSBvZiBmb3JtIGNvbnRyb2xzIGlzIG5vdCByZXN0b3JlZCB1bnRpbCAqYWZ0ZXIqIHRoZSBET01Db250ZW50TG9hZGVkXHJcbiAgLy8gZXZlbnQgaXMgZmlyZWQsIHNvIHdlIG5lZWQgdG8gc3luYyBhZnRlciB0aGUgcGFnZXNob3cgZXZlbnQgaW4gYnJvd3NlcnNcclxuICAvLyB0aGF0IHN1cHBvcnQgaXQuXHJcbiAgaWYgKCdvbnBhZ2VzaG93JyBpbiB3aW5kb3cpIHtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwYWdlc2hvdycsIHRoaXMuc3luY0FsbENvbmRpdGlvbmFsUmV2ZWFscy5iaW5kKHRoaXMpKTtcclxuICB9IGVsc2Uge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCB0aGlzLnN5bmNBbGxDb25kaXRpb25hbFJldmVhbHMuYmluZCh0aGlzKSk7XHJcbiAgfVxyXG5cclxuICAvLyBBbHRob3VnaCB3ZSd2ZSBzZXQgdXAgaGFuZGxlcnMgdG8gc3luYyBzdGF0ZSBvbiB0aGUgcGFnZXNob3cgb3JcclxuICAvLyBET01Db250ZW50TG9hZGVkIGV2ZW50LCBpbml0IGNvdWxkIGJlIGNhbGxlZCBhZnRlciB0aG9zZSBldmVudHMgaGF2ZSBmaXJlZCxcclxuICAvLyBmb3IgZXhhbXBsZSBpZiB0aGV5IGFyZSBhZGRlZCB0byB0aGUgcGFnZSBkeW5hbWljYWxseSwgc28gc3luYyBub3cgdG9vLlxyXG4gIHRoaXMuc3luY0FsbENvbmRpdGlvbmFsUmV2ZWFscygpO1xyXG5cclxuICAkbW9kdWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVDbGljay5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTeW5jIHRoZSBjb25kaXRpb25hbCByZXZlYWwgc3RhdGVzIGZvciBhbGwgaW5wdXRzIGluIHRoaXMgJG1vZHVsZS5cclxuICovXHJcbkNoZWNrYm94ZXMucHJvdG90eXBlLnN5bmNBbGxDb25kaXRpb25hbFJldmVhbHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgbm9kZUxpc3RGb3JFYWNoKHRoaXMuJGlucHV0cywgdGhpcy5zeW5jQ29uZGl0aW9uYWxSZXZlYWxXaXRoSW5wdXRTdGF0ZS5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTeW5jIGNvbmRpdGlvbmFsIHJldmVhbCB3aXRoIHRoZSBpbnB1dCBzdGF0ZVxyXG4gKlxyXG4gKiBTeW5jaHJvbmlzZSB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgY29uZGl0aW9uYWwgcmV2ZWFsLCBhbmQgaXRzIGFjY2Vzc2libGVcclxuICogc3RhdGUsIHdpdGggdGhlIGlucHV0J3MgY2hlY2tlZCBzdGF0ZS5cclxuICpcclxuICogQHBhcmFtIHtIVE1MSW5wdXRFbGVtZW50fSAkaW5wdXQgLSBDaGVja2JveCBpbnB1dFxyXG4gKi9cclxuQ2hlY2tib3hlcy5wcm90b3R5cGUuc3luY0NvbmRpdGlvbmFsUmV2ZWFsV2l0aElucHV0U3RhdGUgPSBmdW5jdGlvbiAoJGlucHV0KSB7XHJcbiAgdmFyICR0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgkaW5wdXQuZ2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJykpO1xyXG5cclxuICBpZiAoJHRhcmdldCAmJiAkdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZ292dWstY2hlY2tib3hlc19fY29uZGl0aW9uYWwnKSkge1xyXG4gICAgdmFyIGlucHV0SXNDaGVja2VkID0gJGlucHV0LmNoZWNrZWQ7XHJcblxyXG4gICAgJGlucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIGlucHV0SXNDaGVja2VkKTtcclxuICAgICR0YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgnZ292dWstY2hlY2tib3hlc19fY29uZGl0aW9uYWwtLWhpZGRlbicsICFpbnB1dElzQ2hlY2tlZCk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFVuY2hlY2sgb3RoZXIgY2hlY2tib3hlc1xyXG4gKlxyXG4gKiBGaW5kIGFueSBvdGhlciBjaGVja2JveCBpbnB1dHMgd2l0aCB0aGUgc2FtZSBuYW1lIHZhbHVlLCBhbmQgdW5jaGVjayB0aGVtLlxyXG4gKiBUaGlzIGlzIHVzZWZ1bCBmb3Igd2hlbiBhIOKAnE5vbmUgb2YgdGhlc2VcIiBjaGVja2JveCBpcyBjaGVja2VkLlxyXG4gKi9cclxuQ2hlY2tib3hlcy5wcm90b3R5cGUudW5DaGVja0FsbElucHV0c0V4Y2VwdCA9IGZ1bmN0aW9uICgkaW5wdXQpIHtcclxuICB2YXIgYWxsSW5wdXRzV2l0aFNhbWVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdW25hbWU9XCInICsgJGlucHV0Lm5hbWUgKyAnXCJdJyk7XHJcblxyXG4gIG5vZGVMaXN0Rm9yRWFjaChhbGxJbnB1dHNXaXRoU2FtZU5hbWUsIGZ1bmN0aW9uICgkaW5wdXRXaXRoU2FtZU5hbWUpIHtcclxuICAgIHZhciBoYXNTYW1lRm9ybU93bmVyID0gKCRpbnB1dC5mb3JtID09PSAkaW5wdXRXaXRoU2FtZU5hbWUuZm9ybSk7XHJcbiAgICBpZiAoaGFzU2FtZUZvcm1Pd25lciAmJiAkaW5wdXRXaXRoU2FtZU5hbWUgIT09ICRpbnB1dCkge1xyXG4gICAgICAkaW5wdXRXaXRoU2FtZU5hbWUuY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnN5bmNDb25kaXRpb25hbFJldmVhbFdpdGhJbnB1dFN0YXRlKCRpbnB1dFdpdGhTYW1lTmFtZSk7XHJcbiAgICB9XHJcbiAgfS5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBVbmNoZWNrIGV4Y2x1c2l2ZSBpbnB1dHNcclxuICpcclxuICogRmluZCBhbnkgY2hlY2tib3ggaW5wdXRzIHdpdGggdGhlIHNhbWUgbmFtZSB2YWx1ZSBhbmQgdGhlICdleGNsdXNpdmUnIGJlaGF2aW91cixcclxuICogYW5kIHVuY2hlY2sgdGhlbS4gVGhpcyBoZWxwcyBwcmV2ZW50IHNvbWVvbmUgY2hlY2tpbmcgYm90aCBhIHJlZ3VsYXIgY2hlY2tib3ggYW5kIGFcclxuICogXCJOb25lIG9mIHRoZXNlXCIgY2hlY2tib3ggaW4gdGhlIHNhbWUgZmllbGRzZXQuXHJcbiAqL1xyXG5DaGVja2JveGVzLnByb3RvdHlwZS51bkNoZWNrRXhjbHVzaXZlSW5wdXRzID0gZnVuY3Rpb24gKCRpbnB1dCkge1xyXG4gIHZhciBhbGxJbnB1dHNXaXRoU2FtZU5hbWVBbmRFeGNsdXNpdmVCZWhhdmlvdXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxyXG4gICAgJ2lucHV0W2RhdGEtYmVoYXZpb3VyPVwiZXhjbHVzaXZlXCJdW3R5cGU9XCJjaGVja2JveFwiXVtuYW1lPVwiJyArICRpbnB1dC5uYW1lICsgJ1wiXSdcclxuICApO1xyXG5cclxuICBub2RlTGlzdEZvckVhY2goYWxsSW5wdXRzV2l0aFNhbWVOYW1lQW5kRXhjbHVzaXZlQmVoYXZpb3VyLCBmdW5jdGlvbiAoJGV4Y2x1c2l2ZUlucHV0KSB7XHJcbiAgICB2YXIgaGFzU2FtZUZvcm1Pd25lciA9ICgkaW5wdXQuZm9ybSA9PT0gJGV4Y2x1c2l2ZUlucHV0LmZvcm0pO1xyXG4gICAgaWYgKGhhc1NhbWVGb3JtT3duZXIpIHtcclxuICAgICAgJGV4Y2x1c2l2ZUlucHV0LmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgdGhpcy5zeW5jQ29uZGl0aW9uYWxSZXZlYWxXaXRoSW5wdXRTdGF0ZSgkZXhjbHVzaXZlSW5wdXQpO1xyXG4gICAgfVxyXG4gIH0uYmluZCh0aGlzKSk7XHJcbn07XHJcblxyXG4vKipcclxuICogQ2xpY2sgZXZlbnQgaGFuZGxlclxyXG4gKlxyXG4gKiBIYW5kbGUgYSBjbGljayB3aXRoaW4gdGhlICRtb2R1bGUg4oCTIGlmIHRoZSBjbGljayBvY2N1cnJlZCBvbiBhIGNoZWNrYm94LCBzeW5jXHJcbiAqIHRoZSBzdGF0ZSBvZiBhbnkgYXNzb2NpYXRlZCBjb25kaXRpb25hbCByZXZlYWwgd2l0aCB0aGUgY2hlY2tib3ggc3RhdGUuXHJcbiAqXHJcbiAqIEBwYXJhbSB7TW91c2VFdmVudH0gZXZlbnQgLSBDbGljayBldmVudFxyXG4gKi9cclxuQ2hlY2tib3hlcy5wcm90b3R5cGUuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICB2YXIgJHRhcmdldCA9IGV2ZW50LnRhcmdldDtcclxuXHJcbiAgLy8gSWdub3JlIGNsaWNrcyBvbiB0aGluZ3MgdGhhdCBhcmVuJ3QgY2hlY2tib3ggaW5wdXRzXHJcbiAgaWYgKCR0YXJnZXQudHlwZSAhPT0gJ2NoZWNrYm94Jykge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICAvLyBJZiB0aGUgY2hlY2tib3ggY29uZGl0aW9uYWxseS1yZXZlYWxzIHNvbWUgY29udGVudCwgc3luYyB0aGUgc3RhdGVcclxuICB2YXIgaGFzQXJpYUNvbnRyb2xzID0gJHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnKTtcclxuICBpZiAoaGFzQXJpYUNvbnRyb2xzKSB7XHJcbiAgICB0aGlzLnN5bmNDb25kaXRpb25hbFJldmVhbFdpdGhJbnB1dFN0YXRlKCR0YXJnZXQpO1xyXG4gIH1cclxuXHJcbiAgLy8gTm8gZnVydGhlciBiZWhhdmlvdXIgbmVlZGVkIGZvciB1bmNoZWNraW5nXHJcbiAgaWYgKCEkdGFyZ2V0LmNoZWNrZWQpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgLy8gSGFuZGxlICdleGNsdXNpdmUnIGNoZWNrYm94IGJlaGF2aW91ciAoaWUgXCJOb25lIG9mIHRoZXNlXCIpXHJcbiAgdmFyIGhhc0JlaGF2aW91ckV4Y2x1c2l2ZSA9ICgkdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1iZWhhdmlvdXInKSA9PT0gJ2V4Y2x1c2l2ZScpO1xyXG4gIGlmIChoYXNCZWhhdmlvdXJFeGNsdXNpdmUpIHtcclxuICAgIHRoaXMudW5DaGVja0FsbElucHV0c0V4Y2VwdCgkdGFyZ2V0KTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhpcy51bkNoZWNrRXhjbHVzaXZlSW5wdXRzKCR0YXJnZXQpO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBKYXZhU2NyaXB0IGVuaGFuY2VtZW50cyBmb3IgdGhlIEVycm9yU3VtbWFyeVxyXG4gKlxyXG4gKiBUYWtlcyBmb2N1cyBvbiBpbml0aWFsaXNhdGlvbiBmb3IgYWNjZXNzaWJsZSBhbm5vdW5jZW1lbnQsIHVubGVzcyBkaXNhYmxlZCBpbiBjb25maWd1cmF0aW9uLlxyXG4gKlxyXG4gKiBAY2xhc3NcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gJG1vZHVsZSAtIFRoZSBlbGVtZW50IHRoaXMgY29tcG9uZW50IGNvbnRyb2xzXHJcbiAqIEBwYXJhbSB7RXJyb3JTdW1tYXJ5Q29uZmlnfSBjb25maWcgLSBFcnJvciBzdW1tYXJ5IGNvbmZpZ1xyXG4gKi9cclxuZnVuY3Rpb24gRXJyb3JTdW1tYXJ5ICgkbW9kdWxlLCBjb25maWcpIHtcclxuICAvLyBTb21lIGNvbnN1bWluZyBjb2RlIG1heSBub3QgYmUgcGFzc2luZyBhIG1vZHVsZSxcclxuICAvLyBmb3IgZXhhbXBsZSBpZiB0aGV5IGluaXRpYWxpc2UgdGhlIGNvbXBvbmVudFxyXG4gIC8vIG9uIHRoZWlyIG93biBieSBkaXJlY3RseSBwYXNzaW5nIHRoZSByZXN1bHRcclxuICAvLyBvZiBgZG9jdW1lbnQucXVlcnlTZWxlY3RvcmAuXHJcbiAgLy8gVG8gYXZvaWQgYnJlYWtpbmcgZnVydGhlciBKYXZhU2NyaXB0IGluaXRpYWxpc2F0aW9uXHJcbiAgLy8gd2UgbmVlZCB0byBzYWZlZ3VhcmQgYWdhaW5zdCB0aGlzIHNvIHRoaW5ncyBrZWVwXHJcbiAgLy8gd29ya2luZyB0aGUgc2FtZSBub3cgd2UgcmVhZCB0aGUgZWxlbWVudHMgZGF0YSBhdHRyaWJ1dGVzXHJcbiAgaWYgKCEkbW9kdWxlKSB7XHJcbiAgICAvLyBMaXR0bGUgc2FmZXR5IGluIGNhc2UgY29kZSBnZXRzIHBvcnRlZCBhcy1pc1xyXG4gICAgLy8gaW50byBhbmQgRVM2IGNsYXNzIGNvbnN0cnVjdG9yLCB3aGVyZSB0aGUgcmV0dXJuIHZhbHVlIG1hdHRlcnNcclxuICAgIHJldHVybiB0aGlzXHJcbiAgfVxyXG5cclxuICB0aGlzLiRtb2R1bGUgPSAkbW9kdWxlO1xyXG5cclxuICB2YXIgZGVmYXVsdENvbmZpZyA9IHtcclxuICAgIGRpc2FibGVBdXRvRm9jdXM6IGZhbHNlXHJcbiAgfTtcclxuICB0aGlzLmNvbmZpZyA9IG1lcmdlQ29uZmlncyhcclxuICAgIGRlZmF1bHRDb25maWcsXHJcbiAgICBjb25maWcgfHwge30sXHJcbiAgICBub3JtYWxpc2VEYXRhc2V0KCRtb2R1bGUuZGF0YXNldClcclxuICApO1xyXG59XHJcblxyXG5FcnJvclN1bW1hcnkucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICRtb2R1bGUgPSB0aGlzLiRtb2R1bGU7XHJcbiAgaWYgKCEkbW9kdWxlKSB7XHJcbiAgICByZXR1cm5cclxuICB9XHJcblxyXG4gIHRoaXMuc2V0Rm9jdXMoKTtcclxuICAkbW9kdWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVDbGljay5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBGb2N1cyB0aGUgZXJyb3Igc3VtbWFyeVxyXG4gKi9cclxuRXJyb3JTdW1tYXJ5LnByb3RvdHlwZS5zZXRGb2N1cyA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJG1vZHVsZSA9IHRoaXMuJG1vZHVsZTtcclxuXHJcbiAgaWYgKHRoaXMuY29uZmlnLmRpc2FibGVBdXRvRm9jdXMpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgLy8gU2V0IHRhYmluZGV4IHRvIC0xIHRvIG1ha2UgdGhlIGVsZW1lbnQgcHJvZ3JhbW1hdGljYWxseSBmb2N1c2FibGUsIGJ1dFxyXG4gIC8vIHJlbW92ZSBpdCBvbiBibHVyIGFzIHRoZSBlcnJvciBzdW1tYXJ5IGRvZXNuJ3QgbmVlZCB0byBiZSBmb2N1c2VkIGFnYWluLlxyXG4gICRtb2R1bGUuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xyXG5cclxuICAkbW9kdWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAkbW9kdWxlLnJlbW92ZUF0dHJpYnV0ZSgndGFiaW5kZXgnKTtcclxuICB9KTtcclxuXHJcbiAgJG1vZHVsZS5mb2N1cygpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENsaWNrIGV2ZW50IGhhbmRsZXJcclxuICpcclxuICogQHBhcmFtIHtNb3VzZUV2ZW50fSBldmVudCAtIENsaWNrIGV2ZW50XHJcbiAqL1xyXG5FcnJvclN1bW1hcnkucHJvdG90eXBlLmhhbmRsZUNsaWNrID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDtcclxuICBpZiAodGhpcy5mb2N1c1RhcmdldCh0YXJnZXQpKSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBGb2N1cyB0aGUgdGFyZ2V0IGVsZW1lbnRcclxuICpcclxuICogQnkgZGVmYXVsdCwgdGhlIGJyb3dzZXIgd2lsbCBzY3JvbGwgdGhlIHRhcmdldCBpbnRvIHZpZXcuIEJlY2F1c2Ugb3VyIGxhYmVsc1xyXG4gKiBvciBsZWdlbmRzIGFwcGVhciBhYm92ZSB0aGUgaW5wdXQsIHRoaXMgbWVhbnMgdGhlIHVzZXIgd2lsbCBiZSBwcmVzZW50ZWQgd2l0aFxyXG4gKiBhbiBpbnB1dCB3aXRob3V0IGFueSBjb250ZXh0LCBhcyB0aGUgbGFiZWwgb3IgbGVnZW5kIHdpbGwgYmUgb2ZmIHRoZSB0b3Agb2ZcclxuICogdGhlIHNjcmVlbi5cclxuICpcclxuICogTWFudWFsbHkgaGFuZGxpbmcgdGhlIGNsaWNrIGV2ZW50LCBzY3JvbGxpbmcgdGhlIHF1ZXN0aW9uIGludG8gdmlldyBhbmQgdGhlblxyXG4gKiBmb2N1c3NpbmcgdGhlIGVsZW1lbnQgc29sdmVzIHRoaXMuXHJcbiAqXHJcbiAqIFRoaXMgYWxzbyByZXN1bHRzIGluIHRoZSBsYWJlbCBhbmQvb3IgbGVnZW5kIGJlaW5nIGFubm91bmNlZCBjb3JyZWN0bHkgaW5cclxuICogTlZEQSAoYXMgdGVzdGVkIGluIDIwMTguMy4yKSAtIHdpdGhvdXQgdGhpcyBvbmx5IHRoZSBmaWVsZCB0eXBlIGlzIGFubm91bmNlZFxyXG4gKiAoZS5nLiBcIkVkaXQsIGhhcyBhdXRvY29tcGxldGVcIikuXHJcbiAqXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICR0YXJnZXQgLSBFdmVudCB0YXJnZXRcclxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdGhlIHRhcmdldCB3YXMgYWJsZSB0byBiZSBmb2N1c3NlZFxyXG4gKi9cclxuRXJyb3JTdW1tYXJ5LnByb3RvdHlwZS5mb2N1c1RhcmdldCA9IGZ1bmN0aW9uICgkdGFyZ2V0KSB7XHJcbiAgLy8gSWYgdGhlIGVsZW1lbnQgdGhhdCB3YXMgY2xpY2tlZCB3YXMgbm90IGEgbGluaywgcmV0dXJuIGVhcmx5XHJcbiAgaWYgKCR0YXJnZXQudGFnTmFtZSAhPT0gJ0EnIHx8ICR0YXJnZXQuaHJlZiA9PT0gZmFsc2UpIHtcclxuICAgIHJldHVybiBmYWxzZVxyXG4gIH1cclxuXHJcbiAgdmFyIGlucHV0SWQgPSB0aGlzLmdldEZyYWdtZW50RnJvbVVybCgkdGFyZ2V0LmhyZWYpO1xyXG4gIHZhciAkaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpbnB1dElkKTtcclxuICBpZiAoISRpbnB1dCkge1xyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG5cclxuICB2YXIgJGxlZ2VuZE9yTGFiZWwgPSB0aGlzLmdldEFzc29jaWF0ZWRMZWdlbmRPckxhYmVsKCRpbnB1dCk7XHJcbiAgaWYgKCEkbGVnZW5kT3JMYWJlbCkge1xyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG5cclxuICAvLyBTY3JvbGwgdGhlIGxlZ2VuZCBvciBsYWJlbCBpbnRvIHZpZXcgKmJlZm9yZSogY2FsbGluZyBmb2N1cyBvbiB0aGUgaW5wdXQgdG9cclxuICAvLyBhdm9pZCBleHRyYSBzY3JvbGxpbmcgaW4gYnJvd3NlcnMgdGhhdCBkb24ndCBzdXBwb3J0IGBwcmV2ZW50U2Nyb2xsYCAod2hpY2hcclxuICAvLyBhdCB0aW1lIG9mIHdyaXRpbmcgaXMgbW9zdCBvZiB0aGVtLi4uKVxyXG4gICRsZWdlbmRPckxhYmVsLnNjcm9sbEludG9WaWV3KCk7XHJcbiAgJGlucHV0LmZvY3VzKHsgcHJldmVudFNjcm9sbDogdHJ1ZSB9KTtcclxuXHJcbiAgcmV0dXJuIHRydWVcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgZnJhZ21lbnQgZnJvbSBVUkxcclxuICpcclxuICogRXh0cmFjdCB0aGUgZnJhZ21lbnQgKGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGhhc2gpIGZyb20gYSBVUkwsIGJ1dCBub3QgaW5jbHVkaW5nXHJcbiAqIHRoZSBoYXNoLlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsIC0gVVJMXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9IEZyYWdtZW50IGZyb20gVVJMLCB3aXRob3V0IHRoZSBoYXNoXHJcbiAqL1xyXG5FcnJvclN1bW1hcnkucHJvdG90eXBlLmdldEZyYWdtZW50RnJvbVVybCA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICBpZiAodXJsLmluZGV4T2YoJyMnKSA9PT0gLTEpIHtcclxuICAgIHJldHVybiBmYWxzZVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHVybC5zcGxpdCgnIycpLnBvcCgpXHJcbn07XHJcblxyXG4vKipcclxuICogR2V0IGFzc29jaWF0ZWQgbGVnZW5kIG9yIGxhYmVsXHJcbiAqXHJcbiAqIFJldHVybnMgdGhlIGZpcnN0IGVsZW1lbnQgdGhhdCBleGlzdHMgZnJvbSB0aGlzIGxpc3Q6XHJcbiAqXHJcbiAqIC0gVGhlIGA8bGVnZW5kPmAgYXNzb2NpYXRlZCB3aXRoIHRoZSBjbG9zZXN0IGA8ZmllbGRzZXQ+YCBhbmNlc3RvciwgYXMgbG9uZ1xyXG4gKiAgIGFzIHRoZSB0b3Agb2YgaXQgaXMgbm8gbW9yZSB0aGFuIGhhbGYgYSB2aWV3cG9ydCBoZWlnaHQgYXdheSBmcm9tIHRoZVxyXG4gKiAgIGJvdHRvbSBvZiB0aGUgaW5wdXRcclxuICogLSBUaGUgZmlyc3QgYDxsYWJlbD5gIHRoYXQgaXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBpbnB1dCB1c2luZyBmb3I9XCJpbnB1dElkXCJcclxuICogLSBUaGUgY2xvc2VzdCBwYXJlbnQgYDxsYWJlbD5gXHJcbiAqXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICRpbnB1dCAtIFRoZSBpbnB1dFxyXG4gKiBAcmV0dXJucyB7SFRNTEVsZW1lbnR9IEFzc29jaWF0ZWQgbGVnZW5kIG9yIGxhYmVsLCBvciBudWxsIGlmIG5vIGFzc29jaWF0ZWRcclxuICogICAgICAgICAgICAgICAgICAgICAgICBsZWdlbmQgb3IgbGFiZWwgY2FuIGJlIGZvdW5kXHJcbiAqL1xyXG5FcnJvclN1bW1hcnkucHJvdG90eXBlLmdldEFzc29jaWF0ZWRMZWdlbmRPckxhYmVsID0gZnVuY3Rpb24gKCRpbnB1dCkge1xyXG4gIHZhciAkZmllbGRzZXQgPSAkaW5wdXQuY2xvc2VzdCgnZmllbGRzZXQnKTtcclxuXHJcbiAgaWYgKCRmaWVsZHNldCkge1xyXG4gICAgdmFyIGxlZ2VuZHMgPSAkZmllbGRzZXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2xlZ2VuZCcpO1xyXG5cclxuICAgIGlmIChsZWdlbmRzLmxlbmd0aCkge1xyXG4gICAgICB2YXIgJGNhbmRpZGF0ZUxlZ2VuZCA9IGxlZ2VuZHNbMF07XHJcblxyXG4gICAgICAvLyBJZiB0aGUgaW5wdXQgdHlwZSBpcyByYWRpbyBvciBjaGVja2JveCwgYWx3YXlzIHVzZSB0aGUgbGVnZW5kIGlmIHRoZXJlXHJcbiAgICAgIC8vIGlzIG9uZS5cclxuICAgICAgaWYgKCRpbnB1dC50eXBlID09PSAnY2hlY2tib3gnIHx8ICRpbnB1dC50eXBlID09PSAncmFkaW8nKSB7XHJcbiAgICAgICAgcmV0dXJuICRjYW5kaWRhdGVMZWdlbmRcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gRm9yIG90aGVyIGlucHV0IHR5cGVzLCBvbmx5IHNjcm9sbCB0byB0aGUgZmllbGRzZXTigJlzIGxlZ2VuZCAoaW5zdGVhZCBvZlxyXG4gICAgICAvLyB0aGUgbGFiZWwgYXNzb2NpYXRlZCB3aXRoIHRoZSBpbnB1dCkgaWYgdGhlIGlucHV0IHdvdWxkIGVuZCB1cCBpbiB0aGVcclxuICAgICAgLy8gdG9wIGhhbGYgb2YgdGhlIHNjcmVlbi5cclxuICAgICAgLy9cclxuICAgICAgLy8gVGhpcyBzaG91bGQgYXZvaWQgc2l0dWF0aW9ucyB3aGVyZSB0aGUgaW5wdXQgZWl0aGVyIGVuZHMgdXAgb2ZmIHRoZVxyXG4gICAgICAvLyBzY3JlZW4sIG9yIG9ic2N1cmVkIGJ5IGEgc29mdHdhcmUga2V5Ym9hcmQuXHJcbiAgICAgIHZhciBsZWdlbmRUb3AgPSAkY2FuZGlkYXRlTGVnZW5kLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcclxuICAgICAgdmFyIGlucHV0UmVjdCA9ICRpbnB1dC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgIC8vIElmIHRoZSBicm93c2VyIGRvZXNuJ3Qgc3VwcG9ydCBFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodFxyXG4gICAgICAvLyBvciB3aW5kb3cuaW5uZXJIZWlnaHQgKGxpa2UgSUU4KSwgYmFpbCBhbmQganVzdCBsaW5rIHRvIHRoZSBsYWJlbC5cclxuICAgICAgaWYgKGlucHV0UmVjdC5oZWlnaHQgJiYgd2luZG93LmlubmVySGVpZ2h0KSB7XHJcbiAgICAgICAgdmFyIGlucHV0Qm90dG9tID0gaW5wdXRSZWN0LnRvcCArIGlucHV0UmVjdC5oZWlnaHQ7XHJcblxyXG4gICAgICAgIGlmIChpbnB1dEJvdHRvbSAtIGxlZ2VuZFRvcCA8IHdpbmRvdy5pbm5lckhlaWdodCAvIDIpIHtcclxuICAgICAgICAgIHJldHVybiAkY2FuZGlkYXRlTGVnZW5kXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImxhYmVsW2Zvcj0nXCIgKyAkaW5wdXQuZ2V0QXR0cmlidXRlKCdpZCcpICsgXCInXVwiKSB8fFxyXG4gICAgJGlucHV0LmNsb3Nlc3QoJ2xhYmVsJylcclxufTtcclxuXHJcbi8qKlxyXG4gKiBFcnJvciBzdW1tYXJ5IGNvbmZpZ1xyXG4gKlxyXG4gKiBAdHlwZWRlZiB7b2JqZWN0fSBFcnJvclN1bW1hcnlDb25maWdcclxuICogQHByb3BlcnR5IHtib29sZWFufSBbZGlzYWJsZUF1dG9Gb2N1cyA9IGZhbHNlXSAtXHJcbiAqICBJZiBzZXQgdG8gYHRydWVgIHRoZSBlcnJvciBzdW1tYXJ5IHdpbGwgbm90IGJlIGZvY3Vzc2VkIHdoZW4gdGhlIHBhZ2UgbG9hZHMuXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIE5vdGlmaWNhdGlvbiBCYW5uZXIgY29tcG9uZW50XHJcbiAqXHJcbiAqIEBjbGFzc1xyXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAkbW9kdWxlIC0gSFRNTCBlbGVtZW50IHRvIHVzZSBmb3Igbm90aWZpY2F0aW9uIGJhbm5lclxyXG4gKiBAcGFyYW0ge05vdGlmaWNhdGlvbkJhbm5lckNvbmZpZ30gY29uZmlnIC0gTm90aWZpY2F0aW9uIGJhbm5lciBjb25maWdcclxuICovXHJcbmZ1bmN0aW9uIE5vdGlmaWNhdGlvbkJhbm5lciAoJG1vZHVsZSwgY29uZmlnKSB7XHJcbiAgdGhpcy4kbW9kdWxlID0gJG1vZHVsZTtcclxuXHJcbiAgdmFyIGRlZmF1bHRDb25maWcgPSB7XHJcbiAgICBkaXNhYmxlQXV0b0ZvY3VzOiBmYWxzZVxyXG4gIH07XHJcbiAgdGhpcy5jb25maWcgPSBtZXJnZUNvbmZpZ3MoXHJcbiAgICBkZWZhdWx0Q29uZmlnLFxyXG4gICAgY29uZmlnIHx8IHt9LFxyXG4gICAgbm9ybWFsaXNlRGF0YXNldCgkbW9kdWxlLmRhdGFzZXQpXHJcbiAgKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpc2UgdGhlIGNvbXBvbmVudFxyXG4gKi9cclxuTm90aWZpY2F0aW9uQmFubmVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gIHZhciAkbW9kdWxlID0gdGhpcy4kbW9kdWxlO1xyXG4gIC8vIENoZWNrIGZvciBtb2R1bGVcclxuICBpZiAoISRtb2R1bGUpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgdGhpcy5zZXRGb2N1cygpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEZvY3VzIHRoZSBlbGVtZW50XHJcbiAqXHJcbiAqIElmIGByb2xlPVwiYWxlcnRcImAgaXMgc2V0LCBmb2N1cyB0aGUgZWxlbWVudCB0byBoZWxwIHNvbWUgYXNzaXN0aXZlIHRlY2hub2xvZ2llc1xyXG4gKiBwcmlvcml0aXNlIGFubm91bmNpbmcgaXQuXHJcbiAqXHJcbiAqIFlvdSBjYW4gdHVybiBvZmYgdGhlIGF1dG8tZm9jdXMgZnVuY3Rpb25hbGl0eSBieSBzZXR0aW5nIGBkYXRhLWRpc2FibGUtYXV0by1mb2N1cz1cInRydWVcImAgaW4gdGhlXHJcbiAqIGNvbXBvbmVudCBIVE1MLiBZb3UgbWlnaHQgd2lzaCB0byBkbyB0aGlzIGJhc2VkIG9uIHVzZXIgcmVzZWFyY2ggZmluZGluZ3MsIG9yIHRvIGF2b2lkIGEgY2xhc2hcclxuICogd2l0aCBhbm90aGVyIGVsZW1lbnQgd2hpY2ggc2hvdWxkIGJlIGZvY3VzZWQgd2hlbiB0aGUgcGFnZSBsb2Fkcy5cclxuICovXHJcbk5vdGlmaWNhdGlvbkJhbm5lci5wcm90b3R5cGUuc2V0Rm9jdXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICRtb2R1bGUgPSB0aGlzLiRtb2R1bGU7XHJcblxyXG4gIGlmICh0aGlzLmNvbmZpZy5kaXNhYmxlQXV0b0ZvY3VzKSB7XHJcbiAgICByZXR1cm5cclxuICB9XHJcblxyXG4gIGlmICgkbW9kdWxlLmdldEF0dHJpYnV0ZSgncm9sZScpICE9PSAnYWxlcnQnKSB7XHJcbiAgICByZXR1cm5cclxuICB9XHJcblxyXG4gIC8vIFNldCB0YWJpbmRleCB0byAtMSB0byBtYWtlIHRoZSBlbGVtZW50IGZvY3VzYWJsZSB3aXRoIEphdmFTY3JpcHQuXHJcbiAgLy8gUmVtb3ZlIHRoZSB0YWJpbmRleCBvbiBibHVyIGFzIHRoZSBjb21wb25lbnQgZG9lc24ndCBuZWVkIHRvIGJlIGZvY3VzYWJsZSBhZnRlciB0aGUgcGFnZSBoYXNcclxuICAvLyBsb2FkZWQuXHJcbiAgaWYgKCEkbW9kdWxlLmdldEF0dHJpYnV0ZSgndGFiaW5kZXgnKSkge1xyXG4gICAgJG1vZHVsZS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XHJcblxyXG4gICAgJG1vZHVsZS5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAkbW9kdWxlLnJlbW92ZUF0dHJpYnV0ZSgndGFiaW5kZXgnKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgJG1vZHVsZS5mb2N1cygpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIE5vdGlmaWNhdGlvbiBiYW5uZXIgY29uZmlnXHJcbiAqXHJcbiAqIEB0eXBlZGVmIHtvYmplY3R9IE5vdGlmaWNhdGlvbkJhbm5lckNvbmZpZ1xyXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IFtkaXNhYmxlQXV0b0ZvY3VzID0gZmFsc2VdIC1cclxuICogICBJZiBzZXQgdG8gYHRydWVgIHRoZSBub3RpZmljYXRpb24gYmFubmVyIHdpbGwgbm90IGJlIGZvY3Vzc2VkIHdoZW4gdGhlIHBhZ2VcclxuICogICBsb2Fkcy4gVGhpcyBvbmx5IGFwcGxpZXMgaWYgdGhlIGNvbXBvbmVudCBoYXMgYSBgcm9sZWAgb2YgYGFsZXJ0YCDigJMgaW5cclxuICogICBvdGhlciBjYXNlcyB0aGUgY29tcG9uZW50IHdpbGwgbm90IGJlIGZvY3VzZWQgb24gcGFnZSBsb2FkLCByZWdhcmRsZXNzIG9mXHJcbiAqICAgdGhpcyBvcHRpb24uXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEhlYWRlciBjb21wb25lbnRcclxuICpcclxuICogQGNsYXNzXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICRtb2R1bGUgLSBIVE1MIGVsZW1lbnQgdG8gdXNlIGZvciBoZWFkZXJcclxuICovXHJcbmZ1bmN0aW9uIEhlYWRlciAoJG1vZHVsZSkge1xyXG4gIHRoaXMuJG1vZHVsZSA9ICRtb2R1bGU7XHJcbiAgdGhpcy4kbWVudUJ1dHRvbiA9ICRtb2R1bGUgJiYgJG1vZHVsZS5xdWVyeVNlbGVjdG9yKCcuZ292dWstanMtaGVhZGVyLXRvZ2dsZScpO1xyXG4gIHRoaXMuJG1lbnUgPSB0aGlzLiRtZW51QnV0dG9uICYmICRtb2R1bGUucXVlcnlTZWxlY3RvcihcclxuICAgICcjJyArIHRoaXMuJG1lbnVCdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJylcclxuICApO1xyXG5cclxuICAvLyBTYXZlIHRoZSBvcGVuZWQvY2xvc2VkIHN0YXRlIGZvciB0aGUgbmF2IGluIG1lbW9yeSBzbyB0aGF0IHdlIGNhblxyXG4gIC8vIGFjY3VyYXRlbHkgbWFpbnRhaW4gc3RhdGUgd2hlbiB0aGUgc2NyZWVuIGlzIGNoYW5nZWQgZnJvbSBzbWFsbCB0b1xyXG4gIC8vIGJpZyBhbmQgYmFjayB0byBzbWFsbFxyXG4gIHRoaXMubWVudUlzT3BlbiA9IGZhbHNlO1xyXG5cclxuICAvLyBBIGdsb2JhbCBjb25zdCBmb3Igc3RvcmluZyBhIG1hdGNoTWVkaWEgaW5zdGFuY2Ugd2hpY2ggd2UnbGwgdXNlIHRvXHJcbiAgLy8gZGV0ZWN0IHdoZW4gYSBzY3JlZW4gc2l6ZSBjaGFuZ2UgaGFwcGVucy4gV2Ugc2V0IHRoaXMgbGF0ZXIgZHVyaW5nIHRoZVxyXG4gIC8vIGluaXQgZnVuY3Rpb24gYW5kIHJlbHkgb24gaXQgYmVpbmcgbnVsbCBpZiB0aGUgZmVhdHVyZSBpc24ndCBhdmFpbGFibGVcclxuICAvLyB0byBpbml0aWFsbHkgYXBwbHkgaGlkZGVuIGF0dHJpYnV0ZXNcclxuICB0aGlzLm1xbCA9IG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXNlIGhlYWRlclxyXG4gKlxyXG4gKiBDaGVjayBmb3IgdGhlIHByZXNlbmNlIG9mIHRoZSBoZWFkZXIsIG1lbnUgYW5kIG1lbnUgYnV0dG9uIOKAkyBpZiBhbnkgYXJlXHJcbiAqIG1pc3NpbmcgdGhlbiB0aGVyZSdzIG5vdGhpbmcgdG8gZG8gc28gcmV0dXJuIGVhcmx5LlxyXG4gKiBGZWF0dXJlIHNuaWZmIGZvciBhbmQgYXBwbHkgYSBtYXRjaE1lZGlhIGZvciBkZXNrdG9wIHdoaWNoIHdpbGxcclxuICogdHJpZ2dlciBhIHN0YXRlIHN5bmMgaWYgdGhlIGJyb3dzZXIgdmlld3BvcnQgbW92ZXMgYmV0d2VlbiBzdGF0ZXMuIElmXHJcbiAqIG1hdGNoTWVkaWEgaXNuJ3QgYXZhaWxhYmxlLCBoaWRlIHRoZSBtZW51IGJ1dHRvbiBhbmQgcHJlc2VudCB0aGUgXCJubyBqc1wiXHJcbiAqIHZlcnNpb24gb2YgdGhlIG1lbnUgdG8gdGhlIHVzZXIuXHJcbiAqL1xyXG5IZWFkZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgaWYgKCF0aGlzLiRtb2R1bGUgfHwgIXRoaXMuJG1lbnVCdXR0b24gfHwgIXRoaXMuJG1lbnUpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgaWYgKCdtYXRjaE1lZGlhJyBpbiB3aW5kb3cpIHtcclxuICAgIC8vIFNldCB0aGUgbWF0Y2hNZWRpYSB0byB0aGUgZ292dWstZnJvbnRlbmQgZGVza3RvcCBicmVha3BvaW50XHJcbiAgICB0aGlzLm1xbCA9IHdpbmRvdy5tYXRjaE1lZGlhKCcobWluLXdpZHRoOiA0OC4wNjI1ZW0pJyk7XHJcblxyXG4gICAgaWYgKCdhZGRFdmVudExpc3RlbmVyJyBpbiB0aGlzLm1xbCkge1xyXG4gICAgICB0aGlzLm1xbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLnN5bmNTdGF0ZS5iaW5kKHRoaXMpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIGFkZExpc3RlbmVyIGlzIGEgZGVwcmVjYXRlZCBmdW5jdGlvbiwgaG93ZXZlciBhZGRFdmVudExpc3RlbmVyXHJcbiAgICAgIC8vIGlzbid0IHN1cHBvcnRlZCBieSBJRSBvciBTYWZhcmkuIFdlIHRoZXJlZm9yZSBhZGQgdGhpcyBpbiBhc1xyXG4gICAgICAvLyBhIGZhbGxiYWNrIGZvciB0aG9zZSBicm93c2Vyc1xyXG4gICAgICB0aGlzLm1xbC5hZGRMaXN0ZW5lcih0aGlzLnN5bmNTdGF0ZS5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnN5bmNTdGF0ZSgpO1xyXG4gICAgdGhpcy4kbWVudUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuaGFuZGxlTWVudUJ1dHRvbkNsaWNrLmJpbmQodGhpcykpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0aGlzLiRtZW51QnV0dG9uLnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgJycpO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBTeW5jIG1lbnUgc3RhdGVcclxuICpcclxuICogVXNlcyB0aGUgZ2xvYmFsIHZhcmlhYmxlIG1lbnVJc09wZW4gdG8gY29ycmVjdGx5IHNldCB0aGUgYWNjZXNzaWJsZSBhbmRcclxuICogdmlzdWFsIHN0YXRlcyBvZiB0aGUgbWVudSBhbmQgdGhlIG1lbnUgYnV0dG9uLlxyXG4gKiBBZGRpdGlvbmFsbHkgd2lsbCBmb3JjZSB0aGUgbWVudSB0byBiZSB2aXNpYmxlIGFuZCB0aGUgbWVudSBidXR0b24gdG8gYmVcclxuICogaGlkZGVuIGlmIHRoZSBtYXRjaE1lZGlhIGlzIHRyaWdnZXJlZCB0byBkZXNrdG9wLlxyXG4gKi9cclxuSGVhZGVyLnByb3RvdHlwZS5zeW5jU3RhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgaWYgKHRoaXMubXFsLm1hdGNoZXMpIHtcclxuICAgIHRoaXMuJG1lbnUucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcclxuICAgIHRoaXMuJG1lbnVCdXR0b24uc2V0QXR0cmlidXRlKCdoaWRkZW4nLCAnJyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHRoaXMuJG1lbnVCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcclxuICAgIHRoaXMuJG1lbnVCdXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgdGhpcy5tZW51SXNPcGVuKTtcclxuXHJcbiAgICBpZiAodGhpcy5tZW51SXNPcGVuKSB7XHJcbiAgICAgIHRoaXMuJG1lbnUucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuJG1lbnUuc2V0QXR0cmlidXRlKCdoaWRkZW4nLCAnJyk7XHJcbiAgICB9XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEhhbmRsZSBtZW51IGJ1dHRvbiBjbGlja1xyXG4gKlxyXG4gKiBXaGVuIHRoZSBtZW51IGJ1dHRvbiBpcyBjbGlja2VkLCBjaGFuZ2UgdGhlIHZpc2liaWxpdHkgb2YgdGhlIG1lbnUgYW5kIHRoZW5cclxuICogc3luYyB0aGUgYWNjZXNzaWJpbGl0eSBzdGF0ZSBhbmQgbWVudSBidXR0b24gc3RhdGVcclxuICovXHJcbkhlYWRlci5wcm90b3R5cGUuaGFuZGxlTWVudUJ1dHRvbkNsaWNrID0gZnVuY3Rpb24gKCkge1xyXG4gIHRoaXMubWVudUlzT3BlbiA9ICF0aGlzLm1lbnVJc09wZW47XHJcbiAgdGhpcy5zeW5jU3RhdGUoKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBSYWRpb3MgY29tcG9uZW50XHJcbiAqXHJcbiAqIEBjbGFzc1xyXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAkbW9kdWxlIC0gSFRNTCBlbGVtZW50IHRvIHVzZSBmb3IgcmFkaW9zXHJcbiAqL1xyXG5mdW5jdGlvbiBSYWRpb3MgKCRtb2R1bGUpIHtcclxuICB0aGlzLiRtb2R1bGUgPSAkbW9kdWxlO1xyXG4gIHRoaXMuJGlucHV0cyA9ICRtb2R1bGUucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT1cInJhZGlvXCJdJyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXNlIFJhZGlvc1xyXG4gKlxyXG4gKiBSYWRpb3MgY2FuIGJlIGFzc29jaWF0ZWQgd2l0aCBhICdjb25kaXRpb25hbGx5IHJldmVhbGVkJyBjb250ZW50IGJsb2NrIOKAkyBmb3JcclxuICogZXhhbXBsZSwgYSByYWRpbyBmb3IgJ1Bob25lJyBjb3VsZCByZXZlYWwgYW4gYWRkaXRpb25hbCBmb3JtIGZpZWxkIGZvciB0aGVcclxuICogdXNlciB0byBlbnRlciB0aGVpciBwaG9uZSBudW1iZXIuXHJcbiAqXHJcbiAqIFRoZXNlIGFzc29jaWF0aW9ucyBhcmUgbWFkZSB1c2luZyBhIGBkYXRhLWFyaWEtY29udHJvbHNgIGF0dHJpYnV0ZSwgd2hpY2ggaXNcclxuICogcHJvbW90ZWQgdG8gYW4gYXJpYS1jb250cm9scyBhdHRyaWJ1dGUgZHVyaW5nIGluaXRpYWxpc2F0aW9uLlxyXG4gKlxyXG4gKiBXZSBhbHNvIG5lZWQgdG8gcmVzdG9yZSB0aGUgc3RhdGUgb2YgYW55IGNvbmRpdGlvbmFsIHJldmVhbHMgb24gdGhlIHBhZ2UgKGZvclxyXG4gKiBleGFtcGxlIGlmIHRoZSB1c2VyIGhhcyBuYXZpZ2F0ZWQgYmFjayksIGFuZCBzZXQgdXAgZXZlbnQgaGFuZGxlcnMgdG8ga2VlcFxyXG4gKiB0aGUgcmV2ZWFsIGluIHN5bmMgd2l0aCB0aGUgcmFkaW8gc3RhdGUuXHJcbiAqL1xyXG5SYWRpb3MucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICRtb2R1bGUgPSB0aGlzLiRtb2R1bGU7XHJcbiAgdmFyICRpbnB1dHMgPSB0aGlzLiRpbnB1dHM7XHJcblxyXG4gIG5vZGVMaXN0Rm9yRWFjaCgkaW5wdXRzLCBmdW5jdGlvbiAoJGlucHV0KSB7XHJcbiAgICB2YXIgdGFyZ2V0ID0gJGlucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS1hcmlhLWNvbnRyb2xzJyk7XHJcblxyXG4gICAgLy8gU2tpcCByYWRpb3Mgd2l0aG91dCBkYXRhLWFyaWEtY29udHJvbHMgYXR0cmlidXRlcywgb3Igd2hlcmUgdGhlXHJcbiAgICAvLyB0YXJnZXQgZWxlbWVudCBkb2VzIG5vdCBleGlzdC5cclxuICAgIGlmICghdGFyZ2V0IHx8ICFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXQpKSB7XHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIC8vIFByb21vdGUgdGhlIGRhdGEtYXJpYS1jb250cm9scyBhdHRyaWJ1dGUgdG8gYSBhcmlhLWNvbnRyb2xzIGF0dHJpYnV0ZVxyXG4gICAgLy8gc28gdGhhdCB0aGUgcmVsYXRpb25zaGlwIGlzIGV4cG9zZWQgaW4gdGhlIEFPTVxyXG4gICAgJGlucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsIHRhcmdldCk7XHJcbiAgICAkaW5wdXQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWFyaWEtY29udHJvbHMnKTtcclxuICB9KTtcclxuXHJcbiAgLy8gV2hlbiB0aGUgcGFnZSBpcyByZXN0b3JlZCBhZnRlciBuYXZpZ2F0aW5nICdiYWNrJyBpbiBzb21lIGJyb3dzZXJzIHRoZVxyXG4gIC8vIHN0YXRlIG9mIGZvcm0gY29udHJvbHMgaXMgbm90IHJlc3RvcmVkIHVudGlsICphZnRlciogdGhlIERPTUNvbnRlbnRMb2FkZWRcclxuICAvLyBldmVudCBpcyBmaXJlZCwgc28gd2UgbmVlZCB0byBzeW5jIGFmdGVyIHRoZSBwYWdlc2hvdyBldmVudCBpbiBicm93c2Vyc1xyXG4gIC8vIHRoYXQgc3VwcG9ydCBpdC5cclxuICBpZiAoJ29ucGFnZXNob3cnIGluIHdpbmRvdykge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BhZ2VzaG93JywgdGhpcy5zeW5jQWxsQ29uZGl0aW9uYWxSZXZlYWxzLmJpbmQodGhpcykpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIHRoaXMuc3luY0FsbENvbmRpdGlvbmFsUmV2ZWFscy5iaW5kKHRoaXMpKTtcclxuICB9XHJcblxyXG4gIC8vIEFsdGhvdWdoIHdlJ3ZlIHNldCB1cCBoYW5kbGVycyB0byBzeW5jIHN0YXRlIG9uIHRoZSBwYWdlc2hvdyBvclxyXG4gIC8vIERPTUNvbnRlbnRMb2FkZWQgZXZlbnQsIGluaXQgY291bGQgYmUgY2FsbGVkIGFmdGVyIHRob3NlIGV2ZW50cyBoYXZlIGZpcmVkLFxyXG4gIC8vIGZvciBleGFtcGxlIGlmIHRoZXkgYXJlIGFkZGVkIHRvIHRoZSBwYWdlIGR5bmFtaWNhbGx5LCBzbyBzeW5jIG5vdyB0b28uXHJcbiAgdGhpcy5zeW5jQWxsQ29uZGl0aW9uYWxSZXZlYWxzKCk7XHJcblxyXG4gIC8vIEhhbmRsZSBldmVudHNcclxuICAkbW9kdWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVDbGljay5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTeW5jIHRoZSBjb25kaXRpb25hbCByZXZlYWwgc3RhdGVzIGZvciBhbGwgaW5wdXRzIGluIHRoaXMgJG1vZHVsZS5cclxuICovXHJcblJhZGlvcy5wcm90b3R5cGUuc3luY0FsbENvbmRpdGlvbmFsUmV2ZWFscyA9IGZ1bmN0aW9uICgpIHtcclxuICBub2RlTGlzdEZvckVhY2godGhpcy4kaW5wdXRzLCB0aGlzLnN5bmNDb25kaXRpb25hbFJldmVhbFdpdGhJbnB1dFN0YXRlLmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFN5bmMgY29uZGl0aW9uYWwgcmV2ZWFsIHdpdGggdGhlIGlucHV0IHN0YXRlXHJcbiAqXHJcbiAqIFN5bmNocm9uaXNlIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBjb25kaXRpb25hbCByZXZlYWwsIGFuZCBpdHMgYWNjZXNzaWJsZVxyXG4gKiBzdGF0ZSwgd2l0aCB0aGUgaW5wdXQncyBjaGVja2VkIHN0YXRlLlxyXG4gKlxyXG4gKiBAcGFyYW0ge0hUTUxJbnB1dEVsZW1lbnR9ICRpbnB1dCAtIFJhZGlvIGlucHV0XHJcbiAqL1xyXG5SYWRpb3MucHJvdG90eXBlLnN5bmNDb25kaXRpb25hbFJldmVhbFdpdGhJbnB1dFN0YXRlID0gZnVuY3Rpb24gKCRpbnB1dCkge1xyXG4gIHZhciAkdGFyZ2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJGlucHV0LmdldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycpKTtcclxuXHJcbiAgaWYgKCR0YXJnZXQgJiYgJHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2dvdnVrLXJhZGlvc19fY29uZGl0aW9uYWwnKSkge1xyXG4gICAgdmFyIGlucHV0SXNDaGVja2VkID0gJGlucHV0LmNoZWNrZWQ7XHJcblxyXG4gICAgJGlucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIGlucHV0SXNDaGVja2VkKTtcclxuICAgICR0YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgnZ292dWstcmFkaW9zX19jb25kaXRpb25hbC0taGlkZGVuJywgIWlucHV0SXNDaGVja2VkKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ2xpY2sgZXZlbnQgaGFuZGxlclxyXG4gKlxyXG4gKiBIYW5kbGUgYSBjbGljayB3aXRoaW4gdGhlICRtb2R1bGUg4oCTIGlmIHRoZSBjbGljayBvY2N1cnJlZCBvbiBhIHJhZGlvLCBzeW5jXHJcbiAqIHRoZSBzdGF0ZSBvZiB0aGUgY29uZGl0aW9uYWwgcmV2ZWFsIGZvciBhbGwgcmFkaW8gYnV0dG9ucyBpbiB0aGUgc2FtZSBmb3JtXHJcbiAqIHdpdGggdGhlIHNhbWUgbmFtZSAoYmVjYXVzZSBjaGVja2luZyBvbmUgcmFkaW8gY291bGQgaGF2ZSB1bi1jaGVja2VkIGEgcmFkaW9cclxuICogaW4gYW5vdGhlciAkbW9kdWxlKVxyXG4gKlxyXG4gKiBAcGFyYW0ge01vdXNlRXZlbnR9IGV2ZW50IC0gQ2xpY2sgZXZlbnRcclxuICovXHJcblJhZGlvcy5wcm90b3R5cGUuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICB2YXIgJGNsaWNrZWRJbnB1dCA9IGV2ZW50LnRhcmdldDtcclxuXHJcbiAgLy8gSWdub3JlIGNsaWNrcyBvbiB0aGluZ3MgdGhhdCBhcmVuJ3QgcmFkaW8gYnV0dG9uc1xyXG4gIGlmICgkY2xpY2tlZElucHV0LnR5cGUgIT09ICdyYWRpbycpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgLy8gV2Ugb25seSBuZWVkIHRvIGNvbnNpZGVyIHJhZGlvcyB3aXRoIGNvbmRpdGlvbmFsIHJldmVhbHMsIHdoaWNoIHdpbGwgaGF2ZVxyXG4gIC8vIGFyaWEtY29udHJvbHMgYXR0cmlidXRlcy5cclxuICB2YXIgJGFsbElucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3R5cGU9XCJyYWRpb1wiXVthcmlhLWNvbnRyb2xzXScpO1xyXG5cclxuICBub2RlTGlzdEZvckVhY2goJGFsbElucHV0cywgZnVuY3Rpb24gKCRpbnB1dCkge1xyXG4gICAgdmFyIGhhc1NhbWVGb3JtT3duZXIgPSAoJGlucHV0LmZvcm0gPT09ICRjbGlja2VkSW5wdXQuZm9ybSk7XHJcbiAgICB2YXIgaGFzU2FtZU5hbWUgPSAoJGlucHV0Lm5hbWUgPT09ICRjbGlja2VkSW5wdXQubmFtZSk7XHJcblxyXG4gICAgaWYgKGhhc1NhbWVOYW1lICYmIGhhc1NhbWVGb3JtT3duZXIpIHtcclxuICAgICAgdGhpcy5zeW5jQ29uZGl0aW9uYWxSZXZlYWxXaXRoSW5wdXRTdGF0ZSgkaW5wdXQpO1xyXG4gICAgfVxyXG4gIH0uYmluZCh0aGlzKSk7XHJcbn07XHJcblxyXG4vKipcclxuICogU2tpcCBsaW5rIGNvbXBvbmVudFxyXG4gKlxyXG4gKiBAY2xhc3NcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gJG1vZHVsZSAtIEhUTUwgZWxlbWVudCB0byB1c2UgZm9yIHNraXAgbGlua1xyXG4gKi9cclxuZnVuY3Rpb24gU2tpcExpbmsgKCRtb2R1bGUpIHtcclxuICB0aGlzLiRtb2R1bGUgPSAkbW9kdWxlO1xyXG4gIHRoaXMuJGxpbmtlZEVsZW1lbnQgPSBudWxsO1xyXG4gIHRoaXMubGlua2VkRWxlbWVudExpc3RlbmVyID0gZmFsc2U7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXNlIHRoZSBjb21wb25lbnRcclxuICovXHJcblNraXBMaW5rLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gIC8vIENoZWNrIGZvciBtb2R1bGVcclxuICBpZiAoIXRoaXMuJG1vZHVsZSkge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICAvLyBDaGVjayBmb3IgbGlua2VkIGVsZW1lbnRcclxuICB0aGlzLiRsaW5rZWRFbGVtZW50ID0gdGhpcy5nZXRMaW5rZWRFbGVtZW50KCk7XHJcbiAgaWYgKCF0aGlzLiRsaW5rZWRFbGVtZW50KSB7XHJcbiAgICByZXR1cm5cclxuICB9XHJcblxyXG4gIHRoaXMuJG1vZHVsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuZm9jdXNMaW5rZWRFbGVtZW50LmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldCBsaW5rZWQgZWxlbWVudFxyXG4gKlxyXG4gKiBAcmV0dXJucyB7SFRNTEVsZW1lbnR9ICRsaW5rZWRFbGVtZW50IC0gRE9NIGVsZW1lbnQgbGlua2VkIHRvIGZyb20gdGhlIHNraXAgbGlua1xyXG4gKi9cclxuU2tpcExpbmsucHJvdG90eXBlLmdldExpbmtlZEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyIGxpbmtlZEVsZW1lbnRJZCA9IHRoaXMuZ2V0RnJhZ21lbnRGcm9tVXJsKCk7XHJcblxyXG4gIGlmICghbGlua2VkRWxlbWVudElkKSB7XHJcbiAgICByZXR1cm4gZmFsc2VcclxuICB9XHJcblxyXG4gIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChsaW5rZWRFbGVtZW50SWQpXHJcbn07XHJcblxyXG4vKipcclxuICogRm9jdXMgdGhlIGxpbmtlZCBlbGVtZW50XHJcbiAqXHJcbiAqIFNldCB0YWJpbmRleCBhbmQgaGVscGVyIENTUyBjbGFzcy4gU2V0IGxpc3RlbmVyIHRvIHJlbW92ZSB0aGVtIG9uIGJsdXIuXHJcbiAqL1xyXG5Ta2lwTGluay5wcm90b3R5cGUuZm9jdXNMaW5rZWRFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gIHZhciAkbGlua2VkRWxlbWVudCA9IHRoaXMuJGxpbmtlZEVsZW1lbnQ7XHJcblxyXG4gIGlmICghJGxpbmtlZEVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0YWJpbmRleCcpKSB7XHJcbiAgICAvLyBTZXQgdGhlIGVsZW1lbnQgdGFiaW5kZXggdG8gLTEgc28gaXQgY2FuIGJlIGZvY3VzZWQgd2l0aCBKYXZhU2NyaXB0LlxyXG4gICAgJGxpbmtlZEVsZW1lbnQuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xyXG4gICAgJGxpbmtlZEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZ292dWstc2tpcC1saW5rLWZvY3VzZWQtZWxlbWVudCcpO1xyXG5cclxuICAgIC8vIEFkZCBsaXN0ZW5lciBmb3IgYmx1ciBvbiB0aGUgZm9jdXNlZCBlbGVtZW50ICh1bmxlc3MgdGhlIGxpc3RlbmVyIGhhcyBwcmV2aW91c2x5IGJlZW4gYWRkZWQpXHJcbiAgICBpZiAoIXRoaXMubGlua2VkRWxlbWVudExpc3RlbmVyKSB7XHJcbiAgICAgIHRoaXMuJGxpbmtlZEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMucmVtb3ZlRm9jdXNQcm9wZXJ0aWVzLmJpbmQodGhpcykpO1xyXG4gICAgICB0aGlzLmxpbmtlZEVsZW1lbnRMaXN0ZW5lciA9IHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG4gICRsaW5rZWRFbGVtZW50LmZvY3VzKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogUmVtb3ZlIHRoZSB0YWJpbmRleCB0aGF0IG1ha2VzIHRoZSBsaW5rZWQgZWxlbWVudCBmb2N1c2FibGUgYmVjYXVzZSB0aGUgZWxlbWVudCBvbmx5IG5lZWRzIHRvIGJlXHJcbiAqIGZvY3VzYWJsZSB1bnRpbCBpdCBoYXMgcmVjZWl2ZWQgcHJvZ3JhbW1hdGljIGZvY3VzIGFuZCBhIHNjcmVlbiByZWFkZXIgaGFzIGFubm91bmNlZCBpdC5cclxuICpcclxuICogUmVtb3ZlIHRoZSBDU1MgY2xhc3MgdGhhdCByZW1vdmVzIHRoZSBuYXRpdmUgZm9jdXMgc3R5bGVzLlxyXG4gKi9cclxuU2tpcExpbmsucHJvdG90eXBlLnJlbW92ZUZvY3VzUHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLiRsaW5rZWRFbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgndGFiaW5kZXgnKTtcclxuICB0aGlzLiRsaW5rZWRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2dvdnVrLXNraXAtbGluay1mb2N1c2VkLWVsZW1lbnQnKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgZnJhZ21lbnQgZnJvbSBVUkxcclxuICpcclxuICogRXh0cmFjdCB0aGUgZnJhZ21lbnQgKGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIGhhc2ggc3ltYm9sKSBmcm9tIGEgVVJMLCBidXQgbm90IGluY2x1ZGluZ1xyXG4gKiB0aGUgc3ltYm9sLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBGcmFnbWVudCBmcm9tIFVSTCwgd2l0aG91dCB0aGUgaGFzaCBzeW1ib2xcclxuICovXHJcblNraXBMaW5rLnByb3RvdHlwZS5nZXRGcmFnbWVudEZyb21VcmwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgLy8gQmFpbCBpZiB0aGUgYW5jaG9yIGxpbmsgZG9lc24ndCBoYXZlIGEgaGFzaFxyXG4gIGlmICghdGhpcy4kbW9kdWxlLmhhc2gpIHtcclxuICAgIHJldHVybiBmYWxzZVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHRoaXMuJG1vZHVsZS5oYXNoLnNwbGl0KCcjJykucG9wKClcclxufTtcclxuXHJcbihmdW5jdGlvbih1bmRlZmluZWQpIHtcclxuXHJcbiAgICAvLyBEZXRlY3Rpb24gZnJvbSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLWxpYnJhcnkvbWFzdGVyL3BvbHlmaWxscy9FbGVtZW50L3Byb3RvdHlwZS9uZXh0RWxlbWVudFNpYmxpbmcvZGV0ZWN0LmpzXHJcbiAgICB2YXIgZGV0ZWN0ID0gKFxyXG4gICAgICAnZG9jdW1lbnQnIGluIHRoaXMgJiYgXCJuZXh0RWxlbWVudFNpYmxpbmdcIiBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnRcclxuICAgICk7XHJcblxyXG4gICAgaWYgKGRldGVjdCkgcmV0dXJuXHJcblxyXG4gICAgLy8gUG9seWZpbGwgZnJvbSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLWxpYnJhcnkvbWFzdGVyL3BvbHlmaWxscy9FbGVtZW50L3Byb3RvdHlwZS9uZXh0RWxlbWVudFNpYmxpbmcvcG9seWZpbGwuanNcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFbGVtZW50LnByb3RvdHlwZSwgXCJuZXh0RWxlbWVudFNpYmxpbmdcIiwge1xyXG4gICAgICBnZXQ6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGVsID0gdGhpcy5uZXh0U2libGluZztcclxuICAgICAgICB3aGlsZSAoZWwgJiYgZWwubm9kZVR5cGUgIT09IDEpIHsgZWwgPSBlbC5uZXh0U2libGluZzsgfVxyXG4gICAgICAgIHJldHVybiBlbDtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG59KS5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG5cclxuICAgIC8vIERldGVjdGlvbiBmcm9tIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtbGlicmFyeS9tYXN0ZXIvcG9seWZpbGxzL0VsZW1lbnQvcHJvdG90eXBlL3ByZXZpb3VzRWxlbWVudFNpYmxpbmcvZGV0ZWN0LmpzXHJcbiAgICB2YXIgZGV0ZWN0ID0gKFxyXG4gICAgICAnZG9jdW1lbnQnIGluIHRoaXMgJiYgXCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nXCIgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50XHJcbiAgICApO1xyXG5cclxuICAgIGlmIChkZXRlY3QpIHJldHVyblxyXG5cclxuICAgIC8vIFBvbHlmaWxsIGZyb20gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1saWJyYXJ5L21hc3Rlci9wb2x5ZmlsbHMvRWxlbWVudC9wcm90b3R5cGUvcHJldmlvdXNFbGVtZW50U2libGluZy9wb2x5ZmlsbC5qc1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVsZW1lbnQucHJvdG90eXBlLCAncHJldmlvdXNFbGVtZW50U2libGluZycsIHtcclxuICAgICAgZ2V0OiBmdW5jdGlvbigpe1xyXG4gICAgICAgIHZhciBlbCA9IHRoaXMucHJldmlvdXNTaWJsaW5nO1xyXG4gICAgICAgIHdoaWxlIChlbCAmJiBlbC5ub2RlVHlwZSAhPT0gMSkgeyBlbCA9IGVsLnByZXZpb3VzU2libGluZzsgfVxyXG4gICAgICAgIHJldHVybiBlbDtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG59KS5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxuLyoqXHJcbiAqIFRhYnMgY29tcG9uZW50XHJcbiAqXHJcbiAqIEBjbGFzc1xyXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAkbW9kdWxlIC0gSFRNTCBlbGVtZW50IHRvIHVzZSBmb3IgdGFic1xyXG4gKi9cclxuZnVuY3Rpb24gVGFicyAoJG1vZHVsZSkge1xyXG4gIHRoaXMuJG1vZHVsZSA9ICRtb2R1bGU7XHJcbiAgdGhpcy4kdGFicyA9ICRtb2R1bGUucXVlcnlTZWxlY3RvckFsbCgnLmdvdnVrLXRhYnNfX3RhYicpO1xyXG5cclxuICB0aGlzLmtleXMgPSB7IGxlZnQ6IDM3LCByaWdodDogMzksIHVwOiAzOCwgZG93bjogNDAgfTtcclxuICB0aGlzLmpzSGlkZGVuQ2xhc3MgPSAnZ292dWstdGFic19fcGFuZWwtLWhpZGRlbic7XHJcbn1cclxuXHJcblRhYnMucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgaWYgKHR5cGVvZiB3aW5kb3cubWF0Y2hNZWRpYSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgdGhpcy5zZXR1cFJlc3BvbnNpdmVDaGVja3MoKTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhpcy5zZXR1cCgpO1xyXG4gIH1cclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLnNldHVwUmVzcG9uc2l2ZUNoZWNrcyA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLm1xbCA9IHdpbmRvdy5tYXRjaE1lZGlhKCcobWluLXdpZHRoOiA0MC4wNjI1ZW0pJyk7XHJcbiAgdGhpcy5tcWwuYWRkTGlzdGVuZXIodGhpcy5jaGVja01vZGUuYmluZCh0aGlzKSk7XHJcbiAgdGhpcy5jaGVja01vZGUoKTtcclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLmNoZWNrTW9kZSA9IGZ1bmN0aW9uICgpIHtcclxuICBpZiAodGhpcy5tcWwubWF0Y2hlcykge1xyXG4gICAgdGhpcy5zZXR1cCgpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0aGlzLnRlYXJkb3duKCk7XHJcbiAgfVxyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUuc2V0dXAgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICRtb2R1bGUgPSB0aGlzLiRtb2R1bGU7XHJcbiAgdmFyICR0YWJzID0gdGhpcy4kdGFicztcclxuICB2YXIgJHRhYkxpc3QgPSAkbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoJy5nb3Z1ay10YWJzX19saXN0Jyk7XHJcbiAgdmFyICR0YWJMaXN0SXRlbXMgPSAkbW9kdWxlLnF1ZXJ5U2VsZWN0b3JBbGwoJy5nb3Z1ay10YWJzX19saXN0LWl0ZW0nKTtcclxuXHJcbiAgaWYgKCEkdGFicyB8fCAhJHRhYkxpc3QgfHwgISR0YWJMaXN0SXRlbXMpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgJHRhYkxpc3Quc2V0QXR0cmlidXRlKCdyb2xlJywgJ3RhYmxpc3QnKTtcclxuXHJcbiAgbm9kZUxpc3RGb3JFYWNoKCR0YWJMaXN0SXRlbXMsIGZ1bmN0aW9uICgkaXRlbSkge1xyXG4gICAgJGl0ZW0uc2V0QXR0cmlidXRlKCdyb2xlJywgJ3ByZXNlbnRhdGlvbicpO1xyXG4gIH0pO1xyXG5cclxuICBub2RlTGlzdEZvckVhY2goJHRhYnMsIGZ1bmN0aW9uICgkdGFiKSB7XHJcbiAgICAvLyBTZXQgSFRNTCBhdHRyaWJ1dGVzXHJcbiAgICB0aGlzLnNldEF0dHJpYnV0ZXMoJHRhYik7XHJcblxyXG4gICAgLy8gU2F2ZSBib3VuZGVkIGZ1bmN0aW9ucyB0byB1c2Ugd2hlbiByZW1vdmluZyBldmVudCBsaXN0ZW5lcnMgZHVyaW5nIHRlYXJkb3duXHJcbiAgICAkdGFiLmJvdW5kVGFiQ2xpY2sgPSB0aGlzLm9uVGFiQ2xpY2suYmluZCh0aGlzKTtcclxuICAgICR0YWIuYm91bmRUYWJLZXlkb3duID0gdGhpcy5vblRhYktleWRvd24uYmluZCh0aGlzKTtcclxuXHJcbiAgICAvLyBIYW5kbGUgZXZlbnRzXHJcbiAgICAkdGFiLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgJHRhYi5ib3VuZFRhYkNsaWNrLCB0cnVlKTtcclxuICAgICR0YWIuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsICR0YWIuYm91bmRUYWJLZXlkb3duLCB0cnVlKTtcclxuXHJcbiAgICAvLyBSZW1vdmUgb2xkIGFjdGl2ZSBwYW5lbHNcclxuICAgIHRoaXMuaGlkZVRhYigkdGFiKTtcclxuICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAvLyBTaG93IGVpdGhlciB0aGUgYWN0aXZlIHRhYiBhY2NvcmRpbmcgdG8gdGhlIFVSTCdzIGhhc2ggb3IgdGhlIGZpcnN0IHRhYlxyXG4gIHZhciAkYWN0aXZlVGFiID0gdGhpcy5nZXRUYWIod2luZG93LmxvY2F0aW9uLmhhc2gpIHx8IHRoaXMuJHRhYnNbMF07XHJcbiAgdGhpcy5zaG93VGFiKCRhY3RpdmVUYWIpO1xyXG5cclxuICAvLyBIYW5kbGUgaGFzaGNoYW5nZSBldmVudHNcclxuICAkbW9kdWxlLmJvdW5kT25IYXNoQ2hhbmdlID0gdGhpcy5vbkhhc2hDaGFuZ2UuYmluZCh0aGlzKTtcclxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsICRtb2R1bGUuYm91bmRPbkhhc2hDaGFuZ2UsIHRydWUpO1xyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUudGVhcmRvd24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICRtb2R1bGUgPSB0aGlzLiRtb2R1bGU7XHJcbiAgdmFyICR0YWJzID0gdGhpcy4kdGFicztcclxuICB2YXIgJHRhYkxpc3QgPSAkbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoJy5nb3Z1ay10YWJzX19saXN0Jyk7XHJcbiAgdmFyICR0YWJMaXN0SXRlbXMgPSAkbW9kdWxlLnF1ZXJ5U2VsZWN0b3JBbGwoJy5nb3Z1ay10YWJzX19saXN0LWl0ZW0nKTtcclxuXHJcbiAgaWYgKCEkdGFicyB8fCAhJHRhYkxpc3QgfHwgISR0YWJMaXN0SXRlbXMpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgJHRhYkxpc3QucmVtb3ZlQXR0cmlidXRlKCdyb2xlJyk7XHJcblxyXG4gIG5vZGVMaXN0Rm9yRWFjaCgkdGFiTGlzdEl0ZW1zLCBmdW5jdGlvbiAoJGl0ZW0pIHtcclxuICAgICRpdGVtLnJlbW92ZUF0dHJpYnV0ZSgncm9sZScsICdwcmVzZW50YXRpb24nKTtcclxuICB9KTtcclxuXHJcbiAgbm9kZUxpc3RGb3JFYWNoKCR0YWJzLCBmdW5jdGlvbiAoJHRhYikge1xyXG4gICAgLy8gUmVtb3ZlIGV2ZW50c1xyXG4gICAgJHRhYi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsICR0YWIuYm91bmRUYWJDbGljaywgdHJ1ZSk7XHJcbiAgICAkdGFiLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAkdGFiLmJvdW5kVGFiS2V5ZG93biwgdHJ1ZSk7XHJcblxyXG4gICAgLy8gVW5zZXQgSFRNTCBhdHRyaWJ1dGVzXHJcbiAgICB0aGlzLnVuc2V0QXR0cmlidXRlcygkdGFiKTtcclxuICB9LmJpbmQodGhpcykpO1xyXG5cclxuICAvLyBSZW1vdmUgaGFzaGNoYW5nZSBldmVudCBoYW5kbGVyXHJcbiAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2hhc2hjaGFuZ2UnLCAkbW9kdWxlLmJvdW5kT25IYXNoQ2hhbmdlLCB0cnVlKTtcclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLm9uSGFzaENoYW5nZSA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgdmFyIGhhc2ggPSB3aW5kb3cubG9jYXRpb24uaGFzaDtcclxuICB2YXIgJHRhYldpdGhIYXNoID0gdGhpcy5nZXRUYWIoaGFzaCk7XHJcbiAgaWYgKCEkdGFiV2l0aEhhc2gpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgLy8gUHJldmVudCBjaGFuZ2luZyB0aGUgaGFzaFxyXG4gIGlmICh0aGlzLmNoYW5naW5nSGFzaCkge1xyXG4gICAgdGhpcy5jaGFuZ2luZ0hhc2ggPSBmYWxzZTtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgLy8gU2hvdyBlaXRoZXIgdGhlIGFjdGl2ZSB0YWIgYWNjb3JkaW5nIHRvIHRoZSBVUkwncyBoYXNoIG9yIHRoZSBmaXJzdCB0YWJcclxuICB2YXIgJHByZXZpb3VzVGFiID0gdGhpcy5nZXRDdXJyZW50VGFiKCk7XHJcblxyXG4gIHRoaXMuaGlkZVRhYigkcHJldmlvdXNUYWIpO1xyXG4gIHRoaXMuc2hvd1RhYigkdGFiV2l0aEhhc2gpO1xyXG4gICR0YWJXaXRoSGFzaC5mb2N1cygpO1xyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUuaGlkZVRhYiA9IGZ1bmN0aW9uICgkdGFiKSB7XHJcbiAgdGhpcy51bmhpZ2hsaWdodFRhYigkdGFiKTtcclxuICB0aGlzLmhpZGVQYW5lbCgkdGFiKTtcclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLnNob3dUYWIgPSBmdW5jdGlvbiAoJHRhYikge1xyXG4gIHRoaXMuaGlnaGxpZ2h0VGFiKCR0YWIpO1xyXG4gIHRoaXMuc2hvd1BhbmVsKCR0YWIpO1xyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUuZ2V0VGFiID0gZnVuY3Rpb24gKGhhc2gpIHtcclxuICByZXR1cm4gdGhpcy4kbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoJy5nb3Z1ay10YWJzX190YWJbaHJlZj1cIicgKyBoYXNoICsgJ1wiXScpXHJcbn07XHJcblxyXG5UYWJzLnByb3RvdHlwZS5zZXRBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKCR0YWIpIHtcclxuICAvLyBzZXQgdGFiIGF0dHJpYnV0ZXNcclxuICB2YXIgcGFuZWxJZCA9IHRoaXMuZ2V0SHJlZigkdGFiKS5zbGljZSgxKTtcclxuICAkdGFiLnNldEF0dHJpYnV0ZSgnaWQnLCAndGFiXycgKyBwYW5lbElkKTtcclxuICAkdGFiLnNldEF0dHJpYnV0ZSgncm9sZScsICd0YWInKTtcclxuICAkdGFiLnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsIHBhbmVsSWQpO1xyXG4gICR0YWIuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ2ZhbHNlJyk7XHJcbiAgJHRhYi5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XHJcblxyXG4gIC8vIHNldCBwYW5lbCBhdHRyaWJ1dGVzXHJcbiAgdmFyICRwYW5lbCA9IHRoaXMuZ2V0UGFuZWwoJHRhYik7XHJcbiAgJHBhbmVsLnNldEF0dHJpYnV0ZSgncm9sZScsICd0YWJwYW5lbCcpO1xyXG4gICRwYW5lbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScsICR0YWIuaWQpO1xyXG4gICRwYW5lbC5jbGFzc0xpc3QuYWRkKHRoaXMuanNIaWRkZW5DbGFzcyk7XHJcbn07XHJcblxyXG5UYWJzLnByb3RvdHlwZS51bnNldEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoJHRhYikge1xyXG4gIC8vIHVuc2V0IHRhYiBhdHRyaWJ1dGVzXHJcbiAgJHRhYi5yZW1vdmVBdHRyaWJ1dGUoJ2lkJyk7XHJcbiAgJHRhYi5yZW1vdmVBdHRyaWJ1dGUoJ3JvbGUnKTtcclxuICAkdGFiLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycpO1xyXG4gICR0YWIucmVtb3ZlQXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJyk7XHJcbiAgJHRhYi5yZW1vdmVBdHRyaWJ1dGUoJ3RhYmluZGV4Jyk7XHJcblxyXG4gIC8vIHVuc2V0IHBhbmVsIGF0dHJpYnV0ZXNcclxuICB2YXIgJHBhbmVsID0gdGhpcy5nZXRQYW5lbCgkdGFiKTtcclxuICAkcGFuZWwucmVtb3ZlQXR0cmlidXRlKCdyb2xlJyk7XHJcbiAgJHBhbmVsLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1sYWJlbGxlZGJ5Jyk7XHJcbiAgJHBhbmVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5qc0hpZGRlbkNsYXNzKTtcclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLm9uVGFiQ2xpY2sgPSBmdW5jdGlvbiAoZSkge1xyXG4gIGlmICghZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdnb3Z1ay10YWJzX190YWInKSkge1xyXG4gIC8vIEFsbG93IGV2ZW50cyBvbiBjaGlsZCBET00gZWxlbWVudHMgdG8gYnViYmxlIHVwIHRvIHRhYiBwYXJlbnRcclxuICAgIHJldHVybiBmYWxzZVxyXG4gIH1cclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgdmFyICRuZXdUYWIgPSBlLnRhcmdldDtcclxuICB2YXIgJGN1cnJlbnRUYWIgPSB0aGlzLmdldEN1cnJlbnRUYWIoKTtcclxuICB0aGlzLmhpZGVUYWIoJGN1cnJlbnRUYWIpO1xyXG4gIHRoaXMuc2hvd1RhYigkbmV3VGFiKTtcclxuICB0aGlzLmNyZWF0ZUhpc3RvcnlFbnRyeSgkbmV3VGFiKTtcclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLmNyZWF0ZUhpc3RvcnlFbnRyeSA9IGZ1bmN0aW9uICgkdGFiKSB7XHJcbiAgdmFyICRwYW5lbCA9IHRoaXMuZ2V0UGFuZWwoJHRhYik7XHJcblxyXG4gIC8vIFNhdmUgYW5kIHJlc3RvcmUgdGhlIGlkXHJcbiAgLy8gc28gdGhlIHBhZ2UgZG9lc24ndCBqdW1wIHdoZW4gYSB1c2VyIGNsaWNrcyBhIHRhYiAod2hpY2ggY2hhbmdlcyB0aGUgaGFzaClcclxuICB2YXIgaWQgPSAkcGFuZWwuaWQ7XHJcbiAgJHBhbmVsLmlkID0gJyc7XHJcbiAgdGhpcy5jaGFuZ2luZ0hhc2ggPSB0cnVlO1xyXG4gIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gdGhpcy5nZXRIcmVmKCR0YWIpLnNsaWNlKDEpO1xyXG4gICRwYW5lbC5pZCA9IGlkO1xyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUub25UYWJLZXlkb3duID0gZnVuY3Rpb24gKGUpIHtcclxuICBzd2l0Y2ggKGUua2V5Q29kZSkge1xyXG4gICAgY2FzZSB0aGlzLmtleXMubGVmdDpcclxuICAgIGNhc2UgdGhpcy5rZXlzLnVwOlxyXG4gICAgICB0aGlzLmFjdGl2YXRlUHJldmlvdXNUYWIoKTtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBicmVha1xyXG4gICAgY2FzZSB0aGlzLmtleXMucmlnaHQ6XHJcbiAgICBjYXNlIHRoaXMua2V5cy5kb3duOlxyXG4gICAgICB0aGlzLmFjdGl2YXRlTmV4dFRhYigpO1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGJyZWFrXHJcbiAgfVxyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUuYWN0aXZhdGVOZXh0VGFiID0gZnVuY3Rpb24gKCkge1xyXG4gIHZhciBjdXJyZW50VGFiID0gdGhpcy5nZXRDdXJyZW50VGFiKCk7XHJcbiAgdmFyIG5leHRUYWJMaXN0SXRlbSA9IGN1cnJlbnRUYWIucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmc7XHJcbiAgaWYgKG5leHRUYWJMaXN0SXRlbSkge1xyXG4gICAgdmFyIG5leHRUYWIgPSBuZXh0VGFiTGlzdEl0ZW0ucXVlcnlTZWxlY3RvcignLmdvdnVrLXRhYnNfX3RhYicpO1xyXG4gIH1cclxuICBpZiAobmV4dFRhYikge1xyXG4gICAgdGhpcy5oaWRlVGFiKGN1cnJlbnRUYWIpO1xyXG4gICAgdGhpcy5zaG93VGFiKG5leHRUYWIpO1xyXG4gICAgbmV4dFRhYi5mb2N1cygpO1xyXG4gICAgdGhpcy5jcmVhdGVIaXN0b3J5RW50cnkobmV4dFRhYik7XHJcbiAgfVxyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUuYWN0aXZhdGVQcmV2aW91c1RhYiA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgY3VycmVudFRhYiA9IHRoaXMuZ2V0Q3VycmVudFRhYigpO1xyXG4gIHZhciBwcmV2aW91c1RhYkxpc3RJdGVtID0gY3VycmVudFRhYi5wYXJlbnROb2RlLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XHJcbiAgaWYgKHByZXZpb3VzVGFiTGlzdEl0ZW0pIHtcclxuICAgIHZhciBwcmV2aW91c1RhYiA9IHByZXZpb3VzVGFiTGlzdEl0ZW0ucXVlcnlTZWxlY3RvcignLmdvdnVrLXRhYnNfX3RhYicpO1xyXG4gIH1cclxuICBpZiAocHJldmlvdXNUYWIpIHtcclxuICAgIHRoaXMuaGlkZVRhYihjdXJyZW50VGFiKTtcclxuICAgIHRoaXMuc2hvd1RhYihwcmV2aW91c1RhYik7XHJcbiAgICBwcmV2aW91c1RhYi5mb2N1cygpO1xyXG4gICAgdGhpcy5jcmVhdGVIaXN0b3J5RW50cnkocHJldmlvdXNUYWIpO1xyXG4gIH1cclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLmdldFBhbmVsID0gZnVuY3Rpb24gKCR0YWIpIHtcclxuICB2YXIgJHBhbmVsID0gdGhpcy4kbW9kdWxlLnF1ZXJ5U2VsZWN0b3IodGhpcy5nZXRIcmVmKCR0YWIpKTtcclxuICByZXR1cm4gJHBhbmVsXHJcbn07XHJcblxyXG5UYWJzLnByb3RvdHlwZS5zaG93UGFuZWwgPSBmdW5jdGlvbiAoJHRhYikge1xyXG4gIHZhciAkcGFuZWwgPSB0aGlzLmdldFBhbmVsKCR0YWIpO1xyXG4gICRwYW5lbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuanNIaWRkZW5DbGFzcyk7XHJcbn07XHJcblxyXG5UYWJzLnByb3RvdHlwZS5oaWRlUGFuZWwgPSBmdW5jdGlvbiAodGFiKSB7XHJcbiAgdmFyICRwYW5lbCA9IHRoaXMuZ2V0UGFuZWwodGFiKTtcclxuICAkcGFuZWwuY2xhc3NMaXN0LmFkZCh0aGlzLmpzSGlkZGVuQ2xhc3MpO1xyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUudW5oaWdobGlnaHRUYWIgPSBmdW5jdGlvbiAoJHRhYikge1xyXG4gICR0YWIuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ2ZhbHNlJyk7XHJcbiAgJHRhYi5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2dvdnVrLXRhYnNfX2xpc3QtaXRlbS0tc2VsZWN0ZWQnKTtcclxuICAkdGFiLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLmhpZ2hsaWdodFRhYiA9IGZ1bmN0aW9uICgkdGFiKSB7XHJcbiAgJHRhYi5zZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAndHJ1ZScpO1xyXG4gICR0YWIucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdnb3Z1ay10YWJzX19saXN0LWl0ZW0tLXNlbGVjdGVkJyk7XHJcbiAgJHRhYi5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKTtcclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLmdldEN1cnJlbnRUYWIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgcmV0dXJuIHRoaXMuJG1vZHVsZS5xdWVyeVNlbGVjdG9yKCcuZ292dWstdGFic19fbGlzdC1pdGVtLS1zZWxlY3RlZCAuZ292dWstdGFic19fdGFiJylcclxufTtcclxuXHJcbi8vIHRoaXMgaXMgYmVjYXVzZSBJRSBkb2Vzbid0IGFsd2F5cyByZXR1cm4gdGhlIGFjdHVhbCB2YWx1ZSBidXQgYSByZWxhdGl2ZSBmdWxsIHBhdGhcclxuLy8gc2hvdWxkIGJlIGEgdXRpbGl0eSBmdW5jdGlvbiBtb3N0IHByb2JcclxuLy8gaHR0cDovL2xhYnMudGhlc2VkYXlzLmNvbS9ibG9nLzIwMTAvMDEvMDgvZ2V0dGluZy10aGUtaHJlZi12YWx1ZS13aXRoLWpxdWVyeS1pbi1pZS9cclxuVGFicy5wcm90b3R5cGUuZ2V0SHJlZiA9IGZ1bmN0aW9uICgkdGFiKSB7XHJcbiAgdmFyIGhyZWYgPSAkdGFiLmdldEF0dHJpYnV0ZSgnaHJlZicpO1xyXG4gIHZhciBoYXNoID0gaHJlZi5zbGljZShocmVmLmluZGV4T2YoJyMnKSwgaHJlZi5sZW5ndGgpO1xyXG4gIHJldHVybiBoYXNoXHJcbn07XHJcblxyXG4vKipcclxuICogSW5pdGlhbGlzZSBhbGwgY29tcG9uZW50c1xyXG4gKlxyXG4gKiBVc2UgdGhlIGBkYXRhLW1vZHVsZWAgYXR0cmlidXRlcyB0byBmaW5kLCBpbnN0YW50aWF0ZSBhbmQgaW5pdCBhbGwgb2YgdGhlXHJcbiAqIGNvbXBvbmVudHMgcHJvdmlkZWQgYXMgcGFydCBvZiBHT1YuVUsgRnJvbnRlbmQuXHJcbiAqXHJcbiAqIEBwYXJhbSB7Q29uZmlnfSBbY29uZmlnXSAtIENvbmZpZyBmb3IgYWxsIGNvbXBvbmVudHNcclxuICovXHJcbmZ1bmN0aW9uIGluaXRBbGwgKGNvbmZpZykge1xyXG4gIGNvbmZpZyA9IHR5cGVvZiBjb25maWcgIT09ICd1bmRlZmluZWQnID8gY29uZmlnIDoge307XHJcblxyXG4gIC8vIEFsbG93IHRoZSB1c2VyIHRvIGluaXRpYWxpc2UgR09WLlVLIEZyb250ZW5kIGluIG9ubHkgY2VydGFpbiBzZWN0aW9ucyBvZiB0aGUgcGFnZVxyXG4gIC8vIERlZmF1bHRzIHRvIHRoZSBlbnRpcmUgZG9jdW1lbnQgaWYgbm90aGluZyBpcyBzZXQuXHJcbiAgdmFyICRzY29wZSA9IHR5cGVvZiBjb25maWcuc2NvcGUgIT09ICd1bmRlZmluZWQnID8gY29uZmlnLnNjb3BlIDogZG9jdW1lbnQ7XHJcblxyXG4gIHZhciAkYWNjb3JkaW9ucyA9ICRzY29wZS5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1tb2R1bGU9XCJnb3Z1ay1hY2NvcmRpb25cIl0nKTtcclxuICBub2RlTGlzdEZvckVhY2goJGFjY29yZGlvbnMsIGZ1bmN0aW9uICgkYWNjb3JkaW9uKSB7XHJcbiAgICBuZXcgQWNjb3JkaW9uKCRhY2NvcmRpb24sIGNvbmZpZy5hY2NvcmRpb24pLmluaXQoKTtcclxuICB9KTtcclxuXHJcbiAgdmFyICRidXR0b25zID0gJHNjb3BlLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1vZHVsZT1cImdvdnVrLWJ1dHRvblwiXScpO1xyXG4gIG5vZGVMaXN0Rm9yRWFjaCgkYnV0dG9ucywgZnVuY3Rpb24gKCRidXR0b24pIHtcclxuICAgIG5ldyBCdXR0b24oJGJ1dHRvbiwgY29uZmlnLmJ1dHRvbikuaW5pdCgpO1xyXG4gIH0pO1xyXG5cclxuICB2YXIgJGNoYXJhY3RlckNvdW50cyA9ICRzY29wZS5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1tb2R1bGU9XCJnb3Z1ay1jaGFyYWN0ZXItY291bnRcIl0nKTtcclxuICBub2RlTGlzdEZvckVhY2goJGNoYXJhY3RlckNvdW50cywgZnVuY3Rpb24gKCRjaGFyYWN0ZXJDb3VudCkge1xyXG4gICAgbmV3IENoYXJhY3RlckNvdW50KCRjaGFyYWN0ZXJDb3VudCwgY29uZmlnLmNoYXJhY3RlckNvdW50KS5pbml0KCk7XHJcbiAgfSk7XHJcblxyXG4gIHZhciAkY2hlY2tib3hlcyA9ICRzY29wZS5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1tb2R1bGU9XCJnb3Z1ay1jaGVja2JveGVzXCJdJyk7XHJcbiAgbm9kZUxpc3RGb3JFYWNoKCRjaGVja2JveGVzLCBmdW5jdGlvbiAoJGNoZWNrYm94KSB7XHJcbiAgICBuZXcgQ2hlY2tib3hlcygkY2hlY2tib3gpLmluaXQoKTtcclxuICB9KTtcclxuXHJcbiAgdmFyICRkZXRhaWxzID0gJHNjb3BlLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1vZHVsZT1cImdvdnVrLWRldGFpbHNcIl0nKTtcclxuICBub2RlTGlzdEZvckVhY2goJGRldGFpbHMsIGZ1bmN0aW9uICgkZGV0YWlsKSB7XHJcbiAgICBuZXcgRGV0YWlscygkZGV0YWlsKS5pbml0KCk7XHJcbiAgfSk7XHJcblxyXG4gIC8vIEZpbmQgZmlyc3QgZXJyb3Igc3VtbWFyeSBtb2R1bGUgdG8gZW5oYW5jZS5cclxuICB2YXIgJGVycm9yU3VtbWFyeSA9ICRzY29wZS5xdWVyeVNlbGVjdG9yKCdbZGF0YS1tb2R1bGU9XCJnb3Z1ay1lcnJvci1zdW1tYXJ5XCJdJyk7XHJcbiAgaWYgKCRlcnJvclN1bW1hcnkpIHtcclxuICAgIG5ldyBFcnJvclN1bW1hcnkoJGVycm9yU3VtbWFyeSwgY29uZmlnLmVycm9yU3VtbWFyeSkuaW5pdCgpO1xyXG4gIH1cclxuXHJcbiAgLy8gRmluZCBmaXJzdCBoZWFkZXIgbW9kdWxlIHRvIGVuaGFuY2UuXHJcbiAgdmFyICRoZWFkZXIgPSAkc2NvcGUucXVlcnlTZWxlY3RvcignW2RhdGEtbW9kdWxlPVwiZ292dWstaGVhZGVyXCJdJyk7XHJcbiAgaWYgKCRoZWFkZXIpIHtcclxuICAgIG5ldyBIZWFkZXIoJGhlYWRlcikuaW5pdCgpO1xyXG4gIH1cclxuXHJcbiAgdmFyICRub3RpZmljYXRpb25CYW5uZXJzID0gJHNjb3BlLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1vZHVsZT1cImdvdnVrLW5vdGlmaWNhdGlvbi1iYW5uZXJcIl0nKTtcclxuICBub2RlTGlzdEZvckVhY2goJG5vdGlmaWNhdGlvbkJhbm5lcnMsIGZ1bmN0aW9uICgkbm90aWZpY2F0aW9uQmFubmVyKSB7XHJcbiAgICBuZXcgTm90aWZpY2F0aW9uQmFubmVyKCRub3RpZmljYXRpb25CYW5uZXIsIGNvbmZpZy5ub3RpZmljYXRpb25CYW5uZXIpLmluaXQoKTtcclxuICB9KTtcclxuXHJcbiAgdmFyICRyYWRpb3MgPSAkc2NvcGUucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtbW9kdWxlPVwiZ292dWstcmFkaW9zXCJdJyk7XHJcbiAgbm9kZUxpc3RGb3JFYWNoKCRyYWRpb3MsIGZ1bmN0aW9uICgkcmFkaW8pIHtcclxuICAgIG5ldyBSYWRpb3MoJHJhZGlvKS5pbml0KCk7XHJcbiAgfSk7XHJcblxyXG4gIC8vIEZpbmQgZmlyc3Qgc2tpcCBsaW5rIG1vZHVsZSB0byBlbmhhbmNlLlxyXG4gIHZhciAkc2tpcExpbmsgPSAkc2NvcGUucXVlcnlTZWxlY3RvcignW2RhdGEtbW9kdWxlPVwiZ292dWstc2tpcC1saW5rXCJdJyk7XHJcbiAgbmV3IFNraXBMaW5rKCRza2lwTGluaykuaW5pdCgpO1xyXG5cclxuICB2YXIgJHRhYnMgPSAkc2NvcGUucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtbW9kdWxlPVwiZ292dWstdGFic1wiXScpO1xyXG4gIG5vZGVMaXN0Rm9yRWFjaCgkdGFicywgZnVuY3Rpb24gKCR0YWJzKSB7XHJcbiAgICBuZXcgVGFicygkdGFicykuaW5pdCgpO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogQ29uZmlnIGZvciBhbGwgY29tcG9uZW50c1xyXG4gKlxyXG4gKiBAdHlwZWRlZiB7b2JqZWN0fSBDb25maWdcclxuICogQHByb3BlcnR5IHtIVE1MRWxlbWVudH0gW3Njb3BlPWRvY3VtZW50XSAtIFNjb3BlIHRvIHF1ZXJ5IGZvciBjb21wb25lbnRzXHJcbiAqIEBwcm9wZXJ0eSB7aW1wb3J0KCcuL2NvbXBvbmVudHMvYWNjb3JkaW9uL2FjY29yZGlvbi5tanMnKS5BY2NvcmRpb25Db25maWd9IFthY2NvcmRpb25dIC0gQWNjb3JkaW9uIGNvbmZpZ1xyXG4gKiBAcHJvcGVydHkge2ltcG9ydCgnLi9jb21wb25lbnRzL2J1dHRvbi9idXR0b24ubWpzJykuQnV0dG9uQ29uZmlnfSBbYnV0dG9uXSAtIEJ1dHRvbiBjb25maWdcclxuICogQHByb3BlcnR5IHtpbXBvcnQoJy4vY29tcG9uZW50cy9jaGFyYWN0ZXItY291bnQvY2hhcmFjdGVyLWNvdW50Lm1qcycpLkNoYXJhY3RlckNvdW50Q29uZmlnfSBbY2hhcmFjdGVyQ291bnRdIC0gQ2hhcmFjdGVyIENvdW50IGNvbmZpZ1xyXG4gKiBAcHJvcGVydHkge2ltcG9ydCgnLi9jb21wb25lbnRzL2Vycm9yLXN1bW1hcnkvZXJyb3Itc3VtbWFyeS5tanMnKS5FcnJvclN1bW1hcnlDb25maWd9IFtlcnJvclN1bW1hcnldIC0gRXJyb3IgU3VtbWFyeSBjb25maWdcclxuICogQHByb3BlcnR5IHtpbXBvcnQoJy4vY29tcG9uZW50cy9ub3RpZmljYXRpb24tYmFubmVyL25vdGlmaWNhdGlvbi1iYW5uZXIubWpzJykuTm90aWZpY2F0aW9uQmFubmVyQ29uZmlnfSBbbm90aWZpY2F0aW9uQmFubmVyXSAtIE5vdGlmaWNhdGlvbiBCYW5uZXIgY29uZmlnXHJcbiAqL1xyXG5cclxuZXhwb3J0cy5pbml0QWxsID0gaW5pdEFsbDtcclxuZXhwb3J0cy5BY2NvcmRpb24gPSBBY2NvcmRpb247XHJcbmV4cG9ydHMuQnV0dG9uID0gQnV0dG9uO1xyXG5leHBvcnRzLkRldGFpbHMgPSBEZXRhaWxzO1xyXG5leHBvcnRzLkNoYXJhY3RlckNvdW50ID0gQ2hhcmFjdGVyQ291bnQ7XHJcbmV4cG9ydHMuQ2hlY2tib3hlcyA9IENoZWNrYm94ZXM7XHJcbmV4cG9ydHMuRXJyb3JTdW1tYXJ5ID0gRXJyb3JTdW1tYXJ5O1xyXG5leHBvcnRzLkhlYWRlciA9IEhlYWRlcjtcclxuZXhwb3J0cy5Ob3RpZmljYXRpb25CYW5uZXIgPSBOb3RpZmljYXRpb25CYW5uZXI7XHJcbmV4cG9ydHMuUmFkaW9zID0gUmFkaW9zO1xyXG5leHBvcnRzLlNraXBMaW5rID0gU2tpcExpbms7XHJcbmV4cG9ydHMuVGFicyA9IFRhYnM7XHJcblxyXG59KSkpO1xyXG4iXX0=\r\n"]}