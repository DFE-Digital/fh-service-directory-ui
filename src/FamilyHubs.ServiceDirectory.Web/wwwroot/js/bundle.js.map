{"version":3,"sources":["tmp/js/components/analytics.js","tmp/js/components/cookie-functions.js","tmp/js/components/helpers.js","tmp/js/components/cookie-banner.js","tmp/js/components/cookies-page.js","tmp/js/bundle.js"],"names":["loadAnalytics","window","dataLayer","w","d","s","l","i","push","Date","getTime","event","f","getElementsByTagName","j","createElement","async","src","parentNode","insertBefore","document","CONSENT_COOKIE_NAME","TRACKING_LIVE_ID","COOKIE_CATEGORIES","analytics","essential","DEFAULT_COOKIE_CONSENT","Cookie","name","value","options","getCookie","deleteCookie","days","setCookie","getConsentCookie","consentCookieObj","consentCookie","JSON","parse","err","isValidConsentCookie","version","GDS_CONSENT_COOKIE_VERSION","setConsentCookie","cookieConsent","option","stringify","resetCookies","cookieType","Analytics","forEach","cookie","userAllowsCookieCategory","cookieCategory","cookiePreferences","e","console","error","userAllowsCookie","cookieName","category","indexOf","nameEQ","cookies","split","len","length","charAt","substring","decodeURIComponent","cookieString","date","setTime","toUTCString","location","protocol","hostname","nodeListForEach","nodes","callback","NodeList","prototype","call","cookieBannerAcceptSelector","cookieBannerRejectSelector","cookieBannerHideButtonSelector","cookieMessageSelector","cookieConfirmationAcceptSelector","cookieConfirmationRejectSelector","CookieBanner","$module","this","CookiesPage","init","$cookieBanner","$acceptButton","querySelector","$rejectButton","$cookieMessage","$cookieConfirmationAccept","$cookieConfirmationReject","$cookieBannerHideButtons","querySelectorAll","onCookiesPage","currentConsentCookie","CookieFunctions.getConsentCookie","CookieFunctions.isValidConsentCookie","CookieFunctions.resetCookies","removeAttribute","addEventListener","acceptCookies","bind","rejectCookies","$cookieBannerHideButton","hideBanner","setAttribute","CookieFunctions.setConsentCookie","revealConfirmationMessage","confirmationMessage","getAttribute","focus","pathname","$cookiePage","$cookieForm","$cookieFormFieldsets","$successNotification","$successLink","$cookieFormFieldset","showUserPreference","savePreferences","preventDefault","preferences","getCookieType","selectedItem","showSuccessNotification","preference","undefined","radioValue","checked","referrer","URL","href","scrollTo","id","global","factory","exports","module","define","amd","GOVUKFrontend","mergeConfigs","flattenObject","configObject","flattenedObject","flattenLoop","obj","prefix","key","Object","hasOwnProperty","prefixedKey","formattedConfigObject","arguments","extractConfigByNamespace","namespace","Error","newObject","keyParts","shift","join","I18n","translations","config","locale","documentElement","lang","normaliseString","trimmedValue","trim","isFinite","Number","normaliseDataset","dataset","out","t","lookupKey","count","getPluralSuffix","translationString","match","replacePlaceholders","formatter","hasIntlNumberFormatSupport","Intl","NumberFormat","replace","placeholderWithBraces","placeholderKey","placeholderValue","format","hasIntlPluralRulesSupport","Boolean","PluralRules","supportedLocalesOf","preferredForm","select","selectPluralFormUsingFallbackRules","warn","Math","abs","floor","ruleset","getPluralRulesForLocale","pluralRules","localeShort","pluralRule","pluralRulesMap","languages","arabic","chinese","french","german","irish","russian","scottish","spanish","welsh","n","lastTwo","last","nativeDefineProperty","supportsAccessors","ERR_ACCESSORS_NOT_SUPPORTED","ERR_VALUE_ACCESSORS","defineProperty","object","property","descriptor","Element","TypeError","propertyString","String","hasValueOrWritable","getterType","get","setterType","set","__defineGetter__","__defineSetter__","self","Function","that","isCallable","$Array","Array","$Object","ObjectPrototype","ArrayPrototype","Empty","to_string","toString","hasToStringTag","Symbol","toStringTag","fnToStr","tryFunctionObject","fnClass","genClass","strClass","array_slice","slice","array_concat","concat","array_push","max","target","bound","args","binder","result","apply","boundLength","boundArgs","x","classList","toggle","className","DOMTokenList","createElementNS","dpSupport","defineGetter","fn","configurable","el","prop","tokens","tokenMap","maxLength","addIndexGetter","preop","reindex","rSpace","test","SyntaxError","code","baseVal","toLocaleString","item","idx","contains","token","add","remove","ignore","force","constructor","native","WorkerGlobalScope","importScripts","HTMLDocument","Document","HTMLElement","interval","vbody","appendChild","frameDocument","contentWindow","cache","shiv","element","deep","childNode","childNodes","index","nodeType","elements","nativeCreateElement","loopLimit","attachEvent","propertyName","nonValue","newValue","oldValue","hasAttribute","bodyCheck","onreadystatechange","setInterval","nodeName","toLowerCase","removeChild","clearTimeout","body","readyState","addProp","o","attr","tokenList","THIS","gibberishProperty","visage","mirror","reflections","_R","HTMLLinkElement","HTMLAnchorElement","HTMLAreaElement","aB","attributes","map","attribute","propName","substr","toUpperCase","enumerable","ACCORDION_TRANSLATIONS","hideAllSections","hideSection","hideSectionAriaLabel","showAllSections","showSection","showSectionAriaLabel","Accordion","$sections","browserSupportsSessionStorage","helper","checkForSessionStorage","defaultConfig","i18n","controlsClass","showAllClass","showAllTextClass","sectionExpandedClass","sectionButtonClass","sectionHeaderClass","sectionHeadingClass","sectionHeadingTextClass","sectionHeadingTextFocusClass","sectionShowHideToggleClass","sectionShowHideToggleFocusClass","sectionShowHideTextClass","upChevronIconClass","downChevronIconClass","sectionSummaryClass","sectionSummaryFocusClass","initControls","initSectionHeaders","areAllSectionsOpen","checkIfAllSectionsOpen","updateShowAllButton","$showAllButton","$icon","$accordionControls","firstChild","$wrappershowAllText","onShowOrHideAllToggle","$section","$header","constructHeaderMarkup","setExpanded","isExpanded","onSectionToggle","setInitialState","$headerWrapper","$span","$heading","$summary","$button","nodeValue","$headingText","$headingTextFocus","innerHTML","$showToggle","$showToggleFocus","$showToggleText","getButtonPunctuationEl","$summarySpan","$summarySpanFocus","replaceChild","expanded","storeState","nowExpanded","$showHideText","newButtonText","innerText","ariaLabelParts","ariaLabelMessage","$showAllIcon","$showAllText","testString","sessionStorage","setItem","getItem","removeItem","exception","contentId","contentState","$punctuationEl","Window","Event","unlistenableWindowEvents","click","dblclick","keyup","keypress","keydown","mousedown","mouseup","mousemove","mouseover","mouseenter","mouseleave","mouseout","storage","storagecommit","textinput","existingProto","type","eventInitDict","createEvent","bubbles","cancelable","initEvent","createEventObject","writable","listener","_events","eventElement","list","events","returnValue","stopPropagation","cancelBubble","stopImmediatePropagation","cancelImmediate","currentTarget","relatedTarget","fromElement","srcElement","timeStamp","clientX","pageX","scrollLeft","pageY","clientY","scrollTop","removeEventListener","splice","detachEvent","dispatchEvent","cancelBubbleEvent","fireEvent","parentWindow","array","Button","debounceFormSubmitTimer","preventDoubleClick","handleKeyDown","debounce","keyCode","setTimeout","DEBOUNCE_TIMEOUT_IN_SECONDS","Details","closestAttributeValue","$element","attributeName","closestElementWithAttribute","closest","open","polyfillDetails","$content","performance","now","c","r","random","tabIndex","style","display","polyfillHandleInputs","polyfillSetAttributes","node","matches","webkitMatchesSelector","oMatchesSelector","msMatchesSelector","mozMatchesSelector","selector","ownerDocument","SVGElement","parentElement","CHARACTER_COUNT_TRANSLATIONS","charactersUnderLimit","one","other","charactersAtLimit","charactersOverLimit","wordsUnderLimit","wordsAtLimit","wordsOverLimit","textareaDescription","CharacterCount","threshold","datasetConfig","configOverrides","maxlength","maxwords","$textarea","$visibleCountMessage","$screenReaderCountMessage","lastInputTimestamp","Checkboxes","$inputs","ErrorSummary","disableAutoFocus","NotificationBanner","Header","$menuButton","$menu","menuIsOpen","mql","Radios","SkipLink","$linkedElement","linkedElementListener","Tabs","$tabs","keys","left","right","up","down","jsHiddenClass","$textareaDescription","getElementById","insertAdjacentElement","bindChangeEvents","updateCountMessage","handleKeyUp","handleFocus","handleBlur","updateVisibleCountMessage","valueChecker","updateIfValueChanged","clearInterval","updateScreenReaderCountMessage","remainingNumber","isOverThreshold","getCountMessage","text","countType","formatCountMessage","translationKeySuffix","currentLength","$input","syncAllConditionalReveals","handleClick","syncConditionalRevealWithInputState","$target","inputIsChecked","unCheckAllInputsExcept","$inputWithSameName","form","unCheckExclusiveInputs","$exclusiveInput","setFocus","focusTarget","tagName","inputId","getFragmentFromUrl","$legendOrLabel","getAssociatedLegendOrLabel","scrollIntoView","preventScroll","url","pop","$fieldset","legends","$candidateLegend","legendTop","getBoundingClientRect","top","inputRect","height","innerHeight","matchMedia","syncState","addListener","handleMenuButtonClick","$clickedInput","hasSameFormOwner","getLinkedElement","focusLinkedElement","linkedElementId","removeFocusProperties","hash","nextSibling","previousSibling","setupResponsiveChecks","setup","checkMode","teardown","$tabList","$tabListItems","$item","$tab","setAttributes","boundTabClick","onTabClick","boundTabKeydown","onTabKeydown","hideTab","$activeTab","getTab","showTab","boundOnHashChange","onHashChange","unsetAttributes","$tabWithHash","changingHash","$previousTab","getCurrentTab","unhighlightTab","hidePanel","highlightTab","showPanel","panelId","getHref","$panel","getPanel","$newTab","$currentTab","createHistoryEntry","activatePreviousTab","activateNextTab","currentTab","nextTabListItem","nextElementSibling","nextTab","previousTabListItem","previousElementSibling","previousTab","tab","initAll","$scope","scope","$accordion","accordion","button","$characterCount","characterCount","$checkbox","$detail","$errorSummary","errorSummary","$notificationBanner","notificationBanner","$radio","userConsent","$cookiesPage","backLinks","link","history","back","filterButton"],"mappings":"AAIe,SAASA,gBAGfC,OAAOC,WAGR,SAAWC,EAAGC,EAAGC,EAAGC,EAAGC,GACnBJ,EAAEG,GAAKH,EAAEG,IAAM,GACfH,EAAEG,GAAGE,KAAK,CACN,aAAa,IAAIC,MAAOC,UAAWC,MAAO,WAE9C,IAAIC,EAAIR,EAAES,qBAAqBR,GAAG,GAAIS,EAAIV,EAAEW,cAAcV,GAC1DS,EAAEE,OAAQ,EACVF,EAAEG,IACE,yDACJL,EAAEM,WAAWC,aAAaL,EAAGF,EAChC,CAVD,CAUGX,OAAQmB,SAAU,SAAU,YAevC,CCpBA,IAAIC,oBAAsB,mCAKtBC,iBAAmB,eAEnBC,kBAAoB,CACpBC,UAAW,CAAC,MAAO,OAASF,kBAO5BG,UAAW,CAAC,qCASZC,uBAAyB,CACzBF,WAAW,GAgBf,SAAgBG,OAAOC,EAAMC,EAAOC,GAChC,QAAqB,IAAVD,EAaP,OAAOE,UAAUH,IAZH,IAAVC,GAA6B,OAAVA,EACnBG,aAAaJ,SAIU,IAAZE,IACPA,EAAU,CAAEG,KAAM,KAEtBC,UAAUN,EAAMC,EAAOC,GAMnC,CAMA,SAAgBK,mBACZ,IACIC,EADAC,EAAgBN,UAAUV,qBAE9B,IAAIgB,EASA,OAAO,KARP,IACID,EAAmBE,KAAKC,MAAMF,EAI1C,CAFQ,MAAOG,GACH,OAAO,IACnB,CAKI,OAAOJ,CACX,CAQA,SAAgBK,qBAAqBX,GACjC,OAAQA,GAAWA,EAAQY,SAAWzC,OAAO0C,0BACjD,CAEA,SAAgBC,iBAAiBd,GAC7B,IAAIe,EAAgBV,mBAKpB,IAAK,IAAIW,KAJJD,IACDA,EAAgBP,KAAKC,MAAMD,KAAKS,UAAUrB,0BAG3BI,EACfe,EAAcC,GAAUhB,EAAQgB,UAG7BD,EAAcpB,UACrBoB,EAAcH,QAAUzC,OAAO0C,2BAE/BT,UAAUb,oBAAqBiB,KAAKS,UAAUF,GAAgB,CAAEZ,KAAM,MAEtEe,cACJ,CAKA,SAAgBA,eACZ,IAAIlB,EAAUK,mBAKd,IAAK,IAAIc,KAHJR,qBAAqBX,KACtBA,EAAUQ,KAAKC,MAAMD,KAAKS,UAAUrB,0BAEjBI,EAAS,CAC5B,GAAmB,YAAfmB,EAIJ,GAAmB,cAAfA,EAaJ,GATmB,cAAfA,GAA8BnB,EAAQmB,IAEtChD,OAAO,cAAgBqB,mBAAoB,EAC3C4B,iBAIAjD,OAAO,cAAgBqB,mBAAoB,GAE1CQ,EAAQmB,GAEe1B,kBAAkB0B,GACxBE,SAAQ,SAAUC,GAEhCzB,OAAOyB,EAAQ,KAC/B,GAEA,CACA,CACA,SAASC,yBAAyBC,EAAgBC,GAE9C,GAAuB,cAAnBD,EACA,OAAO,EAGX,IACI,OAAOC,EAAkBD,EAKjC,CAHI,MAAOE,GAEH,OADAC,QAAQC,MAAMF,IACP,CACf,CACA,CACA,SAASG,iBAAiBC,GAEtB,GAAIA,IAAevC,oBACf,OAAO,EAGX,IAAIkC,EAAoBpB,mBAKxB,IAAK,IAAI0B,KAHJpB,qBAAqBc,KACtBA,EAAoB7B,wBAEHH,kBAAmB,CAEpC,GAA8C,OADtBA,kBAAkBsC,GACpBC,QAAQF,GAC1B,OAAOP,yBAAyBQ,EAAUN,EAEtD,CAEI,OAAO,CACX,CACA,SAASxB,UAAUH,GAGf,IAFA,IAAImC,EAASnC,EAAO,IAChBoC,EAAU5C,SAASgC,OAAOa,MAAM,KAC3B1D,EAAI,EAAG2D,EAAMF,EAAQG,OAAQ5D,EAAI2D,EAAK3D,IAAK,CAEhD,IADA,IAAI6C,EAASY,EAAQzD,GACO,MAArB6C,EAAOgB,OAAO,IACjBhB,EAASA,EAAOiB,UAAU,EAAGjB,EAAOe,QAExC,GAA+B,IAA3Bf,EAAOU,QAAQC,GACf,OAAOO,mBAAmBlB,EAAOiB,UAAUN,EAAOI,QAE9D,CACI,OAAO,IACX,CAEA,SAASjC,UAAUN,EAAMC,EAAOC,GAC5B,GAAI6B,iBAAiB/B,GAAO,MACD,IAAZE,IACPA,EAAU,CAAA,GAEd,IAAIyC,EAAe3C,EAAO,IAAMC,EAAQ,4BACxC,GAAIC,EAAQG,KAAM,CACd,IAAIuC,EAAO,IAAI/D,KACf+D,EAAKC,QAAQD,EAAK9D,UAA4B,GAAfoB,EAAQG,KAAY,GAAK,GAAK,KAC7DsC,EAAeA,EAAe,aAAeC,EAAKE,aAC9D,CAC2C,WAA/BtD,SAASuD,SAASC,WAClBL,GAA8B,YAElCnD,SAASgC,OAASmB,CAC1B,CACA,CACA,SAASvC,aAAaJ,GACdD,OAAOC,KAKPR,SAASgC,OAASxB,EAAO,iDACzBR,SAASgC,OAASxB,EAAO,kDAAoD3B,OAAO0E,SAASE,SAAW,UACxGzD,SAASgC,OAASxB,EAAO,mDAAqD3B,OAAO0E,SAASE,SAAW,UAEjH,CCxOA,SAASC,gBAAgBC,EAAOC,GAC5B,GAAI/E,OAAOgF,SAASC,UAAU/B,QAC1B,OAAO4B,EAAM5B,QAAQ6B,GAEzB,IAAK,IAAIzE,EAAI,EAAGA,EAAIwE,EAAMZ,OAAQ5D,IAC9ByE,EAASG,KAAKlF,OAAQ8E,EAAMxE,GAAIA,EAAGwE,EAE3C,CCLA,IAAIK,2BAA6B,2BAC7BC,2BAA6B,2BAC7BC,+BAAiC,yBACjCC,sBAAwB,4BACxBC,iCAAmC,wCACnCC,iCAAmC,wCACvC,SAASC,aAAaC,GAClBC,KAAKD,QAAUA,CACnB,CCZA,SAASE,YAAYF,GACjBC,KAAKD,QAAUA,CACnB,CDWAD,aAAaR,UAAUY,KAAO,WAU1B,GATAF,KAAKG,cAAgBH,KAAKD,QAC1BC,KAAKI,cAAgBJ,KAAKD,QAAQM,cAAcb,4BAChDQ,KAAKM,cAAgBN,KAAKD,QAAQM,cAAcZ,4BAChDO,KAAKO,eAAiBP,KAAKD,QAAQM,cAAcV,uBACjDK,KAAKQ,0BAA4BR,KAAKD,QAAQM,cAAcT,kCAC5DI,KAAKS,0BAA4BT,KAAKD,QAAQM,cAAcR,kCAC5DG,KAAKU,yBAA2BV,KAAKD,QAAQY,iBAAiBjB,gCAGzDM,KAAKG,gBAAiBH,KAAKY,gBAAhC,CAKA,IAAIC,EAAuBC,mBACtBD,GAAyBE,qBAAqCF,KAG/DG,eACAhB,KAAKG,cAAcc,gBAAgB,WAEvCjB,KAAKI,cAAcc,iBAAiB,QAASlB,KAAKmB,cAAcC,KAAKpB,OACrEA,KAAKM,cAAcY,iBAAiB,QAASlB,KAAKqB,cAAcD,KAAKpB,OACrEd,gBAAgBc,KAAKU,yBAA0B,SAAUY,GACrDA,EAAwBJ,iBAAiB,QAASlB,KAAKuB,WAAWH,KAAKpB,MAC/E,EAAMoB,KAAKpB,MAdX,CAeA,EACAF,aAAaR,UAAUiC,WAAa,WAChCvB,KAAKG,cAAcqB,aAAa,UAAU,EAC9C,EACA1B,aAAaR,UAAU6B,cAAgB,WAEnCM,iBAAiC,CAAE7F,WAAW,IAE9CoE,KAAKO,eAAeiB,aAAa,UAAU,GAC3CxB,KAAK0B,0BAA0B1B,KAAKQ,0BACxC,EACAV,aAAaR,UAAU+B,cAAgB,WAEnCI,iBAAiC,CAAE7F,WAAW,IAE9CoE,KAAKO,eAAeiB,aAAa,UAAU,GAC3CxB,KAAK0B,0BAA0B1B,KAAKS,0BACxC,EACAX,aAAaR,UAAUoC,0BAA4B,SAAUC,GACzDA,EAAoBV,gBAAgB,UAE/BU,EAAoBC,aAAa,cAClCD,EAAoBH,aAAa,WAAY,MAC7CG,EAAoBT,iBAAiB,QAAQ,WACzCS,EAAoBV,gBAAgB,WAChD,KAEIU,EAAoBE,OACxB,EACA/B,aAAaR,UAAUsB,cAAgB,WACnC,MAAoC,cAA7BvG,OAAO0E,SAAS+C,QAC3B,ECpEA7B,YAAYX,UAAUY,KAAO,WACzBF,KAAK+B,YAAc/B,KAAKD,QACnBC,KAAK+B,cAGV/B,KAAKgC,YAAchC,KAAK+B,YAAY1B,cAAc,yBAClDL,KAAKiC,qBAAuBjC,KAAKgC,YAAYrB,iBAAiB,kCAC9DX,KAAKkC,qBAAuBlC,KAAK+B,YAAY1B,cAAc,4BAC3DL,KAAKmC,aAAenC,KAAK+B,YAAY1B,cAAc,iCACnDnB,gBAAgBc,KAAKiC,qBAAsB,SAAUG,GACjDpC,KAAKqC,mBAAmBD,EAAqB7F,mBAErD,EAAM6E,KAAKpB,OAGPA,KAAKgC,YAAYd,iBAAiB,SAAUlB,KAAKsC,gBAAgBlB,KAAKpB,OAC1E,EACAC,YAAYX,UAAUgD,gBAAkB,SAAUvH,GAE9CA,EAAMwH,iBACN,IAAIC,EAAc,CAAA,EAClBtD,gBAAgBc,KAAKiC,qBAAsB,SAAUG,GACjD,IAAI/E,EAAa2C,KAAKyC,cAAcL,GAChCM,EAAeN,EAAoB/B,cAAc,cAAgBhD,EAAa,aAAapB,MAC/FuG,EAAYnF,GAA+B,SAAjBqF,CAClC,EAAMtB,KAAKpB,OAEPhD,iBAAiBwF,GAGJhH,SAAS6E,cAAc,uCAC7BmB,aAAa,SAAU,QAC9BxB,KAAK2C,yBACT,EACA1C,YAAYX,UAAU+C,mBAAqB,SAAUD,EAAqBI,GACtE,IAAInF,EAAa2C,KAAKyC,cAAcL,GAChCQ,GAAa,EACbvF,GAAcmF,QAA2CK,IAA5BL,EAAYnF,KACzCuF,EAAaJ,EAAYnF,IAE7B,IAAIyF,EAAaF,EAAa,OAAS,QAC3BR,EAAoB/B,cAAc,cAAgBhD,EAAa,WAAayF,EAAa,KAC/FC,SAAU,CACpB,EACA9C,YAAYX,UAAUqD,wBAA0B,WAC5C3C,KAAKkC,qBAAqBjB,gBAAgB,UAE1C,IAAI+B,IAAWxH,SAASwH,UAAW,IAAIC,IAAIzH,SAASwH,UAAUlB,SAC1DkB,GAAYA,IAAaxH,SAASuD,SAAS+C,UAC3C9B,KAAKmC,aAAae,KAAOF,EACzBhD,KAAKmC,aAAalB,gBAAgB,WAGlCjB,KAAKmC,aAAaX,aAAa,SAAU,QAKxCxB,KAAKkC,qBAAqBN,aAAa,aACxC5B,KAAKkC,qBAAqBV,aAAa,WAAY,MAEvDxB,KAAKkC,qBAAqBL,QAE1BxH,OAAO8I,SAAS,EAAG,EACvB,EACAlD,YAAYX,UAAUmD,cAAgB,SAAUL,GAC5C,OAAOA,EAAoBgB,EAC/B,ECxEC,SAAUC,EAAQC,GACC,iBAAZC,SAA0C,oBAAXC,OAAyBF,EAAQC,SACrD,mBAAXE,QAAyBA,OAAOC,IAAMD,OAAO,gBAAiB,CAAC,WAAYH,GACjFA,EAASD,EAAOM,cAAgB,CAAA,EAClC,CAJA,MAIE3D,GAAI,SAAauD,GAqBnB,SAASrE,EAAiBC,EAAOC,GAC/B,GAAI/E,OAAOgF,SAASC,UAAU/B,QAC5B,OAAO4B,EAAM5B,QAAQ6B,GAEvB,IAAK,IAAIzE,EAAI,EAAGA,EAAIwE,EAAMZ,OAAQ5D,IAChCyE,EAASG,KAAKlF,OAAQ8E,EAAMxE,GAAIA,EAAGwE,EAEvC,CA8BA,SAASyE,IAgDP,IAtCA,IAAIC,EAAgB,SAAUC,GAE5B,IAAIC,EAAkB,CAAA,EAKlBC,EAAc,SAAUC,EAAKC,GAE/B,IAAK,IAAIC,KAAOF,EAGd,GAAKG,OAAO9E,UAAU+E,eAAe9E,KAAK0E,EAAKE,GAA/C,CAGA,IAAIlI,EAAQgI,EAAIE,GACZG,EAAcJ,EAASA,EAAS,IAAMC,EAAMA,EAC3B,iBAAVlI,EAET+H,EAAY/H,EAAOqI,GAGnBP,EAAgBO,GAAerI,CARzC,CAWA,EAII,OADA+H,EAAYF,GACLC,CACX,EAGMQ,EAAwB,CAAA,EAKnB5J,EAAI,EAAGA,EAAI6J,UAAUjG,OAAQ5D,IAAK,CACzC,IAAIsJ,EAAMJ,EAAcW,UAAU7J,IAClC,IAAK,IAAIwJ,KAAOF,EACVG,OAAO9E,UAAU+E,eAAe9E,KAAK0E,EAAKE,KAC5CI,EAAsBJ,GAAOF,EAAIE,GAGzC,CAEE,OAAOI,CACT,CAUA,SAASE,EAA0BX,EAAcY,GAE/C,IAAKZ,GAAwC,iBAAjBA,EAC1B,MAAM,IAAIa,MAAM,8CAElB,IAAKD,GAAkC,iBAAdA,EACvB,MAAM,IAAIC,MAAM,2EAElB,IAAIC,EAAY,CAAA,EAChB,IAAK,IAAIT,KAAOL,EAAc,CAE5B,IAAIe,EAAWV,EAAI9F,MAAM,KAEzB,GAAI+F,OAAO9E,UAAU+E,eAAe9E,KAAKuE,EAAcK,IAAQU,EAAS,KAAOH,EAGzEG,EAAStG,OAAS,GACpBsG,EAASC,QAKXF,EAFaC,EAASE,KAAK,MAEPjB,EAAaK,EAEvC,CACE,OAAOS,CACT,CAoBA,SAASI,EAAMC,EAAcC,GAE3BlF,KAAKiF,aAAeA,GAAgB,CAAA,EAGpCjF,KAAKmF,OAAUD,GAAUA,EAAOC,QAAW3J,SAAS4J,gBAAgBC,MAAQ,IAC9E,CA+qCA,SAASC,EAAiBrJ,GACxB,GAAqB,iBAAVA,EACT,OAAOA,EAGT,IAAIsJ,EAAetJ,EAAMuJ,OAEzB,MAAqB,SAAjBD,GAIiB,UAAjBA,IAMAA,EAAahH,OAAS,GAAKkH,SAASF,GAC/BG,OAAOH,GAGTtJ,EACT,CAUA,SAAS0J,EAAkBC,GACzB,IAAIC,EAAM,CAAA,EAEV,IAAK,IAAI1B,KAAOyB,EACdC,EAAI1B,GAAOmB,EAAgBM,EAAQzB,IAGrC,OAAO0B,CACT,CA7sCAb,EAAK1F,UAAUwG,EAAI,SAAUC,EAAW7J,GACtC,IAAK6J,EAEH,MAAM,IAAIpB,MAAM,4BAWlB,GALIzI,QAAoC,IAAlBA,EAAQ8J,QAE5BD,EAAYA,EAAY,IAAM/F,KAAKiG,gBAAgBF,EAAW7J,EAAQ8J,QAGpED,KAAa/F,KAAKiF,aAAc,CAElC,IAAIiB,EAAoBlG,KAAKiF,aAAac,GAG1C,GAAIG,EAAkBC,MAAM,aAAc,CACxC,IAAKjK,EACH,MAAM,IAAIyI,MAAM,0EAGlB,OAAO3E,KAAKoG,oBAAoBF,EAAmBhK,EACzD,CACM,OAAOgK,CAEb,CAGI,OAAOH,CAEX,EAUAf,EAAK1F,UAAU8G,oBAAsB,SAAUF,EAAmBhK,GAChE,IAAImK,EAMJ,OAJIrG,KAAKsG,+BACPD,EAAY,IAAIE,KAAKC,aAAaxG,KAAKmF,SAGlCe,EAAkBO,QAAQ,cAAc,SAAUC,EAAuBC,GAC9E,GAAIvC,OAAO9E,UAAU+E,eAAe9E,KAAKrD,EAASyK,GAAiB,CACjE,IAAIC,EAAmB1K,EAAQyK,GAI/B,OAAyB,IAArBC,EACK,GAIuB,iBAArBA,GAAiCP,EACnCA,EAAUQ,OAAOD,GAGnBA,CACb,CACM,MAAM,IAAIjC,MAAM,kCAAoC+B,EAAwB,yBAElF,GACA,EAYA1B,EAAK1F,UAAUwH,0BAA4B,WACzC,OAAOC,QAAQ1M,OAAOkM,MAAS,gBAAiBlM,OAAOkM,MAAQA,KAAKS,YAAYC,mBAAmBjH,KAAKmF,QAAQ5G,OAClH,EAYAyG,EAAK1F,UAAUgH,2BAA6B,WAC1C,OAAOS,QAAQ1M,OAAOkM,MAAS,iBAAkBlM,OAAOkM,MAAQA,KAAKC,aAAaS,mBAAmBjH,KAAKmF,QAAQ5G,OACpH,EAgBAyG,EAAK1F,UAAU2G,gBAAkB,SAAUF,EAAWC,GAMpD,GADAA,EAAQN,OAAOM,IACVP,SAASO,GAAU,MAAO,QAE/B,IAAIkB,EAYJ,GAAInB,EAAY,KANdmB,EADElH,KAAK8G,4BACS,IAAIP,KAAKS,YAAYhH,KAAKmF,QAAQgC,OAAOnB,GAEzChG,KAAKoH,mCAAmCpB,MAInBhG,KAAKiF,aAC1C,OAAOiC,EAGF,GAAInB,EAAY,WAAY/F,KAAKiF,aAMtC,OALIpH,SAAW,SAAUA,SACvBA,QAAQwJ,KAAK,+BAAiCH,EAAgB,UAC5DlH,KAAKmF,OAAS,uCAGX,QAGP,MAAM,IAAIR,MACR,+CAAiD3E,KAAKmF,OAAS,WAGrE,EAWAH,EAAK1F,UAAU8H,mCAAqC,SAAUpB,GAG5DA,EAAQsB,KAAKC,IAAID,KAAKE,MAAMxB,IAE5B,IAAIyB,EAAUzH,KAAK0H,0BAEnB,OAAID,EACKzC,EAAK2C,YAAYF,GAASzB,GAG5B,OACT,EAaAhB,EAAK1F,UAAUoI,wBAA0B,WACvC,IAAIvC,EAASnF,KAAKmF,OACdyC,EAAczC,EAAO9G,MAAM,KAAK,GAIpC,IAAK,IAAIwJ,KAAc7C,EAAK8C,eAC1B,GAAI1D,OAAO9E,UAAU+E,eAAe9E,KAAKyF,EAAK8C,eAAgBD,GAE5D,IADA,IAAIE,EAAY/C,EAAK8C,eAAeD,GAC3BlN,EAAI,EAAGA,EAAIoN,EAAUxJ,OAAQ5D,IACpC,GAAIoN,EAAUpN,KAAOwK,GAAU4C,EAAUpN,KAAOiN,EAC9C,OAAOC,CAKjB,EAkCA7C,EAAK8C,eAAiB,CACpBE,OAAQ,CAAC,MACTC,QAAS,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAC1DC,OAAQ,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MACnDC,OAAQ,CACN,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAEpEC,MAAO,CAAC,MACRC,QAAS,CAAC,KAAM,MAChBC,SAAU,CAAC,MACXC,QAAS,CAAC,QAAS,KAAM,MACzBC,MAAO,CAAC,OAgBVxD,EAAK2C,YAAc,CACjBK,OAAQ,SAAUS,GAChB,OAAU,IAANA,EAAkB,OACZ,IAANA,EAAkB,MACZ,IAANA,EAAkB,MAClBA,EAAI,KAAO,GAAKA,EAAI,KAAO,GAAa,MACxCA,EAAI,KAAO,IAAMA,EAAI,KAAO,GAAa,OACtC,OACX,EACER,QAAS,WACP,MAAO,OACX,EACEC,OAAQ,SAAUO,GAChB,OAAa,IAANA,GAAiB,IAANA,EAAU,MAAQ,OACxC,EACEN,OAAQ,SAAUM,GAChB,OAAa,IAANA,EAAU,MAAQ,OAC7B,EACEL,MAAO,SAAUK,GACf,OAAU,IAANA,EAAkB,MACZ,IAANA,EAAkB,MAClBA,GAAK,GAAKA,GAAK,EAAY,MAC3BA,GAAK,GAAKA,GAAK,GAAa,OACzB,OACX,EACEJ,QAAS,SAAUI,GACjB,IAAIC,EAAUD,EAAI,IACdE,EAAOD,EAAU,GACrB,OAAa,IAATC,GAA0B,KAAZD,EAAyB,MACvCC,GAAQ,GAAKA,GAAQ,KAAOD,GAAW,IAAMA,GAAW,IAAc,MAC7D,IAATC,GAAeA,GAAQ,GAAKA,GAAQ,GAAOD,GAAW,IAAMA,GAAW,GAAc,OAGlF,OACX,EACEJ,SAAU,SAAUG,GAClB,OAAU,IAANA,GAAiB,KAANA,EAAmB,MACxB,IAANA,GAAiB,KAANA,EAAmB,MAC7BA,GAAK,GAAKA,GAAK,IAAQA,GAAK,IAAMA,GAAK,GAAc,MACnD,OACX,EACEF,QAAS,SAAUE,GACjB,OAAU,IAANA,EAAkB,MAClBA,EAAI,KAAY,GAAW,IAANA,EAAkB,OACpC,OACX,EACED,MAAO,SAAUC,GACf,OAAU,IAANA,EAAkB,OACZ,IAANA,EAAkB,MACZ,IAANA,EAAkB,MACZ,IAANA,EAAkB,MACZ,IAANA,EAAkB,OACf,OACX,GAqCA,SAAU5F,GAGV,IAiBW+F,EAENC,EACAC,EACAC,EAlBH,mBAAoB3E,QAAW,WAC9B,IAGC,OADAA,OAAO4E,eADC,CAAA,EACiB,OAAQ,CAAC/M,MAAM,MACjC,CAGX,CAFK,MAAM2B,GACP,OAAO,CACX,CACA,CAR4B,KAcjBgL,EA+DTxE,OAAO4E,eA7DJH,EAAoBzE,OAAO9E,UAAU+E,eAAe,oBACpDyE,EAA8B,gEAC9BC,EAAsB,wEAE1B3E,OAAO4E,eAAiB,SAAwBC,EAAQC,EAAUC,GAGjE,GAAIP,IAAyBK,IAAW5O,QAAU4O,IAAWzN,UAAYyN,IAAWG,QAAQ9J,WAAa2J,aAAkBG,SAC1H,OAAOR,EAAqBK,EAAQC,EAAUC,GAG/C,GAAe,OAAXF,KAAqBA,aAAkB7E,QAA4B,iBAAX6E,GAC3D,MAAM,IAAII,UAAU,8CAGrB,KAAMF,aAAsB/E,QAC3B,MAAM,IAAIiF,UAAU,0CAGrB,IAAIC,EAAiBC,OAAOL,GACxBM,EAAqB,UAAWL,GAAc,aAAcA,EAC5DM,EAAa,QAASN,UAAqBA,EAAWO,IACtDC,EAAa,QAASR,UAAqBA,EAAWS,IAG1D,GAAIH,EAAY,CACf,GAAmB,aAAfA,EACH,MAAM,IAAIJ,UAAU,6BAErB,IAAKR,EACJ,MAAM,IAAIQ,UAAUP,GAErB,GAAIU,EACH,MAAM,IAAIH,UAAUN,GAErB3E,OAAOyF,iBAAiBtK,KAAK0J,EAAQK,EAAgBH,EAAWO,IACnE,MACGT,EAAOK,GAAkBH,EAAWlN,MAIrC,GAAI0N,EAAY,CACf,GAAmB,aAAfA,EACH,MAAM,IAAIN,UAAU,6BAErB,IAAKR,EACJ,MAAM,IAAIQ,UAAUP,GAErB,GAAIU,EACH,MAAM,IAAIH,UAAUN,GAErB3E,OAAO0F,iBAAiBvK,KAAK0J,EAAQK,EAAgBH,EAAWS,IACnE,CAOE,MAJI,UAAWT,IACdF,EAAOK,GAAkBH,EAAWlN,OAG9BgN,CACT,EAEC,EACA1J,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAE1H,SAAUR,GAEK,SAAUmH,SAAS1K,WAKhC8E,OAAO4E,eAAegB,SAAS1K,UAAW,OAAQ,CAC9CrD,MAAO,SAAcgO,GAEjB,IAOIC,EAPAC,EAASC,MACTC,EAAUjG,OACVkG,EAAkBD,EAAQ/K,UAC1BiL,EAAiBJ,EAAO7K,UACxBkL,EAAQ,WAAiB,EACzBC,EAAYH,EAAgBI,SAC5BC,EAAmC,mBAAXC,QAAuD,iBAAvBA,OAAOC,YACEC,EAAUd,SAAS1K,UAAUoL,SAAUK,EAAoB,SAA2B9O,GAAS,IAA2B,OAArB6O,EAAQvL,KAAKtD,IAAe,CAAiC,CAAzB,MAAO2B,GAAK,OAAO,CAAM,CAAE,EAAIoN,EAAU,oBAAqBC,EAAW,6BAA8Bf,EAAa,SAAoBjO,GAAS,GAAqB,mBAAVA,EAAwB,OAAO,EAAS,GAAI0O,EAAkB,OAAOI,EAAkB9O,GAAU,IAAIiP,EAAWT,EAAUlL,KAAKtD,GAAQ,OAAOiP,IAAaF,GAAWE,IAAaD,CAAS,EACtiB,IAAIE,EAAcZ,EAAea,MAC7BC,EAAed,EAAee,OAC9BC,EAAahB,EAAe3P,KAC5B4Q,EAAMlE,KAAKkE,IAIXC,EAASzL,KAEb,IAAKkK,EAAWuB,GACZ,MAAM,IAAIpC,UAAU,kDAAoDoC,GAoF5E,IA/EA,IAUIC,EAVAC,EAAOR,EAAY5L,KAAKiF,UAAW,GAWnCoH,EAAS,WAET,GAAI5L,gBAAgB0L,EAAO,CAiBvB,IAAIG,EAASJ,EAAOK,MAChB9L,KACAqL,EAAa9L,KAAKoM,EAAMR,EAAY5L,KAAKiF,aAE7C,OAAI6F,EAAQwB,KAAYA,EACbA,EAEJ7L,IAEzB,CAoBkB,OAAOyL,EAAOK,MACV7B,EACAoB,EAAa9L,KAAKoM,EAAMR,EAAY5L,KAAKiF,YAK/D,EAQcuH,EAAcP,EAAI,EAAGC,EAAOlN,OAASoN,EAAKpN,QAI1CyN,EAAY,GACPrR,EAAI,EAAGA,EAAIoR,EAAapR,IAC7B4Q,EAAWhM,KAAKyM,EAAW,IAAMrR,GAuCrC,OA9BA+Q,EAAQ1B,SAAS,SAAU,oBAAsBgC,EAAUjH,KAAK,KAAO,6CAA/DiF,CAA6G4B,GAEjHH,EAAOnM,YACPkL,EAAMlL,UAAYmM,EAAOnM,UACzBoM,EAAMpM,UAAY,IAAIkL,EAEtBA,EAAMlL,UAAY,MAwBfoM,CACjB,GAEC,EACAnM,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAE1H,SAAUR,GAGN,IACuCoJ,EAArC,iBAAkBjM,SACT,cAD4BiM,EAElCzQ,SAASL,cAAc,SADG8Q,EAAEC,UAAUC,OAAO,KAAK,KAAWF,EAAEG,YAOnE,SAAU/I,GACT,IAqMMzF,EArMW,iBAAkByF,GAAUA,EAAOgJ,gBAK5C7Q,SAAS8Q,kBACT9Q,SAAS8Q,gBAAgB,6BAA8B,QACvD9Q,SAAS8Q,gBAAgB,6BAA8B,OAAOJ,qBAAqBG,gBAGzFhJ,EAAOgJ,aAAgB,WACrB,IAAIE,GAAY,EACZC,EAAe,SAAUvD,EAAQjN,EAAMyQ,EAAIC,GACzCtI,OAAO4E,eACT5E,OAAO4E,eAAeC,EAAQjN,EAAM,CAClC0Q,cAAc,IAAUH,KAAqBG,EAC7ChD,IAAK+C,IAGJxD,EAAOY,iBAAiB7N,EAAMyQ,EAC/C,EAGU,IACED,EAAa,CAAA,EAAI,UAI7B,CAFU,MAAO5O,GACL2O,GAAY,CACxB,CAmKU,OAhKoB,SAAUI,EAAIC,GAChC,IAAI3C,EAAOjK,KACP6M,EAAS,GACTC,EAAW,CAAA,EACXvO,EAAS,EACTwO,EAAY,EACZC,EAAiB,SAAUrS,GAC7B6R,EAAavC,EAAMtP,GAAG,WAEpB,OADAsS,IACOJ,EAAOlS,EAC9B,IAAiB,EAEjB,EACgBuS,EAAU,WAGZ,GAAI3O,GAAUwO,EACZ,KAAOA,EAAYxO,IAAUwO,EAC3BC,EAAeD,EAEjC,EAGgBE,EAAQ,WACV,IAAInP,EACAnD,EACAgR,EAAOnH,UACP2I,EAAS,MAGb,GAAIxB,EAAKpN,OACP,IAAK5D,EAAI,EAAGA,EAAIgR,EAAKpN,SAAU5D,EAC7B,GAAIwS,EAAOC,KAAKzB,EAAKhR,IAInB,MAHAmD,EAAQ,IAAIuP,YAAY,WAAa1B,EAAKhR,GAAlB,oCAClB2S,KAAO,EACbxP,EAAM9B,KAAO,wBACP8B,EAgBZ,IAJI,MANF+O,EADsB,iBAAbF,EAAGC,IACF,GAAKD,EAAGC,GAAMW,SAAS9G,QAAQ,aAAc,IAAIpI,MAAM8O,IAEvD,GAAKR,EAAGC,IAAOnG,QAAQ,aAAc,IAAIpI,MAAM8O,IAIzC,KAAIN,EAAS,IAG/BC,EAAW,CAAA,EACNnS,EAAI,EAAGA,EAAIkS,EAAOtO,SAAU5D,EAC/BmS,EAASD,EAAOlS,KAAM,EACxB4D,EAASsO,EAAOtO,OAChB2O,GACd,EAqGY,OAlGAD,IAGAT,EAAavC,EAAM,UAAU,WAE3B,OADAgD,IACO1O,CACrB,IAGY0L,EAAKuD,eACHvD,EAAKS,SAAW,WAEd,OADAuC,IACOJ,EAAO9H,KAAK,IACnC,EAEYkF,EAAKwD,KAAO,SAAUC,GAEpB,OADAT,IACOJ,EAAOa,EAC5B,EAEYzD,EAAK0D,SAAW,SAAUC,GAExB,OADAX,MACSH,EAASc,EAChC,EAEY3D,EAAK4D,IAAM,WACTZ,EAAMnB,MAAM7B,EAAM0B,EAAOnH,WAEzB,IAAK,IAAImH,EAAMiC,EAAOjT,EAAI,EAAGD,EAAIiR,EAAKpN,OAAQ5D,EAAID,IAAKC,EACrDiT,EAAQjC,EAAKhR,GACRmS,EAASc,KACZf,EAAOjS,KAAKgT,GACZd,EAASc,IAAS,GAKlBrP,IAAWsO,EAAOtO,SACpBA,EAASsO,EAAOtO,SAAW,EACH,iBAAboO,EAAGC,GACZD,EAAGC,GAAMW,QAAUV,EAAO9H,KAAK,KAE/B4H,EAAGC,GAAQC,EAAO9H,KAAK,KAEzBmI,IAEhB,EAEYjD,EAAK6D,OAAS,WACZb,EAAMnB,MAAM7B,EAAM0B,EAAOnH,WAGzB,IAAK,IAAImH,EAAMoC,EAAS,CAAA,EAAIpT,EAAI,EAAGmL,EAAI,GAAInL,EAAIgR,EAAKpN,SAAU5D,EAC5DoT,EAAOpC,EAAKhR,KAAM,SACXmS,EAASnB,EAAKhR,IAIvB,IAAKA,EAAI,EAAGA,EAAIkS,EAAOtO,SAAU5D,EAC1BoT,EAAOlB,EAAOlS,KAAKmL,EAAElL,KAAKiS,EAAOlS,IAExCkS,EAAS/G,EACTvH,EAASuH,EAAEvH,SAAW,EAGE,iBAAboO,EAAGC,GACZD,EAAGC,GAAMW,QAAUV,EAAO9H,KAAK,KAE/B4H,EAAGC,GAAQC,EAAO9H,KAAK,KAEzBmI,GACd,EAEYjD,EAAKkC,OAAS,SAAUyB,EAAOI,GAI7B,OAHAf,EAAMnB,MAAM7B,EAAM,CAAC2D,IAGf/K,IAAcmL,EACZA,GACF/D,EAAK4D,IAAID,IACF,IAEP3D,EAAK6D,OAAOF,IACL,GAKPd,EAASc,IACX3D,EAAK6D,OAAOF,IACL,IAIT3D,EAAK4D,IAAID,IACF,EACrB,EAEmB3D,CACnB,CAGA,CAtL2B,IA4Lb,cADFrM,EAAIpC,SAASL,cAAc,WAE/ByC,EAAEsO,UAAUC,OAAO,KAAK,GACnBvO,EAAEsO,UAAUyB,SAAS,OAC1B/P,EAAEsO,UAAU+B,YAAY3O,UAAU6M,OAAS,SAAgByB,GACzD,IAAII,EAAQxJ,UAAU,GACtB,GAAIwJ,IAAUnL,EAAW,CACvB,IAAIgL,GAAO7N,KAAK2N,SAASC,GAEzB,OADA5N,KAAK6N,EAAM,MAAQ,UAAUD,GACtBC,CACnB,CAGU,OADA7N,MADAgO,IAAUA,GACG,MAAQ,UAAUJ,GACxBI,CACjB,IAIO,WACC,IAAIpQ,EAAIpC,SAASL,cAAc,QAC/B,GAAM,cAAeyC,IACrBA,EAAEsO,UAAU2B,IAAI,IAAK,MACjBjQ,EAAEsO,UAAUyB,SAAS,MAAzB,CACA,IAAIO,EAAStQ,EAAEsO,UAAU+B,YAAY3O,UAAUuO,IAC/CjQ,EAAEsO,UAAU+B,YAAY3O,UAAUuO,IAAM,WAGtC,IAFA,IAAIlC,EAAOnH,UACP9J,EAAI8J,UAAUjG,OACT5D,EAAI,EAAGA,EAAID,EAAGC,IACrBuT,EAAO3O,KAAKS,KAAM2L,EAAKhR,GAEnC,CARuC,CASvC,CAbM,GAgBC,WACC,IAAIiD,EAAIpC,SAASL,cAAc,QAC/B,GAAM,cAAeyC,IACrBA,EAAEsO,UAAU2B,IAAI,KAChBjQ,EAAEsO,UAAU2B,IAAI,KAChBjQ,EAAEsO,UAAU4B,OAAO,IAAK,KACnBlQ,EAAEsO,UAAUyB,SAAS,MAA1B,CACA,IAAIO,EAAStQ,EAAEsO,UAAU+B,YAAY3O,UAAUwO,OAC/ClQ,EAAEsO,UAAU+B,YAAY3O,UAAUwO,OAAS,WAGzC,IAFA,IAAInC,EAAOnH,UACP9J,EAAI8J,UAAUjG,OACT5D,EAAI,EAAGA,EAAID,EAAGC,IACrBuT,EAAO3O,KAAKS,KAAM2L,EAAKhR,GAEnC,CARwC,CASxC,CAfM,EAiBN,CAzPI,CAyPEqF,KAEL,EAAET,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAE5H,SAAUR,GAGI,aAAc7C,MAKM,oBAAtBmO,mBAAgE,mBAAlBC,gBAErDpO,KAAKqO,aAGRrO,KAAKsO,SAAWtO,KAAKqO,cAKrBrO,KAAKsO,SAAWtO,KAAKqO,aAAe7S,SAASyS,YAAe,IAAIjE,SAAS,gCAAjB,GACxDhK,KAAKsO,SAAShP,UAAY9D,UAK3B,EACA+D,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAE1H,SAAUR,GAGI,YAAa7C,MAAQ,gBAAiBA,MAKnD,WAGA,IAAI3F,OAAO+O,SAAY/O,OAAOkU,YAA9B,CAMAlU,OAAO+O,QAAU/O,OAAOkU,YAAc,IAAIvE,SAAS,+BAAb,GAGtC,IAiCIwE,EAjCAC,EAAQjT,SAASkT,YAAYlT,SAASL,cAAc,SAIpDwT,EAHQF,EAAMC,YAAYlT,SAASL,cAAc,WAG3ByT,cAAcpT,SACpC8D,EAAY8J,QAAQ9J,UAAYqP,EAAcD,YAAYC,EAAcxT,cAAc,MACtF0T,EAAQ,CAAA,EAGRC,EAAO,SAAUC,EAASC,GAC7B,IAGA7K,EAAKlI,EAAOgT,EAFZC,EAAaH,EAAQG,YAAc,GACnCC,GAAS,EAGT,GAAyB,IAArBJ,EAAQK,UAAkBL,EAAQd,cAAgB7E,QAGrD,IAAKjF,KAFL4K,EAAQd,YAAc7E,QAEVyF,EACX5S,EAAQ4S,EAAM1K,GACd4K,EAAQ5K,GAAOlI,EAIjB,KAAOgT,EAAYD,GAAQE,IAAaC,IACvCL,EAAKG,EAAWD,GAGjB,OAAOD,CACT,EAEKM,EAAW7T,SAASP,qBAAqB,KACzCqU,EAAsB9T,SAASL,cAE/BoU,EAAY,IAEhBjQ,EAAUkQ,YAAY,oBAAoB,SAAUzU,GASnD,IARA,IAMAgU,EALAU,EAAe1U,EAAM0U,aACrBC,GAAYb,EAAMxK,eAAeoL,GACjCE,EAAWrQ,EAAUmQ,GACrBG,EAAWf,EAAMY,GACjBN,GAAS,EAGFJ,EAAUM,IAAWF,IACF,IAArBJ,EAAQK,WACPM,GAAYX,EAAQU,KAAkBG,KACzCb,EAAQU,GAAgBE,GAK3Bd,EAAMY,GAAgBE,CACxB,IAECrQ,EAAU2O,YAAc7E,QAEnB9J,EAAUuQ,eAEdvQ,EAAUuQ,aAAe,SAAsB7T,GAC9C,OAAmC,OAA5BgE,KAAK4B,aAAa5F,EAC5B,GAaM8T,MACJtU,SAASuU,mBAAqBD,EAC9BtB,EAAWwB,YAAYF,EAAW,KAInCtU,SAASL,cAAgB,SAAuB8U,GAC/C,IAAIlB,EAAUO,EAAoB/F,OAAO0G,GAAUC,eACnD,OAAOpB,EAAKC,EACd,EAGCvT,SAAS2U,YAAY1B,EA7FtB,MAFEpU,OAAOkU,YAAclU,OAAO+O,QA0E7B,SAAS0G,IAER,OADMP,KAAca,aAAa5B,MAC7BhT,SAAS6U,MAAS7U,SAAS6U,KAAK/Q,YAAa,yBAAyB8N,KAAK5R,SAAS8U,eACvFxB,EAAKtT,UAAU,GACXgT,GAAYhT,SAAS6U,KAAK/Q,WAAW8Q,aAAa5B,KAC5ChT,SAAS6U,KAAK/Q,UAG3B,CAcA,CApGA,EAsGC,EACAC,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAE1H,SAAUR,GAGN,IAEQjF,EADN,aAAcoC,MAAQ,cAAexE,SAAS4J,iBAAmB,YAAapF,MAAQ,cAAeoJ,QAAQ9J,aACvG1B,EAAIpC,SAASL,cAAc,SAC7B+Q,UAAU2B,IAAI,IAAK,KACdjQ,EAAEsO,UAAUyB,SAAS,OAO/B,SAAUtK,GACT,IAAIkJ,GAAY,EACZC,EAAe,SAAUvD,EAAQjN,EAAMyQ,EAAIC,GACzCtI,OAAO4E,eACT5E,OAAO4E,eAAeC,EAAQjN,EAAM,CAClC0Q,cAAc,IAAUH,KAAqBG,EAC7ChD,IAAK+C,IAGJxD,EAAOY,iBAAiB7N,EAAMyQ,EAC3C,EAEM,IACED,EAAa,CAAA,EAAI,UAIzB,CAFM,MAAO5O,GACL2O,GAAY,CACpB,CAEM,IAAIgE,EAAU,SAAUC,EAAGxU,EAAMyU,GAE/BjE,EAAagE,EAAElR,UAAWtD,GAAM,WAC9B,IAAI0U,EAEAC,EAAO3Q,KAGX4Q,EAAoB,kCAAyC5U,EAC7D,GAAG2U,EAAKC,GAAoB,OAAOF,EAWnC,GAVAC,EAAKC,IAAqB,GAUtB,IAAUrE,EAAW,CAOvB,IALA,IAAIsE,EACAC,EAASP,EAAQO,QAAUtV,SAASL,cAAc,OAClD4V,EAAcD,EAAO5B,WACrBxU,EAAIqW,EAAYxS,OAEX5D,EAAI,EAAGA,EAAID,IAAKC,EACvB,GAAIoW,EAAYpW,GAAGqW,KAAOL,EAAM,CAC9BE,EAASE,EAAYpW,GACrB,KAChB,CAGYkW,IAAWA,EAASC,EAAOpC,YAAYlT,SAASL,cAAc,SAE9DuV,EAAYrE,aAAa9M,KAAKsR,EAAQF,EAAMF,EACxD,MAAiBC,EAAY,IAAIrE,aAAasE,EAAMF,GAO1C,OALAjE,EAAamE,EAAM3U,GAAM,WACvB,OAAO0U,CACnB,WACiBC,EAAKC,GAELF,CACjB,IAAW,EACX,EAEMH,EAAQlN,EAAO+F,QAAS,YAAa,aACrCmH,EAAQlN,EAAOkL,YAAa,YAAa,aACzCgC,EAAQlN,EAAO4N,gBAAiB,UAAW,OAC3CV,EAAQlN,EAAO6N,kBAAmB,UAAW,OAC7CX,EAAQlN,EAAO8N,gBAAiB,UAAW,MACjD,CAxEI,CAwEEnR,KAEL,EAAET,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAE5H,SAAUR,GAGQ,SAAU0G,OAAOjK,YAK/BiK,OAAOjK,UAAUkG,KAAO,WACpB,OAAOxF,KAAKyG,QAAQ,qCAAsC,GAClE,EAEC,EAAElH,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAE5H,SAAUR,IAGM,WACZ,IAAKrH,SAAS4J,gBAAgBQ,QAC5B,OAAO,EAET,IAAI+G,EAAKnR,SAASL,cAAc,OAEhC,OADAwR,EAAGnL,aAAa,WAAY,KACrBmL,EAAG/G,SAA4B,KAAjB+G,EAAG/G,QAAQwL,EACpC,EAPY,IAYVhN,OAAO4E,eAAeI,QAAQ9J,UAAW,UAAW,CAClDoK,IAAK,WAKH,IAJA,IACI2H,EAAarR,KAAKqR,WAClBC,EAAM,CAAA,EAED3W,EAAI,EAAGA,EAAI0W,EAAW9S,OAAQ5D,IAAK,CAC1C,IAAI4W,EAAYF,EAAW1W,GAM3B,GAAI4W,GAAaA,EAAUvV,MAAQ,mBAAqBoR,KAAKmE,EAAUvV,MAAO,CAC5E,IAAIA,EAAOuV,EAAUvV,KACjBC,EAAQsV,EAAUtV,MAElBuV,EAAWxV,EAAKyV,OAAO,GAAGhL,QAAQ,OAAO,SAAUmG,GACrD,OAAOA,EAAKpO,OAAO,GAAGkT,aAClC,IAKc,qBAAsBtN,OAAO9E,WAAa,qBAAsB8E,OAAO9E,UACzE8E,OAAO4E,eAAesI,EAAKE,EAAU,CACnCG,YAAY,EACZjI,IAAK,WACH,OAAO1J,KAAK/D,KAC5B,EAAgBmF,KAAK,CAACnF,MAAOA,GAAS,KACxB2N,IAAK,SAAgB5N,EAAMC,QACJ,IAAVA,EACT+D,KAAKwB,aAAaxF,EAAMC,GAExB+D,KAAKiB,gBAAgBjF,EAEvC,EAAgBoF,KAlCIpB,KAkCUhE,KAGlBsV,EAAIE,GAAYvV,CAG5B,CACA,CAEM,OAAOqV,CACb,GAGC,EAAE/R,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAgE5H,IAAIuO,EAAyB,CAC3BC,gBAAiB,oBACjBC,YAAa,OACbC,qBAAsB,oBACtBC,gBAAiB,oBACjBC,YAAa,OACbC,qBAAsB,qBAmBxB,SAASC,EAAWpS,EAASmF,GAC3BlF,KAAKD,QAAUA,EACfC,KAAKoS,UAAYrS,EAAQY,iBAAiB,6BAC1CX,KAAKqS,8BAAgCC,EAAOC,yBAE5C,IAAIC,EAAgB,CAClBC,KAAMb,GAER5R,KAAKkF,OAAStB,EACZ4O,EACAtN,GAAU,CAAA,EACVS,EAAiB5F,EAAQ6F,UAE3B5F,KAAKyS,KAAO,IAAIzN,EAAKP,EAAyBzE,KAAKkF,OAAQ,SAE3DlF,KAAK0S,cAAgB,4BACrB1S,KAAK2S,aAAe,4BACpB3S,KAAK4S,iBAAmB,iCAExB5S,KAAK6S,qBAAuB,qCAC5B7S,KAAK8S,mBAAqB,kCAC1B9S,KAAK+S,mBAAqB,kCAC1B/S,KAAKgT,oBAAsB,mCAC3BhT,KAAKiT,wBAA0B,wCAC/BjT,KAAKkT,6BAA+B,8CAEpClT,KAAKmT,2BAA6B,kCAClCnT,KAAKoT,gCAAkC,wCACvCpT,KAAKqT,yBAA2B,uCAChCrT,KAAKsT,mBAAqB,+BAC1BtT,KAAKuT,qBAAuB,qCAE5BvT,KAAKwT,oBAAsB,mCAC3BxT,KAAKyT,yBAA2B,wCAClC,CAGAtB,EAAU7S,UAAUY,KAAO,WAEzB,GAAKF,KAAKD,QAAV,CAIAC,KAAK0T,eACL1T,KAAK2T,qBAGL,IAAIC,EAAqB5T,KAAK6T,yBAC9B7T,KAAK8T,oBAAoBF,EAP3B,CAQA,EAGAzB,EAAU7S,UAAUoU,aAAe,WAEjC1T,KAAK+T,eAAiBvY,SAASL,cAAc,UAC7C6E,KAAK+T,eAAevS,aAAa,OAAQ,UACzCxB,KAAK+T,eAAevS,aAAa,QAASxB,KAAK2S,cAC/C3S,KAAK+T,eAAevS,aAAa,gBAAiB,SAGlD,IAAIwS,EAAQxY,SAASL,cAAc,QACnC6Y,EAAM9H,UAAU2B,IAAI7N,KAAKsT,oBACzBtT,KAAK+T,eAAerF,YAAYsF,GAGhC,IAAIC,EAAqBzY,SAASL,cAAc,OAChD8Y,EAAmBzS,aAAa,QAASxB,KAAK0S,eAC9CuB,EAAmBvF,YAAY1O,KAAK+T,gBACpC/T,KAAKD,QAAQxE,aAAa0Y,EAAoBjU,KAAKD,QAAQmU,YAG3D,IAAIC,EAAsB3Y,SAASL,cAAc,QACjDgZ,EAAoBjI,UAAU2B,IAAI7N,KAAK4S,kBACvC5S,KAAK+T,eAAerF,YAAYyF,GAGhCnU,KAAK+T,eAAe7S,iBAAiB,QAASlB,KAAKoU,sBAAsBhT,KAAKpB,MAChF,EAGAmS,EAAU7S,UAAUqU,mBAAqB,WAEvCzU,EAAgBc,KAAKoS,UAAW,SAAUiC,EAAU1Z,GAElD,IAAI2Z,EAAUD,EAAShU,cAAc,IAAML,KAAK+S,oBAChD/S,KAAKuU,sBAAsBD,EAAS3Z,GACpCqF,KAAKwU,YAAYxU,KAAKyU,WAAWJ,GAAWA,GAG5CC,EAAQpT,iBAAiB,QAASlB,KAAK0U,gBAAgBtT,KAAKpB,KAAMqU,IAIlErU,KAAK2U,gBAAgBN,EACzB,EAAIjT,KAAKpB,MACT,EAEAmS,EAAU7S,UAAUiV,sBAAwB,SAAUK,EAAgBzF,GACpE,IAAI0F,EAAQD,EAAevU,cAAc,IAAML,KAAK8S,oBAChDgC,EAAWF,EAAevU,cAAc,IAAML,KAAKgT,qBACnD+B,EAAWH,EAAevU,cAAc,IAAML,KAAKwT,qBAGnDwB,EAAUxZ,SAASL,cAAc,UACrC6Z,EAAQxT,aAAa,OAAQ,UAC7BwT,EAAQxT,aAAa,gBAAiBxB,KAAKD,QAAQqD,GAAK,aAAe+L,EAAQ,IAG/E,IAAK,IAAIxU,EAAI,EAAGA,EAAIka,EAAMxD,WAAW9S,OAAQ5D,IAAK,CAChD,IAAI8V,EAAOoE,EAAMxD,WAAW5D,KAAK9S,GAGX,OAAlB8V,EAAKR,UACP+E,EAAQxT,aAAaiP,EAAKR,SAAUQ,EAAKwE,UAE/C,CAGE,IAAIC,EAAe1Z,SAASL,cAAc,QAC1C+Z,EAAahJ,UAAU2B,IAAI7N,KAAKiT,yBAGhCiC,EAAa9R,GAAKyR,EAAMzR,GAGxB,IAAI+R,EAAoB3Z,SAASL,cAAc,QAC/Cga,EAAkBjJ,UAAU2B,IAAI7N,KAAKkT,8BACrCgC,EAAaxG,YAAYyG,GAEzBA,EAAkBC,UAAYP,EAAMO,UAGpC,IAAIC,EAAc7Z,SAASL,cAAc,QACzCka,EAAYnJ,UAAU2B,IAAI7N,KAAKmT,4BAI/BkC,EAAY7T,aAAa,iBAAkB,IAE3C,IAAI8T,EAAmB9Z,SAASL,cAAc,QAC9Cma,EAAiBpJ,UAAU2B,IAAI7N,KAAKoT,iCACpCiC,EAAY3G,YAAY4G,GAExB,IAAIC,EAAkB/Z,SAASL,cAAc,QACzC6Y,EAAQxY,SAASL,cAAc,QAenC,GAdA6Y,EAAM9H,UAAU2B,IAAI7N,KAAKsT,oBACzBgC,EAAiB5G,YAAYsF,GAC7BuB,EAAgBrJ,UAAU2B,IAAI7N,KAAKqT,0BACnCiC,EAAiB5G,YAAY6G,GAO7BP,EAAQtG,YAAYwG,GACpBF,EAAQtG,YAAY1O,KAAKwV,0BAGrB,MAAA,EAAwD,CAK1D,IAAIC,EAAeja,SAASL,cAAc,QAEtCua,EAAoBla,SAASL,cAAc,QAC/Cua,EAAkBxJ,UAAU2B,IAAI7N,KAAKyT,0BACrCgC,EAAa/G,YAAYgH,GAGzB,IAAK,IAAIxa,EAAI,EAAGR,EAAIqa,EAAS1D,WAAW9S,OAAQrD,EAAIR,IAAKQ,EAAG,CAC1D,IAAI+U,EAAW8E,EAAS1D,WAAW5D,KAAKvS,GAAG+U,SACvCgF,EAAYF,EAAS1D,WAAW5D,KAAKvS,GAAG+Z,UAC5CQ,EAAajU,aAAayO,EAAUgF,EAC1C,CAGIS,EAAkBN,UAAYL,EAASK,UAGvCL,EAASzZ,WAAWqa,aAAaF,EAAcV,GAE/CC,EAAQtG,YAAY+G,GACpBT,EAAQtG,YAAY1O,KAAKwV,yBAC7B,CAEER,EAAQtG,YAAY2G,GAEpBP,EAAS3E,YAAY0E,GACrBC,EAASpG,YAAYsG,EACvB,EAGA7C,EAAU7S,UAAUoV,gBAAkB,SAAUL,GAC9C,IAAIuB,EAAW5V,KAAKyU,WAAWJ,GAC/BrU,KAAKwU,aAAaoB,EAAUvB,GAG5BrU,KAAK6V,WAAWxB,EAClB,EAGAlC,EAAU7S,UAAU8U,sBAAwB,WAC1C,IAAIrU,EAAUC,KACVoS,EAAYpS,KAAKoS,UACjB0D,GAAe9V,KAAK6T,yBAExB3U,EAAgBkT,GAAW,SAAUiC,GACnCtU,EAAQyU,YAAYsB,EAAazB,GAEjCtU,EAAQ8V,WAAWxB,EACvB,IAEEtU,EAAQ+T,oBAAoBgC,EAC9B,EAGA3D,EAAU7S,UAAUkV,YAAc,SAAUoB,EAAUvB,GACpD,IAAIL,EAAQK,EAAShU,cAAc,IAAML,KAAKsT,oBAC1CyC,EAAgB1B,EAAShU,cAAc,IAAML,KAAKqT,0BAClD2B,EAAUX,EAAShU,cAAc,IAAML,KAAK8S,oBAC5CkD,EAAgBJ,EAChB5V,KAAKyS,KAAK3M,EAAE,eACZ9F,KAAKyS,KAAK3M,EAAE,eAEhBiQ,EAAcE,UAAYD,EAC1BhB,EAAQxT,aAAa,gBAAiBoU,GAGtC,IACIM,EAAiB,CADP7B,EAAShU,cAAc,IAAML,KAAKiT,yBAClBgD,UAAUzQ,QAEpCuP,EAAWV,EAAShU,cAAc,IAAML,KAAKwT,qBAC7CuB,GACFmB,EAAetb,KAAKma,EAASkB,UAAUzQ,QAGzC,IAAI2Q,EAAmBP,EACnB5V,KAAKyS,KAAK3M,EAAE,wBACZ9F,KAAKyS,KAAK3M,EAAE,wBAChBoQ,EAAetb,KAAKub,GAOpBnB,EAAQxT,aAAa,aAAc0U,EAAenR,KAAK,QAGnD6Q,GACFvB,EAASnI,UAAU2B,IAAI7N,KAAK6S,sBAC5BmB,EAAM9H,UAAU4B,OAAO9N,KAAKuT,wBAE5Bc,EAASnI,UAAU4B,OAAO9N,KAAK6S,sBAC/BmB,EAAM9H,UAAU2B,IAAI7N,KAAKuT,uBAI3B,IAAIK,EAAqB5T,KAAK6T,yBAC9B7T,KAAK8T,oBAAoBF,EAC3B,EAGAzB,EAAU7S,UAAUmV,WAAa,SAAUJ,GACzC,OAAOA,EAASnI,UAAUyB,SAAS3N,KAAK6S,qBAC1C,EAGAV,EAAU7S,UAAUuU,uBAAyB,WAO3C,OALoB7T,KAAKoS,UAAU7T,SAERyB,KAAKD,QAAQY,iBAAiB,IAAMX,KAAK6S,sBAAsBtU,MAI5F,EAGA4T,EAAU7S,UAAUwU,oBAAsB,SAAU8B,GAClD,IAAIQ,EAAepW,KAAK+T,eAAe1T,cAAc,IAAML,KAAKsT,oBAC5D+C,EAAerW,KAAK+T,eAAe1T,cAAc,IAAML,KAAK4S,kBAC5DoD,EAAgBJ,EAChB5V,KAAKyS,KAAK3M,EAAE,mBACZ9F,KAAKyS,KAAK3M,EAAE,mBAChB9F,KAAK+T,eAAevS,aAAa,gBAAiBoU,GAClDS,EAAaJ,UAAYD,EAGrBJ,EACFQ,EAAalK,UAAU4B,OAAO9N,KAAKuT,sBAEnC6C,EAAalK,UAAU2B,IAAI7N,KAAKuT,qBAEpC,EAGA,IAAIjB,EAAS,CACXC,uBAAwB,WACtB,IACI1G,EADAyK,EAAa,0BAEjB,IAIE,OAHAjc,OAAOkc,eAAeC,QAAQF,EAAYA,GAC1CzK,EAASxR,OAAOkc,eAAeE,QAAQH,KAAgBA,EAAW5L,WAClErQ,OAAOkc,eAAeG,WAAWJ,GAC1BzK,CAGb,CAFM,MAAO8K,GACP,OAAO,CACb,CACA,GAIAxE,EAAU7S,UAAUuW,WAAa,SAAUxB,GACzC,GAAIrU,KAAKqS,8BAA+B,CAItC,IAAI2C,EAAUX,EAAShU,cAAc,IAAML,KAAK8S,oBAEhD,GAAIkC,EAAS,CACX,IAAI4B,EAAY5B,EAAQpT,aAAa,iBACjCiV,EAAe7B,EAAQpT,aAAa,iBAGpCgV,GAAaC,GACfxc,OAAOkc,eAAeC,QAAQI,EAAWC,EAEjD,CACA,CACA,EAGA1E,EAAU7S,UAAUqV,gBAAkB,SAAUN,GAC9C,GAAIrU,KAAKqS,8BAA+B,CACtC,IAAI2C,EAAUX,EAAShU,cAAc,IAAML,KAAK8S,oBAEhD,GAAIkC,EAAS,CACX,IAAI4B,EAAY5B,EAAQpT,aAAa,iBACjCiV,EAAeD,EAAYvc,OAAOkc,eAAeE,QAAQG,GAAa,KAErD,OAAjBC,GACF7W,KAAKwU,YAA6B,SAAjBqC,EAAyBxC,EAElD,CACA,CACA,EAWAlC,EAAU7S,UAAUkW,uBAAyB,WAC3C,IAAIsB,EAAiBtb,SAASL,cAAc,QAG5C,OAFA2b,EAAe5K,UAAU2B,IAAI,wBAAyB,4CACtDiJ,EAAe1B,UAAY,KACpB0B,CACT,EA+BA,SAAUjU,GAGI,WAAY7C,MAKQ,oBAAtBmO,mBAAgE,mBAAlBC,eACxD,SAAU/K,GACNA,EAAO4K,YACV5K,EAAO0T,OAAS1T,EAAO4K,aAEtB5K,EAAO0T,OAAS1T,EAAO4K,YAAc,IAAIjE,SAAS,8BAAb,IAA+C1K,UAAYU,IAEpG,CANC,CAMEA,KAGF,EACAT,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAE1H,SAAUR,IAIP,SAASQ,GAET,KAAM,UAAWA,GAAS,OAAO,EACjC,GAA4B,mBAAjBA,EAAO2T,MAAsB,OAAO,EAE/C,IAIC,OADA,IAAIA,MAAM,UACH,CAGX,CAFK,MAAMpZ,GACP,OAAO,CACX,CACA,EAdU,CAcNoC,OAMH,WACA,IAAIiX,EAA2B,CAC9BC,MAAO,EACPC,SAAU,EACVC,MAAO,EACPC,SAAU,EACVC,QAAS,EACTC,UAAW,EACXC,QAAS,EACTC,UAAW,EACXC,UAAW,EACXC,WAAY,EACZC,WAAY,EACZC,SAAU,EACVC,QAAS,EACTC,cAAe,EACfC,UAAW,GAMZ,GAAwB,oBAAbxc,UAA8C,oBAAXnB,OAA9C,CAgBA,IAAI4d,EAAiB5d,OAAO2c,OAAS3c,OAAO2c,MAAM1X,WAAc,KAChEjF,OAAO2c,MAAQD,OAAOzX,UAAU0X,MAAQ,SAAekB,EAAMC,GAC5D,IAAKD,EACJ,MAAM,IAAIvT,MAAM,wBAGjB,IAAI5J,EAEJ,GAAI,gBAAiBS,SAAU,CAC9BT,EAAQS,SAAS4c,YAAY,SAC7B,IAAIC,KAAUF,GAAiBA,EAAcE,UAAYxV,IAAYsV,EAAcE,QAC/EC,KAAaH,GAAiBA,EAAcG,aAAezV,IAAYsV,EAAcG,WAIzF,OAFAvd,EAAMwd,UAAUL,EAAMG,EAASC,GAExBvd,CACV,CAQE,OANAA,EAAQS,SAASgd,qBAEXN,KAAOA,EACbnd,EAAMsd,WAAUF,GAAiBA,EAAcE,UAAYxV,IAAYsV,EAAcE,QACrFtd,EAAMud,cAAaH,GAAiBA,EAAcG,aAAezV,IAAYsV,EAAcG,WAEpFvd,CACT,EACKkd,GACH7T,OAAO4E,eAAe3O,OAAO2c,MAAO,YAAa,CAChDtK,cAAc,EACdiF,YAAY,EACZ8G,UAAU,EACVxc,MAAOgc,IAIH,gBAAiBzc,WACtBnB,OAAO6G,iBAAmB6V,OAAOzX,UAAU4B,iBAAmBoN,SAAShP,UAAU4B,iBAAmBkI,QAAQ9J,UAAU4B,iBAAmB,WACxI,IACA6N,EAAU/O,KACVkY,EAAO1T,UAAU,GACjBkU,EAAWlU,UAAU,GAErB,GAAIuK,IAAY1U,QAAU6d,KAAQjB,EACjC,MAAM,IAAItS,MAAM,qBAAuBuT,EAAO,2IAG1CnJ,EAAQ4J,UACZ5J,EAAQ4J,QAAU,CAAA,GAGd5J,EAAQ4J,QAAQT,KACpBnJ,EAAQ4J,QAAQT,GAAQ,SAAUnd,GACjC,IAKA6d,EAJAC,EAAO9J,EAAQ4J,QAAQ5d,EAAMmd,MAAMW,KACnCC,EAASD,EAAKzN,QACd+D,GAAS,EACT5Q,EAASua,EAAOva,OA4BhB,IAzBAxD,EAAMwH,eAAiB,YACG,IAArBxH,EAAMud,aACTvd,EAAMge,aAAc,EAE3B,EAEKhe,EAAMie,gBAAkB,WACvBje,EAAMke,cAAe,CAC3B,EAEKle,EAAMme,yBAA2B,WAChCne,EAAMke,cAAe,EACrBle,EAAMoe,iBAAkB,CAC9B,EAEKpe,EAAMqe,cAAgBrK,EACtBhU,EAAMse,cAAgBte,EAAMue,aAAe,KAC3Cve,EAAM0Q,OAAS1Q,EAAM0Q,QAAU1Q,EAAMwe,YAAcxK,EACnDhU,EAAMye,WAAY,IAAI3e,MAAOC,UAEzBC,EAAM0e,UACT1e,EAAM2e,MAAQ3e,EAAM0e,QAAUje,SAAS4J,gBAAgBuU,WACvD5e,EAAM6e,MAAQ7e,EAAM8e,QAAUre,SAAS4J,gBAAgB0U,aAG/C3K,EAAQ5Q,IAAWxD,EAAMoe,iBAC7BhK,KAAS2J,IAGyB,IAAjC5a,EAAQ2a,EAFZD,EAAeE,EAAO3J,KAE4C,mBAAjByJ,GAChDA,EAAarZ,KAAKwP,EAAShU,EAInC,EAEIgU,EAAQ4J,QAAQT,GAAMW,KAAO,GAEzB9J,EAAQS,aACXT,EAAQS,YAAY,KAAO0I,EAAMnJ,EAAQ4J,QAAQT,KAInDnJ,EAAQ4J,QAAQT,GAAMW,KAAKje,KAAK8d,EACnC,EAEEre,OAAO0f,oBAAsBhD,OAAOzX,UAAUya,oBAAsBzL,SAAShP,UAAUya,oBAAsB3Q,QAAQ9J,UAAUya,oBAAsB,WACpJ,IAIA5K,EAHAJ,EAAU/O,KACVkY,EAAO1T,UAAU,GACjBkU,EAAWlU,UAAU,GAGjBuK,EAAQ4J,SAAW5J,EAAQ4J,QAAQT,IAASnJ,EAAQ4J,QAAQT,GAAMW,OAGtD,KAFf1J,EAAQjR,EAAQ6Q,EAAQ4J,QAAQT,GAAMW,KAAMH,MAG3C3J,EAAQ4J,QAAQT,GAAMW,KAAKmB,OAAO7K,EAAO,GAEpCJ,EAAQ4J,QAAQT,GAAMW,KAAKta,SAC3BwQ,EAAQkL,aACXlL,EAAQkL,YAAY,KAAO/B,EAAMnJ,EAAQ4J,QAAQT,WAE3CnJ,EAAQ4J,QAAQT,IAI7B,EAEE7d,OAAO6f,cAAgBnD,OAAOzX,UAAU4a,cAAgB5L,SAAShP,UAAU4a,cAAgB9Q,QAAQ9J,UAAU4a,cAAgB,SAAuBnf,GACnJ,IAAKyJ,UAAUjG,OACd,MAAM,IAAIoG,MAAM,wBAGjB,IAAK5J,GAA+B,iBAAfA,EAAMmd,KAC1B,MAAM,IAAIvT,MAAM,0BAGjB,IAAIoK,EAAU/O,KAAMkY,EAAOnd,EAAMmd,KAEjC,IACC,IAAKnd,EAAMsd,QAAS,CACnBtd,EAAMke,cAAe,EAErB,IAAIkB,EAAoB,SAAUpf,GACjCA,EAAMke,cAAe,GAEpBlK,GAAW1U,QAAQ4f,YAAY,KAAO/B,EAAMiC,EACnD,EAEKna,KAAKwP,YAAY,KAAO0I,EAAMiC,EACnC,CAEIna,KAAKoa,UAAU,KAAOlC,EAAMnd,EAiBhC,CAhBK,MAAO+C,GACR/C,EAAM0Q,OAASsD,EAEf,GACChU,EAAMqe,cAAgBrK,EAElB,YAAaA,GAA4C,mBAA1BA,EAAQ4J,QAAQT,IAClDnJ,EAAQ4J,QAAQT,GAAM3Y,KAAKwP,EAAShU,GAGD,mBAAzBgU,EAAQ,KAAOmJ,IACzBnJ,EAAQ,KAAOmJ,GAAM3Y,KAAKwP,EAAShU,GAGpCgU,EAA+B,IAArBA,EAAQK,SAAiBL,EAAQsL,aAAetL,EAAQzT,iBAC1DyT,IAAYhU,EAAMke,aAC/B,CAEG,OAAO,CACV,EAGEzd,SAASgU,YAAY,sBAAsB,WACd,aAAxBhU,SAAS8U,YACZ9U,SAAS0e,cAAc,IAAIlD,MAAM,mBAAoB,CACpDqB,SAAS,IAGd,IArMuE,CAEtE,SAASna,EAAQoc,EAAOvL,GAKvB,IAJA,IACAI,GAAS,EACT5Q,EAAS+b,EAAM/b,SAEN4Q,EAAQ5Q,GAChB,GAAI4Q,KAASmL,GAASA,EAAMnL,KAAWJ,EACtC,OAAOI,EAIT,OAAQ,CACV,CAyLA,CA7NA,EA+NC,EACA5P,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAY1H,SAASkX,EAAQxa,EAASmF,GACxB,IAAKnF,EACH,OAAOC,KAGTA,KAAKD,QAAUA,EACfC,KAAKwa,wBAA0B,KAK/Bxa,KAAKkF,OAAStB,EAHM,CAClB6W,oBAAoB,GAIpBvV,GAAU,CAAA,EACVS,EAAiB5F,EAAQ6F,SAE7B,CAKA2U,EAAOjb,UAAUY,KAAO,WACjBF,KAAKD,UAIVC,KAAKD,QAAQmB,iBAAiB,UAAWlB,KAAK0a,eAC9C1a,KAAKD,QAAQmB,iBAAiB,QAASlB,KAAK2a,SAASvZ,KAAKpB,OAC5D,EAYAua,EAAOjb,UAAUob,cAAgB,SAAU3f,GACzC,IAAI0Q,EAAS1Q,EAAM0Q,OAEiB,WAAhCA,EAAO7J,aAAa,SArDV,KAqDkC7G,EAAM6f,UACpD7f,EAAMwH,iBACNkJ,EAAOyL,QAEX,EAYAqD,EAAOjb,UAAUqb,SAAW,SAAU5f,GAEpC,GAAKiF,KAAKkF,OAAOuV,mBAKjB,OAAIza,KAAKwa,yBACPzf,EAAMwH,kBACC,QAGTvC,KAAKwa,wBAA0BK,WAAW,WACxC7a,KAAKwa,wBAA0B,IACnC,EAAIpZ,KAAKpB,MAAO8a,KAChB,EA2BA,SAASC,EAAShb,GAChBC,KAAKD,QAAUA,CACjB,CAmMA,SAASib,EAAuBC,EAAUC,GACxC,IAAIC,EAA8BF,EAASG,QAAQ,IAAMF,EAAgB,KACzE,GAAIC,EACF,OAAOA,EAA4BvZ,aAAasZ,EAEpD,CAtMAH,EAAQzb,UAAUY,KAAO,WAClBF,KAAKD,UAK0C,kBAAtBC,KAAKD,QAAQsb,MAM3Crb,KAAKsb,kBACP,EAEAP,EAAQzb,UAAUgc,gBAAkB,WAClC,IAhqEI9gB,EAgqEAuF,EAAUC,KAAKD,QAGfgV,EAAW/U,KAAK+U,SAAWhV,EAAQ9E,qBAAqB,WAAWwS,KAAK,GACxE8N,EAAWvb,KAAKub,SAAWxb,EAAQ9E,qBAAqB,OAAOwS,KAAK,GAInEsH,GAAawG,IAMbA,EAASnY,KACZmY,EAASnY,GAAK,oBA/qEZ5I,GAAI,IAAIK,MAAOC,eACe,IAAvBT,OAAOmhB,aAAiE,mBAA3BnhB,OAAOmhB,YAAYC,MACzEjhB,GAAKH,OAAOmhB,YAAYC,OAEnB,uCAAuChV,QAAQ,SAAS,SAAUiV,GACvE,IAAIC,GAAKnhB,EAAoB,GAAhB8M,KAAKsU,UAAiB,GAAK,EAExC,OADAphB,EAAI8M,KAAKE,MAAMhN,EAAI,KACL,MAANkhB,EAAYC,EAAS,EAAJA,EAAU,GAAMjR,SAAS,GACtD,MA2qEE3K,EAAQyB,aAAa,OAAQ,SAG7BuT,EAASvT,aAAa,OAAQ,UAG9BuT,EAASvT,aAAa,gBAAiB+Z,EAASnY,IAMhD2R,EAAS8G,SAAW,EAGhB7b,KAAKD,QAAQ8P,aAAa,QAC5BkF,EAASvT,aAAa,gBAAiB,SAEvCuT,EAASvT,aAAa,gBAAiB,SACvC+Z,EAASO,MAAMC,QAAU,QAI3B/b,KAAKgc,qBAAqBjH,EAAU/U,KAAKic,sBAAsB7a,KAAKpB,OACtE,EAOA+a,EAAQzb,UAAU2c,sBAAwB,WAWxC,OAVIjc,KAAKD,QAAQ8P,aAAa,SAC5B7P,KAAKD,QAAQkB,gBAAgB,QAC7BjB,KAAK+U,SAASvT,aAAa,gBAAiB,SAC5CxB,KAAKub,SAASO,MAAMC,QAAU,SAE9B/b,KAAKD,QAAQyB,aAAa,OAAQ,QAClCxB,KAAK+U,SAASvT,aAAa,gBAAiB,QAC5CxB,KAAKub,SAASO,MAAMC,QAAU,KAGzB,CACT,EAQAhB,EAAQzb,UAAU0c,qBAAuB,SAAUE,EAAM9c,GACvD8c,EAAKhb,iBAAiB,YAAY,SAAUnG,GAC1C,IAAI0Q,EAAS1Q,EAAM0Q,OArGP,KAuGR1Q,EAAM6f,SAtGI,KAsGqB7f,EAAM6f,SACD,YAAlCnP,EAAOwE,SAASC,gBAGlBnV,EAAMwH,iBAEFkJ,EAAOyL,MACTzL,EAAOyL,QAGP9X,EAASrE,GAInB,IAGEmhB,EAAKhb,iBAAiB,SAAS,SAAUnG,GACvC,IAAI0Q,EAAS1Q,EAAM0Q,OAxHL,KAyHV1Q,EAAM6f,SAC8B,YAAlCnP,EAAOwE,SAASC,eAClBnV,EAAMwH,gBAGd,IAEE2Z,EAAKhb,iBAAiB,QAAS9B,EACjC,EAQA,SAAUyD,GAGQ,SAAUkH,MAAQ,QAASA,KAAKlP,MAAQ,YAAakP,KAAKlP,KAAKyE,YAK7EzE,KAAK4gB,IAAM,WACP,OAAO,IAAI5gB,MAAOC,SAC1B,EAEC,EAAEyE,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAE5H,SAAUR,GAIN,aAAc7C,MAAQ,YAAaxE,SAAS4J,kBAM9CgE,QAAQ9J,UAAU6c,QAAU/S,QAAQ9J,UAAU8c,uBAAyBhT,QAAQ9J,UAAU+c,kBAAoBjT,QAAQ9J,UAAUgd,mBAAqBlT,QAAQ9J,UAAUid,oBAAsB,SAAiBC,GAK3M,IAJA,IAAIzN,EAAU/O,KACVqP,GAAYN,EAAQvT,UAAYuT,EAAQ0N,eAAe9b,iBAAiB6b,GACxErN,EAAQ,EAELE,EAASF,IAAUE,EAASF,KAAWJ,KAC1CI,EAGJ,QAASE,EAASF,EACtB,EAEC,EAAE5P,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAE5H,SAAUR,GAIN,aAAc7C,MAAQ,YAAaxE,SAAS4J,kBAM9CgE,QAAQ9J,UAAU8b,QAAU,SAAiBoB,GAG3C,IAFA,IAAIN,EAAOlc,KAEJkc,GAAM,CACX,GAAIA,EAAKC,QAAQK,GAAW,OAAON,EAC9BA,EAAO,eAAgB7hB,QAAU6hB,aAAgBQ,WAAaR,EAAK5gB,WAAa4gB,EAAKS,aAChG,CAEI,OAAO,IACX,EAEC,EAAEpd,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAsB5H,IAAIuZ,EAA+B,CAEjCC,qBAAsB,CACpBC,IAAK,wCACLC,MAAO,0CAETC,kBAAmB,kCACnBC,oBAAqB,CACnBH,IAAK,uCACLC,MAAO,yCAGTG,gBAAiB,CACfJ,IAAK,mCACLC,MAAO,qCAETI,aAAc,6BACdC,eAAgB,CACdN,IAAK,kCACLC,MAAO,oCAETM,oBAAqB,CACnBN,MAAO,KAkBX,SAASO,EAAgBvd,EAASmF,GAChC,IAAKnF,EACH,OAAOC,KAGT,IAAIwS,EAAgB,CAClB+K,UAAW,EACX9K,KAAMmK,GAIJY,EAAgB7X,EAAiB5F,EAAQ6F,SAQzC6X,EAAkB,CAAA,EAqBtB,IApBI,aAAcD,GAAiB,cAAeA,KAChDC,EAAkB,CAChBC,WAAW,EACXC,UAAU,IAId3d,KAAKkF,OAAStB,EACZ4O,EACAtN,GAAU,CAAA,EACVuY,EACAD,GAGFxd,KAAKyS,KAAO,IAAIzN,EAAKP,EAAyBzE,KAAKkF,OAAQ,QAAS,CAElEC,OAAQ6V,EAAsBjb,EAAS,UAIrCC,KAAKkF,OAAOyY,SACd3d,KAAK+M,UAAY/M,KAAKkF,OAAOyY,aACxB,KAAI3d,KAAKkF,OAAOwY,UAGrB,OAFA1d,KAAK+M,UAAY/M,KAAKkF,OAAOwY,SAGjC,CAEE1d,KAAKD,QAAUA,EACfC,KAAK4d,UAAY7d,EAAQM,cAAc,6BACvCL,KAAK6d,qBAAuB,KAC5B7d,KAAK8d,0BAA4B,KACjC9d,KAAK+d,mBAAqB,IAC5B,CA8VA,SAASC,EAAYje,GACnBC,KAAKD,QAAUA,EACfC,KAAKie,QAAUle,EAAQY,iBAAiB,yBAC1C,CAmKA,SAASud,EAAcne,EAASmF,GAQ9B,IAAKnF,EAGH,OAAOC,KAGTA,KAAKD,QAAUA,EAKfC,KAAKkF,OAAStB,EAHM,CAClBua,kBAAkB,GAIlBjZ,GAAU,CAAA,EACVS,EAAiB5F,EAAQ6F,SAE7B,CAgLA,SAASwY,EAAoBre,EAASmF,GACpClF,KAAKD,QAAUA,EAKfC,KAAKkF,OAAStB,EAHM,CAClBua,kBAAkB,GAIlBjZ,GAAU,CAAA,EACVS,EAAiB5F,EAAQ6F,SAE7B,CAmEA,SAASyY,EAAQte,GACfC,KAAKD,QAAUA,EACfC,KAAKse,YAAcve,GAAWA,EAAQM,cAAc,2BACpDL,KAAKue,MAAQve,KAAKse,aAAeve,EAAQM,cACvC,IAAML,KAAKse,YAAY1c,aAAa,kBAMtC5B,KAAKwe,YAAa,EAMlBxe,KAAKye,IAAM,IACb,CA8EA,SAASC,EAAQ3e,GACfC,KAAKD,QAAUA,EACfC,KAAKie,QAAUle,EAAQY,iBAAiB,sBAC1C,CAsHA,SAASge,EAAU5e,GACjBC,KAAKD,QAAUA,EACfC,KAAK4e,eAAiB,KACtB5e,KAAK6e,uBAAwB,CAC/B,CAmIA,SAASC,EAAM/e,GACbC,KAAKD,QAAUA,EACfC,KAAK+e,MAAQhf,EAAQY,iBAAiB,oBAEtCX,KAAKgf,KAAO,CAAEC,KAAM,GAAIC,MAAO,GAAIC,GAAI,GAAIC,KAAM,IACjDpf,KAAKqf,cAAgB,2BACvB,CA1nCA/B,EAAehe,UAAUY,KAAO,WAE9B,GAAKF,KAAK4d,UAAV,CAIA,IAAIA,EAAY5d,KAAK4d,UACjB0B,EAAuB9jB,SAAS+jB,eAAe3B,EAAUxa,GAAK,SAK9Dkc,EAAqBrJ,UAAU9P,MAAM,WACvCmZ,EAAqBrJ,UAAYjW,KAAKyS,KAAK3M,EAAE,sBAAuB,CAAEE,MAAOhG,KAAK+M,aAKpF6Q,EAAU4B,sBAAsB,WAAYF,GAI5C,IAAIxB,EAA4BtiB,SAASL,cAAc,OACvD2iB,EAA0B1R,UAAY,yDACtC0R,EAA0Btc,aAAa,YAAa,UACpDxB,KAAK8d,0BAA4BA,EACjCwB,EAAqBE,sBAAsB,WAAY1B,GAKvD,IAAID,EAAuBriB,SAASL,cAAc,OAClD0iB,EAAqBzR,UAAYkT,EAAqBlT,UACtDyR,EAAqB3R,UAAU2B,IAAI,iCACnCgQ,EAAqBrc,aAAa,cAAe,QACjDxB,KAAK6d,qBAAuBA,EAC5ByB,EAAqBE,sBAAsB,WAAY3B,GAGvDyB,EAAqBpT,UAAU2B,IAAI,yBAGnC+P,EAAU3c,gBAAgB,aAE1BjB,KAAKyf,mBAMD,eAAgBplB,OAClBA,OAAO6G,iBAAiB,WAAYlB,KAAK0f,mBAAmBte,KAAKpB,OAEjE3F,OAAO6G,iBAAiB,mBAAoBlB,KAAK0f,mBAAmBte,KAAKpB,OAE3EA,KAAK0f,oBAnDP,CAoDA,EAQApC,EAAehe,UAAUmgB,iBAAmB,WAC1C,IAAI7B,EAAY5d,KAAK4d,UACrBA,EAAU1c,iBAAiB,QAASlB,KAAK2f,YAAYve,KAAKpB,OAG1D4d,EAAU1c,iBAAiB,QAASlB,KAAK4f,YAAYxe,KAAKpB,OAC1D4d,EAAU1c,iBAAiB,OAAQlB,KAAK6f,WAAWze,KAAKpB,MAC1D,EAQAsd,EAAehe,UAAUqgB,YAAc,WACrC3f,KAAK8f,4BACL9f,KAAK+d,mBAAqBljB,KAAK4gB,KACjC,EAeA6B,EAAehe,UAAUsgB,YAAc,WACrC5f,KAAK+f,aAAe/P,YAAY,aACzBhQ,KAAK+d,oBAAuBljB,KAAK4gB,MAAQ,KAAQzb,KAAK+d,qBACzD/d,KAAKggB,sBAEX,EAAI5e,KAAKpB,MAAO,IAChB,EAOAsd,EAAehe,UAAUugB,WAAa,WAEpCI,cAAcjgB,KAAK+f,aACrB,EAKAzC,EAAehe,UAAU0gB,qBAAuB,WACzChgB,KAAK4d,UAAUhO,WAAU5P,KAAK4d,UAAUhO,SAAW,IACpD5P,KAAK4d,UAAU3hB,QAAU+D,KAAK4d,UAAUhO,WAC1C5P,KAAK4d,UAAUhO,SAAW5P,KAAK4d,UAAU3hB,MACzC+D,KAAK0f,qBAET,EAQApC,EAAehe,UAAUogB,mBAAqB,WAC5C1f,KAAK8f,4BACL9f,KAAKkgB,gCACP,EAKA5C,EAAehe,UAAUwgB,0BAA4B,WACnD,IAAIlC,EAAY5d,KAAK4d,UACjBC,EAAuB7d,KAAK6d,qBAC5BsC,EAAkBngB,KAAK+M,UAAY/M,KAAKgG,MAAM4X,EAAU3hB,OAIxD+D,KAAKogB,kBACPvC,EAAqB3R,UAAU4B,OAAO,4CAEtC+P,EAAqB3R,UAAU2B,IAAI,4CAIjCsS,EAAkB,GACpBvC,EAAU1R,UAAU2B,IAAI,yBACxBgQ,EAAqB3R,UAAU4B,OAAO,cACtC+P,EAAqB3R,UAAU2B,IAAI,yBAEnC+P,EAAU1R,UAAU4B,OAAO,yBAC3B+P,EAAqB3R,UAAU4B,OAAO,uBACtC+P,EAAqB3R,UAAU2B,IAAI,eAIrCgQ,EAAqB5H,UAAYjW,KAAKqgB,iBACxC,EAKA/C,EAAehe,UAAU4gB,+BAAiC,WACxD,IAAIpC,EAA4B9d,KAAK8d,0BAIjC9d,KAAKogB,kBACPtC,EAA0B7c,gBAAgB,eAE1C6c,EAA0Btc,aAAa,eAAe,GAIxDsc,EAA0B7H,UAAYjW,KAAKqgB,iBAC7C,EASA/C,EAAehe,UAAU0G,MAAQ,SAAUsa,GACzC,OAAItgB,KAAKkF,OAAOyY,UACD2C,EAAKna,MAAM,SAAW,IACrB5H,OAEP+hB,EAAK/hB,MAEhB,EAOA+e,EAAehe,UAAU+gB,gBAAkB,WACzC,IAAIF,EAAkBngB,KAAK+M,UAAY/M,KAAKgG,MAAMhG,KAAK4d,UAAU3hB,OAE7DskB,EAAYvgB,KAAKkF,OAAOyY,SAAW,QAAU,aACjD,OAAO3d,KAAKwgB,mBAAmBL,EAAiBI,EAClD,EAUAjD,EAAehe,UAAUkhB,mBAAqB,SAAUL,EAAiBI,GACvE,GAAwB,IAApBJ,EACF,OAAOngB,KAAKyS,KAAK3M,EAAEya,EAAY,WAGjC,IAAIE,EAAuBN,EAAkB,EAAI,YAAc,aAE/D,OAAOngB,KAAKyS,KAAK3M,EAAEya,EAAYE,EAAsB,CAAEza,MAAOsB,KAAKC,IAAI4Y,IACzE,EAYA7C,EAAehe,UAAU8gB,gBAAkB,WAEzC,IAAKpgB,KAAKkF,OAAOqY,UACf,OAAO,EAGT,IAAIK,EAAY5d,KAAK4d,UAGjB8C,EAAgB1gB,KAAKgG,MAAM4X,EAAU3hB,OAKzC,OAJgB+D,KAAK+M,UAEY/M,KAAKkF,OAAOqY,UAAY,KAE/BmD,CAC5B,EA2GA1C,EAAW1e,UAAUY,KAAO,WAC1B,IAAIH,EAAUC,KAAKD,QAGnBb,EAFcc,KAAKie,SAEM,SAAU0C,GACjC,IAAIlV,EAASkV,EAAO/e,aAAa,sBAI5B6J,GAAWjQ,SAAS+jB,eAAe9T,KAMxCkV,EAAOnf,aAAa,gBAAiBiK,GACrCkV,EAAO1f,gBAAgB,sBAC3B,IAMM,eAAgB5G,OAClBA,OAAO6G,iBAAiB,WAAYlB,KAAK4gB,0BAA0Bxf,KAAKpB,OAExE3F,OAAO6G,iBAAiB,mBAAoBlB,KAAK4gB,0BAA0Bxf,KAAKpB,OAMlFA,KAAK4gB,4BAEL7gB,EAAQmB,iBAAiB,QAASlB,KAAK6gB,YAAYzf,KAAKpB,MAC1D,EAKAge,EAAW1e,UAAUshB,0BAA4B,WAC/C1hB,EAAgBc,KAAKie,QAASje,KAAK8gB,oCAAoC1f,KAAKpB,MAC9E,EAUAge,EAAW1e,UAAUwhB,oCAAsC,SAAUH,GACnE,IAAII,EAAUvlB,SAAS+jB,eAAeoB,EAAO/e,aAAa,kBAE1D,GAAImf,GAAWA,EAAQ7U,UAAUyB,SAAS,iCAAkC,CAC1E,IAAIqT,EAAiBL,EAAO5d,QAE5B4d,EAAOnf,aAAa,gBAAiBwf,GACrCD,EAAQ7U,UAAUC,OAAO,yCAA0C6U,EACvE,CACA,EAQAhD,EAAW1e,UAAU2hB,uBAAyB,SAAUN,GAGtDzhB,EAF4B1D,SAASmF,iBAAiB,gCAAkCggB,EAAO3kB,KAAO,MAE/D,SAAUklB,GACvBP,EAAOQ,OAASD,EAAmBC,MACnCD,IAAuBP,IAC7CO,EAAmBne,SAAU,EAC7B/C,KAAK8gB,oCAAoCI,GAE/C,EAAI9f,KAAKpB,MACT,EASAge,EAAW1e,UAAU8hB,uBAAyB,SAAUT,GAKtDzhB,EAJiD1D,SAASmF,iBACxD,4DAA8DggB,EAAO3kB,KAAO,MAGlB,SAAUqlB,GAC5CV,EAAOQ,OAASE,EAAgBF,OAEtDE,EAAgBte,SAAU,EAC1B/C,KAAK8gB,oCAAoCO,GAE/C,EAAIjgB,KAAKpB,MACT,EAUAge,EAAW1e,UAAUuhB,YAAc,SAAU9lB,GAC3C,IAAIgmB,EAAUhmB,EAAM0Q,OAGC,aAAjBsV,EAAQ7I,OAKU6I,EAAQnf,aAAa,kBAEzC5B,KAAK8gB,oCAAoCC,GAItCA,EAAQhe,UAK2D,cAA3Cge,EAAQnf,aAAa,kBAEhD5B,KAAKihB,uBAAuBF,GAE5B/gB,KAAKohB,uBAAuBL,IAEhC,EAqCA7C,EAAa5e,UAAUY,KAAO,WAC5B,IAAIH,EAAUC,KAAKD,QACdA,IAILC,KAAKshB,WACLvhB,EAAQmB,iBAAiB,QAASlB,KAAK6gB,YAAYzf,KAAKpB,OAC1D,EAKAke,EAAa5e,UAAUgiB,SAAW,WAChC,IAAIvhB,EAAUC,KAAKD,QAEfC,KAAKkF,OAAOiZ,mBAMhBpe,EAAQyB,aAAa,WAAY,MAEjCzB,EAAQmB,iBAAiB,QAAQ,WAC/BnB,EAAQkB,gBAAgB,WAC5B,IAEElB,EAAQ8B,QACV,EAOAqc,EAAa5e,UAAUuhB,YAAc,SAAU9lB,GAC7C,IAAI0Q,EAAS1Q,EAAM0Q,OACfzL,KAAKuhB,YAAY9V,IACnB1Q,EAAMwH,gBAEV,EAoBA2b,EAAa5e,UAAUiiB,YAAc,SAAUR,GAE7C,GAAwB,MAApBA,EAAQS,UAAoC,IAAjBT,EAAQ7d,KACrC,OAAO,EAGT,IAAIue,EAAUzhB,KAAK0hB,mBAAmBX,EAAQ7d,MAC1Cyd,EAASnlB,SAAS+jB,eAAekC,GACrC,IAAKd,EACH,OAAO,EAGT,IAAIgB,EAAiB3hB,KAAK4hB,2BAA2BjB,GACrD,QAAKgB,IAOLA,EAAeE,iBACflB,EAAO9e,MAAM,CAAEigB,eAAe,KAEvB,EACT,EAWA5D,EAAa5e,UAAUoiB,mBAAqB,SAAUK,GACpD,OAA0B,IAAtBA,EAAI7jB,QAAQ,MAIT6jB,EAAI1jB,MAAM,KAAK2jB,KACxB,EAiBA9D,EAAa5e,UAAUsiB,2BAA6B,SAAUjB,GAC5D,IAAIsB,EAAYtB,EAAOvF,QAAQ,YAE/B,GAAI6G,EAAW,CACb,IAAIC,EAAUD,EAAUhnB,qBAAqB,UAE7C,GAAIinB,EAAQ3jB,OAAQ,CAClB,IAAI4jB,EAAmBD,EAAQ,GAI/B,GAAoB,aAAhBvB,EAAOzI,MAAuC,UAAhByI,EAAOzI,KACvC,OAAOiK,EAST,IAAIC,EAAYD,EAAiBE,wBAAwBC,IACrDC,EAAY5B,EAAO0B,wBAIvB,GAAIE,EAAUC,QAAUnoB,OAAOooB,YAG7B,GAFkBF,EAAUD,IAAMC,EAAUC,OAE1BJ,EAAY/nB,OAAOooB,YAAc,EACjD,OAAON,CAGjB,CACA,CAEE,OAAO3mB,SAAS6E,cAAc,cAAgBsgB,EAAO/e,aAAa,MAAQ,OACxE+e,EAAOvF,QAAQ,QACnB,EAiCAgD,EAAmB9e,UAAUY,KAAO,WACpBF,KAAKD,SAMnBC,KAAKshB,UACP,EAYAlD,EAAmB9e,UAAUgiB,SAAW,WACtC,IAAIvhB,EAAUC,KAAKD,QAEfC,KAAKkF,OAAOiZ,kBAIqB,UAAjCpe,EAAQ6B,aAAa,UAOpB7B,EAAQ6B,aAAa,cACxB7B,EAAQyB,aAAa,WAAY,MAEjCzB,EAAQmB,iBAAiB,QAAQ,WAC/BnB,EAAQkB,gBAAgB,WAC9B,KAGElB,EAAQ8B,QACV,EAgDAwc,EAAO/e,UAAUY,KAAO,WACjBF,KAAKD,SAAYC,KAAKse,aAAgBte,KAAKue,QAI5C,eAAgBlkB,QAElB2F,KAAKye,IAAMpkB,OAAOqoB,WAAW,0BAEzB,qBAAsB1iB,KAAKye,IAC7Bze,KAAKye,IAAIvd,iBAAiB,SAAUlB,KAAK2iB,UAAUvhB,KAAKpB,OAKxDA,KAAKye,IAAImE,YAAY5iB,KAAK2iB,UAAUvhB,KAAKpB,OAG3CA,KAAK2iB,YACL3iB,KAAKse,YAAYpd,iBAAiB,QAASlB,KAAK6iB,sBAAsBzhB,KAAKpB,QAE3EA,KAAKse,YAAY9c,aAAa,SAAU,IAE5C,EAUA6c,EAAO/e,UAAUqjB,UAAY,WACvB3iB,KAAKye,IAAItC,SACXnc,KAAKue,MAAMtd,gBAAgB,UAC3BjB,KAAKse,YAAY9c,aAAa,SAAU,MAExCxB,KAAKse,YAAYrd,gBAAgB,UACjCjB,KAAKse,YAAY9c,aAAa,gBAAiBxB,KAAKwe,YAEhDxe,KAAKwe,WACPxe,KAAKue,MAAMtd,gBAAgB,UAE3BjB,KAAKue,MAAM/c,aAAa,SAAU,IAGxC,EAQA6c,EAAO/e,UAAUujB,sBAAwB,WACvC7iB,KAAKwe,YAAcxe,KAAKwe,WACxBxe,KAAK2iB,WACP,EA2BAjE,EAAOpf,UAAUY,KAAO,WACtB,IAAIH,EAAUC,KAAKD,QAGnBb,EAFcc,KAAKie,SAEM,SAAU0C,GACjC,IAAIlV,EAASkV,EAAO/e,aAAa,sBAI5B6J,GAAWjQ,SAAS+jB,eAAe9T,KAMxCkV,EAAOnf,aAAa,gBAAiBiK,GACrCkV,EAAO1f,gBAAgB,sBAC3B,IAMM,eAAgB5G,OAClBA,OAAO6G,iBAAiB,WAAYlB,KAAK4gB,0BAA0Bxf,KAAKpB,OAExE3F,OAAO6G,iBAAiB,mBAAoBlB,KAAK4gB,0BAA0Bxf,KAAKpB,OAMlFA,KAAK4gB,4BAGL7gB,EAAQmB,iBAAiB,QAASlB,KAAK6gB,YAAYzf,KAAKpB,MAC1D,EAKA0e,EAAOpf,UAAUshB,0BAA4B,WAC3C1hB,EAAgBc,KAAKie,QAASje,KAAK8gB,oCAAoC1f,KAAKpB,MAC9E,EAUA0e,EAAOpf,UAAUwhB,oCAAsC,SAAUH,GAC/D,IAAII,EAAUvlB,SAAS+jB,eAAeoB,EAAO/e,aAAa,kBAE1D,GAAImf,GAAWA,EAAQ7U,UAAUyB,SAAS,6BAA8B,CACtE,IAAIqT,EAAiBL,EAAO5d,QAE5B4d,EAAOnf,aAAa,gBAAiBwf,GACrCD,EAAQ7U,UAAUC,OAAO,qCAAsC6U,EACnE,CACA,EAYAtC,EAAOpf,UAAUuhB,YAAc,SAAU9lB,GACvC,IAAI+nB,EAAgB/nB,EAAM0Q,OAGC,UAAvBqX,EAAc5K,MAQlBhZ,EAFiB1D,SAASmF,iBAAiB,sCAEf,SAAUggB,GACpC,IAAIoC,EAAoBpC,EAAOQ,OAAS2B,EAAc3B,KACnCR,EAAO3kB,OAAS8mB,EAAc9mB,MAE9B+mB,GACjB/iB,KAAK8gB,oCAAoCH,EAE/C,EAAIvf,KAAKpB,MACT,EAiBA2e,EAASrf,UAAUY,KAAO,WAEnBF,KAAKD,UAKVC,KAAK4e,eAAiB5e,KAAKgjB,mBACtBhjB,KAAK4e,gBAIV5e,KAAKD,QAAQmB,iBAAiB,QAASlB,KAAKijB,mBAAmB7hB,KAAKpB,OACtE,EAOA2e,EAASrf,UAAU0jB,iBAAmB,WACpC,IAAIE,EAAkBljB,KAAK0hB,qBAE3B,QAAKwB,GAIE1nB,SAAS+jB,eAAe2D,EACjC,EAOAvE,EAASrf,UAAU2jB,mBAAqB,WACtC,IAAIrE,EAAiB5e,KAAK4e,eAErBA,EAAehd,aAAa,cAE/Bgd,EAAepd,aAAa,WAAY,MACxCod,EAAe1S,UAAU2B,IAAI,mCAGxB7N,KAAK6e,wBACR7e,KAAK4e,eAAe1d,iBAAiB,OAAQlB,KAAKmjB,sBAAsB/hB,KAAKpB,OAC7EA,KAAK6e,uBAAwB,IAGjCD,EAAe/c,OACjB,EAQA8c,EAASrf,UAAU6jB,sBAAwB,WACzCnjB,KAAK4e,eAAe3d,gBAAgB,YACpCjB,KAAK4e,eAAe1S,UAAU4B,OAAO,kCACvC,EAUA6Q,EAASrf,UAAUoiB,mBAAqB,WAEtC,QAAK1hB,KAAKD,QAAQqjB,MAIXpjB,KAAKD,QAAQqjB,KAAK/kB,MAAM,KAAK2jB,KACtC,EAEA,SAAUnf,GAIJ,aAAc7C,MAAQ,uBAAwBxE,SAAS4J,iBAMzDhB,OAAO4E,eAAeI,QAAQ9J,UAAW,qBAAsB,CAC7DoK,IAAK,WAEH,IADA,IAAIiD,EAAK3M,KAAKqjB,YACP1W,GAAsB,IAAhBA,EAAGyC,UAAkBzC,EAAKA,EAAG0W,YAC1C,OAAO1W,CACf,GAGC,EAAEpN,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAE5H,SAAUR,GAIJ,aAAc7C,MAAQ,2BAA4BxE,SAAS4J,iBAM7DhB,OAAO4E,eAAeI,QAAQ9J,UAAW,yBAA0B,CACjEoK,IAAK,WAEH,IADA,IAAIiD,EAAK3M,KAAKsjB,gBACP3W,GAAsB,IAAhBA,EAAGyC,UAAkBzC,EAAKA,EAAG2W,gBAC1C,OAAO3W,CACf,GAGC,EAAEpN,KAAK,iBAAoBlF,QAAUA,QAAU,iBAAoB0P,MAAQA,MAAQ,iBAAoB1G,QAAUA,QAAU,CAAA,GAgB5Hyb,EAAKxf,UAAUY,KAAO,WACa,mBAAtB7F,OAAOqoB,WAChB1iB,KAAKujB,wBAELvjB,KAAKwjB,OAET,EAEA1E,EAAKxf,UAAUikB,sBAAwB,WACrCvjB,KAAKye,IAAMpkB,OAAOqoB,WAAW,0BAC7B1iB,KAAKye,IAAImE,YAAY5iB,KAAKyjB,UAAUriB,KAAKpB,OACzCA,KAAKyjB,WACP,EAEA3E,EAAKxf,UAAUmkB,UAAY,WACrBzjB,KAAKye,IAAItC,QACXnc,KAAKwjB,QAELxjB,KAAK0jB,UAET,EAEA5E,EAAKxf,UAAUkkB,MAAQ,WACrB,IAAIzjB,EAAUC,KAAKD,QACfgf,EAAQ/e,KAAK+e,MACb4E,EAAW5jB,EAAQM,cAAc,qBACjCujB,EAAgB7jB,EAAQY,iBAAiB,0BAE7C,GAAKoe,GAAU4E,GAAaC,EAA5B,CAIAD,EAASniB,aAAa,OAAQ,WAE9BtC,EAAgB0kB,GAAe,SAAUC,GACvCA,EAAMriB,aAAa,OAAQ,eAC/B,IAEEtC,EAAgB6f,EAAO,SAAU+E,GAE/B9jB,KAAK+jB,cAAcD,GAGnBA,EAAKE,cAAgBhkB,KAAKikB,WAAW7iB,KAAKpB,MAC1C8jB,EAAKI,gBAAkBlkB,KAAKmkB,aAAa/iB,KAAKpB,MAG9C8jB,EAAK5iB,iBAAiB,QAAS4iB,EAAKE,eAAe,GACnDF,EAAK5iB,iBAAiB,UAAW4iB,EAAKI,iBAAiB,GAGvDlkB,KAAKokB,QAAQN,EACjB,EAAI1iB,KAAKpB,OAGP,IAAIqkB,EAAarkB,KAAKskB,OAAOjqB,OAAO0E,SAASqkB,OAASpjB,KAAK+e,MAAM,GACjE/e,KAAKukB,QAAQF,GAGbtkB,EAAQykB,kBAAoBxkB,KAAKykB,aAAarjB,KAAKpB,MACnD3F,OAAO6G,iBAAiB,aAAcnB,EAAQykB,mBAAmB,EA9BnE,CA+BA,EAEA1F,EAAKxf,UAAUokB,SAAW,WACxB,IAAI3jB,EAAUC,KAAKD,QACfgf,EAAQ/e,KAAK+e,MACb4E,EAAW5jB,EAAQM,cAAc,qBACjCujB,EAAgB7jB,EAAQY,iBAAiB,0BAExCoe,GAAU4E,GAAaC,IAI5BD,EAAS1iB,gBAAgB,QAEzB/B,EAAgB0kB,GAAe,SAAUC,GACvCA,EAAM5iB,gBAAgB,OAAQ,eAClC,IAEE/B,EAAgB6f,EAAO,SAAU+E,GAE/BA,EAAK/J,oBAAoB,QAAS+J,EAAKE,eAAe,GACtDF,EAAK/J,oBAAoB,UAAW+J,EAAKI,iBAAiB,GAG1DlkB,KAAK0kB,gBAAgBZ,EACzB,EAAI1iB,KAAKpB,OAGP3F,OAAO0f,oBAAoB,aAAcha,EAAQykB,mBAAmB,GACtE,EAEA1F,EAAKxf,UAAUmlB,aAAe,SAAU7mB,GACtC,IAAIwlB,EAAO/oB,OAAO0E,SAASqkB,KACvBuB,EAAe3kB,KAAKskB,OAAOlB,GAC/B,GAAKuB,EAKL,GAAI3kB,KAAK4kB,aACP5kB,KAAK4kB,cAAe,MADtB,CAMA,IAAIC,EAAe7kB,KAAK8kB,gBAExB9kB,KAAKokB,QAAQS,GACb7kB,KAAKukB,QAAQI,GACbA,EAAa9iB,OAPf,CAQA,EAEAid,EAAKxf,UAAU8kB,QAAU,SAAUN,GACjC9jB,KAAK+kB,eAAejB,GACpB9jB,KAAKglB,UAAUlB,EACjB,EAEAhF,EAAKxf,UAAUilB,QAAU,SAAUT,GACjC9jB,KAAKilB,aAAanB,GAClB9jB,KAAKklB,UAAUpB,EACjB,EAEAhF,EAAKxf,UAAUglB,OAAS,SAAUlB,GAChC,OAAOpjB,KAAKD,QAAQM,cAAc,0BAA4B+iB,EAAO,KACvE,EAEAtE,EAAKxf,UAAUykB,cAAgB,SAAUD,GAEvC,IAAIqB,EAAUnlB,KAAKolB,QAAQtB,GAAM1Y,MAAM,GACvC0Y,EAAKtiB,aAAa,KAAM,OAAS2jB,GACjCrB,EAAKtiB,aAAa,OAAQ,OAC1BsiB,EAAKtiB,aAAa,gBAAiB2jB,GACnCrB,EAAKtiB,aAAa,gBAAiB,SACnCsiB,EAAKtiB,aAAa,WAAY,MAG9B,IAAI6jB,EAASrlB,KAAKslB,SAASxB,GAC3BuB,EAAO7jB,aAAa,OAAQ,YAC5B6jB,EAAO7jB,aAAa,kBAAmBsiB,EAAK1gB,IAC5CiiB,EAAOnZ,UAAU2B,IAAI7N,KAAKqf,cAC5B,EAEAP,EAAKxf,UAAUolB,gBAAkB,SAAUZ,GAEzCA,EAAK7iB,gBAAgB,MACrB6iB,EAAK7iB,gBAAgB,QACrB6iB,EAAK7iB,gBAAgB,iBACrB6iB,EAAK7iB,gBAAgB,iBACrB6iB,EAAK7iB,gBAAgB,YAGrB,IAAIokB,EAASrlB,KAAKslB,SAASxB,GAC3BuB,EAAOpkB,gBAAgB,QACvBokB,EAAOpkB,gBAAgB,mBACvBokB,EAAOnZ,UAAU4B,OAAO9N,KAAKqf,cAC/B,EAEAP,EAAKxf,UAAU2kB,WAAa,SAAUrmB,GACpC,IAAKA,EAAE6N,OAAOS,UAAUyB,SAAS,mBAE/B,OAAO,EAET/P,EAAE2E,iBACF,IAAIgjB,EAAU3nB,EAAE6N,OACZ+Z,EAAcxlB,KAAK8kB,gBACvB9kB,KAAKokB,QAAQoB,GACbxlB,KAAKukB,QAAQgB,GACbvlB,KAAKylB,mBAAmBF,EAC1B,EAEAzG,EAAKxf,UAAUmmB,mBAAqB,SAAU3B,GAC5C,IAAIuB,EAASrlB,KAAKslB,SAASxB,GAIvB1gB,EAAKiiB,EAAOjiB,GAChBiiB,EAAOjiB,GAAK,GACZpD,KAAK4kB,cAAe,EACpBvqB,OAAO0E,SAASqkB,KAAOpjB,KAAKolB,QAAQtB,GAAM1Y,MAAM,GAChDia,EAAOjiB,GAAKA,CACd,EAEA0b,EAAKxf,UAAU6kB,aAAe,SAAUvmB,GACtC,OAAQA,EAAEgd,SACR,KAAK5a,KAAKgf,KAAKC,KACf,KAAKjf,KAAKgf,KAAKG,GACbnf,KAAK0lB,sBACL9nB,EAAE2E,iBACF,MACF,KAAKvC,KAAKgf,KAAKE,MACf,KAAKlf,KAAKgf,KAAKI,KACbpf,KAAK2lB,kBACL/nB,EAAE2E,iBAGR,EAEAuc,EAAKxf,UAAUqmB,gBAAkB,WAC/B,IAAIC,EAAa5lB,KAAK8kB,gBAClBe,EAAkBD,EAAWtqB,WAAWwqB,mBAC5C,GAAID,EACF,IAAIE,EAAUF,EAAgBxlB,cAAc,oBAE1C0lB,IACF/lB,KAAKokB,QAAQwB,GACb5lB,KAAKukB,QAAQwB,GACbA,EAAQlkB,QACR7B,KAAKylB,mBAAmBM,GAE5B,EAEAjH,EAAKxf,UAAUomB,oBAAsB,WACnC,IAAIE,EAAa5lB,KAAK8kB,gBAClBkB,EAAsBJ,EAAWtqB,WAAW2qB,uBAChD,GAAID,EACF,IAAIE,EAAcF,EAAoB3lB,cAAc,oBAElD6lB,IACFlmB,KAAKokB,QAAQwB,GACb5lB,KAAKukB,QAAQ2B,GACbA,EAAYrkB,QACZ7B,KAAKylB,mBAAmBS,GAE5B,EAEApH,EAAKxf,UAAUgmB,SAAW,SAAUxB,GAElC,OADa9jB,KAAKD,QAAQM,cAAcL,KAAKolB,QAAQtB,GAEvD,EAEAhF,EAAKxf,UAAU4lB,UAAY,SAAUpB,GACtB9jB,KAAKslB,SAASxB,GACpB5X,UAAU4B,OAAO9N,KAAKqf,cAC/B,EAEAP,EAAKxf,UAAU0lB,UAAY,SAAUmB,GACtBnmB,KAAKslB,SAASa,GACpBja,UAAU2B,IAAI7N,KAAKqf,cAC5B,EAEAP,EAAKxf,UAAUylB,eAAiB,SAAUjB,GACxCA,EAAKtiB,aAAa,gBAAiB,SACnCsiB,EAAKxoB,WAAW4Q,UAAU4B,OAAO,mCACjCgW,EAAKtiB,aAAa,WAAY,KAChC,EAEAsd,EAAKxf,UAAU2lB,aAAe,SAAUnB,GACtCA,EAAKtiB,aAAa,gBAAiB,QACnCsiB,EAAKxoB,WAAW4Q,UAAU2B,IAAI,mCAC9BiW,EAAKtiB,aAAa,WAAY,IAChC,EAEAsd,EAAKxf,UAAUwlB,cAAgB,WAC7B,OAAO9kB,KAAKD,QAAQM,cAAc,oDACpC,EAKAye,EAAKxf,UAAU8lB,QAAU,SAAUtB,GACjC,IAAI5gB,EAAO4gB,EAAKliB,aAAa,QAE7B,OADWsB,EAAKkI,MAAMlI,EAAKhF,QAAQ,KAAMgF,EAAK3E,OAEhD,EAsFAgF,EAAQ6iB,QA5ER,SAAkBlhB,GAKhB,IAAImhB,OAAiC,KAJrCnhB,OAA2B,IAAXA,EAAyBA,EAAS,CAAA,GAIvBohB,MAAwBphB,EAAOohB,MAAQ9qB,SAGlE0D,EADkBmnB,EAAO1lB,iBAAiB,oCACb,SAAU4lB,GACrC,IAAIpU,EAAUoU,EAAYrhB,EAAOshB,WAAWtmB,MAChD,IAGEhB,EADemnB,EAAO1lB,iBAAiB,iCACb,SAAUqU,GAClC,IAAIuF,EAAOvF,EAAS9P,EAAOuhB,QAAQvmB,MACvC,IAGEhB,EADuBmnB,EAAO1lB,iBAAiB,0CACb,SAAU+lB,GAC1C,IAAIpJ,EAAeoJ,EAAiBxhB,EAAOyhB,gBAAgBzmB,MAC/D,IAGEhB,EADkBmnB,EAAO1lB,iBAAiB,qCACb,SAAUimB,GACrC,IAAI5I,EAAW4I,GAAW1mB,MAC9B,IAGEhB,EADemnB,EAAO1lB,iBAAiB,kCACb,SAAUkmB,GAClC,IAAI9L,EAAQ8L,GAAS3mB,MACzB,IAGE,IAAI4mB,EAAgBT,EAAOhmB,cAAc,uCACrCymB,GACF,IAAI5I,EAAa4I,EAAe5hB,EAAO6hB,cAAc7mB,OAIvD,IAAIoU,EAAU+R,EAAOhmB,cAAc,gCAC/BiU,GACF,IAAI+J,EAAO/J,GAASpU,OAItBhB,EAD2BmnB,EAAO1lB,iBAAiB,8CACb,SAAUqmB,GAC9C,IAAI5I,EAAmB4I,EAAqB9hB,EAAO+hB,oBAAoB/mB,MAC3E,IAGEhB,EADcmnB,EAAO1lB,iBAAiB,iCACb,SAAUumB,GACjC,IAAIxI,EAAOwI,GAAQhnB,MACvB,IAIE,IAAIye,EADY0H,EAAOhmB,cAAc,oCACbH,OAGxBhB,EADYmnB,EAAO1lB,iBAAiB,+BACb,SAAUoe,GAC/B,IAAID,EAAKC,GAAO7e,MACpB,GACA,EAeAqD,EAAQ4O,UAAYA,EACpB5O,EAAQgX,OAASA,EACjBhX,EAAQwX,QAAUA,EAClBxX,EAAQ+Z,eAAiBA,EACzB/Z,EAAQya,WAAaA,EACrBza,EAAQ2a,aAAeA,EACvB3a,EAAQ8a,OAASA,EACjB9a,EAAQ6a,mBAAqBA,EAC7B7a,EAAQmb,OAASA,EACjBnb,EAAQob,SAAWA,EACnBpb,EAAQub,KAAOA,CAEd,IAQD,IAAI3e,cAAgB3E,SAAS6E,cAAc,uCAC3C,IAAIP,aAAaK,eAAeD,OAEhC,IAAIinB,YAAc5qB,mBACd4qB,aAAetqB,qBAAqBsqB,cAAgBA,YAAYvrB,WAChE0B,gBAIJ,IAAI8pB,aAAe5rB,SAAS6E,cAAc,oCAC1C,IAAIJ,YAAYmnB,cAAclnB,OAC9B,MAAMmnB,UAAY7rB,SAASmF,iBAAiB,kBAC5C0mB,UAAU9pB,SAAS+pB,IACfA,EAAKpmB,iBAAiB,SAAS,KAC3B7G,OAAOktB,QAAQC,MAAM,GACvB,IAEN,MAAMf,OAASjrB,SAAS+jB,eAAe,sBACvCkH,cAAgDA,OAAOvlB,iBAAiB,SAAS,SAAqBnG,GAElG,MAAM0sB,EAAejsB,SAAS+jB,eAAe,WACV,SAA/BkI,EAAa3L,MAAMC,QACnB0L,EAAa3L,MAAMC,QAAU,QAG7B0L,EAAa3L,MAAMC,QAAU,MAErC","file":"bundle.js","sourcesContent":["// it doesn't make sense to do typescript type checking in a javascript file where you can't specify the type (is there a way?)\n// (f is a HTMLScriptElement but we can't cast it in js)\n// so switch off javascript compilation for this file...\n// @ts-nocheck\nexport default function loadAnalytics() {\n    // ga side: https://www.youtube.com/watch?v=28d60ejfk3s\n    // should we set up consent?: https://developers.google.com/tag-platform/devguides/consent#tag-manager\n    if (!window.dataLayer) {\n        // is this too early?\n        //ga('set', 'location', getPiiSafeLocation());\n        (function (w, d, s, l, i) {\n            w[l] = w[l] || [];\n            w[l].push({\n                'gtm.start': new Date().getTime(), event: 'gtm.js'\n            });\n            var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';\n            j.async = true;\n            j.src =\n                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;\n            f.parentNode.insertBefore(j, f);\n        })(window, document, 'script', 'dataLayer', 'GTM-W6QMSGQ');\n        // nonce enabled version (if we decide to enable nonces)\n        //\n        // see: https://dev.to/matijamrkaic/using-google-tag-manager-with-a-content-security-policy-9ai\n        // <script id=\"gtmScript\" data-nonce=\"@Context.GetNonce()\" asp-add-nonce>\n        //\n        //    (function (w, d, s, l, i) {\n        //        w[l] = w[l] || [];\n        //        w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\n        //        var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true;\n        //        j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl; var n = d.querySelector('[nonce]'); n && j.setAttribute('nonce', n.nonce || n.getAttribute('nonce'));\n        //        f.parentNode.insertBefore(j, f);\n        //    }\n        //    )(window, document, 'script', 'dataLayer', 'GTM-W6QMSGQ');\n    }\n}\n//export function removeAnalytics() {\n//    // remove the script tag\n//    var script = document.getElementById('gtmScript');\n//    script.parentNode.removeChild(script);\n//}\nfunction getPiiSafeLocation() {\n    var urlArray = window.location.href.split(\"?\");\n    var queryParams = new URLSearchParams(urlArray[1]);\n    var postcode = queryParams.get(\"postcode\");\n    postcode = postcode.replace(/[a-zA-Z]+$/, \"\");\n    queryParams.set(\"postcode\", postcode);\n    var newQueryParams = queryParams.toString();\n    var newUrl = urlArray[0] + \"?\" + newQueryParams;\n    return newUrl;\n}\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvYW5hbHl0aWNzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLCtIQUErSDtBQUMvSCx3REFBd0Q7QUFDeEQsd0RBQXdEO0FBQ3hELGNBQWM7QUFFZCxNQUFNLENBQUMsT0FBTyxVQUFVLGFBQWE7SUFFakMsdURBQXVEO0lBQ3ZELHNHQUFzRztJQUV0RyxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRTtRQUVuQixxQkFBcUI7UUFDckIsOENBQThDO1FBRTlDLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQztZQUNwQixDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7Z0JBQ3pCLFdBQVcsRUFDUCxJQUFJLElBQUksRUFBRSxDQUFDLE9BQU8sRUFBRSxFQUFFLEtBQUssRUFBRSxRQUFRO2FBQzVDLENBQUMsQ0FBQztZQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFDcEMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsSUFBSSxXQUFXLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztZQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO1lBQUMsQ0FBQyxDQUFDLEdBQUc7Z0JBQ3JGLDZDQUE2QyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7WUFBQyxDQUFDLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDaEcsQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsV0FBVyxFQUFFLGFBQWEsQ0FBQyxDQUFDO1FBRS9ELHdEQUF3RDtRQUN4RCxFQUFFO1FBQ0YsK0ZBQStGO1FBQy9GLHlFQUF5RTtRQUN6RSxFQUFFO1FBQ0YsaUNBQWlDO1FBQ2pDLDRCQUE0QjtRQUM1Qiw0RUFBNEU7UUFDNUUsK0hBQStIO1FBQy9ILCtLQUErSztRQUMvSywwQ0FBMEM7UUFDMUMsT0FBTztRQUNQLGdFQUFnRTtLQUMvRDtBQUNMLENBQUM7QUFFRCxxQ0FBcUM7QUFDckMsOEJBQThCO0FBQzlCLHdEQUF3RDtBQUN4RCw0Q0FBNEM7QUFDNUMsR0FBRztBQUVILFNBQVMsa0JBQWtCO0lBQ3ZCLElBQUksUUFBUSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUMvQyxJQUFJLFdBQVcsR0FBRyxJQUFJLGVBQWUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNuRCxJQUFJLFFBQVEsR0FBRyxXQUFXLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzNDLFFBQVEsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxFQUFFLENBQUMsQ0FBQztJQUM5QyxXQUFXLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxRQUFRLENBQUMsQ0FBQztJQUN0QyxJQUFJLGNBQWMsR0FBRyxXQUFXLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDNUMsSUFBSSxNQUFNLEdBQUcsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxjQUFjLENBQUM7SUFDaEQsT0FBTyxNQUFNLENBQUM7QUFDbEIsQ0FBQyIsImZpbGUiOiJjb21wb25lbnRzL2FuYWx5dGljcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG4vLyBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgdG8gZG8gdHlwZXNjcmlwdCB0eXBlIGNoZWNraW5nIGluIGEgamF2YXNjcmlwdCBmaWxlIHdoZXJlIHlvdSBjYW4ndCBzcGVjaWZ5IHRoZSB0eXBlIChpcyB0aGVyZSBhIHdheT8pXHJcbi8vIChmIGlzIGEgSFRNTFNjcmlwdEVsZW1lbnQgYnV0IHdlIGNhbid0IGNhc3QgaXQgaW4ganMpXHJcbi8vIHNvIHN3aXRjaCBvZmYgamF2YXNjcmlwdCBjb21waWxhdGlvbiBmb3IgdGhpcyBmaWxlLi4uXHJcbi8vIEB0cy1ub2NoZWNrXHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBsb2FkQW5hbHl0aWNzKCkge1xyXG5cclxuICAgIC8vIGdhIHNpZGU6IGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9MjhkNjBlamZrM3NcclxuICAgIC8vIHNob3VsZCB3ZSBzZXQgdXAgY29uc2VudD86IGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL3RhZy1wbGF0Zm9ybS9kZXZndWlkZXMvY29uc2VudCN0YWctbWFuYWdlclxyXG5cclxuICAgIGlmICghd2luZG93LmRhdGFMYXllcikge1xyXG5cclxuICAgICAgICAvLyBpcyB0aGlzIHRvbyBlYXJseT9cclxuICAgICAgICAvL2dhKCdzZXQnLCAnbG9jYXRpb24nLCBnZXRQaWlTYWZlTG9jYXRpb24oKSk7XHJcblxyXG4gICAgICAgIChmdW5jdGlvbiAodywgZCwgcywgbCwgaSkge1xyXG4gICAgICAgICAgICB3W2xdID0gd1tsXSB8fCBbXTsgd1tsXS5wdXNoKHtcclxuICAgICAgICAgICAgICAgICdndG0uc3RhcnQnOlxyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKCkuZ2V0VGltZSgpLCBldmVudDogJ2d0bS5qcydcclxuICAgICAgICAgICAgfSk7IHZhciBmID0gZC5nZXRFbGVtZW50c0J5VGFnTmFtZShzKVswXSxcclxuICAgICAgICAgICAgICAgIGogPSBkLmNyZWF0ZUVsZW1lbnQocyksIGRsID0gbCAhPSAnZGF0YUxheWVyJyA/ICcmbD0nICsgbCA6ICcnOyBqLmFzeW5jID0gdHJ1ZTsgai5zcmMgPVxyXG4gICAgICAgICAgICAgICAgJ2h0dHBzOi8vd3d3Lmdvb2dsZXRhZ21hbmFnZXIuY29tL2d0bS5qcz9pZD0nICsgaSArIGRsOyBmLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGosIGYpO1xyXG4gICAgICAgIH0pKHdpbmRvdywgZG9jdW1lbnQsICdzY3JpcHQnLCAnZGF0YUxheWVyJywgJ0dUTS1XNlFNU0dRJyk7XHJcblxyXG4gICAgLy8gbm9uY2UgZW5hYmxlZCB2ZXJzaW9uIChpZiB3ZSBkZWNpZGUgdG8gZW5hYmxlIG5vbmNlcylcclxuICAgIC8vXHJcbiAgICAvLyBzZWU6IGh0dHBzOi8vZGV2LnRvL21hdGlqYW1ya2FpYy91c2luZy1nb29nbGUtdGFnLW1hbmFnZXItd2l0aC1hLWNvbnRlbnQtc2VjdXJpdHktcG9saWN5LTlhaVxyXG4gICAgLy8gPHNjcmlwdCBpZD1cImd0bVNjcmlwdFwiIGRhdGEtbm9uY2U9XCJAQ29udGV4dC5HZXROb25jZSgpXCIgYXNwLWFkZC1ub25jZT5cclxuICAgIC8vXHJcbiAgICAvLyAgICAoZnVuY3Rpb24gKHcsIGQsIHMsIGwsIGkpIHtcclxuICAgIC8vICAgICAgICB3W2xdID0gd1tsXSB8fCBbXTtcclxuICAgIC8vICAgICAgICB3W2xdLnB1c2goeyAnZ3RtLnN0YXJ0JzogbmV3IERhdGUoKS5nZXRUaW1lKCksIGV2ZW50OiAnZ3RtLmpzJyB9KTtcclxuICAgIC8vICAgICAgICB2YXIgZiA9IGQuZ2V0RWxlbWVudHNCeVRhZ05hbWUocylbMF0sIGogPSBkLmNyZWF0ZUVsZW1lbnQocyksIGRsID0gbCAhPSAnZGF0YUxheWVyJyA/ICcmbD0nICsgbCA6ICcnOyBqLmFzeW5jID0gdHJ1ZTtcclxuICAgIC8vICAgICAgICBqLnNyYyA9ICdodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbS9ndG0uanM/aWQ9JyArIGkgKyBkbDsgdmFyIG4gPSBkLnF1ZXJ5U2VsZWN0b3IoJ1tub25jZV0nKTsgbiAmJiBqLnNldEF0dHJpYnV0ZSgnbm9uY2UnLCBuLm5vbmNlIHx8IG4uZ2V0QXR0cmlidXRlKCdub25jZScpKTtcclxuICAgIC8vICAgICAgICBmLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGosIGYpO1xyXG4gICAgLy8gICAgfVxyXG4gICAgLy8gICAgKSh3aW5kb3csIGRvY3VtZW50LCAnc2NyaXB0JywgJ2RhdGFMYXllcicsICdHVE0tVzZRTVNHUScpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vL2V4cG9ydCBmdW5jdGlvbiByZW1vdmVBbmFseXRpY3MoKSB7XHJcbi8vICAgIC8vIHJlbW92ZSB0aGUgc2NyaXB0IHRhZ1xyXG4vLyAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2d0bVNjcmlwdCcpO1xyXG4vLyAgICBzY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHQpO1xyXG4vL31cclxuXHJcbmZ1bmN0aW9uIGdldFBpaVNhZmVMb2NhdGlvbigpIHtcclxuICAgIHZhciB1cmxBcnJheSA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KFwiP1wiKTtcclxuICAgIHZhciBxdWVyeVBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXModXJsQXJyYXlbMV0pO1xyXG4gICAgdmFyIHBvc3Rjb2RlID0gcXVlcnlQYXJhbXMuZ2V0KFwicG9zdGNvZGVcIik7XHJcbiAgICBwb3N0Y29kZSA9IHBvc3Rjb2RlLnJlcGxhY2UoL1thLXpBLVpdKyQvLCBcIlwiKTtcclxuICAgIHF1ZXJ5UGFyYW1zLnNldChcInBvc3Rjb2RlXCIsIHBvc3Rjb2RlKTtcclxuICAgIHZhciBuZXdRdWVyeVBhcmFtcyA9IHF1ZXJ5UGFyYW1zLnRvU3RyaW5nKCk7XHJcbiAgICB2YXIgbmV3VXJsID0gdXJsQXJyYXlbMF0gKyBcIj9cIiArIG5ld1F1ZXJ5UGFyYW1zO1xyXG4gICAgcmV0dXJuIG5ld1VybDtcclxufSJdfQ==\n","/**\n * Cookie functions\n * ================\n *\n * Used by the cookie banner component and cookies page pattern.\n *\n * Includes function `Cookie()` for getting, setting, and deleting cookies, and\n * functions to manage the users' consent to cookies.\n *\n * Note: there is an inline script in cookie-banner.njk to show the banner\n * as soon as possible, to avoid a high Cumulative Layout Shift (CLS) score.\n * The consent cookie version is defined in cookie-banner.njk\n */\nimport Analytics from './analytics.js';\n/* Name of the cookie to save users cookie preferences to. */\nvar CONSENT_COOKIE_NAME = 'service_directory_cookies_policy';\n/* Google Analytics tracking IDs for preview and live environments. */\n/*measurement ids or tag ids*/\n/*Fatayi is going to link the existing ga (this id) into gtm (as a tag), then we can check the disabling*/\n//var TRACKING_PREVIEW_ID = 'GA_TODO:STICKITHERE'\nvar TRACKING_LIVE_ID = 'G-30G6ZFTEJE';\n/* Users can (dis)allow different groups of cookies. */\nvar COOKIE_CATEGORIES = {\n    analytics: ['_ga', '_ga_' + TRACKING_LIVE_ID],\n    /* Essential cookies\n     *\n     * Essential cookies cannot be deselected, but we want our cookie code to\n     * only allow adding cookies that are documented in this object, so they need\n     * to be added here.\n     */\n    essential: ['service_directory_cookies_policy']\n};\n/*\n * Default cookie preferences if user has no cookie preferences.\n *\n * Note that this doesn't include a key for essential cookies, essential\n * cookies cannot be disallowed. If the object contains { essential: false }\n * this will be ignored.\n */\nvar DEFAULT_COOKIE_CONSENT = {\n    analytics: false\n};\n/*\n * Set, get, and delete cookies.\n *\n * Usage:\n *\n *   Setting a cookie:\n *   Cookie('hobnob', 'tasty', { days: 30 })\n *\n *   Reading a cookie:\n *   Cookie('hobnob')\n *\n *   Deleting a cookie:\n *   Cookie('hobnob', null)\n */\nexport function Cookie(name, value, options) {\n    if (typeof value !== 'undefined') {\n        if (value === false || value === null) {\n            deleteCookie(name);\n        }\n        else {\n            // Default expiry date of 30 days\n            if (typeof options === 'undefined') {\n                options = { days: 30 };\n            }\n            setCookie(name, value, options);\n        }\n    }\n    else {\n        return getCookie(name);\n    }\n}\n/** Return the user's cookie preferences.\n *\n * If the consent cookie is malformed, or not present,\n * returns null.\n */\nexport function getConsentCookie() {\n    var consentCookie = getCookie(CONSENT_COOKIE_NAME);\n    var consentCookieObj;\n    if (consentCookie) {\n        try {\n            consentCookieObj = JSON.parse(consentCookie);\n        }\n        catch (err) {\n            return null;\n        }\n    }\n    else {\n        return null;\n    }\n    return consentCookieObj;\n}\n/** Check the cookie preferences object.\n *\n * If the consent object is not present, malformed, or incorrect version,\n * returns false, otherwise returns true.\n *\n * This is also duplicated in cookie-banner.njk - the two need to be kept in sync\n */\nexport function isValidConsentCookie(options) {\n    return (options && options.version >= window.GDS_CONSENT_COOKIE_VERSION);\n}\n/** Update the user's cookie preferences. */\nexport function setConsentCookie(options) {\n    var cookieConsent = getConsentCookie();\n    if (!cookieConsent) {\n        cookieConsent = JSON.parse(JSON.stringify(DEFAULT_COOKIE_CONSENT));\n    }\n    // Merge current cookie preferences and new preferences\n    for (var option in options) {\n        cookieConsent[option] = options[option];\n    }\n    // Essential cookies cannot be deselected, ignore this cookie type\n    delete cookieConsent.essential;\n    cookieConsent.version = window.GDS_CONSENT_COOKIE_VERSION;\n    // Set the consent cookie\n    setCookie(CONSENT_COOKIE_NAME, JSON.stringify(cookieConsent), { days: 365 });\n    // Update the other cookies\n    resetCookies();\n}\n/** Apply the user's cookie preferences\n *\n * Deletes any cookies the user has not consented to.\n */\nexport function resetCookies() {\n    var options = getConsentCookie();\n    // If no preferences or old version use the default\n    if (!isValidConsentCookie(options)) {\n        options = JSON.parse(JSON.stringify(DEFAULT_COOKIE_CONSENT));\n    }\n    for (var cookieType in options) {\n        if (cookieType === 'version') {\n            continue;\n        }\n        // Essential cookies cannot be deselected, ignore this cookie type\n        if (cookieType === 'essential') {\n            continue;\n        }\n        // Initialise analytics if allowed\n        if (cookieType === 'analytics' && options[cookieType]) {\n            // Enable GA if allowed\n            window['ga-disable-' + TRACKING_LIVE_ID] = false;\n            Analytics();\n        }\n        else {\n            // Disable GA if not allowed\n            window['ga-disable-' + TRACKING_LIVE_ID] = true;\n        }\n        if (!options[cookieType]) {\n            // Fetch the cookies in that category\n            var cookiesInCategory = COOKIE_CATEGORIES[cookieType];\n            cookiesInCategory.forEach(function (cookie) {\n                // Delete cookie\n                Cookie(cookie, null);\n            });\n        }\n    }\n}\nfunction userAllowsCookieCategory(cookieCategory, cookiePreferences) {\n    // Essential cookies are always allowed\n    if (cookieCategory === 'essential') {\n        return true;\n    }\n    // Sometimes cookiePreferences is malformed in some of the tests, so we need to handle these\n    try {\n        return cookiePreferences[cookieCategory];\n    }\n    catch (e) {\n        console.error(e);\n        return false;\n    }\n}\nfunction userAllowsCookie(cookieName) {\n    // Always allow setting the consent cookie\n    if (cookieName === CONSENT_COOKIE_NAME) {\n        return true;\n    }\n    // Get the current cookie preferences\n    var cookiePreferences = getConsentCookie();\n    // If no preferences or old version use the default\n    if (!isValidConsentCookie(cookiePreferences)) {\n        cookiePreferences = DEFAULT_COOKIE_CONSENT;\n    }\n    for (var category in COOKIE_CATEGORIES) {\n        var cookiesInCategory = COOKIE_CATEGORIES[category];\n        if (cookiesInCategory.indexOf(cookieName) !== '-1') {\n            return userAllowsCookieCategory(category, cookiePreferences);\n        }\n    }\n    // Deny the cookie if it is not known to us\n    return false;\n}\nfunction getCookie(name) {\n    var nameEQ = name + '=';\n    var cookies = document.cookie.split(';');\n    for (var i = 0, len = cookies.length; i < len; i++) {\n        var cookie = cookies[i];\n        while (cookie.charAt(0) === ' ') {\n            cookie = cookie.substring(1, cookie.length);\n        }\n        if (cookie.indexOf(nameEQ) === 0) {\n            return decodeURIComponent(cookie.substring(nameEQ.length));\n        }\n    }\n    return null;\n}\n// do we need to set the domain?\nfunction setCookie(name, value, options) {\n    if (userAllowsCookie(name)) {\n        if (typeof options === 'undefined') {\n            options = {};\n        }\n        var cookieString = name + '=' + value + '; path=/; SameSite=Strict';\n        if (options.days) {\n            var date = new Date();\n            date.setTime(date.getTime() + (options.days * 24 * 60 * 60 * 1000));\n            cookieString = cookieString + '; expires=' + date.toUTCString();\n        }\n        if (document.location.protocol === 'https:') {\n            cookieString = cookieString + '; Secure';\n        }\n        document.cookie = cookieString;\n    }\n}\nfunction deleteCookie(name) {\n    if (Cookie(name)) {\n        // Cookies need to be deleted in the same level of specificity in which they were set\n        // If a cookie was set with a specified domain, it needs to be specified when deleted\n        // If a cookie wasn't set with the domain attribute, it shouldn't be there when deleted\n        // You can't tell if a cookie was set with a domain attribute or not, so try both options\n        document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/';\n        document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT;domain=' + window.location.hostname + ';path=/';\n        document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT;domain=.' + window.location.hostname + ';path=/';\n    }\n}\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvY29va2llLWZ1bmN0aW9ucy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7O0dBWUc7QUFFSCxPQUFPLFNBQVMsTUFBTSxnQkFBZ0IsQ0FBQTtBQUV0Qyw2REFBNkQ7QUFDN0QsSUFBSSxtQkFBbUIsR0FBRyxrQ0FBa0MsQ0FBQztBQUU3RCxzRUFBc0U7QUFDdEUsOEJBQThCO0FBQzlCLDBHQUEwRztBQUMxRyxpREFBaUQ7QUFDakQsSUFBSSxnQkFBZ0IsR0FBRyxjQUFjLENBQUM7QUFFdEMsdURBQXVEO0FBQ3ZELElBQUksaUJBQWlCLEdBQUc7SUFDcEIsU0FBUyxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQztJQUM3Qzs7Ozs7T0FLRztJQUNILFNBQVMsRUFBRSxDQUFDLGtDQUFrQyxDQUFDO0NBQ2xELENBQUE7QUFFRDs7Ozs7O0dBTUc7QUFDSCxJQUFJLHNCQUFzQixHQUFHO0lBQ3pCLFNBQVMsRUFBRSxLQUFLO0NBQ25CLENBQUE7QUFFRDs7Ozs7Ozs7Ozs7OztHQWFHO0FBQ0gsTUFBTSxVQUFVLE1BQU0sQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLE9BQU87SUFDdkMsSUFBSSxPQUFPLEtBQUssS0FBSyxXQUFXLEVBQUU7UUFDOUIsSUFBSSxLQUFLLEtBQUssS0FBSyxJQUFJLEtBQUssS0FBSyxJQUFJLEVBQUU7WUFDbkMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3RCO2FBQU07WUFDSCxpQ0FBaUM7WUFDakMsSUFBSSxPQUFPLE9BQU8sS0FBSyxXQUFXLEVBQUU7Z0JBQ2hDLE9BQU8sR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsQ0FBQTthQUN6QjtZQUNELFNBQVMsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQ25DO0tBQ0o7U0FBTTtRQUNILE9BQU8sU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQzFCO0FBQ0wsQ0FB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QUcsWUFBWSxHQUFHLFlBQVksR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7U0FDbkU7UUFDRCxJQUFJLFFBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxLQUFLLFFBQVEsRUFBRTtZQUN6QyxZQUFZLEdBQUcsWUFBWSxHQUFHLFVBQVUsQ0FBQztTQUM1QztRQUNELFFBQVEsQ0FBQyxNQUFNLEdBQUcsWUFBWSxDQUFDO0tBQ2xDO0FBQ0wsQ0FBQztBQUVELFNBQVMsWUFBWSxDQUFDLElBQUk7SUFDdEIsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDZCxxRkFBcUY7UUFDckYscUZBQXFGO1FBQ3JGLHVGQUF1RjtRQUN2Rix5RkFBeUY7UUFDekYsUUFBUSxDQUFDLE1BQU0sR0FBRyxJQUFJLEdBQUcsZ0RBQWdELENBQUM7UUFDMUUsUUFBUSxDQUFDLE1BQU0sR0FBRyxJQUFJLEdBQUcsaURBQWlELEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEdBQUcsU0FBUyxDQUFDO1FBQ2xILFFBQVEsQ0FBQyxNQUFNLEdBQUcsSUFBSSxHQUFHLGtEQUFrRCxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsUUFBUSxHQUFHLFNBQVMsQ0FBQztLQUN0SDtBQUNMLENBQUMiLCJmaWxlIjoiY29tcG9uZW50cy9jb29raWUtZnVuY3Rpb25zLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENvb2tpZSBmdW5jdGlvbnNcclxuICogPT09PT09PT09PT09PT09PVxyXG4gKlxyXG4gKiBVc2VkIGJ5IHRoZSBjb29raWUgYmFubmVyIGNvbXBvbmVudCBhbmQgY29va2llcyBwYWdlIHBhdHRlcm4uXHJcbiAqXHJcbiAqIEluY2x1ZGVzIGZ1bmN0aW9uIGBDb29raWUoKWAgZm9yIGdldHRpbmcsIHNldHRpbmcsIGFuZCBkZWxldGluZyBjb29raWVzLCBhbmRcclxuICogZnVuY3Rpb25zIHRvIG1hbmFnZSB0aGUgdXNlcnMnIGNvbnNlbnQgdG8gY29va2llcy5cclxuICpcclxuICogTm90ZTogdGhlcmUgaXMgYW4gaW5saW5lIHNjcmlwdCBpbiBjb29raWUtYmFubmVyLm5qayB0byBzaG93IHRoZSBiYW5uZXJcclxuICogYXMgc29vbiBhcyBwb3NzaWJsZSwgdG8gYXZvaWQgYSBoaWdoIEN1bXVsYXRpdmUgTGF5b3V0IFNoaWZ0IChDTFMpIHNjb3JlLlxyXG4gKiBUaGUgY29uc2VudCBjb29raWUgdmVyc2lvbiBpcyBkZWZpbmVkIGluIGNvb2tpZS1iYW5uZXIubmprXHJcbiAqL1xyXG5cclxuaW1wb3J0IEFuYWx5dGljcyBmcm9tICcuL2FuYWx5dGljcy5qcydcclxuXHJcbi8qIE5hbWUgb2YgdGhlIGNvb2tpZSB0byBzYXZlIHVzZXJzIGNvb2tpZSBwcmVmZXJlbmNlcyB0by4gKi9cclxudmFyIENPTlNFTlRfQ09PS0lFX05BTUUgPSAnc2VydmljZV9kaXJlY3RvcnlfY29va2llc19wb2xpY3knO1xyXG5cclxuLyogR29vZ2xlIEFuYWx5dGljcyB0cmFja2luZyBJRHMgZm9yIHByZXZpZXcgYW5kIGxpdmUgZW52aXJvbm1lbnRzLiAqL1xyXG4vKm1lYXN1cmVtZW50IGlkcyBvciB0YWcgaWRzKi9cclxuLypGYXRheWkgaXMgZ29pbmcgdG8gbGluayB0aGUgZXhpc3RpbmcgZ2EgKHRoaXMgaWQpIGludG8gZ3RtIChhcyBhIHRhZyksIHRoZW4gd2UgY2FuIGNoZWNrIHRoZSBkaXNhYmxpbmcqL1xyXG4vL3ZhciBUUkFDS0lOR19QUkVWSUVXX0lEID0gJ0dBX1RPRE86U1RJQ0tJVEhFUkUnXHJcbnZhciBUUkFDS0lOR19MSVZFX0lEID0gJ0ctMzBHNlpGVEVKRSc7XHJcblxyXG4vKiBVc2VycyBjYW4gKGRpcylhbGxvdyBkaWZmZXJlbnQgZ3JvdXBzIG9mIGNvb2tpZXMuICovXHJcbnZhciBDT09LSUVfQ0FURUdPUklFUyA9IHtcclxuICAgIGFuYWx5dGljczogWydfZ2EnLCAnX2dhXycgKyBUUkFDS0lOR19MSVZFX0lEXSwgLy8gZG8gd2UgYWxzbyBuZWVkICdfZ2lkJyA/XHJcbiAgICAvKiBFc3NlbnRpYWwgY29va2llc1xyXG4gICAgICpcclxuICAgICAqIEVzc2VudGlhbCBjb29raWVzIGNhbm5vdCBiZSBkZXNlbGVjdGVkLCBidXQgd2Ugd2FudCBvdXIgY29va2llIGNvZGUgdG9cclxuICAgICAqIG9ubHkgYWxsb3cgYWRkaW5nIGNvb2tpZXMgdGhhdCBhcmUgZG9jdW1lbnRlZCBpbiB0aGlzIG9iamVjdCwgc28gdGhleSBuZWVkXHJcbiAgICAgKiB0byBiZSBhZGRlZCBoZXJlLlxyXG4gICAgICovXHJcbiAgICBlc3NlbnRpYWw6IFsnc2VydmljZV9kaXJlY3RvcnlfY29va2llc19wb2xpY3knXVxyXG59XHJcblxyXG4vKlxyXG4gKiBEZWZhdWx0IGNvb2tpZSBwcmVmZXJlbmNlcyBpZiB1c2VyIGhhcyBubyBjb29raWUgcHJlZmVyZW5jZXMuXHJcbiAqXHJcbiAqIE5vdGUgdGhhdCB0aGlzIGRvZXNuJ3QgaW5jbHVkZSBhIGtleSBmb3IgZXNzZW50aWFsIGNvb2tpZXMsIGVzc2VudGlhbFxyXG4gKiBjb29raWVzIGNhbm5vdCBiZSBkaXNhbGxvd2VkLiBJZiB0aGUgb2JqZWN0IGNvbnRhaW5zIHsgZXNzZW50aWFsOiBmYWxzZSB9XHJcbiAqIHRoaXMgd2lsbCBiZSBpZ25vcmVkLlxyXG4gKi9cclxudmFyIERFRkFVTFRfQ09PS0lFX0NPTlNFTlQgPSB7XHJcbiAgICBhbmFseXRpY3M6IGZhbHNlXHJcbn1cclxuXHJcbi8qXHJcbiAqIFNldCwgZ2V0LCBhbmQgZGVsZXRlIGNvb2tpZXMuXHJcbiAqXHJcbiAqIFVzYWdlOlxyXG4gKlxyXG4gKiAgIFNldHRpbmcgYSBjb29raWU6XHJcbiAqICAgQ29va2llKCdob2Jub2InLCAndGFzdHknLCB7IGRheXM6IDMwIH0pXHJcbiAqXHJcbiAqICAgUmVhZGluZyBhIGNvb2tpZTpcclxuICogICBDb29raWUoJ2hvYm5vYicpXHJcbiAqXHJcbiAqICAgRGVsZXRpbmcgYSBjb29raWU6XHJcbiAqICAgQ29va2llKCdob2Jub2InLCBudWxsKVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIENvb2tpZShuYW1lLCB2YWx1ZSwgb3B0aW9ucykge1xyXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICBpZiAodmFsdWUgPT09IGZhbHNlIHx8IHZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZUNvb2tpZShuYW1lKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBEZWZhdWx0IGV4cGlyeSBkYXRlIG9mIDMwIGRheXNcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHsgZGF5czogMzAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNldENvb2tpZShuYW1lLCB2YWx1ZSwgb3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZ2V0Q29va2llKG5hbWUpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKiogUmV0dXJuIHRoZSB1c2VyJ3MgY29va2llIHByZWZlcmVuY2VzLlxyXG4gKlxyXG4gKiBJZiB0aGUgY29uc2VudCBjb29raWUgaXMgbWFsZm9ybWVkLCBvciBub3QgcHJlc2VudCxcclxuICogcmV0dXJucyBudWxsLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbnNlbnRDb29raWUoKSB7XHJcbiAgICB2YXIgY29uc2VudENvb2tpZSA9IGdldENvb2tpZShDT05TRU5UX0NPT0tJRV9OQU1FKTtcclxuICAgIHZhciBjb25zZW50Q29va2llT2JqO1xyXG5cclxuICAgIGlmIChjb25zZW50Q29va2llKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc2VudENvb2tpZU9iaiA9IEpTT04ucGFyc2UoY29uc2VudENvb2tpZSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGNvbnNlbnRDb29raWVPYmo7XHJcbn1cclxuXHJcbi8qKiBDaGVjayB0aGUgY29va2llIHByZWZlcmVuY2VzIG9iamVjdC5cclxuICpcclxuICogSWYgdGhlIGNvbnNlbnQgb2JqZWN0IGlzIG5vdCBwcmVzZW50LCBtYWxmb3JtZWQsIG9yIGluY29ycmVjdCB2ZXJzaW9uLFxyXG4gKiByZXR1cm5zIGZhbHNlLCBvdGhlcndpc2UgcmV0dXJucyB0cnVlLlxyXG4gKlxyXG4gKiBUaGlzIGlzIGFsc28gZHVwbGljYXRlZCBpbiBjb29raWUtYmFubmVyLm5qayAtIHRoZSB0d28gbmVlZCB0byBiZSBrZXB0IGluIHN5bmNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkQ29uc2VudENvb2tpZShvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gKG9wdGlvbnMgJiYgb3B0aW9ucy52ZXJzaW9uID49IHdpbmRvdy5HRFNfQ09OU0VOVF9DT09LSUVfVkVSU0lPTik7XHJcbn1cclxuXHJcbi8qKiBVcGRhdGUgdGhlIHVzZXIncyBjb29raWUgcHJlZmVyZW5jZXMuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRDb25zZW50Q29va2llKG9wdGlvbnMpIHtcclxuICAgIHZhciBjb29raWVDb25zZW50ID0gZ2V0Q29uc2VudENvb2tpZSgpO1xyXG5cclxuICAgIGlmICghY29va2llQ29uc2VudCkge1xyXG4gICAgICAgIGNvb2tpZUNvbnNlbnQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KERFRkFVTFRfQ09PS0lFX0NPTlNFTlQpKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBNZXJnZSBjdXJyZW50IGNvb2tpZSBwcmVmZXJlbmNlcyBhbmQgbmV3IHByZWZlcmVuY2VzXHJcbiAgICBmb3IgKHZhciBvcHRpb24gaW4gb3B0aW9ucykge1xyXG4gICAgICAgIGNvb2tpZUNvbnNlbnRbb3B0aW9uXSA9IG9wdGlvbnNbb3B0aW9uXTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFc3NlbnRpYWwgY29va2llcyBjYW5ub3QgYmUgZGVzZWxlY3RlZCwgaWdub3JlIHRoaXMgY29va2llIHR5cGVcclxuICAgIGRlbGV0ZSBjb29raWVDb25zZW50LmVzc2VudGlhbDtcclxuXHJcbiAgICBjb29raWVDb25zZW50LnZlcnNpb24gPSB3aW5kb3cuR0RTX0NPTlNFTlRfQ09PS0lFX1ZFUlNJT047XHJcblxyXG4gICAgLy8gU2V0IHRoZSBjb25zZW50IGNvb2tpZVxyXG4gICAgc2V0Q29va2llKENPTlNFTlRfQ09PS0lFX05BTUUsIEpTT04uc3RyaW5naWZ5KGNvb2tpZUNvbnNlbnQpLCB7IGRheXM6IDM2NSB9KTtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIG90aGVyIGNvb2tpZXNcclxuICAgIHJlc2V0Q29va2llcygpO1xyXG59XHJcblxyXG4vKiogQXBwbHkgdGhlIHVzZXIncyBjb29raWUgcHJlZmVyZW5jZXNcclxuICpcclxuICogRGVsZXRlcyBhbnkgY29va2llcyB0aGUgdXNlciBoYXMgbm90IGNvbnNlbnRlZCB0by5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZXNldENvb2tpZXMoKSB7XHJcbiAgICB2YXIgb3B0aW9ucyA9IGdldENvbnNlbnRDb29raWUoKTtcclxuXHJcbiAgICAvLyBJZiBubyBwcmVmZXJlbmNlcyBvciBvbGQgdmVyc2lvbiB1c2UgdGhlIGRlZmF1bHRcclxuICAgIGlmICghaXNWYWxpZENvbnNlbnRDb29raWUob3B0aW9ucykpIHtcclxuICAgICAgICBvcHRpb25zID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShERUZBVUxUX0NPT0tJRV9DT05TRU5UKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZm9yICh2YXIgY29va2llVHlwZSBpbiBvcHRpb25zKSB7XHJcbiAgICAgICAgaWYgKGNvb2tpZVR5cGUgPT09ICd2ZXJzaW9uJykge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEVzc2VudGlhbCBjb29raWVzIGNhbm5vdCBiZSBkZXNlbGVjdGVkLCBpZ25vcmUgdGhpcyBjb29raWUgdHlwZVxyXG4gICAgICAgIGlmIChjb29raWVUeXBlID09PSAnZXNzZW50aWFsJykge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpc2UgYW5hbHl0aWNzIGlmIGFsbG93ZWRcclxuICAgICAgICBpZiAoY29va2llVHlwZSA9PT0gJ2FuYWx5dGljcycgJiYgb3B0aW9uc1tjb29raWVUeXBlXSkge1xyXG4gICAgICAgICAgICAvLyBFbmFibGUgR0EgaWYgYWxsb3dlZFxyXG4gICAgICAgICAgICB3aW5kb3dbJ2dhLWRpc2FibGUtJyArIFRSQUNLSU5HX0xJVkVfSURdID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBBbmFseXRpY3MoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBEaXNhYmxlIEdBIGlmIG5vdCBhbGxvd2VkXHJcbiAgICAgICAgICAgIHdpbmRvd1snZ2EtZGlzYWJsZS0nICsgVFJBQ0tJTkdfTElWRV9JRF0gPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFvcHRpb25zW2Nvb2tpZVR5cGVdKSB7XHJcbiAgICAgICAgICAgIC8vIEZldGNoIHRoZSBjb29raWVzIGluIHRoYXQgY2F0ZWdvcnlcclxuICAgICAgICAgICAgdmFyIGNvb2tpZXNJbkNhdGVnb3J5ID0gQ09PS0lFX0NBVEVHT1JJRVNbY29va2llVHlwZV1cclxuXHJcbiAgICAgICAgICAgIGNvb2tpZXNJbkNhdGVnb3J5LmZvckVhY2goZnVuY3Rpb24oY29va2llKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBEZWxldGUgY29va2llXHJcbiAgICAgICAgICAgICAgICBDb29raWUoY29va2llLCBudWxsKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiB1c2VyQWxsb3dzQ29va2llQ2F0ZWdvcnkoY29va2llQ2F0ZWdvcnksIGNvb2tpZVByZWZlcmVuY2VzKSB7XHJcbiAgICAvLyBFc3NlbnRpYWwgY29va2llcyBhcmUgYWx3YXlzIGFsbG93ZWRcclxuICAgIGlmIChjb29raWVDYXRlZ29yeSA9PT0gJ2Vzc2VudGlhbCcpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTb21ldGltZXMgY29va2llUHJlZmVyZW5jZXMgaXMgbWFsZm9ybWVkIGluIHNvbWUgb2YgdGhlIHRlc3RzLCBzbyB3ZSBuZWVkIHRvIGhhbmRsZSB0aGVzZVxyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gY29va2llUHJlZmVyZW5jZXNbY29va2llQ2F0ZWdvcnldO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiB1c2VyQWxsb3dzQ29va2llKGNvb2tpZU5hbWUpIHtcclxuICAgIC8vIEFsd2F5cyBhbGxvdyBzZXR0aW5nIHRoZSBjb25zZW50IGNvb2tpZVxyXG4gICAgaWYgKGNvb2tpZU5hbWUgPT09IENPTlNFTlRfQ09PS0lFX05BTUUpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgY29va2llIHByZWZlcmVuY2VzXHJcbiAgICB2YXIgY29va2llUHJlZmVyZW5jZXMgPSBnZXRDb25zZW50Q29va2llKCk7XHJcblxyXG4gICAgLy8gSWYgbm8gcHJlZmVyZW5jZXMgb3Igb2xkIHZlcnNpb24gdXNlIHRoZSBkZWZhdWx0XHJcbiAgICBpZiAoIWlzVmFsaWRDb25zZW50Q29va2llKGNvb2tpZVByZWZlcmVuY2VzKSkge1xyXG4gICAgICAgIGNvb2tpZVByZWZlcmVuY2VzID0gREVGQVVMVF9DT09LSUVfQ09OU0VOVDtcclxuICAgIH1cclxuXHJcbiAgICBmb3IgKHZhciBjYXRlZ29yeSBpbiBDT09LSUVfQ0FURUdPUklFUykge1xyXG4gICAgICAgIHZhciBjb29raWVzSW5DYXRlZ29yeSA9IENPT0tJRV9DQVRFR09SSUVTW2NhdGVnb3J5XTtcclxuXHJcbiAgICAgICAgaWYgKGNvb2tpZXNJbkNhdGVnb3J5LmluZGV4T2YoY29va2llTmFtZSkgIT09ICctMScpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHVzZXJBbGxvd3NDb29raWVDYXRlZ29yeShjYXRlZ29yeSwgY29va2llUHJlZmVyZW5jZXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBEZW55IHRoZSBjb29raWUgaWYgaXQgaXMgbm90IGtub3duIHRvIHVzXHJcbiAgICByZXR1cm4gZmFsc2VcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Q29va2llKG5hbWUpIHtcclxuICAgIHZhciBuYW1lRVEgPSBuYW1lICsgJz0nO1xyXG4gICAgdmFyIGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTtcclxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjb29raWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGNvb2tpZSA9IGNvb2tpZXNbaV07XHJcbiAgICAgICAgd2hpbGUgKGNvb2tpZS5jaGFyQXQoMCkgPT09ICcgJykge1xyXG4gICAgICAgICAgICBjb29raWUgPSBjb29raWUuc3Vic3RyaW5nKDEsIGNvb2tpZS5sZW5ndGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29va2llLmluZGV4T2YobmFtZUVRKSA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGNvb2tpZS5zdWJzdHJpbmcobmFtZUVRLmxlbmd0aCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcblxyXG4vLyBkbyB3ZSBuZWVkIHRvIHNldCB0aGUgZG9tYWluP1xyXG5mdW5jdGlvbiBzZXRDb29raWUobmFtZSwgdmFsdWUsIG9wdGlvbnMpIHtcclxuICAgIGlmICh1c2VyQWxsb3dzQ29va2llKG5hbWUpKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICBvcHRpb25zID0ge31cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGNvb2tpZVN0cmluZyA9IG5hbWUgKyAnPScgKyB2YWx1ZSArICc7IHBhdGg9LzsgU2FtZVNpdGU9U3RyaWN0JztcclxuICAgICAgICBpZiAob3B0aW9ucy5kYXlzKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgZGF0ZS5zZXRUaW1lKGRhdGUuZ2V0VGltZSgpICsgKG9wdGlvbnMuZGF5cyAqIDI0ICogNjAgKiA2MCAqIDEwMDApKTtcclxuICAgICAgICAgICAgY29va2llU3RyaW5nID0gY29va2llU3RyaW5nICsgJzsgZXhwaXJlcz0nICsgZGF0ZS50b1VUQ1N0cmluZygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2wgPT09ICdodHRwczonKSB7XHJcbiAgICAgICAgICAgIGNvb2tpZVN0cmluZyA9IGNvb2tpZVN0cmluZyArICc7IFNlY3VyZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZVN0cmluZztcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZGVsZXRlQ29va2llKG5hbWUpIHtcclxuICAgIGlmIChDb29raWUobmFtZSkpIHtcclxuICAgICAgICAvLyBDb29raWVzIG5lZWQgdG8gYmUgZGVsZXRlZCBpbiB0aGUgc2FtZSBsZXZlbCBvZiBzcGVjaWZpY2l0eSBpbiB3aGljaCB0aGV5IHdlcmUgc2V0XHJcbiAgICAgICAgLy8gSWYgYSBjb29raWUgd2FzIHNldCB3aXRoIGEgc3BlY2lmaWVkIGRvbWFpbiwgaXQgbmVlZHMgdG8gYmUgc3BlY2lmaWVkIHdoZW4gZGVsZXRlZFxyXG4gICAgICAgIC8vIElmIGEgY29va2llIHdhc24ndCBzZXQgd2l0aCB0aGUgZG9tYWluIGF0dHJpYnV0ZSwgaXQgc2hvdWxkbid0IGJlIHRoZXJlIHdoZW4gZGVsZXRlZFxyXG4gICAgICAgIC8vIFlvdSBjYW4ndCB0ZWxsIGlmIGEgY29va2llIHdhcyBzZXQgd2l0aCBhIGRvbWFpbiBhdHRyaWJ1dGUgb3Igbm90LCBzbyB0cnkgYm90aCBvcHRpb25zXHJcbiAgICAgICAgZG9jdW1lbnQuY29va2llID0gbmFtZSArICc9O2V4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBHTVQ7cGF0aD0vJztcclxuICAgICAgICBkb2N1bWVudC5jb29raWUgPSBuYW1lICsgJz07ZXhwaXJlcz1UaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAwIEdNVDtkb21haW49JyArIHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSArICc7cGF0aD0vJztcclxuICAgICAgICBkb2N1bWVudC5jb29raWUgPSBuYW1lICsgJz07ZXhwaXJlcz1UaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAwIEdNVDtkb21haW49LicgKyB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUgKyAnO3BhdGg9Lyc7XHJcbiAgICB9XHJcbn0iXX0=\n","/**\n * This seems to fail in IE8, requires more investigation.\n * See: https://github.com/imagitama/nodelist-foreach-polyfill\n */\nfunction nodeListForEach(nodes, callback) {\n    if (window.NodeList.prototype.forEach) {\n        return nodes.forEach(callback);\n    }\n    for (var i = 0; i < nodes.length; i++) {\n        callback.call(window, nodes[i], i, nodes);\n    }\n}\nexport { nodeListForEach };\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvaGVscGVycy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0dBR0c7QUFDSCxTQUFTLGVBQWUsQ0FBQyxLQUFLLEVBQUUsUUFBUTtJQUNwQyxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRTtRQUNuQyxPQUFPLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUE7S0FDakM7SUFDRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUNuQyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFBO0tBQzVDO0FBQ0wsQ0FBQztBQUVELE9BQU8sRUFDSCxlQUFlLEVBQ2xCLENBQUEiLCJmaWxlIjoiY29tcG9uZW50cy9oZWxwZXJzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFRoaXMgc2VlbXMgdG8gZmFpbCBpbiBJRTgsIHJlcXVpcmVzIG1vcmUgaW52ZXN0aWdhdGlvbi5cclxuICogU2VlOiBodHRwczovL2dpdGh1Yi5jb20vaW1hZ2l0YW1hL25vZGVsaXN0LWZvcmVhY2gtcG9seWZpbGxcclxuICovXHJcbmZ1bmN0aW9uIG5vZGVMaXN0Rm9yRWFjaChub2RlcywgY2FsbGJhY2spIHtcclxuICAgIGlmICh3aW5kb3cuTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2gpIHtcclxuICAgICAgICByZXR1cm4gbm9kZXMuZm9yRWFjaChjYWxsYmFjaylcclxuICAgIH1cclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjYWxsYmFjay5jYWxsKHdpbmRvdywgbm9kZXNbaV0sIGksIG5vZGVzKVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQge1xyXG4gICAgbm9kZUxpc3RGb3JFYWNoXHJcbn0iXX0=\n","import * as CookieFunctions from './cookie-functions.js';\n/*todo: we don't meed a pollyfill for bind, as long as we server up the non js version of the site for ie8 (https://caniuse.com/?search=bind) */\n/*import 'govuk-frontend/govuk/vendor/polyfills/Function/prototype/bind'*/\n/*todo: i think we're ok for this too (see above about ie8), but we _might_ need it for >8 ie (use? https://www.npmjs.com/package/events-polyfill)*/\n/*import 'govuk-frontend/govuk/vendor/polyfills/Event'*/\nimport { nodeListForEach } from './helpers.js';\nvar cookieBannerAcceptSelector = '.js-cookie-banner-accept';\nvar cookieBannerRejectSelector = '.js-cookie-banner-reject';\nvar cookieBannerHideButtonSelector = '.js-cookie-banner-hide';\nvar cookieMessageSelector = '.js-cookie-banner-message';\nvar cookieConfirmationAcceptSelector = '.js-cookie-banner-confirmation-accept';\nvar cookieConfirmationRejectSelector = '.js-cookie-banner-confirmation-reject';\nfunction CookieBanner($module) {\n    this.$module = $module;\n}\nCookieBanner.prototype.init = function () {\n    this.$cookieBanner = this.$module;\n    this.$acceptButton = this.$module.querySelector(cookieBannerAcceptSelector);\n    this.$rejectButton = this.$module.querySelector(cookieBannerRejectSelector);\n    this.$cookieMessage = this.$module.querySelector(cookieMessageSelector);\n    this.$cookieConfirmationAccept = this.$module.querySelector(cookieConfirmationAcceptSelector);\n    this.$cookieConfirmationReject = this.$module.querySelector(cookieConfirmationRejectSelector);\n    this.$cookieBannerHideButtons = this.$module.querySelectorAll(cookieBannerHideButtonSelector);\n    // Exit if no cookie banner module\n    // or if we're on the cookies page to avoid circular journeys\n    if (!this.$cookieBanner || this.onCookiesPage()) {\n        return;\n    }\n    // Show the cookie banner to users who have not consented or have an\n    // outdated consent cookie\n    var currentConsentCookie = CookieFunctions.getConsentCookie();\n    if (!currentConsentCookie || !CookieFunctions.isValidConsentCookie(currentConsentCookie)) {\n        // If the consent cookie version is not valid, we need to remove any cookies which have been\n        // set previously\n        CookieFunctions.resetCookies();\n        this.$cookieBanner.removeAttribute('hidden');\n    }\n    this.$acceptButton.addEventListener('click', this.acceptCookies.bind(this));\n    this.$rejectButton.addEventListener('click', this.rejectCookies.bind(this));\n    nodeListForEach(this.$cookieBannerHideButtons, function ($cookieBannerHideButton) {\n        $cookieBannerHideButton.addEventListener('click', this.hideBanner.bind(this));\n    }.bind(this));\n};\nCookieBanner.prototype.hideBanner = function () {\n    this.$cookieBanner.setAttribute('hidden', true);\n};\nCookieBanner.prototype.acceptCookies = function () {\n    // Do actual cookie consent bit\n    CookieFunctions.setConsentCookie({ analytics: true });\n    // Hide banner and show confirmation message\n    this.$cookieMessage.setAttribute('hidden', true);\n    this.revealConfirmationMessage(this.$cookieConfirmationAccept);\n};\nCookieBanner.prototype.rejectCookies = function () {\n    // Do actual cookie consent bit\n    CookieFunctions.setConsentCookie({ analytics: false });\n    // Hide banner and show confirmation message\n    this.$cookieMessage.setAttribute('hidden', true);\n    this.revealConfirmationMessage(this.$cookieConfirmationReject);\n};\nCookieBanner.prototype.revealConfirmationMessage = function (confirmationMessage) {\n    confirmationMessage.removeAttribute('hidden');\n    // Set tabindex to -1 to make the confirmation banner focusable with JavaScript\n    if (!confirmationMessage.getAttribute('tabindex')) {\n        confirmationMessage.setAttribute('tabindex', '-1');\n        confirmationMessage.addEventListener('blur', function () {\n            confirmationMessage.removeAttribute('tabindex');\n        });\n    }\n    confirmationMessage.focus();\n};\nCookieBanner.prototype.onCookiesPage = function () {\n    return window.location.pathname === '/cookies/';\n};\nexport default CookieBanner;\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvY29va2llLWJhbm5lci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEtBQUssZUFBZSxNQUFNLHVCQUF1QixDQUFBO0FBQ3hELGdKQUFnSjtBQUNoSiwwRUFBMEU7QUFDMUUsb0pBQW9KO0FBQ3BKLHdEQUF3RDtBQUN4RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sY0FBYyxDQUFBO0FBRTlDLElBQUksMEJBQTBCLEdBQUcsMEJBQTBCLENBQUE7QUFDM0QsSUFBSSwwQkFBMEIsR0FBRywwQkFBMEIsQ0FBQTtBQUMzRCxJQUFJLDhCQUE4QixHQUFHLHdCQUF3QixDQUFBO0FBQzdELElBQUkscUJBQXFCLEdBQUcsMkJBQTJCLENBQUE7QUFDdkQsSUFBSSxnQ0FBZ0MsR0FBRyx1Q0FBdUMsQ0FBQTtBQUM5RSxJQUFJLGdDQUFnQyxHQUFHLHVDQUF1QyxDQUFBO0FBRTlFLFNBQVMsWUFBWSxDQUFDLE9BQU87SUFDekIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUE7QUFDMUIsQ0FBQztBQUVELFlBQVksQ0FBQyxTQUFTLENBQUMsSUFBSSxHQUFHO0lBQzFCLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQTtJQUNqQyxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLDBCQUEwQixDQUFDLENBQUE7SUFDM0UsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQywwQkFBMEIsQ0FBQyxDQUFBO0lBQzNFLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMscUJBQXFCLENBQUMsQ0FBQTtJQUN2RSxJQUFJLENBQUMseUJBQXlCLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsZ0NBQWdDLENBQUMsQ0FBQTtJQUM3RixJQUFJLENBQUMseUJBQXlCLEdBQUcsSUFBSSxD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bkQsQ0FBQyxDQUFDLENBQUE7S0FDTDtJQUVELG1CQUFtQixDQUFDLEtBQUssRUFBRSxDQUFBO0FBQy9CLENBQUMsQ0FBQTtBQUVELFlBQVksQ0FBQyxTQUFTLENBQUMsYUFBYSxHQUFHO0lBQ25DLE9BQU8sTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEtBQUssV0FBVyxDQUFBO0FBQ25ELENBQUMsQ0FBQTtBQUVELGVBQWUsWUFBWSxDQUFBIiwiZmlsZSI6ImNvbXBvbmVudHMvY29va2llLWJhbm5lci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIENvb2tpZUZ1bmN0aW9ucyBmcm9tICcuL2Nvb2tpZS1mdW5jdGlvbnMuanMnXHJcbi8qdG9kbzogd2UgZG9uJ3QgbWVlZCBhIHBvbGx5ZmlsbCBmb3IgYmluZCwgYXMgbG9uZyBhcyB3ZSBzZXJ2ZXIgdXAgdGhlIG5vbiBqcyB2ZXJzaW9uIG9mIHRoZSBzaXRlIGZvciBpZTggKGh0dHBzOi8vY2FuaXVzZS5jb20vP3NlYXJjaD1iaW5kKSAqL1xyXG4vKmltcG9ydCAnZ292dWstZnJvbnRlbmQvZ292dWsvdmVuZG9yL3BvbHlmaWxscy9GdW5jdGlvbi9wcm90b3R5cGUvYmluZCcqL1xyXG4vKnRvZG86IGkgdGhpbmsgd2UncmUgb2sgZm9yIHRoaXMgdG9vIChzZWUgYWJvdmUgYWJvdXQgaWU4KSwgYnV0IHdlIF9taWdodF8gbmVlZCBpdCBmb3IgPjggaWUgKHVzZT8gaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvZXZlbnRzLXBvbHlmaWxsKSovXHJcbi8qaW1wb3J0ICdnb3Z1ay1mcm9udGVuZC9nb3Z1ay92ZW5kb3IvcG9seWZpbGxzL0V2ZW50JyovXHJcbmltcG9ydCB7IG5vZGVMaXN0Rm9yRWFjaCB9IGZyb20gJy4vaGVscGVycy5qcydcclxuXHJcbnZhciBjb29raWVCYW5uZXJBY2NlcHRTZWxlY3RvciA9ICcuanMtY29va2llLWJhbm5lci1hY2NlcHQnXHJcbnZhciBjb29raWVCYW5uZXJSZWplY3RTZWxlY3RvciA9ICcuanMtY29va2llLWJhbm5lci1yZWplY3QnXHJcbnZhciBjb29raWVCYW5uZXJIaWRlQnV0dG9uU2VsZWN0b3IgPSAnLmpzLWNvb2tpZS1iYW5uZXItaGlkZSdcclxudmFyIGNvb2tpZU1lc3NhZ2VTZWxlY3RvciA9ICcuanMtY29va2llLWJhbm5lci1tZXNzYWdlJ1xyXG52YXIgY29va2llQ29uZmlybWF0aW9uQWNjZXB0U2VsZWN0b3IgPSAnLmpzLWNvb2tpZS1iYW5uZXItY29uZmlybWF0aW9uLWFjY2VwdCdcclxudmFyIGNvb2tpZUNvbmZpcm1hdGlvblJlamVjdFNlbGVjdG9yID0gJy5qcy1jb29raWUtYmFubmVyLWNvbmZpcm1hdGlvbi1yZWplY3QnXHJcblxyXG5mdW5jdGlvbiBDb29raWVCYW5uZXIoJG1vZHVsZSkge1xyXG4gICAgdGhpcy4kbW9kdWxlID0gJG1vZHVsZVxyXG59XHJcblxyXG5Db29raWVCYW5uZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLiRjb29raWVCYW5uZXIgPSB0aGlzLiRtb2R1bGVcclxuICAgIHRoaXMuJGFjY2VwdEJ1dHRvbiA9IHRoaXMuJG1vZHVsZS5xdWVyeVNlbGVjdG9yKGNvb2tpZUJhbm5lckFjY2VwdFNlbGVjdG9yKVxyXG4gICAgdGhpcy4kcmVqZWN0QnV0dG9uID0gdGhpcy4kbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoY29va2llQmFubmVyUmVqZWN0U2VsZWN0b3IpXHJcbiAgICB0aGlzLiRjb29raWVNZXNzYWdlID0gdGhpcy4kbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoY29va2llTWVzc2FnZVNlbGVjdG9yKVxyXG4gICAgdGhpcy4kY29va2llQ29uZmlybWF0aW9uQWNjZXB0ID0gdGhpcy4kbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoY29va2llQ29uZmlybWF0aW9uQWNjZXB0U2VsZWN0b3IpXHJcbiAgICB0aGlzLiRjb29raWVDb25maXJtYXRpb25SZWplY3QgPSB0aGlzLiRtb2R1bGUucXVlcnlTZWxlY3Rvcihjb29raWVDb25maXJtYXRpb25SZWplY3RTZWxlY3RvcilcclxuICAgIHRoaXMuJGNvb2tpZUJhbm5lckhpZGVCdXR0b25zID0gdGhpcy4kbW9kdWxlLnF1ZXJ5U2VsZWN0b3JBbGwoY29va2llQmFubmVySGlkZUJ1dHRvblNlbGVjdG9yKVxyXG5cclxuICAgIC8vIEV4aXQgaWYgbm8gY29va2llIGJhbm5lciBtb2R1bGVcclxuICAgIC8vIG9yIGlmIHdlJ3JlIG9uIHRoZSBjb29raWVzIHBhZ2UgdG8gYXZvaWQgY2lyY3VsYXIgam91cm5leXNcclxuICAgIGlmICghdGhpcy4kY29va2llQmFubmVyIHx8IHRoaXMub25Db29raWVzUGFnZSgpKSB7XHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2hvdyB0aGUgY29va2llIGJhbm5lciB0byB1c2VycyB3aG8gaGF2ZSBub3QgY29uc2VudGVkIG9yIGhhdmUgYW5cclxuICAgIC8vIG91dGRhdGVkIGNvbnNlbnQgY29va2llXHJcbiAgICB2YXIgY3VycmVudENvbnNlbnRDb29raWUgPSBDb29raWVGdW5jdGlvbnMuZ2V0Q29uc2VudENvb2tpZSgpXHJcblxyXG4gICAgaWYgKCFjdXJyZW50Q29uc2VudENvb2tpZSB8fCAhQ29va2llRnVuY3Rpb25zLmlzVmFsaWRDb25zZW50Q29va2llKGN1cnJlbnRDb25zZW50Q29va2llKSkge1xyXG4gICAgICAgIC8vIElmIHRoZSBjb25zZW50IGNvb2tpZSB2ZXJzaW9uIGlzIG5vdCB2YWxpZCwgd2UgbmVlZCB0byByZW1vdmUgYW55IGNvb2tpZXMgd2hpY2ggaGF2ZSBiZWVuXHJcbiAgICAgICAgLy8gc2V0IHByZXZpb3VzbHlcclxuICAgICAgICBDb29raWVGdW5jdGlvbnMucmVzZXRDb29raWVzKClcclxuXHJcbiAgICAgICAgdGhpcy4kY29va2llQmFubmVyLnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJylcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLiRhY2NlcHRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmFjY2VwdENvb2tpZXMuYmluZCh0aGlzKSlcclxuICAgIHRoaXMuJHJlamVjdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMucmVqZWN0Q29va2llcy5iaW5kKHRoaXMpKVxyXG5cclxuICAgIG5vZGVMaXN0Rm9yRWFjaCh0aGlzLiRjb29raWVCYW5uZXJIaWRlQnV0dG9ucywgZnVuY3Rpb24gKCRjb29raWVCYW5uZXJIaWRlQnV0dG9uKSB7XHJcbiAgICAgICAgJGNvb2tpZUJhbm5lckhpZGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhpZGVCYW5uZXIuYmluZCh0aGlzKSlcclxuICAgIH0uYmluZCh0aGlzKSlcclxufVxyXG5cclxuQ29va2llQmFubmVyLnByb3RvdHlwZS5oaWRlQmFubmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy4kY29va2llQmFubmVyLnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgdHJ1ZSlcclxufVxyXG5cclxuQ29va2llQmFubmVyLnByb3RvdHlwZS5hY2NlcHRDb29raWVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgLy8gRG8gYWN0dWFsIGNvb2tpZSBjb25zZW50IGJpdFxyXG4gICAgQ29va2llRnVuY3Rpb25zLnNldENvbnNlbnRDb29raWUoeyBhbmFseXRpY3M6IHRydWUgfSlcclxuXHJcbiAgICAvLyBIaWRlIGJhbm5lciBhbmQgc2hvdyBjb25maXJtYXRpb24gbWVzc2FnZVxyXG4gICAgdGhpcy4kY29va2llTWVzc2FnZS5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsIHRydWUpXHJcbiAgICB0aGlzLnJldmVhbENvbmZpcm1hdGlvbk1lc3NhZ2UodGhpcy4kY29va2llQ29uZmlybWF0aW9uQWNjZXB0KVxyXG59XHJcblxyXG5Db29raWVCYW5uZXIucHJvdG90eXBlLnJlamVjdENvb2tpZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyBEbyBhY3R1YWwgY29va2llIGNvbnNlbnQgYml0XHJcbiAgICBDb29raWVGdW5jdGlvbnMuc2V0Q29uc2VudENvb2tpZSh7IGFuYWx5dGljczogZmFsc2UgfSlcclxuXHJcbiAgICAvLyBIaWRlIGJhbm5lciBhbmQgc2hvdyBjb25maXJtYXRpb24gbWVzc2FnZVxyXG4gICAgdGhpcy4kY29va2llTWVzc2FnZS5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsIHRydWUpXHJcbiAgICB0aGlzLnJldmVhbENvbmZpcm1hdGlvbk1lc3NhZ2UodGhpcy4kY29va2llQ29uZmlybWF0aW9uUmVqZWN0KVxyXG59XHJcblxyXG5Db29raWVCYW5uZXIucHJvdG90eXBlLnJldmVhbENvbmZpcm1hdGlvbk1lc3NhZ2UgPSBmdW5jdGlvbiAoY29uZmlybWF0aW9uTWVzc2FnZSkge1xyXG4gICAgY29uZmlybWF0aW9uTWVzc2FnZS5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpXHJcblxyXG4gICAgLy8gU2V0IHRhYmluZGV4IHRvIC0xIHRvIG1ha2UgdGhlIGNvbmZpcm1hdGlvbiBiYW5uZXIgZm9jdXNhYmxlIHdpdGggSmF2YVNjcmlwdFxyXG4gICAgaWYgKCFjb25maXJtYXRpb25NZXNzYWdlLmdldEF0dHJpYnV0ZSgndGFiaW5kZXgnKSkge1xyXG4gICAgICAgIGNvbmZpcm1hdGlvbk1lc3NhZ2Uuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpXHJcblxyXG4gICAgICAgIGNvbmZpcm1hdGlvbk1lc3NhZ2UuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uZmlybWF0aW9uTWVzc2FnZS5yZW1vdmVBdHRyaWJ1dGUoJ3RhYmluZGV4JylcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpcm1hdGlvbk1lc3NhZ2UuZm9jdXMoKVxyXG59XHJcblxyXG5Db29raWVCYW5uZXIucHJvdG90eXBlLm9uQ29va2llc1BhZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAnL2Nvb2tpZXMvJ1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDb29raWVCYW5uZXIiXX0=\n","import { getConsentCookie, setConsentCookie } from './cookie-functions.js';\nimport { nodeListForEach } from './helpers.js';\nfunction CookiesPage($module) {\n    this.$module = $module;\n}\nCookiesPage.prototype.init = function () {\n    this.$cookiePage = this.$module;\n    if (!this.$cookiePage) {\n        return;\n    }\n    this.$cookieForm = this.$cookiePage.querySelector('.js-cookies-page-form');\n    this.$cookieFormFieldsets = this.$cookieForm.querySelectorAll('.js-cookies-page-form-fieldset');\n    this.$successNotification = this.$cookiePage.querySelector('.js-cookies-page-success');\n    this.$successLink = this.$cookiePage.querySelector('.js-cookies-page-success-link');\n    nodeListForEach(this.$cookieFormFieldsets, function ($cookieFormFieldset) {\n        this.showUserPreference($cookieFormFieldset, getConsentCookie());\n        /*        $cookieFormFieldset.removeAttribute('hidden')*/\n    }.bind(this));\n    // Show submit button\n    //this.$cookieForm.querySelector('.js-cookies-form-button').removeAttribute('hidden')\n    this.$cookieForm.addEventListener('submit', this.savePreferences.bind(this));\n};\nCookiesPage.prototype.savePreferences = function (event) {\n    // Stop default form submission behaviour\n    event.preventDefault();\n    var preferences = {};\n    nodeListForEach(this.$cookieFormFieldsets, function ($cookieFormFieldset) {\n        var cookieType = this.getCookieType($cookieFormFieldset);\n        var selectedItem = $cookieFormFieldset.querySelector('input[name=' + cookieType + ']:checked').value;\n        preferences[cookieType] = selectedItem === 'true';\n    }.bind(this));\n    // Save preferences to cookie and show success notification\n    setConsentCookie(preferences);\n    // handle the corner case, where the user has selected their preference on the cookie page, whilst the banner is still open as they haven't previously selected their preference\n    //todo: call hideBanner\n    var banner = document.querySelector('[data-module=\"govuk-cookie-banner\"]');\n    banner.setAttribute('hidden', 'true');\n    this.showSuccessNotification();\n};\nCookiesPage.prototype.showUserPreference = function ($cookieFormFieldset, preferences) {\n    var cookieType = this.getCookieType($cookieFormFieldset);\n    var preference = false;\n    if (cookieType && preferences && preferences[cookieType] !== undefined) {\n        preference = preferences[cookieType];\n    }\n    var radioValue = preference ? 'true' : 'false';\n    var radio = $cookieFormFieldset.querySelector('input[name=' + cookieType + '][value=' + radioValue + ']');\n    radio.checked = true;\n};\nCookiesPage.prototype.showSuccessNotification = function () {\n    this.$successNotification.removeAttribute('hidden');\n    // if the user's come to the cookies page through the link in the cookie banner, show a link to take them back to the page they came from\n    var referrer = document.referrer ? new URL(document.referrer).pathname : false;\n    if (referrer && referrer !== document.location.pathname) {\n        this.$successLink.href = referrer;\n        this.$successLink.removeAttribute('hidden');\n    }\n    else {\n        this.$successLink.setAttribute('hidden', 'true');\n    }\n    // Set tabindex to -1 to make the element focusable with JavaScript.\n    // GOV.UK Frontend will remove the tabindex on blur as the component doesn't\n    // need to be focusable after the user has read the text.\n    if (!this.$successNotification.getAttribute('tabindex')) {\n        this.$successNotification.setAttribute('tabindex', '-1');\n    }\n    this.$successNotification.focus();\n    // scroll to the top of the page\n    window.scrollTo(0, 0);\n};\nCookiesPage.prototype.getCookieType = function ($cookieFormFieldset) {\n    return $cookieFormFieldset.id;\n};\nexport default CookiesPage;\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvY29va2llcy1wYWdlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHVCQUF1QixDQUFBO0FBQzFFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxjQUFjLENBQUE7QUFFOUMsU0FBUyxXQUFXLENBQUMsT0FBTztJQUN4QixJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQTtBQUMxQixDQUFDO0FBRUQsV0FBVyxDQUFDLFNBQVMsQ0FBQyxJQUFJLEdBQUc7SUFDekIsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFBO0lBRS9CLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFO1FBQ25CLE9BQU07S0FDVDtJQUVELElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsdUJBQXVCLENBQUMsQ0FBQTtJQUMxRSxJQUFJLENBQUMsb0JBQW9CLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFBO0lBQy9GLElBQUksQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQywwQkFBMEIsQ0FBQyxDQUFBO0lBQ3RGLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsK0JBQStCLENBQUMsQ0FBQTtJQUVuRixlQUFlLENBQUMsSUFBSSxDQUFDLG9CQUFvQixFQUFFLFVBQVUsbUJBQW1CO1FBQ3BFLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxtQkFBbUIsRUFBRSxnQkFBZ0IsRUFBRSxDQUFDLENBQUE7UUFDeEUseURBQXlEO0lBQ3JELENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQTtJQUViLHFCQUFxQjtJQUNyQixxRkFBcUY7SUFFckYsSUFBSSxDQUFDLFdBQVcsQ0FBQyxn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QVksQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUE7S0FDM0Q7SUFFRCxJQUFJLENBQUMsb0JBQW9CLENBQUMsS0FBSyxFQUFFLENBQUE7SUFFakMsZ0NBQWdDO0lBQ2hDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFBO0FBQ3pCLENBQUMsQ0FBQTtBQUVELFdBQVcsQ0FBQyxTQUFTLENBQUMsYUFBYSxHQUFHLFVBQVUsbUJBQW1CO0lBQy9ELE9BQU8sbUJBQW1CLENBQUMsRUFBRSxDQUFBO0FBQ2pDLENBQUMsQ0FBQTtBQUVELGVBQWUsV0FBVyxDQUFBIiwiZmlsZSI6ImNvbXBvbmVudHMvY29va2llcy1wYWdlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0Q29uc2VudENvb2tpZSwgc2V0Q29uc2VudENvb2tpZSB9IGZyb20gJy4vY29va2llLWZ1bmN0aW9ucy5qcydcclxuaW1wb3J0IHsgbm9kZUxpc3RGb3JFYWNoIH0gZnJvbSAnLi9oZWxwZXJzLmpzJ1xyXG5cclxuZnVuY3Rpb24gQ29va2llc1BhZ2UoJG1vZHVsZSkge1xyXG4gICAgdGhpcy4kbW9kdWxlID0gJG1vZHVsZVxyXG59XHJcblxyXG5Db29raWVzUGFnZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuJGNvb2tpZVBhZ2UgPSB0aGlzLiRtb2R1bGVcclxuXHJcbiAgICBpZiAoIXRoaXMuJGNvb2tpZVBhZ2UpIHtcclxuICAgICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLiRjb29raWVGb3JtID0gdGhpcy4kY29va2llUGFnZS5xdWVyeVNlbGVjdG9yKCcuanMtY29va2llcy1wYWdlLWZvcm0nKVxyXG4gICAgdGhpcy4kY29va2llRm9ybUZpZWxkc2V0cyA9IHRoaXMuJGNvb2tpZUZvcm0ucXVlcnlTZWxlY3RvckFsbCgnLmpzLWNvb2tpZXMtcGFnZS1mb3JtLWZpZWxkc2V0JylcclxuICAgIHRoaXMuJHN1Y2Nlc3NOb3RpZmljYXRpb24gPSB0aGlzLiRjb29raWVQYWdlLnF1ZXJ5U2VsZWN0b3IoJy5qcy1jb29raWVzLXBhZ2Utc3VjY2VzcycpXHJcbiAgICB0aGlzLiRzdWNjZXNzTGluayA9IHRoaXMuJGNvb2tpZVBhZ2UucXVlcnlTZWxlY3RvcignLmpzLWNvb2tpZXMtcGFnZS1zdWNjZXNzLWxpbmsnKVxyXG5cclxuICAgIG5vZGVMaXN0Rm9yRWFjaCh0aGlzLiRjb29raWVGb3JtRmllbGRzZXRzLCBmdW5jdGlvbiAoJGNvb2tpZUZvcm1GaWVsZHNldCkge1xyXG4gICAgICAgIHRoaXMuc2hvd1VzZXJQcmVmZXJlbmNlKCRjb29raWVGb3JtRmllbGRzZXQsIGdldENvbnNlbnRDb29raWUoKSlcclxuLyogICAgICAgICRjb29raWVGb3JtRmllbGRzZXQucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKSovXHJcbiAgICB9LmJpbmQodGhpcykpXHJcblxyXG4gICAgLy8gU2hvdyBzdWJtaXQgYnV0dG9uXHJcbiAgICAvL3RoaXMuJGNvb2tpZUZvcm0ucXVlcnlTZWxlY3RvcignLmpzLWNvb2tpZXMtZm9ybS1idXR0b24nKS5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpXHJcblxyXG4gICAgdGhpcy4kY29va2llRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnNhdmVQcmVmZXJlbmNlcy5iaW5kKHRoaXMpKVxyXG59XHJcblxyXG5Db29raWVzUGFnZS5wcm90b3R5cGUuc2F2ZVByZWZlcmVuY2VzID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAvLyBTdG9wIGRlZmF1bHQgZm9ybSBzdWJtaXNzaW9uIGJlaGF2aW91clxyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG5cclxuICAgIHZhciBwcmVmZXJlbmNlcyA9IHt9XHJcblxyXG4gICAgbm9kZUxpc3RGb3JFYWNoKHRoaXMuJGNvb2tpZUZvcm1GaWVsZHNldHMsIGZ1bmN0aW9uICgkY29va2llRm9ybUZpZWxkc2V0KSB7XHJcbiAgICAgICAgdmFyIGNvb2tpZVR5cGUgPSB0aGlzLmdldENvb2tpZVR5cGUoJGNvb2tpZUZvcm1GaWVsZHNldClcclxuICAgICAgICB2YXIgc2VsZWN0ZWRJdGVtID0gJGNvb2tpZUZvcm1GaWVsZHNldC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPScgKyBjb29raWVUeXBlICsgJ106Y2hlY2tlZCcpLnZhbHVlXHJcblxyXG4gICAgICAgIHByZWZlcmVuY2VzW2Nvb2tpZVR5cGVdID0gc2VsZWN0ZWRJdGVtID09PSAndHJ1ZSdcclxuICAgIH0uYmluZCh0aGlzKSlcclxuXHJcbiAgICAvLyBTYXZlIHByZWZlcmVuY2VzIHRvIGNvb2tpZSBhbmQgc2hvdyBzdWNjZXNzIG5vdGlmaWNhdGlvblxyXG4gICAgc2V0Q29uc2VudENvb2tpZShwcmVmZXJlbmNlcyk7XHJcblxyXG4gICAgLy8gaGFuZGxlIHRoZSBjb3JuZXIgY2FzZSwgd2hlcmUgdGhlIHVzZXIgaGFzIHNlbGVjdGVkIHRoZWlyIHByZWZlcmVuY2Ugb24gdGhlIGNvb2tpZSBwYWdlLCB3aGlsc3QgdGhlIGJhbm5lciBpcyBzdGlsbCBvcGVuIGFzIHRoZXkgaGF2ZW4ndCBwcmV2aW91c2x5IHNlbGVjdGVkIHRoZWlyIHByZWZlcmVuY2VcclxuICAgIC8vdG9kbzogY2FsbCBoaWRlQmFubmVyXHJcbiAgICB2YXIgYmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbW9kdWxlPVwiZ292dWstY29va2llLWJhbm5lclwiXScpO1xyXG4gICAgYmFubmVyLnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgJ3RydWUnKTtcclxuICAgIFxyXG4gICAgdGhpcy5zaG93U3VjY2Vzc05vdGlmaWNhdGlvbigpXHJcbn1cclxuXHJcbkNvb2tpZXNQYWdlLnByb3RvdHlwZS5zaG93VXNlclByZWZlcmVuY2UgPSBmdW5jdGlvbiAoJGNvb2tpZUZvcm1GaWVsZHNldCwgcHJlZmVyZW5jZXMpIHtcclxuICAgIHZhciBjb29raWVUeXBlID0gdGhpcy5nZXRDb29raWVUeXBlKCRjb29raWVGb3JtRmllbGRzZXQpXHJcbiAgICB2YXIgcHJlZmVyZW5jZSA9IGZhbHNlXHJcblxyXG4gICAgaWYgKGNvb2tpZVR5cGUgJiYgcHJlZmVyZW5jZXMgJiYgcHJlZmVyZW5jZXNbY29va2llVHlwZV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHByZWZlcmVuY2UgPSBwcmVmZXJlbmNlc1tjb29raWVUeXBlXVxyXG4gICAgfVxyXG5cclxuICAgIHZhciByYWRpb1ZhbHVlID0gcHJlZmVyZW5jZSA/ICd0cnVlJyA6ICdmYWxzZSdcclxuICAgIHZhciByYWRpbyA9ICRjb29raWVGb3JtRmllbGRzZXQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0nICsgY29va2llVHlwZSArICddW3ZhbHVlPScgKyByYWRpb1ZhbHVlICsgJ10nKVxyXG4gICAgcmFkaW8uY2hlY2tlZCA9IHRydWVcclxufVxyXG5cclxuQ29va2llc1BhZ2UucHJvdG90eXBlLnNob3dTdWNjZXNzTm90aWZpY2F0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy4kc3VjY2Vzc05vdGlmaWNhdGlvbi5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpXHJcblxyXG4gICAgLy8gaWYgdGhlIHVzZXIncyBjb21lIHRvIHRoZSBjb29raWVzIHBhZ2UgdGhyb3VnaCB0aGUgbGluayBpbiB0aGUgY29va2llIGJhbm5lciwgc2hvdyBhIGxpbmsgdG8gdGFrZSB0aGVtIGJhY2sgdG8gdGhlIHBhZ2UgdGhleSBjYW1lIGZyb21cclxuICAgIHZhciByZWZlcnJlciA9IGRvY3VtZW50LnJlZmVycmVyID8gbmV3IFVSTChkb2N1bWVudC5yZWZlcnJlcikucGF0aG5hbWUgOiBmYWxzZTtcclxuICAgIGlmIChyZWZlcnJlciAmJiByZWZlcnJlciAhPT0gZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWUpIHtcclxuICAgICAgICB0aGlzLiRzdWNjZXNzTGluay5ocmVmID0gcmVmZXJyZXI7XHJcbiAgICAgICAgdGhpcy4kc3VjY2Vzc0xpbmsucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLiRzdWNjZXNzTGluay5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICd0cnVlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2V0IHRhYmluZGV4IHRvIC0xIHRvIG1ha2UgdGhlIGVsZW1lbnQgZm9jdXNhYmxlIHdpdGggSmF2YVNjcmlwdC5cclxuICAgIC8vIEdPVi5VSyBGcm9udGVuZCB3aWxsIHJlbW92ZSB0aGUgdGFiaW5kZXggb24gYmx1ciBhcyB0aGUgY29tcG9uZW50IGRvZXNuJ3RcclxuICAgIC8vIG5lZWQgdG8gYmUgZm9jdXNhYmxlIGFmdGVyIHRoZSB1c2VyIGhhcyByZWFkIHRoZSB0ZXh0LlxyXG4gICAgaWYgKCF0aGlzLiRzdWNjZXNzTm90aWZpY2F0aW9uLmdldEF0dHJpYnV0ZSgndGFiaW5kZXgnKSkge1xyXG4gICAgICAgIHRoaXMuJHN1Y2Nlc3NOb3RpZmljYXRpb24uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy4kc3VjY2Vzc05vdGlmaWNhdGlvbi5mb2N1cygpXHJcblxyXG4gICAgLy8gc2Nyb2xsIHRvIHRoZSB0b3Agb2YgdGhlIHBhZ2VcclxuICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKVxyXG59XHJcblxyXG5Db29raWVzUGFnZS5wcm90b3R5cGUuZ2V0Q29va2llVHlwZSA9IGZ1bmN0aW9uICgkY29va2llRm9ybUZpZWxkc2V0KSB7XHJcbiAgICByZXR1cm4gJGNvb2tpZUZvcm1GaWVsZHNldC5pZFxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDb29raWVzUGFnZSJdfQ==\n","(function (global, factory) {\r\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\r\n\ttypeof define === 'function' && define.amd ? define('GOVUKFrontend', ['exports'], factory) :\r\n\t(factory((global.GOVUKFrontend = {})));\r\n}(this, (function (exports) { 'use strict';\r\n\r\n/**\r\n * Common helpers which do not require polyfill.\r\n *\r\n * IMPORTANT: If a helper require a polyfill, please isolate it in its own module\r\n * so that the polyfill can be properly tree-shaken and does not burden\r\n * the components that do not need that helper\r\n *\r\n * @module common/index\r\n */\r\n\r\n/**\r\n * TODO: Ideally this would be a NodeList.prototype.forEach polyfill\r\n * This seems to fail in IE8, requires more investigation.\r\n * See: https://github.com/imagitama/nodelist-foreach-polyfill\r\n *\r\n * @param {NodeListOf<Element>} nodes - NodeList from querySelectorAll()\r\n * @param {nodeListIterator} callback - Callback function to run for each node\r\n * @returns {undefined}\r\n */\r\nfunction nodeListForEach (nodes, callback) {\r\n  if (window.NodeList.prototype.forEach) {\r\n    return nodes.forEach(callback)\r\n  }\r\n  for (var i = 0; i < nodes.length; i++) {\r\n    callback.call(window, nodes[i], i, nodes);\r\n  }\r\n}\r\n\r\n/**\r\n * Used to generate a unique string, allows multiple instances of the component\r\n * without them conflicting with each other.\r\n * https://stackoverflow.com/a/8809472\r\n *\r\n * @returns {string} Unique ID\r\n */\r\nfunction generateUniqueID () {\r\n  var d = new Date().getTime();\r\n  if (typeof window.performance !== 'undefined' && typeof window.performance.now === 'function') {\r\n    d += window.performance.now(); // use high-precision timer if available\r\n  }\r\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n    var r = (d + Math.random() * 16) % 16 | 0;\r\n    d = Math.floor(d / 16);\r\n    return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16)\r\n  })\r\n}\r\n\r\n/**\r\n * Config flattening function\r\n *\r\n * Takes any number of objects, flattens them into namespaced key-value pairs,\r\n * (e.g. {'i18n.showSection': 'Show section'}) and combines them together, with\r\n * greatest priority on the LAST item passed in.\r\n *\r\n * @returns {object} A flattened object of key-value pairs.\r\n */\r\nfunction mergeConfigs (/* configObject1, configObject2, ...configObjects */) {\r\n  /**\r\n   * Function to take nested objects and flatten them to a dot-separated keyed\r\n   * object. Doing this means we don't need to do any deep/recursive merging of\r\n   * each of our objects, nor transform our dataset from a flat list into a\r\n   * nested object.\r\n   *\r\n   * @param {object} configObject - Deeply nested object\r\n   * @returns {object} Flattened object with dot-separated keys\r\n   */\r\n  var flattenObject = function (configObject) {\r\n    // Prepare an empty return object\r\n    var flattenedObject = {};\r\n\r\n    // Our flattening function, this is called recursively for each level of\r\n    // depth in the object. At each level we prepend the previous level names to\r\n    // the key using `prefix`.\r\n    var flattenLoop = function (obj, prefix) {\r\n      // Loop through keys...\r\n      for (var key in obj) {\r\n        // Check to see if this is a prototypical key/value,\r\n        // if it is, skip it.\r\n        if (!Object.prototype.hasOwnProperty.call(obj, key)) {\r\n          continue\r\n        }\r\n        var value = obj[key];\r\n        var prefixedKey = prefix ? prefix + '.' + key : key;\r\n        if (typeof value === 'object') {\r\n          // If the value is a nested object, recurse over that too\r\n          flattenLoop(value, prefixedKey);\r\n        } else {\r\n          // Otherwise, add this value to our return object\r\n          flattenedObject[prefixedKey] = value;\r\n        }\r\n      }\r\n    };\r\n\r\n    // Kick off the recursive loop\r\n    flattenLoop(configObject);\r\n    return flattenedObject\r\n  };\r\n\r\n  // Start with an empty object as our base\r\n  var formattedConfigObject = {};\r\n\r\n  // Loop through each of the remaining passed objects and push their keys\r\n  // one-by-one into configObject. Any duplicate keys will override the existing\r\n  // key with the new value.\r\n  for (var i = 0; i < arguments.length; i++) {\r\n    var obj = flattenObject(arguments[i]);\r\n    for (var key in obj) {\r\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n        formattedConfigObject[key] = obj[key];\r\n      }\r\n    }\r\n  }\r\n\r\n  return formattedConfigObject\r\n}\r\n\r\n/**\r\n * Extracts keys starting with a particular namespace from a flattened config\r\n * object, removing the namespace in the process.\r\n *\r\n * @param {object} configObject - The object to extract key-value pairs from.\r\n * @param {string} namespace - The namespace to filter keys with.\r\n * @returns {object} Flattened object with dot-separated key namespace removed\r\n */\r\nfunction extractConfigByNamespace (configObject, namespace) {\r\n  // Check we have what we need\r\n  if (!configObject || typeof configObject !== 'object') {\r\n    throw new Error('Provide a `configObject` of type \"object\".')\r\n  }\r\n  if (!namespace || typeof namespace !== 'string') {\r\n    throw new Error('Provide a `namespace` of type \"string\" to filter the `configObject` by.')\r\n  }\r\n  var newObject = {};\r\n  for (var key in configObject) {\r\n    // Split the key into parts, using . as our namespace separator\r\n    var keyParts = key.split('.');\r\n    // Check if the first namespace matches the configured namespace\r\n    if (Object.prototype.hasOwnProperty.call(configObject, key) && keyParts[0] === namespace) {\r\n      // Remove the first item (the namespace) from the parts array,\r\n      // but only if there is more than one part (we don't want blank keys!)\r\n      if (keyParts.length > 1) {\r\n        keyParts.shift();\r\n      }\r\n      // Join the remaining parts back together\r\n      var newKey = keyParts.join('.');\r\n      // Add them to our new object\r\n      newObject[newKey] = configObject[key];\r\n    }\r\n  }\r\n  return newObject\r\n}\r\n\r\n/**\r\n * @callback nodeListIterator\r\n * @param {Element} value - The current node being iterated on\r\n * @param {number} index - The current index in the iteration\r\n * @param {NodeListOf<Element>} nodes - NodeList from querySelectorAll()\r\n * @returns {undefined}\r\n */\r\n\r\n/**\r\n * Internal support for selecting messages to render, with placeholder\r\n * interpolation and locale-aware number formatting and pluralisation\r\n *\r\n * @class\r\n * @private\r\n * @param {TranslationsFlattened} translations - Key-value pairs of the translation strings to use.\r\n * @param {object} [config] - Configuration options for the function.\r\n * @param {string} config.locale - An overriding locale for the PluralRules functionality.\r\n */\r\nfunction I18n (translations, config) {\r\n  // Make list of translations available throughout function\r\n  this.translations = translations || {};\r\n\r\n  // The locale to use for PluralRules and NumberFormat\r\n  this.locale = (config && config.locale) || document.documentElement.lang || 'en';\r\n}\r\n\r\n/**\r\n * The most used function - takes the key for a given piece of UI text and\r\n * returns the appropriate string.\r\n *\r\n * @param {string} lookupKey - The lookup key of the string to use.\r\n * @param {object} options - Any options passed with the translation string, e.g: for string interpolation.\r\n * @returns {string} The appropriate translation string.\r\n */\r\nI18n.prototype.t = function (lookupKey, options) {\r\n  if (!lookupKey) {\r\n    // Print a console error if no lookup key has been provided\r\n    throw new Error('i18n: lookup key missing')\r\n  }\r\n\r\n  // If the `count` option is set, determine which plural suffix is needed and\r\n  // change the lookupKey to match. We check to see if it's undefined instead of\r\n  // falsy, as this could legitimately be 0.\r\n  if (options && typeof options.count !== 'undefined') {\r\n    // Get the plural suffix\r\n    lookupKey = lookupKey + '.' + this.getPluralSuffix(lookupKey, options.count);\r\n  }\r\n\r\n  if (lookupKey in this.translations) {\r\n    // Fetch the translation string for that lookup key\r\n    var translationString = this.translations[lookupKey];\r\n\r\n    // Check for ${} placeholders in the translation string\r\n    if (translationString.match(/%{(.\\S+)}/)) {\r\n      if (!options) {\r\n        throw new Error('i18n: cannot replace placeholders in string if no option data provided')\r\n      }\r\n\r\n      return this.replacePlaceholders(translationString, options)\r\n    } else {\r\n      return translationString\r\n    }\r\n  } else {\r\n    // If the key wasn't found in our translations object,\r\n    // return the lookup key itself as the fallback\r\n    return lookupKey\r\n  }\r\n};\r\n\r\n/**\r\n * Takes a translation string with placeholders, and replaces the placeholders\r\n * with the provided data\r\n *\r\n * @param {string} translationString - The translation string\r\n * @param {object} options - Any options passed with the translation string, e.g: for string interpolation.\r\n * @returns {string} The translation string to output, with ${} placeholders replaced\r\n */\r\nI18n.prototype.replacePlaceholders = function (translationString, options) {\r\n  var formatter;\r\n\r\n  if (this.hasIntlNumberFormatSupport()) {\r\n    formatter = new Intl.NumberFormat(this.locale);\r\n  }\r\n\r\n  return translationString.replace(/%{(.\\S+)}/g, function (placeholderWithBraces, placeholderKey) {\r\n    if (Object.prototype.hasOwnProperty.call(options, placeholderKey)) {\r\n      var placeholderValue = options[placeholderKey];\r\n\r\n      // If a user has passed `false` as the value for the placeholder\r\n      // treat it as though the value should not be displayed\r\n      if (placeholderValue === false) {\r\n        return ''\r\n      }\r\n\r\n      // If the placeholder's value is a number, localise the number formatting\r\n      if (typeof placeholderValue === 'number' && formatter) {\r\n        return formatter.format(placeholderValue)\r\n      }\r\n\r\n      return placeholderValue\r\n    } else {\r\n      throw new Error('i18n: no data found to replace ' + placeholderWithBraces + ' placeholder in string')\r\n    }\r\n  })\r\n};\r\n\r\n/**\r\n * Check to see if the browser supports Intl and Intl.PluralRules.\r\n *\r\n * It requires all conditions to be met in order to be supported:\r\n * - The browser supports the Intl class (true in IE11)\r\n * - The implementation of Intl supports PluralRules (NOT true in IE11)\r\n * - The browser/OS has plural rules for the current locale (browser dependent)\r\n *\r\n * @returns {boolean} Returns true if all conditions are met. Returns false otherwise.\r\n */\r\nI18n.prototype.hasIntlPluralRulesSupport = function () {\r\n  return Boolean(window.Intl && ('PluralRules' in window.Intl && Intl.PluralRules.supportedLocalesOf(this.locale).length))\r\n};\r\n\r\n/**\r\n * Check to see if the browser supports Intl and Intl.NumberFormat.\r\n *\r\n * It requires all conditions to be met in order to be supported:\r\n * - The browser supports the Intl class (true in IE11)\r\n * - The implementation of Intl supports NumberFormat (also true in IE11)\r\n * - The browser/OS has number formatting rules for the current locale (browser dependent)\r\n *\r\n * @returns {boolean} Returns true if all conditions are met. Returns false otherwise.\r\n */\r\nI18n.prototype.hasIntlNumberFormatSupport = function () {\r\n  return Boolean(window.Intl && ('NumberFormat' in window.Intl && Intl.NumberFormat.supportedLocalesOf(this.locale).length))\r\n};\r\n\r\n/**\r\n * Get the appropriate suffix for the plural form.\r\n *\r\n * Uses Intl.PluralRules (or our own fallback implementation) to get the\r\n * 'preferred' form to use for the given count.\r\n *\r\n * Checks that a translation has been provided for that plural form  if it\r\n * hasn't, it'll fall back to the 'other' plural form (unless that doesn't exist\r\n * either, in which case an error will be thrown)\r\n *\r\n * @param {string} lookupKey - The lookup key of the string to use.\r\n * @param {number} count - Number used to determine which pluralisation to use.\r\n * @returns {PluralRule} The suffix associated with the correct pluralisation for this locale.\r\n */\r\nI18n.prototype.getPluralSuffix = function (lookupKey, count) {\r\n  // Validate that the number is actually a number.\r\n  //\r\n  // Number(count) will turn anything that can't be converted to a Number type\r\n  // into 'NaN'. isFinite filters out NaN, as it isn't a finite number.\r\n  count = Number(count);\r\n  if (!isFinite(count)) { return 'other' }\r\n\r\n  var preferredForm;\r\n\r\n  // Check to verify that all the requirements for Intl.PluralRules are met.\r\n  // If so, we can use that instead of our custom implementation. Otherwise,\r\n  // use the hardcoded fallback.\r\n  if (this.hasIntlPluralRulesSupport()) {\r\n    preferredForm = new Intl.PluralRules(this.locale).select(count);\r\n  } else {\r\n    preferredForm = this.selectPluralFormUsingFallbackRules(count);\r\n  }\r\n\r\n  // Use the correct plural form if provided\r\n  if (lookupKey + '.' + preferredForm in this.translations) {\r\n    return preferredForm\r\n  // Fall back to `other` if the plural form is missing, but log a warning\r\n  // to the console\r\n  } else if (lookupKey + '.other' in this.translations) {\r\n    if (console && 'warn' in console) {\r\n      console.warn('i18n: Missing plural form \".' + preferredForm + '\" for \"' +\r\n        this.locale + '\" locale. Falling back to \".other\".');\r\n    }\r\n\r\n    return 'other'\r\n  // If the required `other` plural form is missing, all we can do is error\r\n  } else {\r\n    throw new Error(\r\n      'i18n: Plural form \".other\" is required for \"' + this.locale + '\" locale'\r\n    )\r\n  }\r\n};\r\n\r\n/**\r\n * Get the plural form using our fallback implementation\r\n *\r\n * This is split out into a separate function to make it easier to test the\r\n * fallback behaviour in an environment where Intl.PluralRules exists.\r\n *\r\n * @param {number} count - Number used to determine which pluralisation to use.\r\n * @returns {PluralRule} The pluralisation form for count in this locale.\r\n */\r\nI18n.prototype.selectPluralFormUsingFallbackRules = function (count) {\r\n  // Currently our custom code can only handle positive integers, so let's\r\n  // make sure our number is one of those.\r\n  count = Math.abs(Math.floor(count));\r\n\r\n  var ruleset = this.getPluralRulesForLocale();\r\n\r\n  if (ruleset) {\r\n    return I18n.pluralRules[ruleset](count)\r\n  }\r\n\r\n  return 'other'\r\n};\r\n\r\n/**\r\n * Work out which pluralisation rules to use for the current locale\r\n *\r\n * The locale may include a regional indicator (such as en-GB), but we don't\r\n * usually care about this part, as pluralisation rules are usually the same\r\n * regardless of region. There are exceptions, however, (e.g. Portuguese) so\r\n * this searches by both the full and shortened locale codes, just to be sure.\r\n *\r\n * @returns {PluralRuleName | undefined} The name of the pluralisation rule to use (a key for one\r\n *   of the functions in this.pluralRules)\r\n */\r\nI18n.prototype.getPluralRulesForLocale = function () {\r\n  var locale = this.locale;\r\n  var localeShort = locale.split('-')[0];\r\n\r\n  // Look through the plural rules map to find which `pluralRule` is\r\n  // appropriate for our current `locale`.\r\n  for (var pluralRule in I18n.pluralRulesMap) {\r\n    if (Object.prototype.hasOwnProperty.call(I18n.pluralRulesMap, pluralRule)) {\r\n      var languages = I18n.pluralRulesMap[pluralRule];\r\n      for (var i = 0; i < languages.length; i++) {\r\n        if (languages[i] === locale || languages[i] === localeShort) {\r\n          return pluralRule\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Map of plural rules to languages where those rules apply.\r\n *\r\n * Note: These groups are named for the most dominant or recognisable language\r\n * that uses each system. The groupings do not imply that the languages are\r\n * related to one another. Many languages have evolved the same systems\r\n * independently of one another.\r\n *\r\n * Code to support more languages can be found in the i18n spike:\r\n * {@link https://github.com/alphagov/govuk-frontend/blob/spike-i18n-support/src/govuk/i18n.mjs}\r\n *\r\n * Languages currently supported:\r\n *\r\n * Arabic: Arabic (ar)\r\n * Chinese: Burmese (my), Chinese (zh), Indonesian (id), Japanese (ja),\r\n *   Javanese (jv), Korean (ko), Malay (ms), Thai (th), Vietnamese (vi)\r\n * French: Armenian (hy), Bangla (bn), French (fr), Gujarati (gu), Hindi (hi),\r\n *   Persian Farsi (fa), Punjabi (pa), Zulu (zu)\r\n * German: Afrikaans (af), Albanian (sq), Azerbaijani (az), Basque (eu),\r\n *   Bulgarian (bg), Catalan (ca), Danish (da), Dutch (nl), English (en),\r\n *   Estonian (et), Finnish (fi), Georgian (ka), German (de), Greek (el),\r\n *   Hungarian (hu), Luxembourgish (lb), Norwegian (no), Somali (so),\r\n *   Swahili (sw), Swedish (sv), Tamil (ta), Telugu (te), Turkish (tr),\r\n *   Urdu (ur)\r\n * Irish: Irish Gaelic (ga)\r\n * Russian: Russian (ru), Ukrainian (uk)\r\n * Scottish: Scottish Gaelic (gd)\r\n * Spanish: European Portuguese (pt-PT), Italian (it), Spanish (es)\r\n * Welsh: Welsh (cy)\r\n *\r\n * @type {Object<PluralRuleName, string[]>}\r\n */\r\nI18n.pluralRulesMap = {\r\n  arabic: ['ar'],\r\n  chinese: ['my', 'zh', 'id', 'ja', 'jv', 'ko', 'ms', 'th', 'vi'],\r\n  french: ['hy', 'bn', 'fr', 'gu', 'hi', 'fa', 'pa', 'zu'],\r\n  german: [\r\n    'af', 'sq', 'az', 'eu', 'bg', 'ca', 'da', 'nl', 'en', 'et', 'fi', 'ka',\r\n    'de', 'el', 'hu', 'lb', 'no', 'so', 'sw', 'sv', 'ta', 'te', 'tr', 'ur'\r\n  ],\r\n  irish: ['ga'],\r\n  russian: ['ru', 'uk'],\r\n  scottish: ['gd'],\r\n  spanish: ['pt-PT', 'it', 'es'],\r\n  welsh: ['cy']\r\n};\r\n\r\n/**\r\n * Different pluralisation rule sets\r\n *\r\n * Returns the appropriate suffix for the plural form associated with `n`.\r\n * Possible suffixes: 'zero', 'one', 'two', 'few', 'many', 'other' (the actual\r\n * meaning of each differs per locale). 'other' should always exist, even in\r\n * languages without plurals, such as Chinese.\r\n * {@link https://cldr.unicode.org/index/cldr-spec/plural-rules}\r\n *\r\n * The count must be a positive integer. Negative numbers and decimals aren't accounted for\r\n *\r\n * @type {Object<string, function(number): PluralRule>}\r\n */\r\nI18n.pluralRules = {\r\n  arabic: function (n) {\r\n    if (n === 0) { return 'zero' }\r\n    if (n === 1) { return 'one' }\r\n    if (n === 2) { return 'two' }\r\n    if (n % 100 >= 3 && n % 100 <= 10) { return 'few' }\r\n    if (n % 100 >= 11 && n % 100 <= 99) { return 'many' }\r\n    return 'other'\r\n  },\r\n  chinese: function () {\r\n    return 'other'\r\n  },\r\n  french: function (n) {\r\n    return n === 0 || n === 1 ? 'one' : 'other'\r\n  },\r\n  german: function (n) {\r\n    return n === 1 ? 'one' : 'other'\r\n  },\r\n  irish: function (n) {\r\n    if (n === 1) { return 'one' }\r\n    if (n === 2) { return 'two' }\r\n    if (n >= 3 && n <= 6) { return 'few' }\r\n    if (n >= 7 && n <= 10) { return 'many' }\r\n    return 'other'\r\n  },\r\n  russian: function (n) {\r\n    var lastTwo = n % 100;\r\n    var last = lastTwo % 10;\r\n    if (last === 1 && lastTwo !== 11) { return 'one' }\r\n    if (last >= 2 && last <= 4 && !(lastTwo >= 12 && lastTwo <= 14)) { return 'few' }\r\n    if (last === 0 || (last >= 5 && last <= 9) || (lastTwo >= 11 && lastTwo <= 14)) { return 'many' }\r\n    // Note: The 'other' suffix is only used by decimal numbers in Russian.\r\n    // We don't anticipate it being used, but it's here for consistency.\r\n    return 'other'\r\n  },\r\n  scottish: function (n) {\r\n    if (n === 1 || n === 11) { return 'one' }\r\n    if (n === 2 || n === 12) { return 'two' }\r\n    if ((n >= 3 && n <= 10) || (n >= 13 && n <= 19)) { return 'few' }\r\n    return 'other'\r\n  },\r\n  spanish: function (n) {\r\n    if (n === 1) { return 'one' }\r\n    if (n % 1000000 === 0 && n !== 0) { return 'many' }\r\n    return 'other'\r\n  },\r\n  welsh: function (n) {\r\n    if (n === 0) { return 'zero' }\r\n    if (n === 1) { return 'one' }\r\n    if (n === 2) { return 'two' }\r\n    if (n === 3) { return 'few' }\r\n    if (n === 6) { return 'many' }\r\n    return 'other'\r\n  }\r\n};\r\n\r\n/**\r\n * Supported languages for plural rules\r\n *\r\n * @typedef {'arabic' | 'chinese' | 'french' | 'german' | 'irish' | 'russian' | 'scottish' | 'spanish' | 'welsh'} PluralRuleName\r\n */\r\n\r\n/**\r\n * Plural rule category mnemonic tags\r\n *\r\n * @typedef {'zero' | 'one' | 'two' | 'few' | 'many' | 'other'} PluralRule\r\n */\r\n\r\n/**\r\n * Translated message by plural rule they correspond to.\r\n *\r\n * Allows to group pluralised messages under a single key when passing\r\n * translations to a component's constructor\r\n *\r\n * @typedef {object} TranslationPluralForms\r\n * @property {string} [other] - General plural form\r\n * @property {string} [zero] - Plural form used with 0\r\n * @property {string} [one] - Plural form used with 1\r\n * @property {string} [two] - Plural form used with 2\r\n * @property {string} [few] - Plural form used for a few\r\n * @property {string} [many] - Plural form used for many\r\n */\r\n\r\n/**\r\n * Translated messages (flattened)\r\n *\r\n * @private\r\n * @typedef {Object<string, string> | {}} TranslationsFlattened\r\n */\r\n\r\n(function(undefined) {\r\n\r\n// Detection from https://github.com/Financial-Times/polyfill-service/blob/master/packages/polyfill-library/polyfills/Object/defineProperty/detect.js\r\nvar detect = (\r\n  // In IE8, defineProperty could only act on DOM elements, so full support\r\n  // for the feature requires the ability to set a property on an arbitrary object\r\n  'defineProperty' in Object && (function() {\r\n  \ttry {\r\n  \t\tvar a = {};\r\n  \t\tObject.defineProperty(a, 'test', {value:42});\r\n  \t\treturn true;\r\n  \t} catch(e) {\r\n  \t\treturn false\r\n  \t}\r\n  }())\r\n);\r\n\r\nif (detect) return\r\n\r\n// Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Object.defineProperty&flags=always\r\n(function (nativeDefineProperty) {\r\n\r\n\tvar supportsAccessors = Object.prototype.hasOwnProperty('__defineGetter__');\r\n\tvar ERR_ACCESSORS_NOT_SUPPORTED = 'Getters & setters cannot be defined on this javascript engine';\r\n\tvar ERR_VALUE_ACCESSORS = 'A property cannot both have accessors and be writable or have a value';\r\n\r\n\tObject.defineProperty = function defineProperty(object, property, descriptor) {\r\n\r\n\t\t// Where native support exists, assume it\r\n\t\tif (nativeDefineProperty && (object === window || object === document || object === Element.prototype || object instanceof Element)) {\r\n\t\t\treturn nativeDefineProperty(object, property, descriptor);\r\n\t\t}\r\n\r\n\t\tif (object === null || !(object instanceof Object || typeof object === 'object')) {\r\n\t\t\tthrow new TypeError('Object.defineProperty called on non-object');\r\n\t\t}\r\n\r\n\t\tif (!(descriptor instanceof Object)) {\r\n\t\t\tthrow new TypeError('Property description must be an object');\r\n\t\t}\r\n\r\n\t\tvar propertyString = String(property);\r\n\t\tvar hasValueOrWritable = 'value' in descriptor || 'writable' in descriptor;\r\n\t\tvar getterType = 'get' in descriptor && typeof descriptor.get;\r\n\t\tvar setterType = 'set' in descriptor && typeof descriptor.set;\r\n\r\n\t\t// handle descriptor.get\r\n\t\tif (getterType) {\r\n\t\t\tif (getterType !== 'function') {\r\n\t\t\t\tthrow new TypeError('Getter must be a function');\r\n\t\t\t}\r\n\t\t\tif (!supportsAccessors) {\r\n\t\t\t\tthrow new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);\r\n\t\t\t}\r\n\t\t\tif (hasValueOrWritable) {\r\n\t\t\t\tthrow new TypeError(ERR_VALUE_ACCESSORS);\r\n\t\t\t}\r\n\t\t\tObject.__defineGetter__.call(object, propertyString, descriptor.get);\r\n\t\t} else {\r\n\t\t\tobject[propertyString] = descriptor.value;\r\n\t\t}\r\n\r\n\t\t// handle descriptor.set\r\n\t\tif (setterType) {\r\n\t\t\tif (setterType !== 'function') {\r\n\t\t\t\tthrow new TypeError('Setter must be a function');\r\n\t\t\t}\r\n\t\t\tif (!supportsAccessors) {\r\n\t\t\t\tthrow new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);\r\n\t\t\t}\r\n\t\t\tif (hasValueOrWritable) {\r\n\t\t\t\tthrow new TypeError(ERR_VALUE_ACCESSORS);\r\n\t\t\t}\r\n\t\t\tObject.__defineSetter__.call(object, propertyString, descriptor.set);\r\n\t\t}\r\n\r\n\t\t// OK to define value unconditionally - if a getter has been specified as well, an error would be thrown above\r\n\t\tif ('value' in descriptor) {\r\n\t\t\tobject[propertyString] = descriptor.value;\r\n\t\t}\r\n\r\n\t\treturn object;\r\n\t};\r\n}(Object.defineProperty));\r\n})\r\n.call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n  // Detection from https://github.com/Financial-Times/polyfill-service/blob/master/packages/polyfill-library/polyfills/Function/prototype/bind/detect.js\r\n  var detect = 'bind' in Function.prototype;\r\n\r\n  if (detect) return\r\n\r\n  // Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Function.prototype.bind&flags=always\r\n  Object.defineProperty(Function.prototype, 'bind', {\r\n      value: function bind(that) { // .length is 1\r\n          // add necessary es5-shim utilities\r\n          var $Array = Array;\r\n          var $Object = Object;\r\n          var ObjectPrototype = $Object.prototype;\r\n          var ArrayPrototype = $Array.prototype;\r\n          var Empty = function Empty() {};\r\n          var to_string = ObjectPrototype.toString;\r\n          var hasToStringTag = typeof Symbol === 'function' && typeof Symbol.toStringTag === 'symbol';\r\n          var isCallable; /* inlined from https://npmjs.com/is-callable */ var fnToStr = Function.prototype.toString, tryFunctionObject = function tryFunctionObject(value) { try { fnToStr.call(value); return true; } catch (e) { return false; } }, fnClass = '[object Function]', genClass = '[object GeneratorFunction]'; isCallable = function isCallable(value) { if (typeof value !== 'function') { return false; } if (hasToStringTag) { return tryFunctionObject(value); } var strClass = to_string.call(value); return strClass === fnClass || strClass === genClass; };\r\n          var array_slice = ArrayPrototype.slice;\r\n          var array_concat = ArrayPrototype.concat;\r\n          var array_push = ArrayPrototype.push;\r\n          var max = Math.max;\r\n          // /add necessary es5-shim utilities\r\n\r\n          // 1. Let Target be the this value.\r\n          var target = this;\r\n          // 2. If IsCallable(Target) is false, throw a TypeError exception.\r\n          if (!isCallable(target)) {\r\n              throw new TypeError('Function.prototype.bind called on incompatible ' + target);\r\n          }\r\n          // 3. Let A be a new (possibly empty) internal list of all of the\r\n          //   argument values provided after thisArg (arg1, arg2 etc), in order.\r\n          // XXX slicedArgs will stand in for \"A\" if used\r\n          var args = array_slice.call(arguments, 1); // for normal call\r\n          // 4. Let F be a new native ECMAScript object.\r\n          // 11. Set the [[Prototype]] internal property of F to the standard\r\n          //   built-in Function prototype object as specified in 15.3.3.1.\r\n          // 12. Set the [[Call]] internal property of F as described in\r\n          //   15.3.4.5.1.\r\n          // 13. Set the [[Construct]] internal property of F as described in\r\n          //   15.3.4.5.2.\r\n          // 14. Set the [[HasInstance]] internal property of F as described in\r\n          //   15.3.4.5.3.\r\n          var bound;\r\n          var binder = function () {\r\n\r\n              if (this instanceof bound) {\r\n                  // 15.3.4.5.2 [[Construct]]\r\n                  // When the [[Construct]] internal method of a function object,\r\n                  // F that was created using the bind function is called with a\r\n                  // list of arguments ExtraArgs, the following steps are taken:\r\n                  // 1. Let target be the value of F's [[TargetFunction]]\r\n                  //   internal property.\r\n                  // 2. If target has no [[Construct]] internal method, a\r\n                  //   TypeError exception is thrown.\r\n                  // 3. Let boundArgs be the value of F's [[BoundArgs]] internal\r\n                  //   property.\r\n                  // 4. Let args be a new list containing the same values as the\r\n                  //   list boundArgs in the same order followed by the same\r\n                  //   values as the list ExtraArgs in the same order.\r\n                  // 5. Return the result of calling the [[Construct]] internal\r\n                  //   method of target providing args as the arguments.\r\n\r\n                  var result = target.apply(\r\n                      this,\r\n                      array_concat.call(args, array_slice.call(arguments))\r\n                  );\r\n                  if ($Object(result) === result) {\r\n                      return result;\r\n                  }\r\n                  return this;\r\n\r\n              } else {\r\n                  // 15.3.4.5.1 [[Call]]\r\n                  // When the [[Call]] internal method of a function object, F,\r\n                  // which was created using the bind function is called with a\r\n                  // this value and a list of arguments ExtraArgs, the following\r\n                  // steps are taken:\r\n                  // 1. Let boundArgs be the value of F's [[BoundArgs]] internal\r\n                  //   property.\r\n                  // 2. Let boundThis be the value of F's [[BoundThis]] internal\r\n                  //   property.\r\n                  // 3. Let target be the value of F's [[TargetFunction]] internal\r\n                  //   property.\r\n                  // 4. Let args be a new list containing the same values as the\r\n                  //   list boundArgs in the same order followed by the same\r\n                  //   values as the list ExtraArgs in the same order.\r\n                  // 5. Return the result of calling the [[Call]] internal method\r\n                  //   of target providing boundThis as the this value and\r\n                  //   providing args as the arguments.\r\n\r\n                  // equiv: target.call(this, ...boundArgs, ...args)\r\n                  return target.apply(\r\n                      that,\r\n                      array_concat.call(args, array_slice.call(arguments))\r\n                  );\r\n\r\n              }\r\n\r\n          };\r\n\r\n          // 15. If the [[Class]] internal property of Target is \"Function\", then\r\n          //     a. Let L be the length property of Target minus the length of A.\r\n          //     b. Set the length own property of F to either 0 or L, whichever is\r\n          //       larger.\r\n          // 16. Else set the length own property of F to 0.\r\n\r\n          var boundLength = max(0, target.length - args.length);\r\n\r\n          // 17. Set the attributes of the length own property of F to the values\r\n          //   specified in 15.3.5.1.\r\n          var boundArgs = [];\r\n          for (var i = 0; i < boundLength; i++) {\r\n              array_push.call(boundArgs, '$' + i);\r\n          }\r\n\r\n          // XXX Build a dynamic function with desired amount of arguments is the only\r\n          // way to set the length property of a function.\r\n          // In environments where Content Security Policies enabled (Chrome extensions,\r\n          // for ex.) all use of eval or Function costructor throws an exception.\r\n          // However in all of these environments Function.prototype.bind exists\r\n          // and so this code will never be executed.\r\n          bound = Function('binder', 'return function (' + boundArgs.join(',') + '){ return binder.apply(this, arguments); }')(binder);\r\n\r\n          if (target.prototype) {\r\n              Empty.prototype = target.prototype;\r\n              bound.prototype = new Empty();\r\n              // Clean up dangling references.\r\n              Empty.prototype = null;\r\n          }\r\n\r\n          // TODO\r\n          // 18. Set the [[Extensible]] internal property of F to true.\r\n\r\n          // TODO\r\n          // 19. Let thrower be the [[ThrowTypeError]] function Object (13.2.3).\r\n          // 20. Call the [[DefineOwnProperty]] internal method of F with\r\n          //   arguments \"caller\", PropertyDescriptor {[[Get]]: thrower, [[Set]]:\r\n          //   thrower, [[Enumerable]]: false, [[Configurable]]: false}, and\r\n          //   false.\r\n          // 21. Call the [[DefineOwnProperty]] internal method of F with\r\n          //   arguments \"arguments\", PropertyDescriptor {[[Get]]: thrower,\r\n          //   [[Set]]: thrower, [[Enumerable]]: false, [[Configurable]]: false},\r\n          //   and false.\r\n\r\n          // TODO\r\n          // NOTE Function objects created using Function.prototype.bind do not\r\n          // have a prototype property or the [[Code]], [[FormalParameters]], and\r\n          // [[Scope]] internal properties.\r\n          // XXX can't delete prototype in pure-js.\r\n\r\n          // 22. Return F.\r\n          return bound;\r\n      }\r\n  });\r\n})\r\n.call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n    // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-service/master/packages/polyfill-library/polyfills/DOMTokenList/detect.js\r\n    var detect = (\r\n      'DOMTokenList' in this && (function (x) {\r\n        return 'classList' in x ? !x.classList.toggle('x', false) && !x.className : true;\r\n      })(document.createElement('x'))\r\n    );\r\n\r\n    if (detect) return\r\n\r\n    // Polyfill from https://raw.githubusercontent.com/Financial-Times/polyfill-service/master/packages/polyfill-library/polyfills/DOMTokenList/polyfill.js\r\n    (function (global) {\r\n      var nativeImpl = \"DOMTokenList\" in global && global.DOMTokenList;\r\n\r\n      if (\r\n          !nativeImpl ||\r\n          (\r\n            !!document.createElementNS &&\r\n            !!document.createElementNS('http://www.w3.org/2000/svg', 'svg') &&\r\n            !(document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\").classList instanceof DOMTokenList)\r\n          )\r\n        ) {\r\n        global.DOMTokenList = (function() { // eslint-disable-line no-unused-vars\r\n          var dpSupport = true;\r\n          var defineGetter = function (object, name, fn, configurable) {\r\n            if (Object.defineProperty)\r\n              Object.defineProperty(object, name, {\r\n                configurable: false === dpSupport ? true : !!configurable,\r\n                get: fn\r\n              });\r\n\r\n            else object.__defineGetter__(name, fn);\r\n          };\r\n\r\n          /** Ensure the browser allows Object.defineProperty to be used on native JavaScript objects. */\r\n          try {\r\n            defineGetter({}, \"support\");\r\n          }\r\n          catch (e) {\r\n            dpSupport = false;\r\n          }\r\n\r\n\r\n          var _DOMTokenList = function (el, prop) {\r\n            var that = this;\r\n            var tokens = [];\r\n            var tokenMap = {};\r\n            var length = 0;\r\n            var maxLength = 0;\r\n            var addIndexGetter = function (i) {\r\n              defineGetter(that, i, function () {\r\n                preop();\r\n                return tokens[i];\r\n              }, false);\r\n\r\n            };\r\n            var reindex = function () {\r\n\r\n              /** Define getter functions for array-like access to the tokenList's contents. */\r\n              if (length >= maxLength)\r\n                for (; maxLength < length; ++maxLength) {\r\n                  addIndexGetter(maxLength);\r\n                }\r\n            };\r\n\r\n            /** Helper function called at the start of each class method. Internal use only. */\r\n            var preop = function () {\r\n              var error;\r\n              var i;\r\n              var args = arguments;\r\n              var rSpace = /\\s+/;\r\n\r\n              /** Validate the token/s passed to an instance method, if any. */\r\n              if (args.length)\r\n                for (i = 0; i < args.length; ++i)\r\n                  if (rSpace.test(args[i])) {\r\n                    error = new SyntaxError('String \"' + args[i] + '\" ' + \"contains\" + ' an invalid character');\r\n                    error.code = 5;\r\n                    error.name = \"InvalidCharacterError\";\r\n                    throw error;\r\n                  }\r\n\r\n\r\n              /** Split the new value apart by whitespace*/\r\n              if (typeof el[prop] === \"object\") {\r\n                tokens = (\"\" + el[prop].baseVal).replace(/^\\s+|\\s+$/g, \"\").split(rSpace);\r\n              } else {\r\n                tokens = (\"\" + el[prop]).replace(/^\\s+|\\s+$/g, \"\").split(rSpace);\r\n              }\r\n\r\n              /** Avoid treating blank strings as single-item token lists */\r\n              if (\"\" === tokens[0]) tokens = [];\r\n\r\n              /** Repopulate the internal token lists */\r\n              tokenMap = {};\r\n              for (i = 0; i < tokens.length; ++i)\r\n                tokenMap[tokens[i]] = true;\r\n              length = tokens.length;\r\n              reindex();\r\n            };\r\n\r\n            /** Populate our internal token list if the targeted attribute of the subject element isn't empty. */\r\n            preop();\r\n\r\n            /** Return the number of tokens in the underlying string. Read-only. */\r\n            defineGetter(that, \"length\", function () {\r\n              preop();\r\n              return length;\r\n            });\r\n\r\n            /** Override the default toString/toLocaleString methods to return a space-delimited list of tokens when typecast. */\r\n            that.toLocaleString =\r\n              that.toString = function () {\r\n                preop();\r\n                return tokens.join(\" \");\r\n              };\r\n\r\n            that.item = function (idx) {\r\n              preop();\r\n              return tokens[idx];\r\n            };\r\n\r\n            that.contains = function (token) {\r\n              preop();\r\n              return !!tokenMap[token];\r\n            };\r\n\r\n            that.add = function () {\r\n              preop.apply(that, args = arguments);\r\n\r\n              for (var args, token, i = 0, l = args.length; i < l; ++i) {\r\n                token = args[i];\r\n                if (!tokenMap[token]) {\r\n                  tokens.push(token);\r\n                  tokenMap[token] = true;\r\n                }\r\n              }\r\n\r\n              /** Update the targeted attribute of the attached element if the token list's changed. */\r\n              if (length !== tokens.length) {\r\n                length = tokens.length >>> 0;\r\n                if (typeof el[prop] === \"object\") {\r\n                  el[prop].baseVal = tokens.join(\" \");\r\n                } else {\r\n                  el[prop] = tokens.join(\" \");\r\n                }\r\n                reindex();\r\n              }\r\n            };\r\n\r\n            that.remove = function () {\r\n              preop.apply(that, args = arguments);\r\n\r\n              /** Build a hash of token names to compare against when recollecting our token list. */\r\n              for (var args, ignore = {}, i = 0, t = []; i < args.length; ++i) {\r\n                ignore[args[i]] = true;\r\n                delete tokenMap[args[i]];\r\n              }\r\n\r\n              /** Run through our tokens list and reassign only those that aren't defined in the hash declared above. */\r\n              for (i = 0; i < tokens.length; ++i)\r\n                if (!ignore[tokens[i]]) t.push(tokens[i]);\r\n\r\n              tokens = t;\r\n              length = t.length >>> 0;\r\n\r\n              /** Update the targeted attribute of the attached element. */\r\n              if (typeof el[prop] === \"object\") {\r\n                el[prop].baseVal = tokens.join(\" \");\r\n              } else {\r\n                el[prop] = tokens.join(\" \");\r\n              }\r\n              reindex();\r\n            };\r\n\r\n            that.toggle = function (token, force) {\r\n              preop.apply(that, [token]);\r\n\r\n              /** Token state's being forced. */\r\n              if (undefined !== force) {\r\n                if (force) {\r\n                  that.add(token);\r\n                  return true;\r\n                } else {\r\n                  that.remove(token);\r\n                  return false;\r\n                }\r\n              }\r\n\r\n              /** Token already exists in tokenList. Remove it, and return FALSE. */\r\n              if (tokenMap[token]) {\r\n                that.remove(token);\r\n                return false;\r\n              }\r\n\r\n              /** Otherwise, add the token and return TRUE. */\r\n              that.add(token);\r\n              return true;\r\n            };\r\n\r\n            return that;\r\n          };\r\n\r\n          return _DOMTokenList;\r\n        }());\r\n      }\r\n\r\n      // Add second argument to native DOMTokenList.toggle() if necessary\r\n      (function () {\r\n        var e = document.createElement('span');\r\n        if (!('classList' in e)) return;\r\n        e.classList.toggle('x', false);\r\n        if (!e.classList.contains('x')) return;\r\n        e.classList.constructor.prototype.toggle = function toggle(token /*, force*/) {\r\n          var force = arguments[1];\r\n          if (force === undefined) {\r\n            var add = !this.contains(token);\r\n            this[add ? 'add' : 'remove'](token);\r\n            return add;\r\n          }\r\n          force = !!force;\r\n          this[force ? 'add' : 'remove'](token);\r\n          return force;\r\n        };\r\n      }());\r\n\r\n      // Add multiple arguments to native DOMTokenList.add() if necessary\r\n      (function () {\r\n        var e = document.createElement('span');\r\n        if (!('classList' in e)) return;\r\n        e.classList.add('a', 'b');\r\n        if (e.classList.contains('b')) return;\r\n        var native = e.classList.constructor.prototype.add;\r\n        e.classList.constructor.prototype.add = function () {\r\n          var args = arguments;\r\n          var l = arguments.length;\r\n          for (var i = 0; i < l; i++) {\r\n            native.call(this, args[i]);\r\n          }\r\n        };\r\n      }());\r\n\r\n      // Add multiple arguments to native DOMTokenList.remove() if necessary\r\n      (function () {\r\n        var e = document.createElement('span');\r\n        if (!('classList' in e)) return;\r\n        e.classList.add('a');\r\n        e.classList.add('b');\r\n        e.classList.remove('a', 'b');\r\n        if (!e.classList.contains('b')) return;\r\n        var native = e.classList.constructor.prototype.remove;\r\n        e.classList.constructor.prototype.remove = function () {\r\n          var args = arguments;\r\n          var l = arguments.length;\r\n          for (var i = 0; i < l; i++) {\r\n            native.call(this, args[i]);\r\n          }\r\n        };\r\n      }());\r\n\r\n    }(this));\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n// Detection from https://github.com/Financial-Times/polyfill-service/blob/master/packages/polyfill-library/polyfills/Document/detect.js\r\nvar detect = (\"Document\" in this);\r\n\r\nif (detect) return\r\n\r\n// Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Document&flags=always\r\nif ((typeof WorkerGlobalScope === \"undefined\") && (typeof importScripts !== \"function\")) {\r\n\r\n\tif (this.HTMLDocument) { // IE8\r\n\r\n\t\t// HTMLDocument is an extension of Document.  If the browser has HTMLDocument but not Document, the former will suffice as an alias for the latter.\r\n\t\tthis.Document = this.HTMLDocument;\r\n\r\n\t} else {\r\n\r\n\t\t// Create an empty function to act as the missing constructor for the document object, attach the document object as its prototype.  The function needs to be anonymous else it is hoisted and causes the feature detect to prematurely pass, preventing the assignments below being made.\r\n\t\tthis.Document = this.HTMLDocument = document.constructor = (new Function('return function Document() {}')());\r\n\t\tthis.Document.prototype = document;\r\n\t}\r\n}\r\n\r\n\r\n})\r\n.call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n// Detection from https://github.com/Financial-Times/polyfill-service/blob/master/packages/polyfill-library/polyfills/Element/detect.js\r\nvar detect = ('Element' in this && 'HTMLElement' in this);\r\n\r\nif (detect) return\r\n\r\n// Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Element&flags=always\r\n(function () {\r\n\r\n\t// IE8\r\n\tif (window.Element && !window.HTMLElement) {\r\n\t\twindow.HTMLElement = window.Element;\r\n\t\treturn;\r\n\t}\r\n\r\n\t// create Element constructor\r\n\twindow.Element = window.HTMLElement = new Function('return function Element() {}')();\r\n\r\n\t// generate sandboxed iframe\r\n\tvar vbody = document.appendChild(document.createElement('body'));\r\n\tvar frame = vbody.appendChild(document.createElement('iframe'));\r\n\r\n\t// use sandboxed iframe to replicate Element functionality\r\n\tvar frameDocument = frame.contentWindow.document;\r\n\tvar prototype = Element.prototype = frameDocument.appendChild(frameDocument.createElement('*'));\r\n\tvar cache = {};\r\n\r\n\t// polyfill Element.prototype on an element\r\n\tvar shiv = function (element, deep) {\r\n\t\tvar\r\n\t\tchildNodes = element.childNodes || [],\r\n\t\tindex = -1,\r\n\t\tkey, value, childNode;\r\n\r\n\t\tif (element.nodeType === 1 && element.constructor !== Element) {\r\n\t\t\telement.constructor = Element;\r\n\r\n\t\t\tfor (key in cache) {\r\n\t\t\t\tvalue = cache[key];\r\n\t\t\t\telement[key] = value;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\twhile (childNode = deep && childNodes[++index]) {\r\n\t\t\tshiv(childNode, deep);\r\n\t\t}\r\n\r\n\t\treturn element;\r\n\t};\r\n\r\n\tvar elements = document.getElementsByTagName('*');\r\n\tvar nativeCreateElement = document.createElement;\r\n\tvar interval;\r\n\tvar loopLimit = 100;\r\n\r\n\tprototype.attachEvent('onpropertychange', function (event) {\r\n\t\tvar\r\n\t\tpropertyName = event.propertyName,\r\n\t\tnonValue = !cache.hasOwnProperty(propertyName),\r\n\t\tnewValue = prototype[propertyName],\r\n\t\toldValue = cache[propertyName],\r\n\t\tindex = -1,\r\n\t\telement;\r\n\r\n\t\twhile (element = elements[++index]) {\r\n\t\t\tif (element.nodeType === 1) {\r\n\t\t\t\tif (nonValue || element[propertyName] === oldValue) {\r\n\t\t\t\t\telement[propertyName] = newValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcache[propertyName] = newValue;\r\n\t});\r\n\r\n\tprototype.constructor = Element;\r\n\r\n\tif (!prototype.hasAttribute) {\r\n\t\t// <Element>.hasAttribute\r\n\t\tprototype.hasAttribute = function hasAttribute(name) {\r\n\t\t\treturn this.getAttribute(name) !== null;\r\n\t\t};\r\n\t}\r\n\r\n\t// Apply Element prototype to the pre-existing DOM as soon as the body element appears.\r\n\tfunction bodyCheck() {\r\n\t\tif (!(loopLimit--)) clearTimeout(interval);\r\n\t\tif (document.body && !document.body.prototype && /(complete|interactive)/.test(document.readyState)) {\r\n\t\t\tshiv(document, true);\r\n\t\t\tif (interval && document.body.prototype) clearTimeout(interval);\r\n\t\t\treturn (!!document.body.prototype);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tif (!bodyCheck()) {\r\n\t\tdocument.onreadystatechange = bodyCheck;\r\n\t\tinterval = setInterval(bodyCheck, 25);\r\n\t}\r\n\r\n\t// Apply to any new elements created after load\r\n\tdocument.createElement = function createElement(nodeName) {\r\n\t\tvar element = nativeCreateElement(String(nodeName).toLowerCase());\r\n\t\treturn shiv(element);\r\n\t};\r\n\r\n\t// remove sandboxed iframe\r\n\tdocument.removeChild(vbody);\r\n}());\r\n\r\n})\r\n.call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n    // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-service/8717a9e04ac7aff99b4980fbedead98036b0929a/packages/polyfill-library/polyfills/Element/prototype/classList/detect.js\r\n    var detect = (\r\n      'document' in this && \"classList\" in document.documentElement && 'Element' in this && 'classList' in Element.prototype && (function () {\r\n        var e = document.createElement('span');\r\n        e.classList.add('a', 'b');\r\n        return e.classList.contains('b');\r\n      }())\r\n    );\r\n\r\n    if (detect) return\r\n\r\n    // Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Element.prototype.classList&flags=always\r\n    (function (global) {\r\n      var dpSupport = true;\r\n      var defineGetter = function (object, name, fn, configurable) {\r\n        if (Object.defineProperty)\r\n          Object.defineProperty(object, name, {\r\n            configurable: false === dpSupport ? true : !!configurable,\r\n            get: fn\r\n          });\r\n\r\n        else object.__defineGetter__(name, fn);\r\n      };\r\n      /** Ensure the browser allows Object.defineProperty to be used on native JavaScript objects. */\r\n      try {\r\n        defineGetter({}, \"support\");\r\n      }\r\n      catch (e) {\r\n        dpSupport = false;\r\n      }\r\n      /** Polyfills a property with a DOMTokenList */\r\n      var addProp = function (o, name, attr) {\r\n\r\n        defineGetter(o.prototype, name, function () {\r\n          var tokenList;\r\n\r\n          var THIS = this,\r\n\r\n          /** Prevent this from firing twice for some reason. What the hell, IE. */\r\n          gibberishProperty = \"__defineGetter__\" + \"DEFINE_PROPERTY\" + name;\r\n          if(THIS[gibberishProperty]) return tokenList;\r\n          THIS[gibberishProperty] = true;\r\n\r\n          /**\r\n           * IE8 can't define properties on native JavaScript objects, so we'll use a dumb hack instead.\r\n           *\r\n           * What this is doing is creating a dummy element (\"reflection\") inside a detached phantom node (\"mirror\")\r\n           * that serves as the target of Object.defineProperty instead. While we could simply use the subject HTML\r\n           * element instead, this would conflict with element types which use indexed properties (such as forms and\r\n           * select lists).\r\n           */\r\n          if (false === dpSupport) {\r\n\r\n            var visage;\r\n            var mirror = addProp.mirror || document.createElement(\"div\");\r\n            var reflections = mirror.childNodes;\r\n            var l = reflections.length;\r\n\r\n            for (var i = 0; i < l; ++i)\r\n              if (reflections[i]._R === THIS) {\r\n                visage = reflections[i];\r\n                break;\r\n              }\r\n\r\n            /** Couldn't find an element's reflection inside the mirror. Materialise one. */\r\n            visage || (visage = mirror.appendChild(document.createElement(\"div\")));\r\n\r\n            tokenList = DOMTokenList.call(visage, THIS, attr);\r\n          } else tokenList = new DOMTokenList(THIS, attr);\r\n\r\n          defineGetter(THIS, name, function () {\r\n            return tokenList;\r\n          });\r\n          delete THIS[gibberishProperty];\r\n\r\n          return tokenList;\r\n        }, true);\r\n      };\r\n\r\n      addProp(global.Element, \"classList\", \"className\");\r\n      addProp(global.HTMLElement, \"classList\", \"className\");\r\n      addProp(global.HTMLLinkElement, \"relList\", \"rel\");\r\n      addProp(global.HTMLAnchorElement, \"relList\", \"rel\");\r\n      addProp(global.HTMLAreaElement, \"relList\", \"rel\");\r\n    }(this));\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n    // Detection from https://github.com/mdn/content/blob/cf607d68522cd35ee7670782d3ee3a361eaef2e4/files/en-us/web/javascript/reference/global_objects/string/trim/index.md#polyfill\r\n    var detect = ('trim' in String.prototype);\r\n    \r\n    if (detect) return\r\n\r\n    // Polyfill from https://github.com/mdn/content/blob/cf607d68522cd35ee7670782d3ee3a361eaef2e4/files/en-us/web/javascript/reference/global_objects/string/trim/index.md#polyfill\r\n    String.prototype.trim = function () {\r\n        return this.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\r\n    };\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n  // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-library/13cf7c340974d128d557580b5e2dafcd1b1192d1/polyfills/Element/prototype/dataset/detect.js\r\n  var detect = (function(){\r\n    if (!document.documentElement.dataset) {\r\n      return false;\r\n    }\r\n    var el = document.createElement('div');\r\n    el.setAttribute(\"data-a-b\", \"c\");\r\n    return el.dataset && el.dataset.aB == \"c\";\r\n  }());\r\n\r\n  if (detect) return\r\n\r\n  // Polyfill derived from  https://raw.githubusercontent.com/Financial-Times/polyfill-library/13cf7c340974d128d557580b5e2dafcd1b1192d1/polyfills/Element/prototype/dataset/polyfill.js\r\n  Object.defineProperty(Element.prototype, 'dataset', {\r\n    get: function() {\r\n      var element = this;\r\n      var attributes = this.attributes;\r\n      var map = {};\r\n  \r\n      for (var i = 0; i < attributes.length; i++) {\r\n        var attribute = attributes[i];\r\n  \r\n        // This regex has been edited from the original polyfill, to add\r\n        // support for period (.) separators in data-* attribute names. These\r\n        // are allowed in the HTML spec, but were not covered by the original\r\n        // polyfill's regex. We use periods in our i18n implementation.\r\n        if (attribute && attribute.name && (/^data-\\w[.\\w-]*$/).test(attribute.name)) {\r\n          var name = attribute.name;\r\n          var value = attribute.value;\r\n  \r\n          var propName = name.substr(5).replace(/-./g, function (prop) {\r\n            return prop.charAt(1).toUpperCase();\r\n          });\r\n          \r\n          // If this browser supports __defineGetter__ and __defineSetter__,\r\n          // continue using defineProperty. If not (like IE 8 and below), we use\r\n          // a hacky fallback which at least gives an object in the right format\r\n          if ('__defineGetter__' in Object.prototype && '__defineSetter__' in Object.prototype) {\r\n            Object.defineProperty(map, propName, {\r\n              enumerable: true,\r\n              get: function() {\r\n                return this.value;\r\n              }.bind({value: value || ''}),\r\n              set: function setter(name, value) {\r\n                if (typeof value !== 'undefined') {\r\n                  this.setAttribute(name, value);\r\n                } else {\r\n                  this.removeAttribute(name);\r\n                }\r\n              }.bind(element, name)\r\n            });\r\n          } else {\r\n            map[propName] = value;\r\n          }\r\n\r\n        }\r\n      }\r\n  \r\n      return map;\r\n    }\r\n  });\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n/**\r\n * Normalise string\r\n *\r\n * 'If it looks like a duck, and it quacks like a duck' \r\n *\r\n * If the passed value looks like a boolean or a number, convert it to a boolean\r\n * or number.\r\n *\r\n * Designed to be used to convert config passed via data attributes (which are\r\n * always strings) into something sensible.\r\n *\r\n * @param {string} value - The value to normalise\r\n * @returns {string | boolean | number | undefined} Normalised data\r\n */\r\nfunction normaliseString (value) {\r\n  if (typeof value !== 'string') {\r\n    return value\r\n  }\r\n\r\n  var trimmedValue = value.trim();\r\n\r\n  if (trimmedValue === 'true') {\r\n    return true\r\n  }\r\n\r\n  if (trimmedValue === 'false') {\r\n    return false\r\n  }\r\n\r\n  // Empty / whitespace-only strings are considered finite so we need to check\r\n  // the length of the trimmed string as well\r\n  if (trimmedValue.length > 0 && isFinite(trimmedValue)) {\r\n    return Number(trimmedValue)\r\n  }\r\n\r\n  return value\r\n}\r\n\r\n/**\r\n * Normalise dataset\r\n *\r\n * Loop over an object and normalise each value using normaliseData function\r\n *\r\n * @param {DOMStringMap} dataset - HTML element dataset\r\n * @returns {Object<string, string | boolean | number | undefined>} Normalised dataset\r\n */\r\nfunction normaliseDataset (dataset) {\r\n  var out = {};\r\n\r\n  for (var key in dataset) {\r\n    out[key] = normaliseString(dataset[key]);\r\n  }\r\n\r\n  return out\r\n}\r\n\r\n/**\r\n * @constant\r\n * @type {AccordionTranslations}\r\n * @see Default value for {@link AccordionConfig.i18n}\r\n * @default\r\n */\r\nvar ACCORDION_TRANSLATIONS = {\r\n  hideAllSections: 'Hide all sections',\r\n  hideSection: 'Hide',\r\n  hideSectionAriaLabel: 'Hide this section',\r\n  showAllSections: 'Show all sections',\r\n  showSection: 'Show',\r\n  showSectionAriaLabel: 'Show this section'\r\n};\r\n\r\n/**\r\n * Accordion component\r\n *\r\n * This allows a collection of sections to be collapsed by default, showing only\r\n * their headers. Sections can be expanded or collapsed individually by clicking\r\n * their headers. A \"Show all sections\" button is also added to the top of the\r\n * accordion, which switches to \"Hide all sections\" when all the sections are\r\n * expanded.\r\n *\r\n * The state of each section is saved to the DOM via the `aria-expanded`\r\n * attribute, which also provides accessibility.\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for accordion\r\n * @param {AccordionConfig} [config] - Accordion config\r\n */\r\nfunction Accordion ($module, config) {\r\n  this.$module = $module;\r\n  this.$sections = $module.querySelectorAll('.govuk-accordion__section');\r\n  this.browserSupportsSessionStorage = helper.checkForSessionStorage();\r\n\r\n  var defaultConfig = {\r\n    i18n: ACCORDION_TRANSLATIONS\r\n  };\r\n  this.config = mergeConfigs(\r\n    defaultConfig,\r\n    config || {},\r\n    normaliseDataset($module.dataset)\r\n  );\r\n  this.i18n = new I18n(extractConfigByNamespace(this.config, 'i18n'));\r\n\r\n  this.controlsClass = 'govuk-accordion__controls';\r\n  this.showAllClass = 'govuk-accordion__show-all';\r\n  this.showAllTextClass = 'govuk-accordion__show-all-text';\r\n\r\n  this.sectionExpandedClass = 'govuk-accordion__section--expanded';\r\n  this.sectionButtonClass = 'govuk-accordion__section-button';\r\n  this.sectionHeaderClass = 'govuk-accordion__section-header';\r\n  this.sectionHeadingClass = 'govuk-accordion__section-heading';\r\n  this.sectionHeadingTextClass = 'govuk-accordion__section-heading-text';\r\n  this.sectionHeadingTextFocusClass = 'govuk-accordion__section-heading-text-focus';\r\n\r\n  this.sectionShowHideToggleClass = 'govuk-accordion__section-toggle';\r\n  this.sectionShowHideToggleFocusClass = 'govuk-accordion__section-toggle-focus';\r\n  this.sectionShowHideTextClass = 'govuk-accordion__section-toggle-text';\r\n  this.upChevronIconClass = 'govuk-accordion-nav__chevron';\r\n  this.downChevronIconClass = 'govuk-accordion-nav__chevron--down';\r\n\r\n  this.sectionSummaryClass = 'govuk-accordion__section-summary';\r\n  this.sectionSummaryFocusClass = 'govuk-accordion__section-summary-focus';\r\n}\r\n\r\n// Initialize component\r\nAccordion.prototype.init = function () {\r\n  // Check for module\r\n  if (!this.$module) {\r\n    return\r\n  }\r\n\r\n  this.initControls();\r\n  this.initSectionHeaders();\r\n\r\n  // See if \"Show all sections\" button text should be updated\r\n  var areAllSectionsOpen = this.checkIfAllSectionsOpen();\r\n  this.updateShowAllButton(areAllSectionsOpen);\r\n};\r\n\r\n// Initialise controls and set attributes\r\nAccordion.prototype.initControls = function () {\r\n  // Create \"Show all\" button and set attributes\r\n  this.$showAllButton = document.createElement('button');\r\n  this.$showAllButton.setAttribute('type', 'button');\r\n  this.$showAllButton.setAttribute('class', this.showAllClass);\r\n  this.$showAllButton.setAttribute('aria-expanded', 'false');\r\n\r\n  // Create icon, add to element\r\n  var $icon = document.createElement('span');\r\n  $icon.classList.add(this.upChevronIconClass);\r\n  this.$showAllButton.appendChild($icon);\r\n\r\n  // Create control wrapper and add controls to it\r\n  var $accordionControls = document.createElement('div');\r\n  $accordionControls.setAttribute('class', this.controlsClass);\r\n  $accordionControls.appendChild(this.$showAllButton);\r\n  this.$module.insertBefore($accordionControls, this.$module.firstChild);\r\n\r\n  // Build additional wrapper for Show all toggle text and place after icon\r\n  var $wrappershowAllText = document.createElement('span');\r\n  $wrappershowAllText.classList.add(this.showAllTextClass);\r\n  this.$showAllButton.appendChild($wrappershowAllText);\r\n\r\n  // Handle click events on the show/hide all button\r\n  this.$showAllButton.addEventListener('click', this.onShowOrHideAllToggle.bind(this));\r\n};\r\n\r\n// Initialise section headers\r\nAccordion.prototype.initSectionHeaders = function () {\r\n  // Loop through section headers\r\n  nodeListForEach(this.$sections, function ($section, i) {\r\n    // Set header attributes\r\n    var $header = $section.querySelector('.' + this.sectionHeaderClass);\r\n    this.constructHeaderMarkup($header, i);\r\n    this.setExpanded(this.isExpanded($section), $section);\r\n\r\n    // Handle events\r\n    $header.addEventListener('click', this.onSectionToggle.bind(this, $section));\r\n\r\n    // See if there is any state stored in sessionStorage and set the sections to\r\n    // open or closed.\r\n    this.setInitialState($section);\r\n  }.bind(this));\r\n};\r\n\r\nAccordion.prototype.constructHeaderMarkup = function ($headerWrapper, index) {\r\n  var $span = $headerWrapper.querySelector('.' + this.sectionButtonClass);\r\n  var $heading = $headerWrapper.querySelector('.' + this.sectionHeadingClass);\r\n  var $summary = $headerWrapper.querySelector('.' + this.sectionSummaryClass);\r\n\r\n  // Create a button element that will replace the '.govuk-accordion__section-button' span\r\n  var $button = document.createElement('button');\r\n  $button.setAttribute('type', 'button');\r\n  $button.setAttribute('aria-controls', this.$module.id + '-content-' + (index + 1));\r\n\r\n  // Copy all attributes (https://developer.mozilla.org/en-US/docs/Web/API/Element/attributes) from $span to $button\r\n  for (var i = 0; i < $span.attributes.length; i++) {\r\n    var attr = $span.attributes.item(i);\r\n    // Add all attributes but not ID as this is being added to\r\n    // the section heading ($headingText)\r\n    if (attr.nodeName !== 'id') {\r\n      $button.setAttribute(attr.nodeName, attr.nodeValue);\r\n    }\r\n  }\r\n\r\n  // Create container for heading text so it can be styled\r\n  var $headingText = document.createElement('span');\r\n  $headingText.classList.add(this.sectionHeadingTextClass);\r\n  // Copy the span ID to the heading text to allow it to be referenced by `aria-labelledby` on the\r\n  // hidden content area without \"Show this section\"\r\n  $headingText.id = $span.id;\r\n\r\n  // Create an inner heading text container to limit the width of the focus state\r\n  var $headingTextFocus = document.createElement('span');\r\n  $headingTextFocus.classList.add(this.sectionHeadingTextFocusClass);\r\n  $headingText.appendChild($headingTextFocus);\r\n  // span could contain HTML elements (see https://www.w3.org/TR/2011/WD-html5-20110525/content-models.html#phrasing-content)\r\n  $headingTextFocus.innerHTML = $span.innerHTML;\r\n\r\n  // Create container for show / hide icons and text.\r\n  var $showToggle = document.createElement('span');\r\n  $showToggle.classList.add(this.sectionShowHideToggleClass);\r\n  // Tell Google not to index the 'show' text as part of the heading\r\n  // For the snippet to work with JavaScript, it must be added before adding the page element to the\r\n  // page's DOM. See https://developers.google.com/search/docs/advanced/robots/robots_meta_tag#data-nosnippet-attr\r\n  $showToggle.setAttribute('data-nosnippet', '');\r\n  // Create an inner container to limit the width of the focus state\r\n  var $showToggleFocus = document.createElement('span');\r\n  $showToggleFocus.classList.add(this.sectionShowHideToggleFocusClass);\r\n  $showToggle.appendChild($showToggleFocus);\r\n  // Create wrapper for the show / hide text. Append text after the show/hide icon\r\n  var $showToggleText = document.createElement('span');\r\n  var $icon = document.createElement('span');\r\n  $icon.classList.add(this.upChevronIconClass);\r\n  $showToggleFocus.appendChild($icon);\r\n  $showToggleText.classList.add(this.sectionShowHideTextClass);\r\n  $showToggleFocus.appendChild($showToggleText);\r\n\r\n  // Append elements to the button:\r\n  // 1. Heading text\r\n  // 2. Punctuation\r\n  // 3. (Optional: Summary line followed by punctuation)\r\n  // 4. Show / hide toggle\r\n  $button.appendChild($headingText);\r\n  $button.appendChild(this.getButtonPunctuationEl());\r\n\r\n  // If summary content exists add to DOM in correct order\r\n  if (typeof ($summary) !== 'undefined' && $summary !== null) {\r\n    // Create a new `span` element and copy the summary line content from the original `div` to the\r\n    // new `span`\r\n    // This is because the summary line text is now inside a button element, which can only contain\r\n    // phrasing content\r\n    var $summarySpan = document.createElement('span');\r\n    // Create an inner summary container to limit the width of the summary focus state\r\n    var $summarySpanFocus = document.createElement('span');\r\n    $summarySpanFocus.classList.add(this.sectionSummaryFocusClass);\r\n    $summarySpan.appendChild($summarySpanFocus);\r\n\r\n    // Get original attributes, and pass them to the replacement\r\n    for (var j = 0, l = $summary.attributes.length; j < l; ++j) {\r\n      var nodeName = $summary.attributes.item(j).nodeName;\r\n      var nodeValue = $summary.attributes.item(j).nodeValue;\r\n      $summarySpan.setAttribute(nodeName, nodeValue);\r\n    }\r\n\r\n    // Copy original contents of summary to the new summary span\r\n    $summarySpanFocus.innerHTML = $summary.innerHTML;\r\n\r\n    // Replace the original summary `div` with the new summary `span`\r\n    $summary.parentNode.replaceChild($summarySpan, $summary);\r\n\r\n    $button.appendChild($summarySpan);\r\n    $button.appendChild(this.getButtonPunctuationEl());\r\n  }\r\n\r\n  $button.appendChild($showToggle);\r\n\r\n  $heading.removeChild($span);\r\n  $heading.appendChild($button);\r\n};\r\n\r\n// When section toggled, set and store state\r\nAccordion.prototype.onSectionToggle = function ($section) {\r\n  var expanded = this.isExpanded($section);\r\n  this.setExpanded(!expanded, $section);\r\n\r\n  // Store the state in sessionStorage when a change is triggered\r\n  this.storeState($section);\r\n};\r\n\r\n// When Open/Close All toggled, set and store state\r\nAccordion.prototype.onShowOrHideAllToggle = function () {\r\n  var $module = this;\r\n  var $sections = this.$sections;\r\n  var nowExpanded = !this.checkIfAllSectionsOpen();\r\n\r\n  nodeListForEach($sections, function ($section) {\r\n    $module.setExpanded(nowExpanded, $section);\r\n    // Store the state in sessionStorage when a change is triggered\r\n    $module.storeState($section);\r\n  });\r\n\r\n  $module.updateShowAllButton(nowExpanded);\r\n};\r\n\r\n// Set section attributes when opened/closed\r\nAccordion.prototype.setExpanded = function (expanded, $section) {\r\n  var $icon = $section.querySelector('.' + this.upChevronIconClass);\r\n  var $showHideText = $section.querySelector('.' + this.sectionShowHideTextClass);\r\n  var $button = $section.querySelector('.' + this.sectionButtonClass);\r\n  var newButtonText = expanded\r\n    ? this.i18n.t('hideSection')\r\n    : this.i18n.t('showSection');\r\n\r\n  $showHideText.innerText = newButtonText;\r\n  $button.setAttribute('aria-expanded', expanded);\r\n\r\n  // Update aria-label combining\r\n  var $header = $section.querySelector('.' + this.sectionHeadingTextClass);\r\n  var ariaLabelParts = [$header.innerText.trim()];\r\n\r\n  var $summary = $section.querySelector('.' + this.sectionSummaryClass);\r\n  if ($summary) {\r\n    ariaLabelParts.push($summary.innerText.trim());\r\n  }\r\n\r\n  var ariaLabelMessage = expanded\r\n    ? this.i18n.t('hideSectionAriaLabel')\r\n    : this.i18n.t('showSectionAriaLabel');\r\n  ariaLabelParts.push(ariaLabelMessage);\r\n\r\n  /*\r\n   * Join with a comma to add pause for assistive technology.\r\n   * Example: [heading]Section A ,[pause] Show this section.\r\n   * https://accessibility.blog.gov.uk/2017/12/18/what-working-on-gov-uk-navigation-taught-us-about-accessibility/\r\n   */\r\n  $button.setAttribute('aria-label', ariaLabelParts.join(' , '));\r\n\r\n  // Swap icon, change class\r\n  if (expanded) {\r\n    $section.classList.add(this.sectionExpandedClass);\r\n    $icon.classList.remove(this.downChevronIconClass);\r\n  } else {\r\n    $section.classList.remove(this.sectionExpandedClass);\r\n    $icon.classList.add(this.downChevronIconClass);\r\n  }\r\n\r\n  // See if \"Show all sections\" button text should be updated\r\n  var areAllSectionsOpen = this.checkIfAllSectionsOpen();\r\n  this.updateShowAllButton(areAllSectionsOpen);\r\n};\r\n\r\n// Get state of section\r\nAccordion.prototype.isExpanded = function ($section) {\r\n  return $section.classList.contains(this.sectionExpandedClass)\r\n};\r\n\r\n// Check if all sections are open\r\nAccordion.prototype.checkIfAllSectionsOpen = function () {\r\n  // Get a count of all the Accordion sections\r\n  var sectionsCount = this.$sections.length;\r\n  // Get a count of all Accordion sections that are expanded\r\n  var expandedSectionCount = this.$module.querySelectorAll('.' + this.sectionExpandedClass).length;\r\n  var areAllSectionsOpen = sectionsCount === expandedSectionCount;\r\n\r\n  return areAllSectionsOpen\r\n};\r\n\r\n// Update \"Show all sections\" button\r\nAccordion.prototype.updateShowAllButton = function (expanded) {\r\n  var $showAllIcon = this.$showAllButton.querySelector('.' + this.upChevronIconClass);\r\n  var $showAllText = this.$showAllButton.querySelector('.' + this.showAllTextClass);\r\n  var newButtonText = expanded\r\n    ? this.i18n.t('hideAllSections')\r\n    : this.i18n.t('showAllSections');\r\n  this.$showAllButton.setAttribute('aria-expanded', expanded);\r\n  $showAllText.innerText = newButtonText;\r\n\r\n  // Swap icon, toggle class\r\n  if (expanded) {\r\n    $showAllIcon.classList.remove(this.downChevronIconClass);\r\n  } else {\r\n    $showAllIcon.classList.add(this.downChevronIconClass);\r\n  }\r\n};\r\n\r\n// Check for `window.sessionStorage`, and that it actually works.\r\nvar helper = {\r\n  checkForSessionStorage: function () {\r\n    var testString = 'this is the test string';\r\n    var result;\r\n    try {\r\n      window.sessionStorage.setItem(testString, testString);\r\n      result = window.sessionStorage.getItem(testString) === testString.toString();\r\n      window.sessionStorage.removeItem(testString);\r\n      return result\r\n    } catch (exception) {\r\n      return false\r\n    }\r\n  }\r\n};\r\n\r\n// Set the state of the accordions in sessionStorage\r\nAccordion.prototype.storeState = function ($section) {\r\n  if (this.browserSupportsSessionStorage) {\r\n    // We need a unique way of identifying each content in the Accordion. Since\r\n    // an `#id` should be unique and an `id` is required for `aria-` attributes\r\n    // `id` can be safely used.\r\n    var $button = $section.querySelector('.' + this.sectionButtonClass);\r\n\r\n    if ($button) {\r\n      var contentId = $button.getAttribute('aria-controls');\r\n      var contentState = $button.getAttribute('aria-expanded');\r\n\r\n      // Only set the state when both `contentId` and `contentState` are taken from the DOM.\r\n      if (contentId && contentState) {\r\n        window.sessionStorage.setItem(contentId, contentState);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n// Read the state of the accordions from sessionStorage\r\nAccordion.prototype.setInitialState = function ($section) {\r\n  if (this.browserSupportsSessionStorage) {\r\n    var $button = $section.querySelector('.' + this.sectionButtonClass);\r\n\r\n    if ($button) {\r\n      var contentId = $button.getAttribute('aria-controls');\r\n      var contentState = contentId ? window.sessionStorage.getItem(contentId) : null;\r\n\r\n      if (contentState !== null) {\r\n        this.setExpanded(contentState === 'true', $section);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Create an element to improve semantics of the section button with punctuation\r\n *\r\n * @returns {HTMLSpanElement} DOM element\r\n *\r\n * Adding punctuation to the button can also improve its general semantics by dividing its contents\r\n * into thematic chunks.\r\n * See https://github.com/alphagov/govuk-frontend/issues/2327#issuecomment-922957442\r\n */\r\nAccordion.prototype.getButtonPunctuationEl = function () {\r\n  var $punctuationEl = document.createElement('span');\r\n  $punctuationEl.classList.add('govuk-visually-hidden', 'govuk-accordion__section-heading-divider');\r\n  $punctuationEl.innerHTML = ', ';\r\n  return $punctuationEl\r\n};\r\n\r\n/**\r\n * Accordion config\r\n *\r\n * @typedef {object} AccordionConfig\r\n * @property {AccordionTranslations} [i18n = ACCORDION_TRANSLATIONS] - See constant {@link ACCORDION_TRANSLATIONS}\r\n */\r\n\r\n/**\r\n * Accordion translations\r\n *\r\n * @typedef {object} AccordionTranslations\r\n *\r\n * Messages used by the component for the labels of its buttons. This includes\r\n * the visible text shown on screen, and text to help assistive technology users\r\n * for the buttons toggling each section.\r\n * @property {string} [hideAllSections] - The text content for the 'Hide all\r\n * sections' button, used when at least one section is expanded.\r\n * @property {string} [hideSection] - The text content for the 'Hide'\r\n * button, used when a section is expanded.\r\n * @property {string} [hideSectionAriaLabel] - The text content appended to the\r\n * 'Hide' button's accessible name when a section is expanded.\r\n * @property {string} [showAllSections] - The text content for the 'Show all\r\n * sections' button, used when all sections are collapsed.\r\n * @property {string} [showSection] - The text content for the 'Show'\r\n * button, used when a section is collapsed.\r\n * @property {string} [showSectionAriaLabel] - The text content appended to the\r\n * 'Show' button's accessible name when a section is expanded.\r\n */\r\n\r\n(function(undefined) {\r\n\r\n// Detection from https://github.com/Financial-Times/polyfill-service/blob/master/packages/polyfill-library/polyfills/Window/detect.js\r\nvar detect = ('Window' in this);\r\n\r\nif (detect) return\r\n\r\n// Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Window&flags=always\r\nif ((typeof WorkerGlobalScope === \"undefined\") && (typeof importScripts !== \"function\")) {\r\n\t(function (global) {\r\n\t\tif (global.constructor) {\r\n\t\t\tglobal.Window = global.constructor;\r\n\t\t} else {\r\n\t\t\t(global.Window = global.constructor = new Function('return function Window() {}')()).prototype = this;\r\n\t\t}\r\n\t}(this));\r\n}\r\n\r\n})\r\n.call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n// Detection from https://github.com/Financial-Times/polyfill-service/blob/master/packages/polyfill-library/polyfills/Event/detect.js\r\nvar detect = (\r\n  (function(global) {\r\n\r\n  \tif (!('Event' in global)) return false;\r\n  \tif (typeof global.Event === 'function') return true;\r\n\r\n  \ttry {\r\n\r\n  \t\t// In IE 9-11, the Event object exists but cannot be instantiated\r\n  \t\tnew Event('click');\r\n  \t\treturn true;\r\n  \t} catch(e) {\r\n  \t\treturn false;\r\n  \t}\r\n  }(this))\r\n);\r\n\r\nif (detect) return\r\n\r\n// Polyfill from https://cdn.polyfill.io/v2/polyfill.js?features=Event&flags=always\r\n(function () {\r\n\tvar unlistenableWindowEvents = {\r\n\t\tclick: 1,\r\n\t\tdblclick: 1,\r\n\t\tkeyup: 1,\r\n\t\tkeypress: 1,\r\n\t\tkeydown: 1,\r\n\t\tmousedown: 1,\r\n\t\tmouseup: 1,\r\n\t\tmousemove: 1,\r\n\t\tmouseover: 1,\r\n\t\tmouseenter: 1,\r\n\t\tmouseleave: 1,\r\n\t\tmouseout: 1,\r\n\t\tstorage: 1,\r\n\t\tstoragecommit: 1,\r\n\t\ttextinput: 1\r\n\t};\r\n\r\n\t// This polyfill depends on availability of `document` so will not run in a worker\r\n\t// However, we asssume there are no browsers with worker support that lack proper\r\n\t// support for `Event` within the worker\r\n\tif (typeof document === 'undefined' || typeof window === 'undefined') return;\r\n\r\n\tfunction indexOf(array, element) {\r\n\t\tvar\r\n\t\tindex = -1,\r\n\t\tlength = array.length;\r\n\r\n\t\twhile (++index < length) {\r\n\t\t\tif (index in array && array[index] === element) {\r\n\t\t\t\treturn index;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn -1;\r\n\t}\r\n\r\n\tvar existingProto = (window.Event && window.Event.prototype) || null;\r\n\twindow.Event = Window.prototype.Event = function Event(type, eventInitDict) {\r\n\t\tif (!type) {\r\n\t\t\tthrow new Error('Not enough arguments');\r\n\t\t}\r\n\r\n\t\tvar event;\r\n\t\t// Shortcut if browser supports createEvent\r\n\t\tif ('createEvent' in document) {\r\n\t\t\tevent = document.createEvent('Event');\r\n\t\t\tvar bubbles = eventInitDict && eventInitDict.bubbles !== undefined ? eventInitDict.bubbles : false;\r\n\t\t\tvar cancelable = eventInitDict && eventInitDict.cancelable !== undefined ? eventInitDict.cancelable : false;\r\n\r\n\t\t\tevent.initEvent(type, bubbles, cancelable);\r\n\r\n\t\t\treturn event;\r\n\t\t}\r\n\r\n\t\tevent = document.createEventObject();\r\n\r\n\t\tevent.type = type;\r\n\t\tevent.bubbles = eventInitDict && eventInitDict.bubbles !== undefined ? eventInitDict.bubbles : false;\r\n\t\tevent.cancelable = eventInitDict && eventInitDict.cancelable !== undefined ? eventInitDict.cancelable : false;\r\n\r\n\t\treturn event;\r\n\t};\r\n\tif (existingProto) {\r\n\t\tObject.defineProperty(window.Event, 'prototype', {\r\n\t\t\tconfigurable: false,\r\n\t\t\tenumerable: false,\r\n\t\t\twritable: true,\r\n\t\t\tvalue: existingProto\r\n\t\t});\r\n\t}\r\n\r\n\tif (!('createEvent' in document)) {\r\n\t\twindow.addEventListener = Window.prototype.addEventListener = Document.prototype.addEventListener = Element.prototype.addEventListener = function addEventListener() {\r\n\t\t\tvar\r\n\t\t\telement = this,\r\n\t\t\ttype = arguments[0],\r\n\t\t\tlistener = arguments[1];\r\n\r\n\t\t\tif (element === window && type in unlistenableWindowEvents) {\r\n\t\t\t\tthrow new Error('In IE8 the event: ' + type + ' is not available on the window object. Please see https://github.com/Financial-Times/polyfill-service/issues/317 for more information.');\r\n\t\t\t}\r\n\r\n\t\t\tif (!element._events) {\r\n\t\t\t\telement._events = {};\r\n\t\t\t}\r\n\r\n\t\t\tif (!element._events[type]) {\r\n\t\t\t\telement._events[type] = function (event) {\r\n\t\t\t\t\tvar\r\n\t\t\t\t\tlist = element._events[event.type].list,\r\n\t\t\t\t\tevents = list.slice(),\r\n\t\t\t\t\tindex = -1,\r\n\t\t\t\t\tlength = events.length,\r\n\t\t\t\t\teventElement;\r\n\r\n\t\t\t\t\tevent.preventDefault = function preventDefault() {\r\n\t\t\t\t\t\tif (event.cancelable !== false) {\r\n\t\t\t\t\t\t\tevent.returnValue = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tevent.stopPropagation = function stopPropagation() {\r\n\t\t\t\t\t\tevent.cancelBubble = true;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tevent.stopImmediatePropagation = function stopImmediatePropagation() {\r\n\t\t\t\t\t\tevent.cancelBubble = true;\r\n\t\t\t\t\t\tevent.cancelImmediate = true;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tevent.currentTarget = element;\r\n\t\t\t\t\tevent.relatedTarget = event.fromElement || null;\r\n\t\t\t\t\tevent.target = event.target || event.srcElement || element;\r\n\t\t\t\t\tevent.timeStamp = new Date().getTime();\r\n\r\n\t\t\t\t\tif (event.clientX) {\r\n\t\t\t\t\t\tevent.pageX = event.clientX + document.documentElement.scrollLeft;\r\n\t\t\t\t\t\tevent.pageY = event.clientY + document.documentElement.scrollTop;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\twhile (++index < length && !event.cancelImmediate) {\r\n\t\t\t\t\t\tif (index in events) {\r\n\t\t\t\t\t\t\teventElement = events[index];\r\n\r\n\t\t\t\t\t\t\tif (indexOf(list, eventElement) !== -1 && typeof eventElement === 'function') {\r\n\t\t\t\t\t\t\t\teventElement.call(element, event);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\telement._events[type].list = [];\r\n\r\n\t\t\t\tif (element.attachEvent) {\r\n\t\t\t\t\telement.attachEvent('on' + type, element._events[type]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\telement._events[type].list.push(listener);\r\n\t\t};\r\n\r\n\t\twindow.removeEventListener = Window.prototype.removeEventListener = Document.prototype.removeEventListener = Element.prototype.removeEventListener = function removeEventListener() {\r\n\t\t\tvar\r\n\t\t\telement = this,\r\n\t\t\ttype = arguments[0],\r\n\t\t\tlistener = arguments[1],\r\n\t\t\tindex;\r\n\r\n\t\t\tif (element._events && element._events[type] && element._events[type].list) {\r\n\t\t\t\tindex = indexOf(element._events[type].list, listener);\r\n\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\telement._events[type].list.splice(index, 1);\r\n\r\n\t\t\t\t\tif (!element._events[type].list.length) {\r\n\t\t\t\t\t\tif (element.detachEvent) {\r\n\t\t\t\t\t\t\telement.detachEvent('on' + type, element._events[type]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdelete element._events[type];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\twindow.dispatchEvent = Window.prototype.dispatchEvent = Document.prototype.dispatchEvent = Element.prototype.dispatchEvent = function dispatchEvent(event) {\r\n\t\t\tif (!arguments.length) {\r\n\t\t\t\tthrow new Error('Not enough arguments');\r\n\t\t\t}\r\n\r\n\t\t\tif (!event || typeof event.type !== 'string') {\r\n\t\t\t\tthrow new Error('DOM Events Exception 0');\r\n\t\t\t}\r\n\r\n\t\t\tvar element = this, type = event.type;\r\n\r\n\t\t\ttry {\r\n\t\t\t\tif (!event.bubbles) {\r\n\t\t\t\t\tevent.cancelBubble = true;\r\n\r\n\t\t\t\t\tvar cancelBubbleEvent = function (event) {\r\n\t\t\t\t\t\tevent.cancelBubble = true;\r\n\r\n\t\t\t\t\t\t(element || window).detachEvent('on' + type, cancelBubbleEvent);\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tthis.attachEvent('on' + type, cancelBubbleEvent);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.fireEvent('on' + type, event);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tevent.target = element;\r\n\r\n\t\t\t\tdo {\r\n\t\t\t\t\tevent.currentTarget = element;\r\n\r\n\t\t\t\t\tif ('_events' in element && typeof element._events[type] === 'function') {\r\n\t\t\t\t\t\telement._events[type].call(element, event);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (typeof element['on' + type] === 'function') {\r\n\t\t\t\t\t\telement['on' + type].call(element, event);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telement = element.nodeType === 9 ? element.parentWindow : element.parentNode;\r\n\t\t\t\t} while (element && !event.cancelBubble);\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\t// Add the DOMContentLoaded Event\r\n\t\tdocument.attachEvent('onreadystatechange', function() {\r\n\t\t\tif (document.readyState === 'complete') {\r\n\t\t\t\tdocument.dispatchEvent(new Event('DOMContentLoaded', {\r\n\t\t\t\t\tbubbles: true\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}());\r\n\r\n})\r\n.call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\nvar KEY_SPACE = 32;\r\nvar DEBOUNCE_TIMEOUT_IN_SECONDS = 1;\r\n\r\n/**\r\n * JavaScript enhancements for the Button component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - The element this component controls\r\n * @param {ButtonConfig} config - Button config\r\n */\r\nfunction Button ($module, config) {\r\n  if (!$module) {\r\n    return this\r\n  }\r\n\r\n  this.$module = $module;\r\n  this.debounceFormSubmitTimer = null;\r\n\r\n  var defaultConfig = {\r\n    preventDoubleClick: false\r\n  };\r\n  this.config = mergeConfigs(\r\n    defaultConfig,\r\n    config || {},\r\n    normaliseDataset($module.dataset)\r\n  );\r\n}\r\n\r\n/**\r\n * Initialise component\r\n */\r\nButton.prototype.init = function () {\r\n  if (!this.$module) {\r\n    return\r\n  }\r\n\r\n  this.$module.addEventListener('keydown', this.handleKeyDown);\r\n  this.$module.addEventListener('click', this.debounce.bind(this));\r\n};\r\n\r\n/**\r\n * Trigger a click event when the space key is pressed\r\n *\r\n * Some screen readers tell users they can activate things with the 'button'\r\n * role, so we need to match the functionality of native HTML buttons\r\n *\r\n * See https://github.com/alphagov/govuk_elements/pull/272#issuecomment-233028270\r\n *\r\n * @param {KeyboardEvent} event\r\n */\r\nButton.prototype.handleKeyDown = function (event) {\r\n  var target = event.target;\r\n\r\n  if (target.getAttribute('role') === 'button' && event.keyCode === KEY_SPACE) {\r\n    event.preventDefault(); // prevent the page from scrolling\r\n    target.click();\r\n  }\r\n};\r\n\r\n/**\r\n * Debounce double-clicks\r\n *\r\n * If the click quickly succeeds a previous click then nothing will happen. This\r\n * stops people accidentally causing multiple form submissions by double\r\n * clicking buttons.\r\n *\r\n * @param {MouseEvent} event\r\n * @returns {undefined | false} - Returns undefined, or false when debounced\r\n */\r\nButton.prototype.debounce = function (event) {\r\n  // Check the button that was clicked has preventDoubleClick enabled\r\n  if (!this.config.preventDoubleClick) {\r\n    return\r\n  }\r\n\r\n  // If the timer is still running, prevent the click from submitting the form\r\n  if (this.debounceFormSubmitTimer) {\r\n    event.preventDefault();\r\n    return false\r\n  }\r\n\r\n  this.debounceFormSubmitTimer = setTimeout(function () {\r\n    this.debounceFormSubmitTimer = null;\r\n  }.bind(this), DEBOUNCE_TIMEOUT_IN_SECONDS * 1000);\r\n};\r\n\r\n/**\r\n * Button config\r\n *\r\n * @typedef {object} ButtonConfig\r\n * @property {boolean} [preventDoubleClick = false] -\r\n *  Prevent accidental double clicks on submit buttons from submitting forms\r\n *  multiple times.\r\n */\r\n\r\n/**\r\n * JavaScript 'polyfill' for HTML5's <details> and <summary> elements\r\n * and 'shim' to add accessiblity enhancements for all browsers\r\n *\r\n * http://caniuse.com/#feat=details\r\n */\r\n\r\nvar KEY_ENTER = 13;\r\nvar KEY_SPACE$1 = 32;\r\n\r\n/**\r\n * Details component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for details\r\n */\r\nfunction Details ($module) {\r\n  this.$module = $module;\r\n}\r\n\r\nDetails.prototype.init = function () {\r\n  if (!this.$module) {\r\n    return\r\n  }\r\n\r\n  // If there is native details support, we want to avoid running code to polyfill native behaviour.\r\n  var hasNativeDetails = typeof this.$module.open === 'boolean';\r\n\r\n  if (hasNativeDetails) {\r\n    return\r\n  }\r\n\r\n  this.polyfillDetails();\r\n};\r\n\r\nDetails.prototype.polyfillDetails = function () {\r\n  var $module = this.$module;\r\n\r\n  // Save shortcuts to the inner summary and content elements\r\n  var $summary = this.$summary = $module.getElementsByTagName('summary').item(0);\r\n  var $content = this.$content = $module.getElementsByTagName('div').item(0);\r\n\r\n  // If <details> doesn't have a <summary> and a <div> representing the content\r\n  // it means the required HTML structure is not met so the script will stop\r\n  if (!$summary || !$content) {\r\n    return\r\n  }\r\n\r\n  // If the content doesn't have an ID, assign it one now\r\n  // which we'll need for the summary's aria-controls assignment\r\n  if (!$content.id) {\r\n    $content.id = 'details-content-' + generateUniqueID();\r\n  }\r\n\r\n  // Add ARIA role=\"group\" to details\r\n  $module.setAttribute('role', 'group');\r\n\r\n  // Add role=button to summary\r\n  $summary.setAttribute('role', 'button');\r\n\r\n  // Add aria-controls\r\n  $summary.setAttribute('aria-controls', $content.id);\r\n\r\n  // Set tabIndex so the summary is keyboard accessible for non-native elements\r\n  //\r\n  // We have to use the camelcase `tabIndex` property as there is a bug in IE6/IE7 when we set the correct attribute lowercase:\r\n  // See http://web.archive.org/web/20170120194036/http://www.saliences.com/browserBugs/tabIndex.html for more information.\r\n  $summary.tabIndex = 0;\r\n\r\n  // Detect initial open state\r\n  if (this.$module.hasAttribute('open')) {\r\n    $summary.setAttribute('aria-expanded', 'true');\r\n  } else {\r\n    $summary.setAttribute('aria-expanded', 'false');\r\n    $content.style.display = 'none';\r\n  }\r\n\r\n  // Bind an event to handle summary elements\r\n  this.polyfillHandleInputs($summary, this.polyfillSetAttributes.bind(this));\r\n};\r\n\r\n/**\r\n * Define a statechange function that updates aria-expanded and style.display\r\n *\r\n * @returns {boolean} Returns true\r\n */\r\nDetails.prototype.polyfillSetAttributes = function () {\r\n  if (this.$module.hasAttribute('open')) {\r\n    this.$module.removeAttribute('open');\r\n    this.$summary.setAttribute('aria-expanded', 'false');\r\n    this.$content.style.display = 'none';\r\n  } else {\r\n    this.$module.setAttribute('open', 'open');\r\n    this.$summary.setAttribute('aria-expanded', 'true');\r\n    this.$content.style.display = '';\r\n  }\r\n\r\n  return true\r\n};\r\n\r\n/**\r\n * Handle cross-modal click events\r\n *\r\n * @param {object} node - element\r\n * @param {polyfillHandleInputsCallback} callback - function\r\n */\r\nDetails.prototype.polyfillHandleInputs = function (node, callback) {\r\n  node.addEventListener('keypress', function (event) {\r\n    var target = event.target;\r\n    // When the key gets pressed - check if it is enter or space\r\n    if (event.keyCode === KEY_ENTER || event.keyCode === KEY_SPACE$1) {\r\n      if (target.nodeName.toLowerCase() === 'summary') {\r\n        // Prevent space from scrolling the page\r\n        // and enter from submitting a form\r\n        event.preventDefault();\r\n        // Click to let the click event do all the necessary action\r\n        if (target.click) {\r\n          target.click();\r\n        } else {\r\n          // except Safari 5.1 and under don't support .click() here\r\n          callback(event);\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  // Prevent keyup to prevent clicking twice in Firefox when using space key\r\n  node.addEventListener('keyup', function (event) {\r\n    var target = event.target;\r\n    if (event.keyCode === KEY_SPACE$1) {\r\n      if (target.nodeName.toLowerCase() === 'summary') {\r\n        event.preventDefault();\r\n      }\r\n    }\r\n  });\r\n\r\n  node.addEventListener('click', callback);\r\n};\r\n\r\n/**\r\n * @callback polyfillHandleInputsCallback\r\n * @param {KeyboardEvent} event - Keyboard event\r\n * @returns {undefined}\r\n */\r\n\r\n(function(undefined) {\r\n\r\n    // Detection from https://github.com/Financial-Times/polyfill-library/blob/v3.111.0/polyfills/Date/now/detect.js\r\n    var detect = ('Date' in self && 'now' in self.Date && 'getTime' in self.Date.prototype);\r\n\r\n    if (detect) return\r\n\r\n    // Polyfill from https://polyfill.io/v3/polyfill.js?version=3.111.0&features=Date.now&flags=always\r\n    Date.now = function () {\r\n        return new Date().getTime();\r\n    };\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n  // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-service/1f3c09b402f65bf6e393f933a15ba63f1b86ef1f/packages/polyfill-library/polyfills/Element/prototype/matches/detect.js\r\n  var detect = (\r\n    'document' in this && \"matches\" in document.documentElement\r\n  );\r\n\r\n  if (detect) return\r\n\r\n  // Polyfill from https://raw.githubusercontent.com/Financial-Times/polyfill-service/1f3c09b402f65bf6e393f933a15ba63f1b86ef1f/packages/polyfill-library/polyfills/Element/prototype/matches/polyfill.js\r\n  Element.prototype.matches = Element.prototype.webkitMatchesSelector || Element.prototype.oMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.mozMatchesSelector || function matches(selector) {\r\n    var element = this;\r\n    var elements = (element.document || element.ownerDocument).querySelectorAll(selector);\r\n    var index = 0;\r\n\r\n    while (elements[index] && elements[index] !== element) {\r\n      ++index;\r\n    }\r\n\r\n    return !!elements[index];\r\n  };\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n  // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-service/1f3c09b402f65bf6e393f933a15ba63f1b86ef1f/packages/polyfill-library/polyfills/Element/prototype/closest/detect.js\r\n  var detect = (\r\n    'document' in this && \"closest\" in document.documentElement\r\n  );\r\n\r\n  if (detect) return\r\n\r\n  // Polyfill from https://raw.githubusercontent.com/Financial-Times/polyfill-service/1f3c09b402f65bf6e393f933a15ba63f1b86ef1f/packages/polyfill-library/polyfills/Element/prototype/closest/polyfill.js\r\n  Element.prototype.closest = function closest(selector) {\r\n    var node = this;\r\n\r\n    while (node) {\r\n      if (node.matches(selector)) return node;\r\n      else node = 'SVGElement' in window && node instanceof SVGElement ? node.parentNode : node.parentElement;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n/**\r\n * Returns the value of the given attribute closest to the given element (including itself)\r\n *\r\n * @param {HTMLElement} $element - The element to start walking the DOM tree up\r\n * @param {string} attributeName - The name of the attribute\r\n * @returns {string | undefined} Attribute value\r\n */\r\nfunction closestAttributeValue ($element, attributeName) {\r\n  var closestElementWithAttribute = $element.closest('[' + attributeName + ']');\r\n  if (closestElementWithAttribute) {\r\n    return closestElementWithAttribute.getAttribute(attributeName)\r\n  }\r\n}\r\n\r\n/**\r\n * @constant\r\n * @type {CharacterCountTranslations}\r\n * @see Default value for {@link CharacterCountConfig.i18n}\r\n * @default\r\n */\r\nvar CHARACTER_COUNT_TRANSLATIONS = {\r\n  // Characters\r\n  charactersUnderLimit: {\r\n    one: 'You have %{count} character remaining',\r\n    other: 'You have %{count} characters remaining'\r\n  },\r\n  charactersAtLimit: 'You have 0 characters remaining',\r\n  charactersOverLimit: {\r\n    one: 'You have %{count} character too many',\r\n    other: 'You have %{count} characters too many'\r\n  },\r\n  // Words\r\n  wordsUnderLimit: {\r\n    one: 'You have %{count} word remaining',\r\n    other: 'You have %{count} words remaining'\r\n  },\r\n  wordsAtLimit: 'You have 0 words remaining',\r\n  wordsOverLimit: {\r\n    one: 'You have %{count} word too many',\r\n    other: 'You have %{count} words too many'\r\n  },\r\n  textareaDescription: {\r\n    other: ''\r\n  }\r\n};\r\n\r\n/**\r\n * JavaScript enhancements for the CharacterCount component\r\n *\r\n * Tracks the number of characters or words in the `.govuk-js-character-count`\r\n * `<textarea>` inside the element. Displays a message with the remaining number\r\n * of characters/words available, or the number of characters/words in excess.\r\n *\r\n * You can configure the message to only appear after a certain percentage\r\n * of the available characters/words has been entered.\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - The element this component controls\r\n * @param {CharacterCountConfig} [config] - Character count config\r\n */\r\nfunction CharacterCount ($module, config) {\r\n  if (!$module) {\r\n    return this\r\n  }\r\n\r\n  var defaultConfig = {\r\n    threshold: 0,\r\n    i18n: CHARACTER_COUNT_TRANSLATIONS\r\n  };\r\n\r\n  // Read config set using dataset ('data-' values)\r\n  var datasetConfig = normaliseDataset($module.dataset);\r\n\r\n  // To ensure data-attributes take complete precedence, even if they change the\r\n  // type of count, we need to reset the `maxlength` and `maxwords` from the\r\n  // JavaScript config.\r\n  //\r\n  // We can't mutate `config`, though, as it may be shared across multiple\r\n  // components inside `initAll`.\r\n  var configOverrides = {};\r\n  if ('maxwords' in datasetConfig || 'maxlength' in datasetConfig) {\r\n    configOverrides = {\r\n      maxlength: false,\r\n      maxwords: false\r\n    };\r\n  }\r\n\r\n  this.config = mergeConfigs(\r\n    defaultConfig,\r\n    config || {},\r\n    configOverrides,\r\n    datasetConfig\r\n  );\r\n\r\n  this.i18n = new I18n(extractConfigByNamespace(this.config, 'i18n'), {\r\n    // Read the fallback if necessary rather than have it set in the defaults\r\n    locale: closestAttributeValue($module, 'lang')\r\n  });\r\n\r\n  // Determine the limit attribute (characters or words)\r\n  if (this.config.maxwords) {\r\n    this.maxLength = this.config.maxwords;\r\n  } else if (this.config.maxlength) {\r\n    this.maxLength = this.config.maxlength;\r\n  } else {\r\n    return\r\n  }\r\n\r\n  this.$module = $module;\r\n  this.$textarea = $module.querySelector('.govuk-js-character-count');\r\n  this.$visibleCountMessage = null;\r\n  this.$screenReaderCountMessage = null;\r\n  this.lastInputTimestamp = null;\r\n}\r\n\r\n/**\r\n * Initialise component\r\n */\r\nCharacterCount.prototype.init = function () {\r\n  // Check that required elements are present\r\n  if (!this.$textarea) {\r\n    return\r\n  }\r\n\r\n  var $textarea = this.$textarea;\r\n  var $textareaDescription = document.getElementById($textarea.id + '-info');\r\n\r\n  // Inject a decription for the textarea if none is present already\r\n  // for when the component was rendered with no maxlength, maxwords\r\n  // nor custom textareaDescriptionText\r\n  if ($textareaDescription.innerText.match(/^\\s*$/)) {\r\n    $textareaDescription.innerText = this.i18n.t('textareaDescription', { count: this.maxLength });\r\n  }\r\n\r\n  // Move the textarea description to be immediately after the textarea\r\n  // Kept for backwards compatibility\r\n  $textarea.insertAdjacentElement('afterend', $textareaDescription);\r\n\r\n  // Create the *screen reader* specific live-updating counter\r\n  // This doesn't need any styling classes, as it is never visible\r\n  var $screenReaderCountMessage = document.createElement('div');\r\n  $screenReaderCountMessage.className = 'govuk-character-count__sr-status govuk-visually-hidden';\r\n  $screenReaderCountMessage.setAttribute('aria-live', 'polite');\r\n  this.$screenReaderCountMessage = $screenReaderCountMessage;\r\n  $textareaDescription.insertAdjacentElement('afterend', $screenReaderCountMessage);\r\n\r\n  // Create our live-updating counter element, copying the classes from the\r\n  // textarea description for backwards compatibility as these may have been\r\n  // configured\r\n  var $visibleCountMessage = document.createElement('div');\r\n  $visibleCountMessage.className = $textareaDescription.className;\r\n  $visibleCountMessage.classList.add('govuk-character-count__status');\r\n  $visibleCountMessage.setAttribute('aria-hidden', 'true');\r\n  this.$visibleCountMessage = $visibleCountMessage;\r\n  $textareaDescription.insertAdjacentElement('afterend', $visibleCountMessage);\r\n\r\n  // Hide the textarea description\r\n  $textareaDescription.classList.add('govuk-visually-hidden');\r\n\r\n  // Remove hard limit if set\r\n  $textarea.removeAttribute('maxlength');\r\n\r\n  this.bindChangeEvents();\r\n\r\n  // When the page is restored after navigating 'back' in some browsers the\r\n  // state of the character count is not restored until *after* the\r\n  // DOMContentLoaded event is fired, so we need to manually update it after the\r\n  // pageshow event in browsers that support it.\r\n  if ('onpageshow' in window) {\r\n    window.addEventListener('pageshow', this.updateCountMessage.bind(this));\r\n  } else {\r\n    window.addEventListener('DOMContentLoaded', this.updateCountMessage.bind(this));\r\n  }\r\n  this.updateCountMessage();\r\n};\r\n\r\n/**\r\n * Bind change events\r\n *\r\n * Set up event listeners on the $textarea so that the count messages update\r\n * when the user types.\r\n */\r\nCharacterCount.prototype.bindChangeEvents = function () {\r\n  var $textarea = this.$textarea;\r\n  $textarea.addEventListener('keyup', this.handleKeyUp.bind(this));\r\n\r\n  // Bind focus/blur events to start/stop polling\r\n  $textarea.addEventListener('focus', this.handleFocus.bind(this));\r\n  $textarea.addEventListener('blur', this.handleBlur.bind(this));\r\n};\r\n\r\n/**\r\n * Handle key up event\r\n *\r\n * Update the visible character counter and keep track of when the last update\r\n * happened for each keypress\r\n */\r\nCharacterCount.prototype.handleKeyUp = function () {\r\n  this.updateVisibleCountMessage();\r\n  this.lastInputTimestamp = Date.now();\r\n};\r\n\r\n/**\r\n * Handle focus event\r\n *\r\n * Speech recognition software such as Dragon NaturallySpeaking will modify the\r\n * fields by directly changing its `value`. These changes don't trigger events\r\n * in JavaScript, so we need to poll to handle when and if they occur.\r\n *\r\n * Once the keyup event hasn't been detected for at least 1000 ms (1s), check if\r\n * the textarea value has changed and update the count message if it has.\r\n *\r\n * This is so that the update triggered by the manual comparison doesn't\r\n * conflict with debounced KeyboardEvent updates.\r\n */\r\nCharacterCount.prototype.handleFocus = function () {\r\n  this.valueChecker = setInterval(function () {\r\n    if (!this.lastInputTimestamp || (Date.now() - 500) >= this.lastInputTimestamp) {\r\n      this.updateIfValueChanged();\r\n    }\r\n  }.bind(this), 1000);\r\n};\r\n\r\n/**\r\n * Handle blur event\r\n *\r\n * Stop checking the textarea value once the textarea no longer has focus\r\n */\r\nCharacterCount.prototype.handleBlur = function () {\r\n  // Cancel value checking on blur\r\n  clearInterval(this.valueChecker);\r\n};\r\n\r\n/**\r\n * Update count message if textarea value has changed\r\n */\r\nCharacterCount.prototype.updateIfValueChanged = function () {\r\n  if (!this.$textarea.oldValue) this.$textarea.oldValue = '';\r\n  if (this.$textarea.value !== this.$textarea.oldValue) {\r\n    this.$textarea.oldValue = this.$textarea.value;\r\n    this.updateCountMessage();\r\n  }\r\n};\r\n\r\n/**\r\n * Update count message\r\n *\r\n * Helper function to update both the visible and screen reader-specific\r\n * counters simultaneously (e.g. on init)\r\n */\r\nCharacterCount.prototype.updateCountMessage = function () {\r\n  this.updateVisibleCountMessage();\r\n  this.updateScreenReaderCountMessage();\r\n};\r\n\r\n/**\r\n * Update visible count message\r\n */\r\nCharacterCount.prototype.updateVisibleCountMessage = function () {\r\n  var $textarea = this.$textarea;\r\n  var $visibleCountMessage = this.$visibleCountMessage;\r\n  var remainingNumber = this.maxLength - this.count($textarea.value);\r\n\r\n  // If input is over the threshold, remove the disabled class which renders the\r\n  // counter invisible.\r\n  if (this.isOverThreshold()) {\r\n    $visibleCountMessage.classList.remove('govuk-character-count__message--disabled');\r\n  } else {\r\n    $visibleCountMessage.classList.add('govuk-character-count__message--disabled');\r\n  }\r\n\r\n  // Update styles\r\n  if (remainingNumber < 0) {\r\n    $textarea.classList.add('govuk-textarea--error');\r\n    $visibleCountMessage.classList.remove('govuk-hint');\r\n    $visibleCountMessage.classList.add('govuk-error-message');\r\n  } else {\r\n    $textarea.classList.remove('govuk-textarea--error');\r\n    $visibleCountMessage.classList.remove('govuk-error-message');\r\n    $visibleCountMessage.classList.add('govuk-hint');\r\n  }\r\n\r\n  // Update message\r\n  $visibleCountMessage.innerText = this.getCountMessage();\r\n};\r\n\r\n/**\r\n * Update screen reader count message\r\n */\r\nCharacterCount.prototype.updateScreenReaderCountMessage = function () {\r\n  var $screenReaderCountMessage = this.$screenReaderCountMessage;\r\n\r\n  // If over the threshold, remove the aria-hidden attribute, allowing screen\r\n  // readers to announce the content of the element.\r\n  if (this.isOverThreshold()) {\r\n    $screenReaderCountMessage.removeAttribute('aria-hidden');\r\n  } else {\r\n    $screenReaderCountMessage.setAttribute('aria-hidden', true);\r\n  }\r\n\r\n  // Update message\r\n  $screenReaderCountMessage.innerText = this.getCountMessage();\r\n};\r\n\r\n/**\r\n * Count the number of characters (or words, if `config.maxwords` is set)\r\n * in the given text\r\n *\r\n * @param {string} text - The text to count the characters of\r\n * @returns {number} the number of characters (or words) in the text\r\n */\r\nCharacterCount.prototype.count = function (text) {\r\n  if (this.config.maxwords) {\r\n    var tokens = text.match(/\\S+/g) || []; // Matches consecutive non-whitespace chars\r\n    return tokens.length\r\n  } else {\r\n    return text.length\r\n  }\r\n};\r\n\r\n/**\r\n * Get count message\r\n *\r\n * @returns {string} Status message\r\n */\r\nCharacterCount.prototype.getCountMessage = function () {\r\n  var remainingNumber = this.maxLength - this.count(this.$textarea.value);\r\n\r\n  var countType = this.config.maxwords ? 'words' : 'characters';\r\n  return this.formatCountMessage(remainingNumber, countType)\r\n};\r\n\r\n/**\r\n * Formats the message shown to users according to what's counted\r\n * and how many remain\r\n *\r\n * @param {number} remainingNumber - The number of words/characaters remaining\r\n * @param {string} countType - \"words\" or \"characters\"\r\n * @returns {string} Status message\r\n */\r\nCharacterCount.prototype.formatCountMessage = function (remainingNumber, countType) {\r\n  if (remainingNumber === 0) {\r\n    return this.i18n.t(countType + 'AtLimit')\r\n  }\r\n\r\n  var translationKeySuffix = remainingNumber < 0 ? 'OverLimit' : 'UnderLimit';\r\n\r\n  return this.i18n.t(countType + translationKeySuffix, { count: Math.abs(remainingNumber) })\r\n};\r\n\r\n/**\r\n * Check if count is over threshold\r\n *\r\n * Checks whether the value is over the configured threshold for the input.\r\n * If there is no configured threshold, it is set to 0 and this function will\r\n * always return true.\r\n *\r\n * @returns {boolean} true if the current count is over the config.threshold\r\n *   (or no threshold is set)\r\n */\r\nCharacterCount.prototype.isOverThreshold = function () {\r\n  // No threshold means we're always above threshold so save some computation\r\n  if (!this.config.threshold) {\r\n    return true\r\n  }\r\n\r\n  var $textarea = this.$textarea;\r\n\r\n  // Determine the remaining number of characters/words\r\n  var currentLength = this.count($textarea.value);\r\n  var maxLength = this.maxLength;\r\n\r\n  var thresholdValue = maxLength * this.config.threshold / 100;\r\n\r\n  return (thresholdValue <= currentLength)\r\n};\r\n\r\n/**\r\n * Character count config\r\n *\r\n * @typedef {CharacterCountConfigWithMaxLength | CharacterCountConfigWithMaxWords} CharacterCountConfig\r\n */\r\n\r\n/**\r\n * Character count config (with maximum number of characters)\r\n *\r\n * @typedef {object} CharacterCountConfigWithMaxLength\r\n * @property {number} [maxlength] - The maximum number of characters.\r\n *  If maxwords is provided, the maxlength option will be ignored.\r\n * @property {number} [threshold = 0] - The percentage value of the limit at\r\n *  which point the count message is displayed. If this attribute is set, the\r\n *  count message will be hidden by default.\r\n * @property {CharacterCountTranslations} [i18n = CHARACTER_COUNT_TRANSLATIONS] - See constant {@link CHARACTER_COUNT_TRANSLATIONS}\r\n */\r\n\r\n/**\r\n * Character count config (with maximum number of words)\r\n *\r\n * @typedef {object} CharacterCountConfigWithMaxWords\r\n * @property {number} [maxwords] - The maximum number of words. If maxwords is\r\n *  provided, the maxlength option will be ignored.\r\n * @property {number} [threshold = 0] - The percentage value of the limit at\r\n *  which point the count message is displayed. If this attribute is set, the\r\n *  count message will be hidden by default.\r\n * @property {CharacterCountTranslations} [i18n = CHARACTER_COUNT_TRANSLATIONS] - See constant {@link CHARACTER_COUNT_TRANSLATIONS}\r\n */\r\n\r\n/**\r\n * Character count translations\r\n *\r\n * @typedef {object} CharacterCountTranslations\r\n *\r\n * Messages shown to users as they type. It provides feedback on how many words\r\n * or characters they have remaining or if they are over the limit. This also\r\n * includes a message used as an accessible description for the textarea.\r\n * @property {TranslationPluralForms} [charactersUnderLimit] - Message displayed\r\n *   when the number of characters is under the configured maximum, `maxlength`.\r\n *   This message is displayed visually and through assistive technologies. The\r\n *   component will replace the `%{count}` placeholder with the number of\r\n *   remaining characters. This is a [pluralised list of\r\n *   messages](https://frontend.design-system.service.gov.uk/localise-govuk-frontend).\r\n * @property {string} [charactersAtLimit] - Message displayed when the number of\r\n *   characters reaches the configured maximum, `maxlength`. This message is\r\n *   displayed visually and through assistive technologies.\r\n * @property {TranslationPluralForms} [charactersOverLimit] - Message displayed\r\n *   when the number of characters is over the configured maximum, `maxlength`.\r\n *   This message is displayed visually and through assistive technologies. The\r\n *   component will replace the `%{count}` placeholder with the number of\r\n *   remaining characters. This is a [pluralised list of\r\n *   messages](https://frontend.design-system.service.gov.uk/localise-govuk-frontend).\r\n * @property {TranslationPluralForms} [wordsUnderLimit] - Message displayed when\r\n *   the number of words is under the configured maximum, `maxlength`. This\r\n *   message is displayed visually and through assistive technologies. The\r\n *   component will replace the `%{count}` placeholder with the number of\r\n *   remaining words. This is a [pluralised list of\r\n *   messages](https://frontend.design-system.service.gov.uk/localise-govuk-frontend).\r\n * @property {string} [wordsAtLimit] - Message displayed when the number of\r\n *   words reaches the configured maximum, `maxlength`. This message is\r\n *   displayed visually and through assistive technologies.\r\n * @property {TranslationPluralForms} [wordsOverLimit] - Message displayed when\r\n *   the number of words is over the configured maximum, `maxlength`. This\r\n *   message is displayed visually and through assistive technologies. The\r\n *   component will replace the `%{count}` placeholder with the number of\r\n *   remaining words. This is a [pluralised list of\r\n *   messages](https://frontend.design-system.service.gov.uk/localise-govuk-frontend).\r\n * @property {TranslationPluralForms} [textareaDescription] - Message made\r\n *   available to assistive technologies, if none is already present in the\r\n *   HTML, to describe that the component accepts only a limited amount of\r\n *   content. It is visible on the page when JavaScript is unavailable. The\r\n *   component will replace the `%{count}` placeholder with the value of the\r\n *   `maxlength` or `maxwords` parameter.\r\n */\r\n\r\n/**\r\n * @typedef {import('../../i18n.mjs').TranslationPluralForms} TranslationPluralForms\r\n */\r\n\r\n/**\r\n * Checkboxes component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for checkboxes\r\n */\r\nfunction Checkboxes ($module) {\r\n  this.$module = $module;\r\n  this.$inputs = $module.querySelectorAll('input[type=\"checkbox\"]');\r\n}\r\n\r\n/**\r\n * Initialise Checkboxes\r\n *\r\n * Checkboxes can be associated with a 'conditionally revealed' content block \r\n * for example, a checkbox for 'Phone' could reveal an additional form field for\r\n * the user to enter their phone number.\r\n *\r\n * These associations are made using a `data-aria-controls` attribute, which is\r\n * promoted to an aria-controls attribute during initialisation.\r\n *\r\n * We also need to restore the state of any conditional reveals on the page (for\r\n * example if the user has navigated back), and set up event handlers to keep\r\n * the reveal in sync with the checkbox state.\r\n */\r\nCheckboxes.prototype.init = function () {\r\n  var $module = this.$module;\r\n  var $inputs = this.$inputs;\r\n\r\n  nodeListForEach($inputs, function ($input) {\r\n    var target = $input.getAttribute('data-aria-controls');\r\n\r\n    // Skip checkboxes without data-aria-controls attributes, or where the\r\n    // target element does not exist.\r\n    if (!target || !document.getElementById(target)) {\r\n      return\r\n    }\r\n\r\n    // Promote the data-aria-controls attribute to a aria-controls attribute\r\n    // so that the relationship is exposed in the AOM\r\n    $input.setAttribute('aria-controls', target);\r\n    $input.removeAttribute('data-aria-controls');\r\n  });\r\n\r\n  // When the page is restored after navigating 'back' in some browsers the\r\n  // state of form controls is not restored until *after* the DOMContentLoaded\r\n  // event is fired, so we need to sync after the pageshow event in browsers\r\n  // that support it.\r\n  if ('onpageshow' in window) {\r\n    window.addEventListener('pageshow', this.syncAllConditionalReveals.bind(this));\r\n  } else {\r\n    window.addEventListener('DOMContentLoaded', this.syncAllConditionalReveals.bind(this));\r\n  }\r\n\r\n  // Although we've set up handlers to sync state on the pageshow or\r\n  // DOMContentLoaded event, init could be called after those events have fired,\r\n  // for example if they are added to the page dynamically, so sync now too.\r\n  this.syncAllConditionalReveals();\r\n\r\n  $module.addEventListener('click', this.handleClick.bind(this));\r\n};\r\n\r\n/**\r\n * Sync the conditional reveal states for all inputs in this $module.\r\n */\r\nCheckboxes.prototype.syncAllConditionalReveals = function () {\r\n  nodeListForEach(this.$inputs, this.syncConditionalRevealWithInputState.bind(this));\r\n};\r\n\r\n/**\r\n * Sync conditional reveal with the input state\r\n *\r\n * Synchronise the visibility of the conditional reveal, and its accessible\r\n * state, with the input's checked state.\r\n *\r\n * @param {HTMLInputElement} $input - Checkbox input\r\n */\r\nCheckboxes.prototype.syncConditionalRevealWithInputState = function ($input) {\r\n  var $target = document.getElementById($input.getAttribute('aria-controls'));\r\n\r\n  if ($target && $target.classList.contains('govuk-checkboxes__conditional')) {\r\n    var inputIsChecked = $input.checked;\r\n\r\n    $input.setAttribute('aria-expanded', inputIsChecked);\r\n    $target.classList.toggle('govuk-checkboxes__conditional--hidden', !inputIsChecked);\r\n  }\r\n};\r\n\r\n/**\r\n * Uncheck other checkboxes\r\n *\r\n * Find any other checkbox inputs with the same name value, and uncheck them.\r\n * This is useful for when a None of these\" checkbox is checked.\r\n */\r\nCheckboxes.prototype.unCheckAllInputsExcept = function ($input) {\r\n  var allInputsWithSameName = document.querySelectorAll('input[type=\"checkbox\"][name=\"' + $input.name + '\"]');\r\n\r\n  nodeListForEach(allInputsWithSameName, function ($inputWithSameName) {\r\n    var hasSameFormOwner = ($input.form === $inputWithSameName.form);\r\n    if (hasSameFormOwner && $inputWithSameName !== $input) {\r\n      $inputWithSameName.checked = false;\r\n      this.syncConditionalRevealWithInputState($inputWithSameName);\r\n    }\r\n  }.bind(this));\r\n};\r\n\r\n/**\r\n * Uncheck exclusive inputs\r\n *\r\n * Find any checkbox inputs with the same name value and the 'exclusive' behaviour,\r\n * and uncheck them. This helps prevent someone checking both a regular checkbox and a\r\n * \"None of these\" checkbox in the same fieldset.\r\n */\r\nCheckboxes.prototype.unCheckExclusiveInputs = function ($input) {\r\n  var allInputsWithSameNameAndExclusiveBehaviour = document.querySelectorAll(\r\n    'input[data-behaviour=\"exclusive\"][type=\"checkbox\"][name=\"' + $input.name + '\"]'\r\n  );\r\n\r\n  nodeListForEach(allInputsWithSameNameAndExclusiveBehaviour, function ($exclusiveInput) {\r\n    var hasSameFormOwner = ($input.form === $exclusiveInput.form);\r\n    if (hasSameFormOwner) {\r\n      $exclusiveInput.checked = false;\r\n      this.syncConditionalRevealWithInputState($exclusiveInput);\r\n    }\r\n  }.bind(this));\r\n};\r\n\r\n/**\r\n * Click event handler\r\n *\r\n * Handle a click within the $module  if the click occurred on a checkbox, sync\r\n * the state of any associated conditional reveal with the checkbox state.\r\n *\r\n * @param {MouseEvent} event - Click event\r\n */\r\nCheckboxes.prototype.handleClick = function (event) {\r\n  var $target = event.target;\r\n\r\n  // Ignore clicks on things that aren't checkbox inputs\r\n  if ($target.type !== 'checkbox') {\r\n    return\r\n  }\r\n\r\n  // If the checkbox conditionally-reveals some content, sync the state\r\n  var hasAriaControls = $target.getAttribute('aria-controls');\r\n  if (hasAriaControls) {\r\n    this.syncConditionalRevealWithInputState($target);\r\n  }\r\n\r\n  // No further behaviour needed for unchecking\r\n  if (!$target.checked) {\r\n    return\r\n  }\r\n\r\n  // Handle 'exclusive' checkbox behaviour (ie \"None of these\")\r\n  var hasBehaviourExclusive = ($target.getAttribute('data-behaviour') === 'exclusive');\r\n  if (hasBehaviourExclusive) {\r\n    this.unCheckAllInputsExcept($target);\r\n  } else {\r\n    this.unCheckExclusiveInputs($target);\r\n  }\r\n};\r\n\r\n/**\r\n * JavaScript enhancements for the ErrorSummary\r\n *\r\n * Takes focus on initialisation for accessible announcement, unless disabled in configuration.\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - The element this component controls\r\n * @param {ErrorSummaryConfig} config - Error summary config\r\n */\r\nfunction ErrorSummary ($module, config) {\r\n  // Some consuming code may not be passing a module,\r\n  // for example if they initialise the component\r\n  // on their own by directly passing the result\r\n  // of `document.querySelector`.\r\n  // To avoid breaking further JavaScript initialisation\r\n  // we need to safeguard against this so things keep\r\n  // working the same now we read the elements data attributes\r\n  if (!$module) {\r\n    // Little safety in case code gets ported as-is\r\n    // into and ES6 class constructor, where the return value matters\r\n    return this\r\n  }\r\n\r\n  this.$module = $module;\r\n\r\n  var defaultConfig = {\r\n    disableAutoFocus: false\r\n  };\r\n  this.config = mergeConfigs(\r\n    defaultConfig,\r\n    config || {},\r\n    normaliseDataset($module.dataset)\r\n  );\r\n}\r\n\r\nErrorSummary.prototype.init = function () {\r\n  var $module = this.$module;\r\n  if (!$module) {\r\n    return\r\n  }\r\n\r\n  this.setFocus();\r\n  $module.addEventListener('click', this.handleClick.bind(this));\r\n};\r\n\r\n/**\r\n * Focus the error summary\r\n */\r\nErrorSummary.prototype.setFocus = function () {\r\n  var $module = this.$module;\r\n\r\n  if (this.config.disableAutoFocus) {\r\n    return\r\n  }\r\n\r\n  // Set tabindex to -1 to make the element programmatically focusable, but\r\n  // remove it on blur as the error summary doesn't need to be focused again.\r\n  $module.setAttribute('tabindex', '-1');\r\n\r\n  $module.addEventListener('blur', function () {\r\n    $module.removeAttribute('tabindex');\r\n  });\r\n\r\n  $module.focus();\r\n};\r\n\r\n/**\r\n * Click event handler\r\n *\r\n * @param {MouseEvent} event - Click event\r\n */\r\nErrorSummary.prototype.handleClick = function (event) {\r\n  var target = event.target;\r\n  if (this.focusTarget(target)) {\r\n    event.preventDefault();\r\n  }\r\n};\r\n\r\n/**\r\n * Focus the target element\r\n *\r\n * By default, the browser will scroll the target into view. Because our labels\r\n * or legends appear above the input, this means the user will be presented with\r\n * an input without any context, as the label or legend will be off the top of\r\n * the screen.\r\n *\r\n * Manually handling the click event, scrolling the question into view and then\r\n * focussing the element solves this.\r\n *\r\n * This also results in the label and/or legend being announced correctly in\r\n * NVDA (as tested in 2018.3.2) - without this only the field type is announced\r\n * (e.g. \"Edit, has autocomplete\").\r\n *\r\n * @param {HTMLElement} $target - Event target\r\n * @returns {boolean} True if the target was able to be focussed\r\n */\r\nErrorSummary.prototype.focusTarget = function ($target) {\r\n  // If the element that was clicked was not a link, return early\r\n  if ($target.tagName !== 'A' || $target.href === false) {\r\n    return false\r\n  }\r\n\r\n  var inputId = this.getFragmentFromUrl($target.href);\r\n  var $input = document.getElementById(inputId);\r\n  if (!$input) {\r\n    return false\r\n  }\r\n\r\n  var $legendOrLabel = this.getAssociatedLegendOrLabel($input);\r\n  if (!$legendOrLabel) {\r\n    return false\r\n  }\r\n\r\n  // Scroll the legend or label into view *before* calling focus on the input to\r\n  // avoid extra scrolling in browsers that don't support `preventScroll` (which\r\n  // at time of writing is most of them...)\r\n  $legendOrLabel.scrollIntoView();\r\n  $input.focus({ preventScroll: true });\r\n\r\n  return true\r\n};\r\n\r\n/**\r\n * Get fragment from URL\r\n *\r\n * Extract the fragment (everything after the hash) from a URL, but not including\r\n * the hash.\r\n *\r\n * @param {string} url - URL\r\n * @returns {string} Fragment from URL, without the hash\r\n */\r\nErrorSummary.prototype.getFragmentFromUrl = function (url) {\r\n  if (url.indexOf('#') === -1) {\r\n    return false\r\n  }\r\n\r\n  return url.split('#').pop()\r\n};\r\n\r\n/**\r\n * Get associated legend or label\r\n *\r\n * Returns the first element that exists from this list:\r\n *\r\n * - The `<legend>` associated with the closest `<fieldset>` ancestor, as long\r\n *   as the top of it is no more than half a viewport height away from the\r\n *   bottom of the input\r\n * - The first `<label>` that is associated with the input using for=\"inputId\"\r\n * - The closest parent `<label>`\r\n *\r\n * @param {HTMLElement} $input - The input\r\n * @returns {HTMLElement} Associated legend or label, or null if no associated\r\n *                        legend or label can be found\r\n */\r\nErrorSummary.prototype.getAssociatedLegendOrLabel = function ($input) {\r\n  var $fieldset = $input.closest('fieldset');\r\n\r\n  if ($fieldset) {\r\n    var legends = $fieldset.getElementsByTagName('legend');\r\n\r\n    if (legends.length) {\r\n      var $candidateLegend = legends[0];\r\n\r\n      // If the input type is radio or checkbox, always use the legend if there\r\n      // is one.\r\n      if ($input.type === 'checkbox' || $input.type === 'radio') {\r\n        return $candidateLegend\r\n      }\r\n\r\n      // For other input types, only scroll to the fieldsets legend (instead of\r\n      // the label associated with the input) if the input would end up in the\r\n      // top half of the screen.\r\n      //\r\n      // This should avoid situations where the input either ends up off the\r\n      // screen, or obscured by a software keyboard.\r\n      var legendTop = $candidateLegend.getBoundingClientRect().top;\r\n      var inputRect = $input.getBoundingClientRect();\r\n\r\n      // If the browser doesn't support Element.getBoundingClientRect().height\r\n      // or window.innerHeight (like IE8), bail and just link to the label.\r\n      if (inputRect.height && window.innerHeight) {\r\n        var inputBottom = inputRect.top + inputRect.height;\r\n\r\n        if (inputBottom - legendTop < window.innerHeight / 2) {\r\n          return $candidateLegend\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return document.querySelector(\"label[for='\" + $input.getAttribute('id') + \"']\") ||\r\n    $input.closest('label')\r\n};\r\n\r\n/**\r\n * Error summary config\r\n *\r\n * @typedef {object} ErrorSummaryConfig\r\n * @property {boolean} [disableAutoFocus = false] -\r\n *  If set to `true` the error summary will not be focussed when the page loads.\r\n */\r\n\r\n/**\r\n * Notification Banner component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for notification banner\r\n * @param {NotificationBannerConfig} config - Notification banner config\r\n */\r\nfunction NotificationBanner ($module, config) {\r\n  this.$module = $module;\r\n\r\n  var defaultConfig = {\r\n    disableAutoFocus: false\r\n  };\r\n  this.config = mergeConfigs(\r\n    defaultConfig,\r\n    config || {},\r\n    normaliseDataset($module.dataset)\r\n  );\r\n}\r\n\r\n/**\r\n * Initialise the component\r\n */\r\nNotificationBanner.prototype.init = function () {\r\n  var $module = this.$module;\r\n  // Check for module\r\n  if (!$module) {\r\n    return\r\n  }\r\n\r\n  this.setFocus();\r\n};\r\n\r\n/**\r\n * Focus the element\r\n *\r\n * If `role=\"alert\"` is set, focus the element to help some assistive technologies\r\n * prioritise announcing it.\r\n *\r\n * You can turn off the auto-focus functionality by setting `data-disable-auto-focus=\"true\"` in the\r\n * component HTML. You might wish to do this based on user research findings, or to avoid a clash\r\n * with another element which should be focused when the page loads.\r\n */\r\nNotificationBanner.prototype.setFocus = function () {\r\n  var $module = this.$module;\r\n\r\n  if (this.config.disableAutoFocus) {\r\n    return\r\n  }\r\n\r\n  if ($module.getAttribute('role') !== 'alert') {\r\n    return\r\n  }\r\n\r\n  // Set tabindex to -1 to make the element focusable with JavaScript.\r\n  // Remove the tabindex on blur as the component doesn't need to be focusable after the page has\r\n  // loaded.\r\n  if (!$module.getAttribute('tabindex')) {\r\n    $module.setAttribute('tabindex', '-1');\r\n\r\n    $module.addEventListener('blur', function () {\r\n      $module.removeAttribute('tabindex');\r\n    });\r\n  }\r\n\r\n  $module.focus();\r\n};\r\n\r\n/**\r\n * Notification banner config\r\n *\r\n * @typedef {object} NotificationBannerConfig\r\n * @property {boolean} [disableAutoFocus = false] -\r\n *   If set to `true` the notification banner will not be focussed when the page\r\n *   loads. This only applies if the component has a `role` of `alert`  in\r\n *   other cases the component will not be focused on page load, regardless of\r\n *   this option.\r\n */\r\n\r\n/**\r\n * Header component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for header\r\n */\r\nfunction Header ($module) {\r\n  this.$module = $module;\r\n  this.$menuButton = $module && $module.querySelector('.govuk-js-header-toggle');\r\n  this.$menu = this.$menuButton && $module.querySelector(\r\n    '#' + this.$menuButton.getAttribute('aria-controls')\r\n  );\r\n\r\n  // Save the opened/closed state for the nav in memory so that we can\r\n  // accurately maintain state when the screen is changed from small to\r\n  // big and back to small\r\n  this.menuIsOpen = false;\r\n\r\n  // A global const for storing a matchMedia instance which we'll use to\r\n  // detect when a screen size change happens. We set this later during the\r\n  // init function and rely on it being null if the feature isn't available\r\n  // to initially apply hidden attributes\r\n  this.mql = null;\r\n}\r\n\r\n/**\r\n * Initialise header\r\n *\r\n * Check for the presence of the header, menu and menu button  if any are\r\n * missing then there's nothing to do so return early.\r\n * Feature sniff for and apply a matchMedia for desktop which will\r\n * trigger a state sync if the browser viewport moves between states. If\r\n * matchMedia isn't available, hide the menu button and present the \"no js\"\r\n * version of the menu to the user.\r\n */\r\nHeader.prototype.init = function () {\r\n  if (!this.$module || !this.$menuButton || !this.$menu) {\r\n    return\r\n  }\r\n\r\n  if ('matchMedia' in window) {\r\n    // Set the matchMedia to the govuk-frontend desktop breakpoint\r\n    this.mql = window.matchMedia('(min-width: 48.0625em)');\r\n\r\n    if ('addEventListener' in this.mql) {\r\n      this.mql.addEventListener('change', this.syncState.bind(this));\r\n    } else {\r\n      // addListener is a deprecated function, however addEventListener\r\n      // isn't supported by IE or Safari. We therefore add this in as\r\n      // a fallback for those browsers\r\n      this.mql.addListener(this.syncState.bind(this));\r\n    }\r\n\r\n    this.syncState();\r\n    this.$menuButton.addEventListener('click', this.handleMenuButtonClick.bind(this));\r\n  } else {\r\n    this.$menuButton.setAttribute('hidden', '');\r\n  }\r\n};\r\n\r\n/**\r\n * Sync menu state\r\n *\r\n * Uses the global variable menuIsOpen to correctly set the accessible and\r\n * visual states of the menu and the menu button.\r\n * Additionally will force the menu to be visible and the menu button to be\r\n * hidden if the matchMedia is triggered to desktop.\r\n */\r\nHeader.prototype.syncState = function () {\r\n  if (this.mql.matches) {\r\n    this.$menu.removeAttribute('hidden');\r\n    this.$menuButton.setAttribute('hidden', '');\r\n  } else {\r\n    this.$menuButton.removeAttribute('hidden');\r\n    this.$menuButton.setAttribute('aria-expanded', this.menuIsOpen);\r\n\r\n    if (this.menuIsOpen) {\r\n      this.$menu.removeAttribute('hidden');\r\n    } else {\r\n      this.$menu.setAttribute('hidden', '');\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Handle menu button click\r\n *\r\n * When the menu button is clicked, change the visibility of the menu and then\r\n * sync the accessibility state and menu button state\r\n */\r\nHeader.prototype.handleMenuButtonClick = function () {\r\n  this.menuIsOpen = !this.menuIsOpen;\r\n  this.syncState();\r\n};\r\n\r\n/**\r\n * Radios component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for radios\r\n */\r\nfunction Radios ($module) {\r\n  this.$module = $module;\r\n  this.$inputs = $module.querySelectorAll('input[type=\"radio\"]');\r\n}\r\n\r\n/**\r\n * Initialise Radios\r\n *\r\n * Radios can be associated with a 'conditionally revealed' content block  for\r\n * example, a radio for 'Phone' could reveal an additional form field for the\r\n * user to enter their phone number.\r\n *\r\n * These associations are made using a `data-aria-controls` attribute, which is\r\n * promoted to an aria-controls attribute during initialisation.\r\n *\r\n * We also need to restore the state of any conditional reveals on the page (for\r\n * example if the user has navigated back), and set up event handlers to keep\r\n * the reveal in sync with the radio state.\r\n */\r\nRadios.prototype.init = function () {\r\n  var $module = this.$module;\r\n  var $inputs = this.$inputs;\r\n\r\n  nodeListForEach($inputs, function ($input) {\r\n    var target = $input.getAttribute('data-aria-controls');\r\n\r\n    // Skip radios without data-aria-controls attributes, or where the\r\n    // target element does not exist.\r\n    if (!target || !document.getElementById(target)) {\r\n      return\r\n    }\r\n\r\n    // Promote the data-aria-controls attribute to a aria-controls attribute\r\n    // so that the relationship is exposed in the AOM\r\n    $input.setAttribute('aria-controls', target);\r\n    $input.removeAttribute('data-aria-controls');\r\n  });\r\n\r\n  // When the page is restored after navigating 'back' in some browsers the\r\n  // state of form controls is not restored until *after* the DOMContentLoaded\r\n  // event is fired, so we need to sync after the pageshow event in browsers\r\n  // that support it.\r\n  if ('onpageshow' in window) {\r\n    window.addEventListener('pageshow', this.syncAllConditionalReveals.bind(this));\r\n  } else {\r\n    window.addEventListener('DOMContentLoaded', this.syncAllConditionalReveals.bind(this));\r\n  }\r\n\r\n  // Although we've set up handlers to sync state on the pageshow or\r\n  // DOMContentLoaded event, init could be called after those events have fired,\r\n  // for example if they are added to the page dynamically, so sync now too.\r\n  this.syncAllConditionalReveals();\r\n\r\n  // Handle events\r\n  $module.addEventListener('click', this.handleClick.bind(this));\r\n};\r\n\r\n/**\r\n * Sync the conditional reveal states for all inputs in this $module.\r\n */\r\nRadios.prototype.syncAllConditionalReveals = function () {\r\n  nodeListForEach(this.$inputs, this.syncConditionalRevealWithInputState.bind(this));\r\n};\r\n\r\n/**\r\n * Sync conditional reveal with the input state\r\n *\r\n * Synchronise the visibility of the conditional reveal, and its accessible\r\n * state, with the input's checked state.\r\n *\r\n * @param {HTMLInputElement} $input - Radio input\r\n */\r\nRadios.prototype.syncConditionalRevealWithInputState = function ($input) {\r\n  var $target = document.getElementById($input.getAttribute('aria-controls'));\r\n\r\n  if ($target && $target.classList.contains('govuk-radios__conditional')) {\r\n    var inputIsChecked = $input.checked;\r\n\r\n    $input.setAttribute('aria-expanded', inputIsChecked);\r\n    $target.classList.toggle('govuk-radios__conditional--hidden', !inputIsChecked);\r\n  }\r\n};\r\n\r\n/**\r\n * Click event handler\r\n *\r\n * Handle a click within the $module  if the click occurred on a radio, sync\r\n * the state of the conditional reveal for all radio buttons in the same form\r\n * with the same name (because checking one radio could have un-checked a radio\r\n * in another $module)\r\n *\r\n * @param {MouseEvent} event - Click event\r\n */\r\nRadios.prototype.handleClick = function (event) {\r\n  var $clickedInput = event.target;\r\n\r\n  // Ignore clicks on things that aren't radio buttons\r\n  if ($clickedInput.type !== 'radio') {\r\n    return\r\n  }\r\n\r\n  // We only need to consider radios with conditional reveals, which will have\r\n  // aria-controls attributes.\r\n  var $allInputs = document.querySelectorAll('input[type=\"radio\"][aria-controls]');\r\n\r\n  nodeListForEach($allInputs, function ($input) {\r\n    var hasSameFormOwner = ($input.form === $clickedInput.form);\r\n    var hasSameName = ($input.name === $clickedInput.name);\r\n\r\n    if (hasSameName && hasSameFormOwner) {\r\n      this.syncConditionalRevealWithInputState($input);\r\n    }\r\n  }.bind(this));\r\n};\r\n\r\n/**\r\n * Skip link component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for skip link\r\n */\r\nfunction SkipLink ($module) {\r\n  this.$module = $module;\r\n  this.$linkedElement = null;\r\n  this.linkedElementListener = false;\r\n}\r\n\r\n/**\r\n * Initialise the component\r\n */\r\nSkipLink.prototype.init = function () {\r\n  // Check for module\r\n  if (!this.$module) {\r\n    return\r\n  }\r\n\r\n  // Check for linked element\r\n  this.$linkedElement = this.getLinkedElement();\r\n  if (!this.$linkedElement) {\r\n    return\r\n  }\r\n\r\n  this.$module.addEventListener('click', this.focusLinkedElement.bind(this));\r\n};\r\n\r\n/**\r\n * Get linked element\r\n *\r\n * @returns {HTMLElement} $linkedElement - DOM element linked to from the skip link\r\n */\r\nSkipLink.prototype.getLinkedElement = function () {\r\n  var linkedElementId = this.getFragmentFromUrl();\r\n\r\n  if (!linkedElementId) {\r\n    return false\r\n  }\r\n\r\n  return document.getElementById(linkedElementId)\r\n};\r\n\r\n/**\r\n * Focus the linked element\r\n *\r\n * Set tabindex and helper CSS class. Set listener to remove them on blur.\r\n */\r\nSkipLink.prototype.focusLinkedElement = function () {\r\n  var $linkedElement = this.$linkedElement;\r\n\r\n  if (!$linkedElement.getAttribute('tabindex')) {\r\n    // Set the element tabindex to -1 so it can be focused with JavaScript.\r\n    $linkedElement.setAttribute('tabindex', '-1');\r\n    $linkedElement.classList.add('govuk-skip-link-focused-element');\r\n\r\n    // Add listener for blur on the focused element (unless the listener has previously been added)\r\n    if (!this.linkedElementListener) {\r\n      this.$linkedElement.addEventListener('blur', this.removeFocusProperties.bind(this));\r\n      this.linkedElementListener = true;\r\n    }\r\n  }\r\n  $linkedElement.focus();\r\n};\r\n\r\n/**\r\n * Remove the tabindex that makes the linked element focusable because the element only needs to be\r\n * focusable until it has received programmatic focus and a screen reader has announced it.\r\n *\r\n * Remove the CSS class that removes the native focus styles.\r\n */\r\nSkipLink.prototype.removeFocusProperties = function () {\r\n  this.$linkedElement.removeAttribute('tabindex');\r\n  this.$linkedElement.classList.remove('govuk-skip-link-focused-element');\r\n};\r\n\r\n/**\r\n * Get fragment from URL\r\n *\r\n * Extract the fragment (everything after the hash symbol) from a URL, but not including\r\n * the symbol.\r\n *\r\n * @returns {string} Fragment from URL, without the hash symbol\r\n */\r\nSkipLink.prototype.getFragmentFromUrl = function () {\r\n  // Bail if the anchor link doesn't have a hash\r\n  if (!this.$module.hash) {\r\n    return false\r\n  }\r\n\r\n  return this.$module.hash.split('#').pop()\r\n};\r\n\r\n(function(undefined) {\r\n\r\n    // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-library/master/polyfills/Element/prototype/nextElementSibling/detect.js\r\n    var detect = (\r\n      'document' in this && \"nextElementSibling\" in document.documentElement\r\n    );\r\n\r\n    if (detect) return\r\n\r\n    // Polyfill from https://raw.githubusercontent.com/Financial-Times/polyfill-library/master/polyfills/Element/prototype/nextElementSibling/polyfill.js\r\n    Object.defineProperty(Element.prototype, \"nextElementSibling\", {\r\n      get: function(){\r\n        var el = this.nextSibling;\r\n        while (el && el.nodeType !== 1) { el = el.nextSibling; }\r\n        return el;\r\n      }\r\n    });\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n(function(undefined) {\r\n\r\n    // Detection from https://raw.githubusercontent.com/Financial-Times/polyfill-library/master/polyfills/Element/prototype/previousElementSibling/detect.js\r\n    var detect = (\r\n      'document' in this && \"previousElementSibling\" in document.documentElement\r\n    );\r\n\r\n    if (detect) return\r\n\r\n    // Polyfill from https://raw.githubusercontent.com/Financial-Times/polyfill-library/master/polyfills/Element/prototype/previousElementSibling/polyfill.js\r\n    Object.defineProperty(Element.prototype, 'previousElementSibling', {\r\n      get: function(){\r\n        var el = this.previousSibling;\r\n        while (el && el.nodeType !== 1) { el = el.previousSibling; }\r\n        return el;\r\n      }\r\n    });\r\n\r\n}).call('object' === typeof window && window || 'object' === typeof self && self || 'object' === typeof global && global || {});\r\n\r\n/**\r\n * Tabs component\r\n *\r\n * @class\r\n * @param {HTMLElement} $module - HTML element to use for tabs\r\n */\r\nfunction Tabs ($module) {\r\n  this.$module = $module;\r\n  this.$tabs = $module.querySelectorAll('.govuk-tabs__tab');\r\n\r\n  this.keys = { left: 37, right: 39, up: 38, down: 40 };\r\n  this.jsHiddenClass = 'govuk-tabs__panel--hidden';\r\n}\r\n\r\nTabs.prototype.init = function () {\r\n  if (typeof window.matchMedia === 'function') {\r\n    this.setupResponsiveChecks();\r\n  } else {\r\n    this.setup();\r\n  }\r\n};\r\n\r\nTabs.prototype.setupResponsiveChecks = function () {\r\n  this.mql = window.matchMedia('(min-width: 40.0625em)');\r\n  this.mql.addListener(this.checkMode.bind(this));\r\n  this.checkMode();\r\n};\r\n\r\nTabs.prototype.checkMode = function () {\r\n  if (this.mql.matches) {\r\n    this.setup();\r\n  } else {\r\n    this.teardown();\r\n  }\r\n};\r\n\r\nTabs.prototype.setup = function () {\r\n  var $module = this.$module;\r\n  var $tabs = this.$tabs;\r\n  var $tabList = $module.querySelector('.govuk-tabs__list');\r\n  var $tabListItems = $module.querySelectorAll('.govuk-tabs__list-item');\r\n\r\n  if (!$tabs || !$tabList || !$tabListItems) {\r\n    return\r\n  }\r\n\r\n  $tabList.setAttribute('role', 'tablist');\r\n\r\n  nodeListForEach($tabListItems, function ($item) {\r\n    $item.setAttribute('role', 'presentation');\r\n  });\r\n\r\n  nodeListForEach($tabs, function ($tab) {\r\n    // Set HTML attributes\r\n    this.setAttributes($tab);\r\n\r\n    // Save bounded functions to use when removing event listeners during teardown\r\n    $tab.boundTabClick = this.onTabClick.bind(this);\r\n    $tab.boundTabKeydown = this.onTabKeydown.bind(this);\r\n\r\n    // Handle events\r\n    $tab.addEventListener('click', $tab.boundTabClick, true);\r\n    $tab.addEventListener('keydown', $tab.boundTabKeydown, true);\r\n\r\n    // Remove old active panels\r\n    this.hideTab($tab);\r\n  }.bind(this));\r\n\r\n  // Show either the active tab according to the URL's hash or the first tab\r\n  var $activeTab = this.getTab(window.location.hash) || this.$tabs[0];\r\n  this.showTab($activeTab);\r\n\r\n  // Handle hashchange events\r\n  $module.boundOnHashChange = this.onHashChange.bind(this);\r\n  window.addEventListener('hashchange', $module.boundOnHashChange, true);\r\n};\r\n\r\nTabs.prototype.teardown = function () {\r\n  var $module = this.$module;\r\n  var $tabs = this.$tabs;\r\n  var $tabList = $module.querySelector('.govuk-tabs__list');\r\n  var $tabListItems = $module.querySelectorAll('.govuk-tabs__list-item');\r\n\r\n  if (!$tabs || !$tabList || !$tabListItems) {\r\n    return\r\n  }\r\n\r\n  $tabList.removeAttribute('role');\r\n\r\n  nodeListForEach($tabListItems, function ($item) {\r\n    $item.removeAttribute('role', 'presentation');\r\n  });\r\n\r\n  nodeListForEach($tabs, function ($tab) {\r\n    // Remove events\r\n    $tab.removeEventListener('click', $tab.boundTabClick, true);\r\n    $tab.removeEventListener('keydown', $tab.boundTabKeydown, true);\r\n\r\n    // Unset HTML attributes\r\n    this.unsetAttributes($tab);\r\n  }.bind(this));\r\n\r\n  // Remove hashchange event handler\r\n  window.removeEventListener('hashchange', $module.boundOnHashChange, true);\r\n};\r\n\r\nTabs.prototype.onHashChange = function (e) {\r\n  var hash = window.location.hash;\r\n  var $tabWithHash = this.getTab(hash);\r\n  if (!$tabWithHash) {\r\n    return\r\n  }\r\n\r\n  // Prevent changing the hash\r\n  if (this.changingHash) {\r\n    this.changingHash = false;\r\n    return\r\n  }\r\n\r\n  // Show either the active tab according to the URL's hash or the first tab\r\n  var $previousTab = this.getCurrentTab();\r\n\r\n  this.hideTab($previousTab);\r\n  this.showTab($tabWithHash);\r\n  $tabWithHash.focus();\r\n};\r\n\r\nTabs.prototype.hideTab = function ($tab) {\r\n  this.unhighlightTab($tab);\r\n  this.hidePanel($tab);\r\n};\r\n\r\nTabs.prototype.showTab = function ($tab) {\r\n  this.highlightTab($tab);\r\n  this.showPanel($tab);\r\n};\r\n\r\nTabs.prototype.getTab = function (hash) {\r\n  return this.$module.querySelector('.govuk-tabs__tab[href=\"' + hash + '\"]')\r\n};\r\n\r\nTabs.prototype.setAttributes = function ($tab) {\r\n  // set tab attributes\r\n  var panelId = this.getHref($tab).slice(1);\r\n  $tab.setAttribute('id', 'tab_' + panelId);\r\n  $tab.setAttribute('role', 'tab');\r\n  $tab.setAttribute('aria-controls', panelId);\r\n  $tab.setAttribute('aria-selected', 'false');\r\n  $tab.setAttribute('tabindex', '-1');\r\n\r\n  // set panel attributes\r\n  var $panel = this.getPanel($tab);\r\n  $panel.setAttribute('role', 'tabpanel');\r\n  $panel.setAttribute('aria-labelledby', $tab.id);\r\n  $panel.classList.add(this.jsHiddenClass);\r\n};\r\n\r\nTabs.prototype.unsetAttributes = function ($tab) {\r\n  // unset tab attributes\r\n  $tab.removeAttribute('id');\r\n  $tab.removeAttribute('role');\r\n  $tab.removeAttribute('aria-controls');\r\n  $tab.removeAttribute('aria-selected');\r\n  $tab.removeAttribute('tabindex');\r\n\r\n  // unset panel attributes\r\n  var $panel = this.getPanel($tab);\r\n  $panel.removeAttribute('role');\r\n  $panel.removeAttribute('aria-labelledby');\r\n  $panel.classList.remove(this.jsHiddenClass);\r\n};\r\n\r\nTabs.prototype.onTabClick = function (e) {\r\n  if (!e.target.classList.contains('govuk-tabs__tab')) {\r\n  // Allow events on child DOM elements to bubble up to tab parent\r\n    return false\r\n  }\r\n  e.preventDefault();\r\n  var $newTab = e.target;\r\n  var $currentTab = this.getCurrentTab();\r\n  this.hideTab($currentTab);\r\n  this.showTab($newTab);\r\n  this.createHistoryEntry($newTab);\r\n};\r\n\r\nTabs.prototype.createHistoryEntry = function ($tab) {\r\n  var $panel = this.getPanel($tab);\r\n\r\n  // Save and restore the id\r\n  // so the page doesn't jump when a user clicks a tab (which changes the hash)\r\n  var id = $panel.id;\r\n  $panel.id = '';\r\n  this.changingHash = true;\r\n  window.location.hash = this.getHref($tab).slice(1);\r\n  $panel.id = id;\r\n};\r\n\r\nTabs.prototype.onTabKeydown = function (e) {\r\n  switch (e.keyCode) {\r\n    case this.keys.left:\r\n    case this.keys.up:\r\n      this.activatePreviousTab();\r\n      e.preventDefault();\r\n      break\r\n    case this.keys.right:\r\n    case this.keys.down:\r\n      this.activateNextTab();\r\n      e.preventDefault();\r\n      break\r\n  }\r\n};\r\n\r\nTabs.prototype.activateNextTab = function () {\r\n  var currentTab = this.getCurrentTab();\r\n  var nextTabListItem = currentTab.parentNode.nextElementSibling;\r\n  if (nextTabListItem) {\r\n    var nextTab = nextTabListItem.querySelector('.govuk-tabs__tab');\r\n  }\r\n  if (nextTab) {\r\n    this.hideTab(currentTab);\r\n    this.showTab(nextTab);\r\n    nextTab.focus();\r\n    this.createHistoryEntry(nextTab);\r\n  }\r\n};\r\n\r\nTabs.prototype.activatePreviousTab = function () {\r\n  var currentTab = this.getCurrentTab();\r\n  var previousTabListItem = currentTab.parentNode.previousElementSibling;\r\n  if (previousTabListItem) {\r\n    var previousTab = previousTabListItem.querySelector('.govuk-tabs__tab');\r\n  }\r\n  if (previousTab) {\r\n    this.hideTab(currentTab);\r\n    this.showTab(previousTab);\r\n    previousTab.focus();\r\n    this.createHistoryEntry(previousTab);\r\n  }\r\n};\r\n\r\nTabs.prototype.getPanel = function ($tab) {\r\n  var $panel = this.$module.querySelector(this.getHref($tab));\r\n  return $panel\r\n};\r\n\r\nTabs.prototype.showPanel = function ($tab) {\r\n  var $panel = this.getPanel($tab);\r\n  $panel.classList.remove(this.jsHiddenClass);\r\n};\r\n\r\nTabs.prototype.hidePanel = function (tab) {\r\n  var $panel = this.getPanel(tab);\r\n  $panel.classList.add(this.jsHiddenClass);\r\n};\r\n\r\nTabs.prototype.unhighlightTab = function ($tab) {\r\n  $tab.setAttribute('aria-selected', 'false');\r\n  $tab.parentNode.classList.remove('govuk-tabs__list-item--selected');\r\n  $tab.setAttribute('tabindex', '-1');\r\n};\r\n\r\nTabs.prototype.highlightTab = function ($tab) {\r\n  $tab.setAttribute('aria-selected', 'true');\r\n  $tab.parentNode.classList.add('govuk-tabs__list-item--selected');\r\n  $tab.setAttribute('tabindex', '0');\r\n};\r\n\r\nTabs.prototype.getCurrentTab = function () {\r\n  return this.$module.querySelector('.govuk-tabs__list-item--selected .govuk-tabs__tab')\r\n};\r\n\r\n// this is because IE doesn't always return the actual value but a relative full path\r\n// should be a utility function most prob\r\n// http://labs.thesedays.com/blog/2010/01/08/getting-the-href-value-with-jquery-in-ie/\r\nTabs.prototype.getHref = function ($tab) {\r\n  var href = $tab.getAttribute('href');\r\n  var hash = href.slice(href.indexOf('#'), href.length);\r\n  return hash\r\n};\r\n\r\n/**\r\n * Initialise all components\r\n *\r\n * Use the `data-module` attributes to find, instantiate and init all of the\r\n * components provided as part of GOV.UK Frontend.\r\n *\r\n * @param {Config} [config] - Config for all components\r\n */\r\nfunction initAll (config) {\r\n  config = typeof config !== 'undefined' ? config : {};\r\n\r\n  // Allow the user to initialise GOV.UK Frontend in only certain sections of the page\r\n  // Defaults to the entire document if nothing is set.\r\n  var $scope = typeof config.scope !== 'undefined' ? config.scope : document;\r\n\r\n  var $accordions = $scope.querySelectorAll('[data-module=\"govuk-accordion\"]');\r\n  nodeListForEach($accordions, function ($accordion) {\r\n    new Accordion($accordion, config.accordion).init();\r\n  });\r\n\r\n  var $buttons = $scope.querySelectorAll('[data-module=\"govuk-button\"]');\r\n  nodeListForEach($buttons, function ($button) {\r\n    new Button($button, config.button).init();\r\n  });\r\n\r\n  var $characterCounts = $scope.querySelectorAll('[data-module=\"govuk-character-count\"]');\r\n  nodeListForEach($characterCounts, function ($characterCount) {\r\n    new CharacterCount($characterCount, config.characterCount).init();\r\n  });\r\n\r\n  var $checkboxes = $scope.querySelectorAll('[data-module=\"govuk-checkboxes\"]');\r\n  nodeListForEach($checkboxes, function ($checkbox) {\r\n    new Checkboxes($checkbox).init();\r\n  });\r\n\r\n  var $details = $scope.querySelectorAll('[data-module=\"govuk-details\"]');\r\n  nodeListForEach($details, function ($detail) {\r\n    new Details($detail).init();\r\n  });\r\n\r\n  // Find first error summary module to enhance.\r\n  var $errorSummary = $scope.querySelector('[data-module=\"govuk-error-summary\"]');\r\n  if ($errorSummary) {\r\n    new ErrorSummary($errorSummary, config.errorSummary).init();\r\n  }\r\n\r\n  // Find first header module to enhance.\r\n  var $header = $scope.querySelector('[data-module=\"govuk-header\"]');\r\n  if ($header) {\r\n    new Header($header).init();\r\n  }\r\n\r\n  var $notificationBanners = $scope.querySelectorAll('[data-module=\"govuk-notification-banner\"]');\r\n  nodeListForEach($notificationBanners, function ($notificationBanner) {\r\n    new NotificationBanner($notificationBanner, config.notificationBanner).init();\r\n  });\r\n\r\n  var $radios = $scope.querySelectorAll('[data-module=\"govuk-radios\"]');\r\n  nodeListForEach($radios, function ($radio) {\r\n    new Radios($radio).init();\r\n  });\r\n\r\n  // Find first skip link module to enhance.\r\n  var $skipLink = $scope.querySelector('[data-module=\"govuk-skip-link\"]');\r\n  new SkipLink($skipLink).init();\r\n\r\n  var $tabs = $scope.querySelectorAll('[data-module=\"govuk-tabs\"]');\r\n  nodeListForEach($tabs, function ($tabs) {\r\n    new Tabs($tabs).init();\r\n  });\r\n}\r\n\r\n/**\r\n * Config for all components\r\n *\r\n * @typedef {object} Config\r\n * @property {HTMLElement} [scope=document] - Scope to query for components\r\n * @property {import('./components/accordion/accordion.mjs').AccordionConfig} [accordion] - Accordion config\r\n * @property {import('./components/button/button.mjs').ButtonConfig} [button] - Button config\r\n * @property {import('./components/character-count/character-count.mjs').CharacterCountConfig} [characterCount] - Character Count config\r\n * @property {import('./components/error-summary/error-summary.mjs').ErrorSummaryConfig} [errorSummary] - Error Summary config\r\n * @property {import('./components/notification-banner/notification-banner.mjs').NotificationBannerConfig} [notificationBanner] - Notification Banner config\r\n */\r\n\r\nexports.initAll = initAll;\r\nexports.Accordion = Accordion;\r\nexports.Button = Button;\r\nexports.Details = Details;\r\nexports.CharacterCount = CharacterCount;\r\nexports.Checkboxes = Checkboxes;\r\nexports.ErrorSummary = ErrorSummary;\r\nexports.Header = Header;\r\nexports.NotificationBanner = NotificationBanner;\r\nexports.Radios = Radios;\r\nexports.SkipLink = SkipLink;\r\nexports.Tabs = Tabs;\r\n\r\n})));\r\n\n// js components have been snaffled from https://github.com/alphagov/govuk-design-system/blob/main/src/javascripts/components/\nimport CookieBanner from './components/cookie-banner.js';\nimport { getConsentCookie, isValidConsentCookie } from './components/cookie-functions.js';\nimport Analytics from './components/analytics.js';\nimport CookiesPage from './components/cookies-page.js';\n// Initialise cookie banner\nvar $cookieBanner = document.querySelector('[data-module=\"govuk-cookie-banner\"]');\nnew CookieBanner($cookieBanner).init();\n// Initialise analytics if consent is given\nvar userConsent = getConsentCookie();\nif (userConsent && isValidConsentCookie(userConsent) && userConsent.analytics) {\n    Analytics();\n}\n//todo: move this into scripts section on cookie page\n// Initialise cookie page\nvar $cookiesPage = document.querySelector('[data-module=\"app-cookies-page\"]');\nnew CookiesPage($cookiesPage).init();\nconst backLinks = document.querySelectorAll(\".app-back-link\");\nbackLinks.forEach((link) => {\n    link.addEventListener(\"click\", () => {\n        window.history.back();\n    });\n});\nconst button = document.getElementById('open-close-filters');\nbutton === null || button === void 0 ? void 0 : button.addEventListener('click', function handleClick(event) {\n    //todo: update to ts 2?\n    const filterButton = document.getElementById(\"filters\");\n    if (filterButton.style.display === \"none\") {\n        filterButton.style.display = \"block\";\n    }\n    else {\n        filterButton.style.display = \"none\";\n    }\n});\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSw4SEFBOEg7QUFROUgsT0FBTyxZQUFZLE1BQU0sK0JBQStCLENBQUE7QUFDeEQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLG9CQUFvQixFQUFFLE1BQU0sa0NBQWtDLENBQUE7QUFDekYsT0FBTyxTQUFTLE1BQU0sMkJBQTJCLENBQUE7QUFDakQsT0FBTyxXQUFXLE1BQU0sOEJBQThCLENBQUE7QUFFdEQsMkJBQTJCO0FBQzNCLElBQUksYUFBYSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMscUNBQXFDLENBQUMsQ0FBQTtBQUNqRixJQUFJLFlBQVksQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtBQUV0QywyQ0FBMkM7QUFDM0MsSUFBSSxXQUFXLEdBQUcsZ0JBQWdCLEVBQUUsQ0FBQTtBQUNwQyxJQUFJLFdBQVcsSUFBSSxvQkFBb0IsQ0FBQyxXQUFXLENBQUMsSUFBSSxXQUFXLENBQUMsU0FBUyxFQUFFO0lBQzNFLFNBQVMsRUFBRSxDQUFBO0NBQ2Q7QUFFRCxxREFBcUQ7QUFDckQseUJBQXlCO0FBQ3pCLElBQUksWUFBWSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsa0NBQWtDLENBQUMsQ0FBQTtBQUM3RSxJQUFJLFdBQVcsQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtBQUVwQyxNQUFNLFNBQVMsR0FBRyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztBQUM5RCxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBdUIsRUFBRSxFQUFFO0lBQzFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFO1FBQ2hDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDMUIsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQztBQUVILE1BQU0sTUFBTSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsb0JBQW9CLENBQUMsQ0FBQztBQUM3RCxNQUFNLGFBQU4sTUFBTSx1QkFBTixNQUFNLENBQUUsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLFNBQVMsV0FBVyxDQUFDLEtBQUs7SUFDeEQsdUJBQXVCO0lBQ3ZCLE1BQU0sWUFBWSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUEwQixDQUFDO0lBQ2pGLElBQUksWUFBWSxDQUFDLEtBQUssQ0FBQyxPQUFPLEtBQUssTUFBTSxFQUFFO1FBQ3ZDLFlBQVksQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztLQUN4QztTQUFNO1FBQ0gsWUFBWSxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO0tBQ3ZDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8ganMgY29tcG9uZW50cyBoYXZlIGJlZW4gc25hZmZsZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vYWxwaGFnb3YvZ292dWstZGVzaWduLXN5c3RlbS9ibG9iL21haW4vc3JjL2phdmFzY3JpcHRzL2NvbXBvbmVudHMvXHJcblxyXG5kZWNsYXJlIGdsb2JhbCB7XHJcbiAgICBpbnRlcmZhY2UgV2luZG93IHtcclxuICAgICAgICBHRFNfQ09OU0VOVF9DT09LSUVfVkVSU0lPTjogYW55O1xyXG4gICAgfVxyXG59XHJcblxyXG5pbXBvcnQgQ29va2llQmFubmVyIGZyb20gJy4vY29tcG9uZW50cy9jb29raWUtYmFubmVyLmpzJ1xyXG5pbXBvcnQgeyBnZXRDb25zZW50Q29va2llLCBpc1ZhbGlkQ29uc2VudENvb2tpZSB9IGZyb20gJy4vY29tcG9uZW50cy9jb29raWUtZnVuY3Rpb25zLmpzJ1xyXG5pbXBvcnQgQW5hbHl0aWNzIGZyb20gJy4vY29tcG9uZW50cy9hbmFseXRpY3MuanMnXHJcbmltcG9ydCBDb29raWVzUGFnZSBmcm9tICcuL2NvbXBvbmVudHMvY29va2llcy1wYWdlLmpzJ1xyXG5cclxuLy8gSW5pdGlhbGlzZSBjb29raWUgYmFubmVyXHJcbnZhciAkY29va2llQmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbW9kdWxlPVwiZ292dWstY29va2llLWJhbm5lclwiXScpXHJcbm5ldyBDb29raWVCYW5uZXIoJGNvb2tpZUJhbm5lcikuaW5pdCgpXHJcblxyXG4vLyBJbml0aWFsaXNlIGFuYWx5dGljcyBpZiBjb25zZW50IGlzIGdpdmVuXHJcbnZhciB1c2VyQ29uc2VudCA9IGdldENvbnNlbnRDb29raWUoKVxyXG5pZiAodXNlckNvbnNlbnQgJiYgaXNWYWxpZENvbnNlbnRDb29raWUodXNlckNvbnNlbnQpICYmIHVzZXJDb25zZW50LmFuYWx5dGljcykge1xyXG4gICAgQW5hbHl0aWNzKClcclxufVxyXG5cclxuLy90b2RvOiBtb3ZlIHRoaXMgaW50byBzY3JpcHRzIHNlY3Rpb24gb24gY29va2llIHBhZ2VcclxuLy8gSW5pdGlhbGlzZSBjb29raWUgcGFnZVxyXG52YXIgJGNvb2tpZXNQYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbW9kdWxlPVwiYXBwLWNvb2tpZXMtcGFnZVwiXScpXHJcbm5ldyBDb29raWVzUGFnZSgkY29va2llc1BhZ2UpLmluaXQoKVxyXG5cclxuY29uc3QgYmFja0xpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5hcHAtYmFjay1saW5rXCIpO1xyXG5iYWNrTGlua3MuZm9yRWFjaCgobGluazogSFRNTEFuY2hvckVsZW1lbnQpID0+IHtcclxuICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB3aW5kb3cuaGlzdG9yeS5iYWNrKCk7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5jb25zdCBidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3Blbi1jbG9zZS1maWx0ZXJzJyk7XHJcbmJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiBoYW5kbGVDbGljayhldmVudCkge1xyXG4gICAgLy90b2RvOiB1cGRhdGUgdG8gdHMgMj9cclxuICAgIGNvbnN0IGZpbHRlckJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZmlsdGVyc1wiKSBhcyBIVE1MRGl2RWxlbWVudCB8IG51bGw7XHJcbiAgICBpZiAoZmlsdGVyQnV0dG9uLnN0eWxlLmRpc3BsYXkgPT09IFwibm9uZVwiKSB7XHJcbiAgICAgICAgZmlsdGVyQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZpbHRlckJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICB9XHJcbn0pO1xyXG4iXX0=\n\r\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdvdnVrLTQuNC4xLmpzIiwiYXBwLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbDlIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xyXG5cdHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IGZhY3RvcnkoZXhwb3J0cykgOlxyXG5cdHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZSgnR09WVUtGcm9udGVuZCcsIFsnZXhwb3J0cyddLCBmYWN0b3J5KSA6XHJcblx0KGZhY3RvcnkoKGdsb2JhbC5HT1ZVS0Zyb250ZW5kID0ge30pKSk7XHJcbn0odGhpcywgKGZ1bmN0aW9uIChleHBvcnRzKSB7ICd1c2Ugc3RyaWN0JztcclxuXHJcbi8qKlxyXG4gKiBDb21tb24gaGVscGVycyB3aGljaCBkbyBub3QgcmVxdWlyZSBwb2x5ZmlsbC5cclxuICpcclxuICogSU1QT1JUQU5UOiBJZiBhIGhlbHBlciByZXF1aXJlIGEgcG9seWZpbGwsIHBsZWFzZSBpc29sYXRlIGl0IGluIGl0cyBvd24gbW9kdWxlXHJcbiAqIHNvIHRoYXQgdGhlIHBvbHlmaWxsIGNhbiBiZSBwcm9wZXJseSB0cmVlLXNoYWtlbiBhbmQgZG9lcyBub3QgYnVyZGVuXHJcbiAqIHRoZSBjb21wb25lbnRzIHRoYXQgZG8gbm90IG5lZWQgdGhhdCBoZWxwZXJcclxuICpcclxuICogQG1vZHVsZSBjb21tb24vaW5kZXhcclxuICovXHJcblxyXG4vKipcclxuICogVE9ETzogSWRlYWxseSB0aGlzIHdvdWxkIGJlIGEgTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2ggcG9seWZpbGxcclxuICogVGhpcyBzZWVtcyB0byBmYWlsIGluIElFOCwgcmVxdWlyZXMgbW9yZSBpbnZlc3RpZ2F0aW9uLlxyXG4gKiBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9pbWFnaXRhbWEvbm9kZWxpc3QtZm9yZWFjaC1wb2x5ZmlsbFxyXG4gKlxyXG4gKiBAcGFyYW0ge05vZGVMaXN0T2Y8RWxlbWVudD59IG5vZGVzIC0gTm9kZUxpc3QgZnJvbSBxdWVyeVNlbGVjdG9yQWxsKClcclxuICogQHBhcmFtIHtub2RlTGlzdEl0ZXJhdG9yfSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIHRvIHJ1biBmb3IgZWFjaCBub2RlXHJcbiAqIEByZXR1cm5zIHt1bmRlZmluZWR9XHJcbiAqL1xyXG5mdW5jdGlvbiBub2RlTGlzdEZvckVhY2ggKG5vZGVzLCBjYWxsYmFjaykge1xyXG4gIGlmICh3aW5kb3cuTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2gpIHtcclxuICAgIHJldHVybiBub2Rlcy5mb3JFYWNoKGNhbGxiYWNrKVxyXG4gIH1cclxuICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBjYWxsYmFjay5jYWxsKHdpbmRvdywgbm9kZXNbaV0sIGksIG5vZGVzKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVc2VkIHRvIGdlbmVyYXRlIGEgdW5pcXVlIHN0cmluZywgYWxsb3dzIG11bHRpcGxlIGluc3RhbmNlcyBvZiB0aGUgY29tcG9uZW50XHJcbiAqIHdpdGhvdXQgdGhlbSBjb25mbGljdGluZyB3aXRoIGVhY2ggb3RoZXIuXHJcbiAqIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS84ODA5NDcyXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFVuaXF1ZSBJRFxyXG4gKi9cclxuZnVuY3Rpb24gZ2VuZXJhdGVVbmlxdWVJRCAoKSB7XHJcbiAgdmFyIGQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICBpZiAodHlwZW9mIHdpbmRvdy5wZXJmb3JtYW5jZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3cgPT09ICdmdW5jdGlvbicpIHtcclxuICAgIGQgKz0gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpOyAvLyB1c2UgaGlnaC1wcmVjaXNpb24gdGltZXIgaWYgYXZhaWxhYmxlXHJcbiAgfVxyXG4gIHJldHVybiAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uIChjKSB7XHJcbiAgICB2YXIgciA9IChkICsgTWF0aC5yYW5kb20oKSAqIDE2KSAlIDE2IHwgMDtcclxuICAgIGQgPSBNYXRoLmZsb29yKGQgLyAxNik7XHJcbiAgICByZXR1cm4gKGMgPT09ICd4JyA/IHIgOiAociAmIDB4MyB8IDB4OCkpLnRvU3RyaW5nKDE2KVxyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb25maWcgZmxhdHRlbmluZyBmdW5jdGlvblxyXG4gKlxyXG4gKiBUYWtlcyBhbnkgbnVtYmVyIG9mIG9iamVjdHMsIGZsYXR0ZW5zIHRoZW0gaW50byBuYW1lc3BhY2VkIGtleS12YWx1ZSBwYWlycyxcclxuICogKGUuZy4geydpMThuLnNob3dTZWN0aW9uJzogJ1Nob3cgc2VjdGlvbid9KSBhbmQgY29tYmluZXMgdGhlbSB0b2dldGhlciwgd2l0aFxyXG4gKiBncmVhdGVzdCBwcmlvcml0eSBvbiB0aGUgTEFTVCBpdGVtIHBhc3NlZCBpbi5cclxuICpcclxuICogQHJldHVybnMge29iamVjdH0gQSBmbGF0dGVuZWQgb2JqZWN0IG9mIGtleS12YWx1ZSBwYWlycy5cclxuICovXHJcbmZ1bmN0aW9uIG1lcmdlQ29uZmlncyAoLyogY29uZmlnT2JqZWN0MSwgY29uZmlnT2JqZWN0MiwgLi4uY29uZmlnT2JqZWN0cyAqLykge1xyXG4gIC8qKlxyXG4gICAqIEZ1bmN0aW9uIHRvIHRha2UgbmVzdGVkIG9iamVjdHMgYW5kIGZsYXR0ZW4gdGhlbSB0byBhIGRvdC1zZXBhcmF0ZWQga2V5ZWRcclxuICAgKiBvYmplY3QuIERvaW5nIHRoaXMgbWVhbnMgd2UgZG9uJ3QgbmVlZCB0byBkbyBhbnkgZGVlcC9yZWN1cnNpdmUgbWVyZ2luZyBvZlxyXG4gICAqIGVhY2ggb2Ygb3VyIG9iamVjdHMsIG5vciB0cmFuc2Zvcm0gb3VyIGRhdGFzZXQgZnJvbSBhIGZsYXQgbGlzdCBpbnRvIGFcclxuICAgKiBuZXN0ZWQgb2JqZWN0LlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtvYmplY3R9IGNvbmZpZ09iamVjdCAtIERlZXBseSBuZXN0ZWQgb2JqZWN0XHJcbiAgICogQHJldHVybnMge29iamVjdH0gRmxhdHRlbmVkIG9iamVjdCB3aXRoIGRvdC1zZXBhcmF0ZWQga2V5c1xyXG4gICAqL1xyXG4gIHZhciBmbGF0dGVuT2JqZWN0ID0gZnVuY3Rpb24gKGNvbmZpZ09iamVjdCkge1xyXG4gICAgLy8gUHJlcGFyZSBhbiBlbXB0eSByZXR1cm4gb2JqZWN0XHJcbiAgICB2YXIgZmxhdHRlbmVkT2JqZWN0ID0ge307XHJcblxyXG4gICAgLy8gT3VyIGZsYXR0ZW5pbmcgZnVuY3Rpb24sIHRoaXMgaXMgY2FsbGVkIHJlY3Vyc2l2ZWx5IGZvciBlYWNoIGxldmVsIG9mXHJcbiAgICAvLyBkZXB0aCBpbiB0aGUgb2JqZWN0LiBBdCBlYWNoIGxldmVsIHdlIHByZXBlbmQgdGhlIHByZXZpb3VzIGxldmVsIG5hbWVzIHRvXHJcbiAgICAvLyB0aGUga2V5IHVzaW5nIGBwcmVmaXhgLlxyXG4gICAgdmFyIGZsYXR0ZW5Mb29wID0gZnVuY3Rpb24gKG9iaiwgcHJlZml4KSB7XHJcbiAgICAgIC8vIExvb3AgdGhyb3VnaCBrZXlzLi4uXHJcbiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhpcyBpcyBhIHByb3RvdHlwaWNhbCBrZXkvdmFsdWUsXHJcbiAgICAgICAgLy8gaWYgaXQgaXMsIHNraXAgaXQuXHJcbiAgICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdmFsdWUgPSBvYmpba2V5XTtcclxuICAgICAgICB2YXIgcHJlZml4ZWRLZXkgPSBwcmVmaXggPyBwcmVmaXggKyAnLicgKyBrZXkgOiBrZXk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgIC8vIElmIHRoZSB2YWx1ZSBpcyBhIG5lc3RlZCBvYmplY3QsIHJlY3Vyc2Ugb3ZlciB0aGF0IHRvb1xyXG4gICAgICAgICAgZmxhdHRlbkxvb3AodmFsdWUsIHByZWZpeGVkS2V5KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gT3RoZXJ3aXNlLCBhZGQgdGhpcyB2YWx1ZSB0byBvdXIgcmV0dXJuIG9iamVjdFxyXG4gICAgICAgICAgZmxhdHRlbmVkT2JqZWN0W3ByZWZpeGVkS2V5XSA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBLaWNrIG9mZiB0aGUgcmVjdXJzaXZlIGxvb3BcclxuICAgIGZsYXR0ZW5Mb29wKGNvbmZpZ09iamVjdCk7XHJcbiAgICByZXR1cm4gZmxhdHRlbmVkT2JqZWN0XHJcbiAgfTtcclxuXHJcbiAgLy8gU3RhcnQgd2l0aCBhbiBlbXB0eSBvYmplY3QgYXMgb3VyIGJhc2VcclxuICB2YXIgZm9ybWF0dGVkQ29uZmlnT2JqZWN0ID0ge307XHJcblxyXG4gIC8vIExvb3AgdGhyb3VnaCBlYWNoIG9mIHRoZSByZW1haW5pbmcgcGFzc2VkIG9iamVjdHMgYW5kIHB1c2ggdGhlaXIga2V5c1xyXG4gIC8vIG9uZS1ieS1vbmUgaW50byBjb25maWdPYmplY3QuIEFueSBkdXBsaWNhdGUga2V5cyB3aWxsIG92ZXJyaWRlIHRoZSBleGlzdGluZ1xyXG4gIC8vIGtleSB3aXRoIHRoZSBuZXcgdmFsdWUuXHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcclxuICAgIHZhciBvYmogPSBmbGF0dGVuT2JqZWN0KGFyZ3VtZW50c1tpXSk7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgZm9ybWF0dGVkQ29uZmlnT2JqZWN0W2tleV0gPSBvYmpba2V5XTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGZvcm1hdHRlZENvbmZpZ09iamVjdFxyXG59XHJcblxyXG4vKipcclxuICogRXh0cmFjdHMga2V5cyBzdGFydGluZyB3aXRoIGEgcGFydGljdWxhciBuYW1lc3BhY2UgZnJvbSBhIGZsYXR0ZW5lZCBjb25maWdcclxuICogb2JqZWN0LCByZW1vdmluZyB0aGUgbmFtZXNwYWNlIGluIHRoZSBwcm9jZXNzLlxyXG4gKlxyXG4gKiBAcGFyYW0ge29iamVjdH0gY29uZmlnT2JqZWN0IC0gVGhlIG9iamVjdCB0byBleHRyYWN0IGtleS12YWx1ZSBwYWlycyBmcm9tLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZXNwYWNlIC0gVGhlIG5hbWVzcGFjZSB0byBmaWx0ZXIga2V5cyB3aXRoLlxyXG4gKiBAcmV0dXJucyB7b2JqZWN0fSBGbGF0dGVuZWQgb2JqZWN0IHdpdGggZG90LXNlcGFyYXRlZCBrZXkgbmFtZXNwYWNlIHJlbW92ZWRcclxuICovXHJcbmZ1bmN0aW9uIGV4dHJhY3RDb25maWdCeU5hbWVzcGFjZSAoY29uZmlnT2JqZWN0LCBuYW1lc3BhY2UpIHtcclxuICAvLyBDaGVjayB3ZSBoYXZlIHdoYXQgd2UgbmVlZFxyXG4gIGlmICghY29uZmlnT2JqZWN0IHx8IHR5cGVvZiBjb25maWdPYmplY3QgIT09ICdvYmplY3QnKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Byb3ZpZGUgYSBgY29uZmlnT2JqZWN0YCBvZiB0eXBlIFwib2JqZWN0XCIuJylcclxuICB9XHJcbiAgaWYgKCFuYW1lc3BhY2UgfHwgdHlwZW9mIG5hbWVzcGFjZSAhPT0gJ3N0cmluZycpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcignUHJvdmlkZSBhIGBuYW1lc3BhY2VgIG9mIHR5cGUgXCJzdHJpbmdcIiB0byBmaWx0ZXIgdGhlIGBjb25maWdPYmplY3RgIGJ5LicpXHJcbiAgfVxyXG4gIHZhciBuZXdPYmplY3QgPSB7fTtcclxuICBmb3IgKHZhciBrZXkgaW4gY29uZmlnT2JqZWN0KSB7XHJcbiAgICAvLyBTcGxpdCB0aGUga2V5IGludG8gcGFydHMsIHVzaW5nIC4gYXMgb3VyIG5hbWVzcGFjZSBzZXBhcmF0b3JcclxuICAgIHZhciBrZXlQYXJ0cyA9IGtleS5zcGxpdCgnLicpO1xyXG4gICAgLy8gQ2hlY2sgaWYgdGhlIGZpcnN0IG5hbWVzcGFjZSBtYXRjaGVzIHRoZSBjb25maWd1cmVkIG5hbWVzcGFjZVxyXG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChjb25maWdPYmplY3QsIGtleSkgJiYga2V5UGFydHNbMF0gPT09IG5hbWVzcGFjZSkge1xyXG4gICAgICAvLyBSZW1vdmUgdGhlIGZpcnN0IGl0ZW0gKHRoZSBuYW1lc3BhY2UpIGZyb20gdGhlIHBhcnRzIGFycmF5LFxyXG4gICAgICAvLyBidXQgb25seSBpZiB0aGVyZSBpcyBtb3JlIHRoYW4gb25lIHBhcnQgKHdlIGRvbid0IHdhbnQgYmxhbmsga2V5cyEpXHJcbiAgICAgIGlmIChrZXlQYXJ0cy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAga2V5UGFydHMuc2hpZnQoKTtcclxuICAgICAgfVxyXG4gICAgICAvLyBKb2luIHRoZSByZW1haW5pbmcgcGFydHMgYmFjayB0b2dldGhlclxyXG4gICAgICB2YXIgbmV3S2V5ID0ga2V5UGFydHMuam9pbignLicpO1xyXG4gICAgICAvLyBBZGQgdGhlbSB0byBvdXIgbmV3IG9iamVjdFxyXG4gICAgICBuZXdPYmplY3RbbmV3S2V5XSA9IGNvbmZpZ09iamVjdFtrZXldO1xyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gbmV3T2JqZWN0XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAY2FsbGJhY2sgbm9kZUxpc3RJdGVyYXRvclxyXG4gKiBAcGFyYW0ge0VsZW1lbnR9IHZhbHVlIC0gVGhlIGN1cnJlbnQgbm9kZSBiZWluZyBpdGVyYXRlZCBvblxyXG4gKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSBUaGUgY3VycmVudCBpbmRleCBpbiB0aGUgaXRlcmF0aW9uXHJcbiAqIEBwYXJhbSB7Tm9kZUxpc3RPZjxFbGVtZW50Pn0gbm9kZXMgLSBOb2RlTGlzdCBmcm9tIHF1ZXJ5U2VsZWN0b3JBbGwoKVxyXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBJbnRlcm5hbCBzdXBwb3J0IGZvciBzZWxlY3RpbmcgbWVzc2FnZXMgdG8gcmVuZGVyLCB3aXRoIHBsYWNlaG9sZGVyXHJcbiAqIGludGVycG9sYXRpb24gYW5kIGxvY2FsZS1hd2FyZSBudW1iZXIgZm9ybWF0dGluZyBhbmQgcGx1cmFsaXNhdGlvblxyXG4gKlxyXG4gKiBAY2xhc3NcclxuICogQHByaXZhdGVcclxuICogQHBhcmFtIHtUcmFuc2xhdGlvbnNGbGF0dGVuZWR9IHRyYW5zbGF0aW9ucyAtIEtleS12YWx1ZSBwYWlycyBvZiB0aGUgdHJhbnNsYXRpb24gc3RyaW5ncyB0byB1c2UuXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSBbY29uZmlnXSAtIENvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgdGhlIGZ1bmN0aW9uLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gY29uZmlnLmxvY2FsZSAtIEFuIG92ZXJyaWRpbmcgbG9jYWxlIGZvciB0aGUgUGx1cmFsUnVsZXMgZnVuY3Rpb25hbGl0eS5cclxuICovXHJcbmZ1bmN0aW9uIEkxOG4gKHRyYW5zbGF0aW9ucywgY29uZmlnKSB7XHJcbiAgLy8gTWFrZSBsaXN0IG9mIHRyYW5zbGF0aW9ucyBhdmFpbGFibGUgdGhyb3VnaG91dCBmdW5jdGlvblxyXG4gIHRoaXMudHJhbnNsYXRpb25zID0gdHJhbnNsYXRpb25zIHx8IHt9O1xyXG5cclxuICAvLyBUaGUgbG9jYWxlIHRvIHVzZSBmb3IgUGx1cmFsUnVsZXMgYW5kIE51bWJlckZvcm1hdFxyXG4gIHRoaXMubG9jYWxlID0gKGNvbmZpZyAmJiBjb25maWcubG9jYWxlKSB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQubGFuZyB8fCAnZW4nO1xyXG59XHJcblxyXG4vKipcclxuICogVGhlIG1vc3QgdXNlZCBmdW5jdGlvbiAtIHRha2VzIHRoZSBrZXkgZm9yIGEgZ2l2ZW4gcGllY2Ugb2YgVUkgdGV4dCBhbmRcclxuICogcmV0dXJucyB0aGUgYXBwcm9wcmlhdGUgc3RyaW5nLlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbG9va3VwS2V5IC0gVGhlIGxvb2t1cCBrZXkgb2YgdGhlIHN0cmluZyB0byB1c2UuXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIC0gQW55IG9wdGlvbnMgcGFzc2VkIHdpdGggdGhlIHRyYW5zbGF0aW9uIHN0cmluZywgZS5nOiBmb3Igc3RyaW5nIGludGVycG9sYXRpb24uXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBhcHByb3ByaWF0ZSB0cmFuc2xhdGlvbiBzdHJpbmcuXHJcbiAqL1xyXG5JMThuLnByb3RvdHlwZS50ID0gZnVuY3Rpb24gKGxvb2t1cEtleSwgb3B0aW9ucykge1xyXG4gIGlmICghbG9va3VwS2V5KSB7XHJcbiAgICAvLyBQcmludCBhIGNvbnNvbGUgZXJyb3IgaWYgbm8gbG9va3VwIGtleSBoYXMgYmVlbiBwcm92aWRlZFxyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdpMThuOiBsb29rdXAga2V5IG1pc3NpbmcnKVxyXG4gIH1cclxuXHJcbiAgLy8gSWYgdGhlIGBjb3VudGAgb3B0aW9uIGlzIHNldCwgZGV0ZXJtaW5lIHdoaWNoIHBsdXJhbCBzdWZmaXggaXMgbmVlZGVkIGFuZFxyXG4gIC8vIGNoYW5nZSB0aGUgbG9va3VwS2V5IHRvIG1hdGNoLiBXZSBjaGVjayB0byBzZWUgaWYgaXQncyB1bmRlZmluZWQgaW5zdGVhZCBvZlxyXG4gIC8vIGZhbHN5LCBhcyB0aGlzIGNvdWxkIGxlZ2l0aW1hdGVseSBiZSAwLlxyXG4gIGlmIChvcHRpb25zICYmIHR5cGVvZiBvcHRpb25zLmNvdW50ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgLy8gR2V0IHRoZSBwbHVyYWwgc3VmZml4XHJcbiAgICBsb29rdXBLZXkgPSBsb29rdXBLZXkgKyAnLicgKyB0aGlzLmdldFBsdXJhbFN1ZmZpeChsb29rdXBLZXksIG9wdGlvbnMuY291bnQpO1xyXG4gIH1cclxuXHJcbiAgaWYgKGxvb2t1cEtleSBpbiB0aGlzLnRyYW5zbGF0aW9ucykge1xyXG4gICAgLy8gRmV0Y2ggdGhlIHRyYW5zbGF0aW9uIHN0cmluZyBmb3IgdGhhdCBsb29rdXAga2V5XHJcbiAgICB2YXIgdHJhbnNsYXRpb25TdHJpbmcgPSB0aGlzLnRyYW5zbGF0aW9uc1tsb29rdXBLZXldO1xyXG5cclxuICAgIC8vIENoZWNrIGZvciAke30gcGxhY2Vob2xkZXJzIGluIHRoZSB0cmFuc2xhdGlvbiBzdHJpbmdcclxuICAgIGlmICh0cmFuc2xhdGlvblN0cmluZy5tYXRjaCgvJXsoLlxcUyspfS8pKSB7XHJcbiAgICAgIGlmICghb3B0aW9ucykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignaTE4bjogY2Fubm90IHJlcGxhY2UgcGxhY2Vob2xkZXJzIGluIHN0cmluZyBpZiBubyBvcHRpb24gZGF0YSBwcm92aWRlZCcpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB0aGlzLnJlcGxhY2VQbGFjZWhvbGRlcnModHJhbnNsYXRpb25TdHJpbmcsIG9wdGlvbnMpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gdHJhbnNsYXRpb25TdHJpbmdcclxuICAgIH1cclxuICB9IGVsc2Uge1xyXG4gICAgLy8gSWYgdGhlIGtleSB3YXNuJ3QgZm91bmQgaW4gb3VyIHRyYW5zbGF0aW9ucyBvYmplY3QsXHJcbiAgICAvLyByZXR1cm4gdGhlIGxvb2t1cCBrZXkgaXRzZWxmIGFzIHRoZSBmYWxsYmFja1xyXG4gICAgcmV0dXJuIGxvb2t1cEtleVxyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBUYWtlcyBhIHRyYW5zbGF0aW9uIHN0cmluZyB3aXRoIHBsYWNlaG9sZGVycywgYW5kIHJlcGxhY2VzIHRoZSBwbGFjZWhvbGRlcnNcclxuICogd2l0aCB0aGUgcHJvdmlkZWQgZGF0YVxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdHJhbnNsYXRpb25TdHJpbmcgLSBUaGUgdHJhbnNsYXRpb24gc3RyaW5nXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIC0gQW55IG9wdGlvbnMgcGFzc2VkIHdpdGggdGhlIHRyYW5zbGF0aW9uIHN0cmluZywgZS5nOiBmb3Igc3RyaW5nIGludGVycG9sYXRpb24uXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSB0cmFuc2xhdGlvbiBzdHJpbmcgdG8gb3V0cHV0LCB3aXRoICR7fSBwbGFjZWhvbGRlcnMgcmVwbGFjZWRcclxuICovXHJcbkkxOG4ucHJvdG90eXBlLnJlcGxhY2VQbGFjZWhvbGRlcnMgPSBmdW5jdGlvbiAodHJhbnNsYXRpb25TdHJpbmcsIG9wdGlvbnMpIHtcclxuICB2YXIgZm9ybWF0dGVyO1xyXG5cclxuICBpZiAodGhpcy5oYXNJbnRsTnVtYmVyRm9ybWF0U3VwcG9ydCgpKSB7XHJcbiAgICBmb3JtYXR0ZXIgPSBuZXcgSW50bC5OdW1iZXJGb3JtYXQodGhpcy5sb2NhbGUpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHRyYW5zbGF0aW9uU3RyaW5nLnJlcGxhY2UoLyV7KC5cXFMrKX0vZywgZnVuY3Rpb24gKHBsYWNlaG9sZGVyV2l0aEJyYWNlcywgcGxhY2Vob2xkZXJLZXkpIHtcclxuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob3B0aW9ucywgcGxhY2Vob2xkZXJLZXkpKSB7XHJcbiAgICAgIHZhciBwbGFjZWhvbGRlclZhbHVlID0gb3B0aW9uc1twbGFjZWhvbGRlcktleV07XHJcblxyXG4gICAgICAvLyBJZiBhIHVzZXIgaGFzIHBhc3NlZCBgZmFsc2VgIGFzIHRoZSB2YWx1ZSBmb3IgdGhlIHBsYWNlaG9sZGVyXHJcbiAgICAgIC8vIHRyZWF0IGl0IGFzIHRob3VnaCB0aGUgdmFsdWUgc2hvdWxkIG5vdCBiZSBkaXNwbGF5ZWRcclxuICAgICAgaWYgKHBsYWNlaG9sZGVyVmFsdWUgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgcmV0dXJuICcnXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIElmIHRoZSBwbGFjZWhvbGRlcidzIHZhbHVlIGlzIGEgbnVtYmVyLCBsb2NhbGlzZSB0aGUgbnVtYmVyIGZvcm1hdHRpbmdcclxuICAgICAgaWYgKHR5cGVvZiBwbGFjZWhvbGRlclZhbHVlID09PSAnbnVtYmVyJyAmJiBmb3JtYXR0ZXIpIHtcclxuICAgICAgICByZXR1cm4gZm9ybWF0dGVyLmZvcm1hdChwbGFjZWhvbGRlclZhbHVlKVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcGxhY2Vob2xkZXJWYWx1ZVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdpMThuOiBubyBkYXRhIGZvdW5kIHRvIHJlcGxhY2UgJyArIHBsYWNlaG9sZGVyV2l0aEJyYWNlcyArICcgcGxhY2Vob2xkZXIgaW4gc3RyaW5nJylcclxuICAgIH1cclxuICB9KVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIENoZWNrIHRvIHNlZSBpZiB0aGUgYnJvd3NlciBzdXBwb3J0cyBJbnRsIGFuZCBJbnRsLlBsdXJhbFJ1bGVzLlxyXG4gKlxyXG4gKiBJdCByZXF1aXJlcyBhbGwgY29uZGl0aW9ucyB0byBiZSBtZXQgaW4gb3JkZXIgdG8gYmUgc3VwcG9ydGVkOlxyXG4gKiAtIFRoZSBicm93c2VyIHN1cHBvcnRzIHRoZSBJbnRsIGNsYXNzICh0cnVlIGluIElFMTEpXHJcbiAqIC0gVGhlIGltcGxlbWVudGF0aW9uIG9mIEludGwgc3VwcG9ydHMgUGx1cmFsUnVsZXMgKE5PVCB0cnVlIGluIElFMTEpXHJcbiAqIC0gVGhlIGJyb3dzZXIvT1MgaGFzIHBsdXJhbCBydWxlcyBmb3IgdGhlIGN1cnJlbnQgbG9jYWxlIChicm93c2VyIGRlcGVuZGVudClcclxuICpcclxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiBhbGwgY29uZGl0aW9ucyBhcmUgbWV0LiBSZXR1cm5zIGZhbHNlIG90aGVyd2lzZS5cclxuICovXHJcbkkxOG4ucHJvdG90eXBlLmhhc0ludGxQbHVyYWxSdWxlc1N1cHBvcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgcmV0dXJuIEJvb2xlYW4od2luZG93LkludGwgJiYgKCdQbHVyYWxSdWxlcycgaW4gd2luZG93LkludGwgJiYgSW50bC5QbHVyYWxSdWxlcy5zdXBwb3J0ZWRMb2NhbGVzT2YodGhpcy5sb2NhbGUpLmxlbmd0aCkpXHJcbn07XHJcblxyXG4vKipcclxuICogQ2hlY2sgdG8gc2VlIGlmIHRoZSBicm93c2VyIHN1cHBvcnRzIEludGwgYW5kIEludGwuTnVtYmVyRm9ybWF0LlxyXG4gKlxyXG4gKiBJdCByZXF1aXJlcyBhbGwgY29uZGl0aW9ucyB0byBiZSBtZXQgaW4gb3JkZXIgdG8gYmUgc3VwcG9ydGVkOlxyXG4gKiAtIFRoZSBicm93c2VyIHN1cHBvcnRzIHRoZSBJbnRsIGNsYXNzICh0cnVlIGluIElFMTEpXHJcbiAqIC0gVGhlIGltcGxlbWVudGF0aW9uIG9mIEludGwgc3VwcG9ydHMgTnVtYmVyRm9ybWF0IChhbHNvIHRydWUgaW4gSUUxMSlcclxuICogLSBUaGUgYnJvd3Nlci9PUyBoYXMgbnVtYmVyIGZvcm1hdHRpbmcgcnVsZXMgZm9yIHRoZSBjdXJyZW50IGxvY2FsZSAoYnJvd3NlciBkZXBlbmRlbnQpXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIHRydWUgaWYgYWxsIGNvbmRpdGlvbnMgYXJlIG1ldC4gUmV0dXJucyBmYWxzZSBvdGhlcndpc2UuXHJcbiAqL1xyXG5JMThuLnByb3RvdHlwZS5oYXNJbnRsTnVtYmVyRm9ybWF0U3VwcG9ydCA9IGZ1bmN0aW9uICgpIHtcclxuICByZXR1cm4gQm9vbGVhbih3aW5kb3cuSW50bCAmJiAoJ051bWJlckZvcm1hdCcgaW4gd2luZG93LkludGwgJiYgSW50bC5OdW1iZXJGb3JtYXQuc3VwcG9ydGVkTG9jYWxlc09mKHRoaXMubG9jYWxlKS5sZW5ndGgpKVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldCB0aGUgYXBwcm9wcmlhdGUgc3VmZml4IGZvciB0aGUgcGx1cmFsIGZvcm0uXHJcbiAqXHJcbiAqIFVzZXMgSW50bC5QbHVyYWxSdWxlcyAob3Igb3VyIG93biBmYWxsYmFjayBpbXBsZW1lbnRhdGlvbikgdG8gZ2V0IHRoZVxyXG4gKiAncHJlZmVycmVkJyBmb3JtIHRvIHVzZSBmb3IgdGhlIGdpdmVuIGNvdW50LlxyXG4gKlxyXG4gKiBDaGVja3MgdGhhdCBhIHRyYW5zbGF0aW9uIGhhcyBiZWVuIHByb3ZpZGVkIGZvciB0aGF0IHBsdXJhbCBmb3JtIOKAkyBpZiBpdFxyXG4gKiBoYXNuJ3QsIGl0J2xsIGZhbGwgYmFjayB0byB0aGUgJ290aGVyJyBwbHVyYWwgZm9ybSAodW5sZXNzIHRoYXQgZG9lc24ndCBleGlzdFxyXG4gKiBlaXRoZXIsIGluIHdoaWNoIGNhc2UgYW4gZXJyb3Igd2lsbCBiZSB0aHJvd24pXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBsb29rdXBLZXkgLSBUaGUgbG9va3VwIGtleSBvZiB0aGUgc3RyaW5nIHRvIHVzZS5cclxuICogQHBhcmFtIHtudW1iZXJ9IGNvdW50IC0gTnVtYmVyIHVzZWQgdG8gZGV0ZXJtaW5lIHdoaWNoIHBsdXJhbGlzYXRpb24gdG8gdXNlLlxyXG4gKiBAcmV0dXJucyB7UGx1cmFsUnVsZX0gVGhlIHN1ZmZpeCBhc3NvY2lhdGVkIHdpdGggdGhlIGNvcnJlY3QgcGx1cmFsaXNhdGlvbiBmb3IgdGhpcyBsb2NhbGUuXHJcbiAqL1xyXG5JMThuLnByb3RvdHlwZS5nZXRQbHVyYWxTdWZmaXggPSBmdW5jdGlvbiAobG9va3VwS2V5LCBjb3VudCkge1xyXG4gIC8vIFZhbGlkYXRlIHRoYXQgdGhlIG51bWJlciBpcyBhY3R1YWxseSBhIG51bWJlci5cclxuICAvL1xyXG4gIC8vIE51bWJlcihjb3VudCkgd2lsbCB0dXJuIGFueXRoaW5nIHRoYXQgY2FuJ3QgYmUgY29udmVydGVkIHRvIGEgTnVtYmVyIHR5cGVcclxuICAvLyBpbnRvICdOYU4nLiBpc0Zpbml0ZSBmaWx0ZXJzIG91dCBOYU4sIGFzIGl0IGlzbid0IGEgZmluaXRlIG51bWJlci5cclxuICBjb3VudCA9IE51bWJlcihjb3VudCk7XHJcbiAgaWYgKCFpc0Zpbml0ZShjb3VudCkpIHsgcmV0dXJuICdvdGhlcicgfVxyXG5cclxuICB2YXIgcHJlZmVycmVkRm9ybTtcclxuXHJcbiAgLy8gQ2hlY2sgdG8gdmVyaWZ5IHRoYXQgYWxsIHRoZSByZXF1aXJlbWVudHMgZm9yIEludGwuUGx1cmFsUnVsZXMgYXJlIG1ldC5cclxuICAvLyBJZiBzbywgd2UgY2FuIHVzZSB0aGF0IGluc3RlYWQgb2Ygb3VyIGN1c3RvbSBpbXBsZW1lbnRhdGlvbi4gT3RoZXJ3aXNlLFxyXG4gIC8vIHVzZSB0aGUgaGFyZGNvZGVkIGZhbGxiYWNrLlxyXG4gIGlmICh0aGlzLmhhc0ludGxQbHVyYWxSdWxlc1N1cHBvcnQoKSkge1xyXG4gICAgcHJlZmVycmVkRm9ybSA9IG5ldyBJbnRsLlBsdXJhbFJ1bGVzKHRoaXMubG9jYWxlKS5zZWxlY3QoY291bnQpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBwcmVmZXJyZWRGb3JtID0gdGhpcy5zZWxlY3RQbHVyYWxGb3JtVXNpbmdGYWxsYmFja1J1bGVzKGNvdW50KTtcclxuICB9XHJcblxyXG4gIC8vIFVzZSB0aGUgY29ycmVjdCBwbHVyYWwgZm9ybSBpZiBwcm92aWRlZFxyXG4gIGlmIChsb29rdXBLZXkgKyAnLicgKyBwcmVmZXJyZWRGb3JtIGluIHRoaXMudHJhbnNsYXRpb25zKSB7XHJcbiAgICByZXR1cm4gcHJlZmVycmVkRm9ybVxyXG4gIC8vIEZhbGwgYmFjayB0byBgb3RoZXJgIGlmIHRoZSBwbHVyYWwgZm9ybSBpcyBtaXNzaW5nLCBidXQgbG9nIGEgd2FybmluZ1xyXG4gIC8vIHRvIHRoZSBjb25zb2xlXHJcbiAgfSBlbHNlIGlmIChsb29rdXBLZXkgKyAnLm90aGVyJyBpbiB0aGlzLnRyYW5zbGF0aW9ucykge1xyXG4gICAgaWYgKGNvbnNvbGUgJiYgJ3dhcm4nIGluIGNvbnNvbGUpIHtcclxuICAgICAgY29uc29sZS53YXJuKCdpMThuOiBNaXNzaW5nIHBsdXJhbCBmb3JtIFwiLicgKyBwcmVmZXJyZWRGb3JtICsgJ1wiIGZvciBcIicgK1xyXG4gICAgICAgIHRoaXMubG9jYWxlICsgJ1wiIGxvY2FsZS4gRmFsbGluZyBiYWNrIHRvIFwiLm90aGVyXCIuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuICdvdGhlcidcclxuICAvLyBJZiB0aGUgcmVxdWlyZWQgYG90aGVyYCBwbHVyYWwgZm9ybSBpcyBtaXNzaW5nLCBhbGwgd2UgY2FuIGRvIGlzIGVycm9yXHJcbiAgfSBlbHNlIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgJ2kxOG46IFBsdXJhbCBmb3JtIFwiLm90aGVyXCIgaXMgcmVxdWlyZWQgZm9yIFwiJyArIHRoaXMubG9jYWxlICsgJ1wiIGxvY2FsZSdcclxuICAgIClcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogR2V0IHRoZSBwbHVyYWwgZm9ybSB1c2luZyBvdXIgZmFsbGJhY2sgaW1wbGVtZW50YXRpb25cclxuICpcclxuICogVGhpcyBpcyBzcGxpdCBvdXQgaW50byBhIHNlcGFyYXRlIGZ1bmN0aW9uIHRvIG1ha2UgaXQgZWFzaWVyIHRvIHRlc3QgdGhlXHJcbiAqIGZhbGxiYWNrIGJlaGF2aW91ciBpbiBhbiBlbnZpcm9ubWVudCB3aGVyZSBJbnRsLlBsdXJhbFJ1bGVzIGV4aXN0cy5cclxuICpcclxuICogQHBhcmFtIHtudW1iZXJ9IGNvdW50IC0gTnVtYmVyIHVzZWQgdG8gZGV0ZXJtaW5lIHdoaWNoIHBsdXJhbGlzYXRpb24gdG8gdXNlLlxyXG4gKiBAcmV0dXJucyB7UGx1cmFsUnVsZX0gVGhlIHBsdXJhbGlzYXRpb24gZm9ybSBmb3IgY291bnQgaW4gdGhpcyBsb2NhbGUuXHJcbiAqL1xyXG5JMThuLnByb3RvdHlwZS5zZWxlY3RQbHVyYWxGb3JtVXNpbmdGYWxsYmFja1J1bGVzID0gZnVuY3Rpb24gKGNvdW50KSB7XHJcbiAgLy8gQ3VycmVudGx5IG91ciBjdXN0b20gY29kZSBjYW4gb25seSBoYW5kbGUgcG9zaXRpdmUgaW50ZWdlcnMsIHNvIGxldCdzXHJcbiAgLy8gbWFrZSBzdXJlIG91ciBudW1iZXIgaXMgb25lIG9mIHRob3NlLlxyXG4gIGNvdW50ID0gTWF0aC5hYnMoTWF0aC5mbG9vcihjb3VudCkpO1xyXG5cclxuICB2YXIgcnVsZXNldCA9IHRoaXMuZ2V0UGx1cmFsUnVsZXNGb3JMb2NhbGUoKTtcclxuXHJcbiAgaWYgKHJ1bGVzZXQpIHtcclxuICAgIHJldHVybiBJMThuLnBsdXJhbFJ1bGVzW3J1bGVzZXRdKGNvdW50KVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuICdvdGhlcidcclxufTtcclxuXHJcbi8qKlxyXG4gKiBXb3JrIG91dCB3aGljaCBwbHVyYWxpc2F0aW9uIHJ1bGVzIHRvIHVzZSBmb3IgdGhlIGN1cnJlbnQgbG9jYWxlXHJcbiAqXHJcbiAqIFRoZSBsb2NhbGUgbWF5IGluY2x1ZGUgYSByZWdpb25hbCBpbmRpY2F0b3IgKHN1Y2ggYXMgZW4tR0IpLCBidXQgd2UgZG9uJ3RcclxuICogdXN1YWxseSBjYXJlIGFib3V0IHRoaXMgcGFydCwgYXMgcGx1cmFsaXNhdGlvbiBydWxlcyBhcmUgdXN1YWxseSB0aGUgc2FtZVxyXG4gKiByZWdhcmRsZXNzIG9mIHJlZ2lvbi4gVGhlcmUgYXJlIGV4Y2VwdGlvbnMsIGhvd2V2ZXIsIChlLmcuIFBvcnR1Z3Vlc2UpIHNvXHJcbiAqIHRoaXMgc2VhcmNoZXMgYnkgYm90aCB0aGUgZnVsbCBhbmQgc2hvcnRlbmVkIGxvY2FsZSBjb2RlcywganVzdCB0byBiZSBzdXJlLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7UGx1cmFsUnVsZU5hbWUgfCB1bmRlZmluZWR9IFRoZSBuYW1lIG9mIHRoZSBwbHVyYWxpc2F0aW9uIHJ1bGUgdG8gdXNlIChhIGtleSBmb3Igb25lXHJcbiAqICAgb2YgdGhlIGZ1bmN0aW9ucyBpbiB0aGlzLnBsdXJhbFJ1bGVzKVxyXG4gKi9cclxuSTE4bi5wcm90b3R5cGUuZ2V0UGx1cmFsUnVsZXNGb3JMb2NhbGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyIGxvY2FsZSA9IHRoaXMubG9jYWxlO1xyXG4gIHZhciBsb2NhbGVTaG9ydCA9IGxvY2FsZS5zcGxpdCgnLScpWzBdO1xyXG5cclxuICAvLyBMb29rIHRocm91Z2ggdGhlIHBsdXJhbCBydWxlcyBtYXAgdG8gZmluZCB3aGljaCBgcGx1cmFsUnVsZWAgaXNcclxuICAvLyBhcHByb3ByaWF0ZSBmb3Igb3VyIGN1cnJlbnQgYGxvY2FsZWAuXHJcbiAgZm9yICh2YXIgcGx1cmFsUnVsZSBpbiBJMThuLnBsdXJhbFJ1bGVzTWFwKSB7XHJcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKEkxOG4ucGx1cmFsUnVsZXNNYXAsIHBsdXJhbFJ1bGUpKSB7XHJcbiAgICAgIHZhciBsYW5ndWFnZXMgPSBJMThuLnBsdXJhbFJ1bGVzTWFwW3BsdXJhbFJ1bGVdO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxhbmd1YWdlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmIChsYW5ndWFnZXNbaV0gPT09IGxvY2FsZSB8fCBsYW5ndWFnZXNbaV0gPT09IGxvY2FsZVNob3J0KSB7XHJcbiAgICAgICAgICByZXR1cm4gcGx1cmFsUnVsZVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBNYXAgb2YgcGx1cmFsIHJ1bGVzIHRvIGxhbmd1YWdlcyB3aGVyZSB0aG9zZSBydWxlcyBhcHBseS5cclxuICpcclxuICogTm90ZTogVGhlc2UgZ3JvdXBzIGFyZSBuYW1lZCBmb3IgdGhlIG1vc3QgZG9taW5hbnQgb3IgcmVjb2duaXNhYmxlIGxhbmd1YWdlXHJcbiAqIHRoYXQgdXNlcyBlYWNoIHN5c3RlbS4gVGhlIGdyb3VwaW5ncyBkbyBub3QgaW1wbHkgdGhhdCB0aGUgbGFuZ3VhZ2VzIGFyZVxyXG4gKiByZWxhdGVkIHRvIG9uZSBhbm90aGVyLiBNYW55IGxhbmd1YWdlcyBoYXZlIGV2b2x2ZWQgdGhlIHNhbWUgc3lzdGVtc1xyXG4gKiBpbmRlcGVuZGVudGx5IG9mIG9uZSBhbm90aGVyLlxyXG4gKlxyXG4gKiBDb2RlIHRvIHN1cHBvcnQgbW9yZSBsYW5ndWFnZXMgY2FuIGJlIGZvdW5kIGluIHRoZSBpMThuIHNwaWtlOlxyXG4gKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL2FscGhhZ292L2dvdnVrLWZyb250ZW5kL2Jsb2Ivc3Bpa2UtaTE4bi1zdXBwb3J0L3NyYy9nb3Z1ay9pMThuLm1qc31cclxuICpcclxuICogTGFuZ3VhZ2VzIGN1cnJlbnRseSBzdXBwb3J0ZWQ6XHJcbiAqXHJcbiAqIEFyYWJpYzogQXJhYmljIChhcilcclxuICogQ2hpbmVzZTogQnVybWVzZSAobXkpLCBDaGluZXNlICh6aCksIEluZG9uZXNpYW4gKGlkKSwgSmFwYW5lc2UgKGphKSxcclxuICogICBKYXZhbmVzZSAoanYpLCBLb3JlYW4gKGtvKSwgTWFsYXkgKG1zKSwgVGhhaSAodGgpLCBWaWV0bmFtZXNlICh2aSlcclxuICogRnJlbmNoOiBBcm1lbmlhbiAoaHkpLCBCYW5nbGEgKGJuKSwgRnJlbmNoIChmciksIEd1amFyYXRpIChndSksIEhpbmRpIChoaSksXHJcbiAqICAgUGVyc2lhbiBGYXJzaSAoZmEpLCBQdW5qYWJpIChwYSksIFp1bHUgKHp1KVxyXG4gKiBHZXJtYW46IEFmcmlrYWFucyAoYWYpLCBBbGJhbmlhbiAoc3EpLCBBemVyYmFpamFuaSAoYXopLCBCYXNxdWUgKGV1KSxcclxuICogICBCdWxnYXJpYW4gKGJnKSwgQ2F0YWxhbiAoY2EpLCBEYW5pc2ggKGRhKSwgRHV0Y2ggKG5sKSwgRW5nbGlzaCAoZW4pLFxyXG4gKiAgIEVzdG9uaWFuIChldCksIEZpbm5pc2ggKGZpKSwgR2VvcmdpYW4gKGthKSwgR2VybWFuIChkZSksIEdyZWVrIChlbCksXHJcbiAqICAgSHVuZ2FyaWFuIChodSksIEx1eGVtYm91cmdpc2ggKGxiKSwgTm9yd2VnaWFuIChubyksIFNvbWFsaSAoc28pLFxyXG4gKiAgIFN3YWhpbGkgKHN3KSwgU3dlZGlzaCAoc3YpLCBUYW1pbCAodGEpLCBUZWx1Z3UgKHRlKSwgVHVya2lzaCAodHIpLFxyXG4gKiAgIFVyZHUgKHVyKVxyXG4gKiBJcmlzaDogSXJpc2ggR2FlbGljIChnYSlcclxuICogUnVzc2lhbjogUnVzc2lhbiAocnUpLCBVa3JhaW5pYW4gKHVrKVxyXG4gKiBTY290dGlzaDogU2NvdHRpc2ggR2FlbGljIChnZClcclxuICogU3BhbmlzaDogRXVyb3BlYW4gUG9ydHVndWVzZSAocHQtUFQpLCBJdGFsaWFuIChpdCksIFNwYW5pc2ggKGVzKVxyXG4gKiBXZWxzaDogV2Vsc2ggKGN5KVxyXG4gKlxyXG4gKiBAdHlwZSB7T2JqZWN0PFBsdXJhbFJ1bGVOYW1lLCBzdHJpbmdbXT59XHJcbiAqL1xyXG5JMThuLnBsdXJhbFJ1bGVzTWFwID0ge1xyXG4gIGFyYWJpYzogWydhciddLFxyXG4gIGNoaW5lc2U6IFsnbXknLCAnemgnLCAnaWQnLCAnamEnLCAnanYnLCAna28nLCAnbXMnLCAndGgnLCAndmknXSxcclxuICBmcmVuY2g6IFsnaHknLCAnYm4nLCAnZnInLCAnZ3UnLCAnaGknLCAnZmEnLCAncGEnLCAnenUnXSxcclxuICBnZXJtYW46IFtcclxuICAgICdhZicsICdzcScsICdheicsICdldScsICdiZycsICdjYScsICdkYScsICdubCcsICdlbicsICdldCcsICdmaScsICdrYScsXHJcbiAgICAnZGUnLCAnZWwnLCAnaHUnLCAnbGInLCAnbm8nLCAnc28nLCAnc3cnLCAnc3YnLCAndGEnLCAndGUnLCAndHInLCAndXInXHJcbiAgXSxcclxuICBpcmlzaDogWydnYSddLFxyXG4gIHJ1c3NpYW46IFsncnUnLCAndWsnXSxcclxuICBzY290dGlzaDogWydnZCddLFxyXG4gIHNwYW5pc2g6IFsncHQtUFQnLCAnaXQnLCAnZXMnXSxcclxuICB3ZWxzaDogWydjeSddXHJcbn07XHJcblxyXG4vKipcclxuICogRGlmZmVyZW50IHBsdXJhbGlzYXRpb24gcnVsZSBzZXRzXHJcbiAqXHJcbiAqIFJldHVybnMgdGhlIGFwcHJvcHJpYXRlIHN1ZmZpeCBmb3IgdGhlIHBsdXJhbCBmb3JtIGFzc29jaWF0ZWQgd2l0aCBgbmAuXHJcbiAqIFBvc3NpYmxlIHN1ZmZpeGVzOiAnemVybycsICdvbmUnLCAndHdvJywgJ2ZldycsICdtYW55JywgJ290aGVyJyAodGhlIGFjdHVhbFxyXG4gKiBtZWFuaW5nIG9mIGVhY2ggZGlmZmVycyBwZXIgbG9jYWxlKS4gJ290aGVyJyBzaG91bGQgYWx3YXlzIGV4aXN0LCBldmVuIGluXHJcbiAqIGxhbmd1YWdlcyB3aXRob3V0IHBsdXJhbHMsIHN1Y2ggYXMgQ2hpbmVzZS5cclxuICoge0BsaW5rIGh0dHBzOi8vY2xkci51bmljb2RlLm9yZy9pbmRleC9jbGRyLXNwZWMvcGx1cmFsLXJ1bGVzfVxyXG4gKlxyXG4gKiBUaGUgY291bnQgbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXIuIE5lZ2F0aXZlIG51bWJlcnMgYW5kIGRlY2ltYWxzIGFyZW4ndCBhY2NvdW50ZWQgZm9yXHJcbiAqXHJcbiAqIEB0eXBlIHtPYmplY3Q8c3RyaW5nLCBmdW5jdGlvbihudW1iZXIpOiBQbHVyYWxSdWxlPn1cclxuICovXHJcbkkxOG4ucGx1cmFsUnVsZXMgPSB7XHJcbiAgYXJhYmljOiBmdW5jdGlvbiAobikge1xyXG4gICAgaWYgKG4gPT09IDApIHsgcmV0dXJuICd6ZXJvJyB9XHJcbiAgICBpZiAobiA9PT0gMSkgeyByZXR1cm4gJ29uZScgfVxyXG4gICAgaWYgKG4gPT09IDIpIHsgcmV0dXJuICd0d28nIH1cclxuICAgIGlmIChuICUgMTAwID49IDMgJiYgbiAlIDEwMCA8PSAxMCkgeyByZXR1cm4gJ2ZldycgfVxyXG4gICAgaWYgKG4gJSAxMDAgPj0gMTEgJiYgbiAlIDEwMCA8PSA5OSkgeyByZXR1cm4gJ21hbnknIH1cclxuICAgIHJldHVybiAnb3RoZXInXHJcbiAgfSxcclxuICBjaGluZXNlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gJ290aGVyJ1xyXG4gIH0sXHJcbiAgZnJlbmNoOiBmdW5jdGlvbiAobikge1xyXG4gICAgcmV0dXJuIG4gPT09IDAgfHwgbiA9PT0gMSA/ICdvbmUnIDogJ290aGVyJ1xyXG4gIH0sXHJcbiAgZ2VybWFuOiBmdW5jdGlvbiAobikge1xyXG4gICAgcmV0dXJuIG4gPT09IDEgPyAnb25lJyA6ICdvdGhlcidcclxuICB9LFxyXG4gIGlyaXNoOiBmdW5jdGlvbiAobikge1xyXG4gICAgaWYgKG4gPT09IDEpIHsgcmV0dXJuICdvbmUnIH1cclxuICAgIGlmIChuID09PSAyKSB7IHJldHVybiAndHdvJyB9XHJcbiAgICBpZiAobiA+PSAzICYmIG4gPD0gNikgeyByZXR1cm4gJ2ZldycgfVxyXG4gICAgaWYgKG4gPj0gNyAmJiBuIDw9IDEwKSB7IHJldHVybiAnbWFueScgfVxyXG4gICAgcmV0dXJuICdvdGhlcidcclxuICB9LFxyXG4gIHJ1c3NpYW46IGZ1bmN0aW9uIChuKSB7XHJcbiAgICB2YXIgbGFzdFR3byA9IG4gJSAxMDA7XHJcbiAgICB2YXIgbGFzdCA9IGxhc3RUd28gJSAxMDtcclxuICAgIGlmIChsYXN0ID09PSAxICYmIGxhc3RUd28gIT09IDExKSB7IHJldHVybiAnb25lJyB9XHJcbiAgICBpZiAobGFzdCA+PSAyICYmIGxhc3QgPD0gNCAmJiAhKGxhc3RUd28gPj0gMTIgJiYgbGFzdFR3byA8PSAxNCkpIHsgcmV0dXJuICdmZXcnIH1cclxuICAgIGlmIChsYXN0ID09PSAwIHx8IChsYXN0ID49IDUgJiYgbGFzdCA8PSA5KSB8fCAobGFzdFR3byA+PSAxMSAmJiBsYXN0VHdvIDw9IDE0KSkgeyByZXR1cm4gJ21hbnknIH1cclxuICAgIC8vIE5vdGU6IFRoZSAnb3RoZXInIHN1ZmZpeCBpcyBvbmx5IHVzZWQgYnkgZGVjaW1hbCBudW1iZXJzIGluIFJ1c3NpYW4uXHJcbiAgICAvLyBXZSBkb24ndCBhbnRpY2lwYXRlIGl0IGJlaW5nIHVzZWQsIGJ1dCBpdCdzIGhlcmUgZm9yIGNvbnNpc3RlbmN5LlxyXG4gICAgcmV0dXJuICdvdGhlcidcclxuICB9LFxyXG4gIHNjb3R0aXNoOiBmdW5jdGlvbiAobikge1xyXG4gICAgaWYgKG4gPT09IDEgfHwgbiA9PT0gMTEpIHsgcmV0dXJuICdvbmUnIH1cclxuICAgIGlmIChuID09PSAyIHx8IG4gPT09IDEyKSB7IHJldHVybiAndHdvJyB9XHJcbiAgICBpZiAoKG4gPj0gMyAmJiBuIDw9IDEwKSB8fCAobiA+PSAxMyAmJiBuIDw9IDE5KSkgeyByZXR1cm4gJ2ZldycgfVxyXG4gICAgcmV0dXJuICdvdGhlcidcclxuICB9LFxyXG4gIHNwYW5pc2g6IGZ1bmN0aW9uIChuKSB7XHJcbiAgICBpZiAobiA9PT0gMSkgeyByZXR1cm4gJ29uZScgfVxyXG4gICAgaWYgKG4gJSAxMDAwMDAwID09PSAwICYmIG4gIT09IDApIHsgcmV0dXJuICdtYW55JyB9XHJcbiAgICByZXR1cm4gJ290aGVyJ1xyXG4gIH0sXHJcbiAgd2Vsc2g6IGZ1bmN0aW9uIChuKSB7XHJcbiAgICBpZiAobiA9PT0gMCkgeyByZXR1cm4gJ3plcm8nIH1cclxuICAgIGlmIChuID09PSAxKSB7IHJldHVybiAnb25lJyB9XHJcbiAgICBpZiAobiA9PT0gMikgeyByZXR1cm4gJ3R3bycgfVxyXG4gICAgaWYgKG4gPT09IDMpIHsgcmV0dXJuICdmZXcnIH1cclxuICAgIGlmIChuID09PSA2KSB7IHJldHVybiAnbWFueScgfVxyXG4gICAgcmV0dXJuICdvdGhlcidcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogU3VwcG9ydGVkIGxhbmd1YWdlcyBmb3IgcGx1cmFsIHJ1bGVzXHJcbiAqXHJcbiAqIEB0eXBlZGVmIHsnYXJhYmljJyB8ICdjaGluZXNlJyB8ICdmcmVuY2gnIHwgJ2dlcm1hbicgfCAnaXJpc2gnIHwgJ3J1c3NpYW4nIHwgJ3Njb3R0aXNoJyB8ICdzcGFuaXNoJyB8ICd3ZWxzaCd9IFBsdXJhbFJ1bGVOYW1lXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIFBsdXJhbCBydWxlIGNhdGVnb3J5IG1uZW1vbmljIHRhZ3NcclxuICpcclxuICogQHR5cGVkZWYgeyd6ZXJvJyB8ICdvbmUnIHwgJ3R3bycgfCAnZmV3JyB8ICdtYW55JyB8ICdvdGhlcid9IFBsdXJhbFJ1bGVcclxuICovXHJcblxyXG4vKipcclxuICogVHJhbnNsYXRlZCBtZXNzYWdlIGJ5IHBsdXJhbCBydWxlIHRoZXkgY29ycmVzcG9uZCB0by5cclxuICpcclxuICogQWxsb3dzIHRvIGdyb3VwIHBsdXJhbGlzZWQgbWVzc2FnZXMgdW5kZXIgYSBzaW5nbGUga2V5IHdoZW4gcGFzc2luZ1xyXG4gKiB0cmFuc2xhdGlvbnMgdG8gYSBjb21wb25lbnQncyBjb25zdHJ1Y3RvclxyXG4gKlxyXG4gKiBAdHlwZWRlZiB7b2JqZWN0fSBUcmFuc2xhdGlvblBsdXJhbEZvcm1zXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbb3RoZXJdIC0gR2VuZXJhbCBwbHVyYWwgZm9ybVxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW3plcm9dIC0gUGx1cmFsIGZvcm0gdXNlZCB3aXRoIDBcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IFtvbmVdIC0gUGx1cmFsIGZvcm0gdXNlZCB3aXRoIDFcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IFt0d29dIC0gUGx1cmFsIGZvcm0gdXNlZCB3aXRoIDJcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IFtmZXddIC0gUGx1cmFsIGZvcm0gdXNlZCBmb3IgYSBmZXdcclxuICogQHByb3BlcnR5IHtzdHJpbmd9IFttYW55XSAtIFBsdXJhbCBmb3JtIHVzZWQgZm9yIG1hbnlcclxuICovXHJcblxyXG4vKipcclxuICogVHJhbnNsYXRlZCBtZXNzYWdlcyAoZmxhdHRlbmVkKVxyXG4gKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKiBAdHlwZWRlZiB7T2JqZWN0PHN0cmluZywgc3RyaW5nPiB8IHt9fSBUcmFuc2xhdGlvbnNGbGF0dGVuZWRcclxuICovXHJcblxyXG4oZnVuY3Rpb24odW5kZWZpbmVkKSB7XHJcblxyXG4vLyBEZXRlY3Rpb24gZnJvbSBodHRwczovL2dpdGh1Yi5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLXNlcnZpY2UvYmxvYi9tYXN0ZXIvcGFja2FnZXMvcG9seWZpbGwtbGlicmFyeS9wb2x5ZmlsbHMvT2JqZWN0L2RlZmluZVByb3BlcnR5L2RldGVjdC5qc1xyXG52YXIgZGV0ZWN0ID0gKFxyXG4gIC8vIEluIElFOCwgZGVmaW5lUHJvcGVydHkgY291bGQgb25seSBhY3Qgb24gRE9NIGVsZW1lbnRzLCBzbyBmdWxsIHN1cHBvcnRcclxuICAvLyBmb3IgdGhlIGZlYXR1cmUgcmVxdWlyZXMgdGhlIGFiaWxpdHkgdG8gc2V0IGEgcHJvcGVydHkgb24gYW4gYXJiaXRyYXJ5IG9iamVjdFxyXG4gICdkZWZpbmVQcm9wZXJ0eScgaW4gT2JqZWN0ICYmIChmdW5jdGlvbigpIHtcclxuICBcdHRyeSB7XHJcbiAgXHRcdHZhciBhID0ge307XHJcbiAgXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCAndGVzdCcsIHt2YWx1ZTo0Mn0pO1xyXG4gIFx0XHRyZXR1cm4gdHJ1ZTtcclxuICBcdH0gY2F0Y2goZSkge1xyXG4gIFx0XHRyZXR1cm4gZmFsc2VcclxuICBcdH1cclxuICB9KCkpXHJcbik7XHJcblxyXG5pZiAoZGV0ZWN0KSByZXR1cm5cclxuXHJcbi8vIFBvbHlmaWxsIGZyb20gaHR0cHM6Ly9jZG4ucG9seWZpbGwuaW8vdjIvcG9seWZpbGwuanM/ZmVhdHVyZXM9T2JqZWN0LmRlZmluZVByb3BlcnR5JmZsYWdzPWFsd2F5c1xyXG4oZnVuY3Rpb24gKG5hdGl2ZURlZmluZVByb3BlcnR5KSB7XHJcblxyXG5cdHZhciBzdXBwb3J0c0FjY2Vzc29ycyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkoJ19fZGVmaW5lR2V0dGVyX18nKTtcclxuXHR2YXIgRVJSX0FDQ0VTU09SU19OT1RfU1VQUE9SVEVEID0gJ0dldHRlcnMgJiBzZXR0ZXJzIGNhbm5vdCBiZSBkZWZpbmVkIG9uIHRoaXMgamF2YXNjcmlwdCBlbmdpbmUnO1xyXG5cdHZhciBFUlJfVkFMVUVfQUNDRVNTT1JTID0gJ0EgcHJvcGVydHkgY2Fubm90IGJvdGggaGF2ZSBhY2Nlc3NvcnMgYW5kIGJlIHdyaXRhYmxlIG9yIGhhdmUgYSB2YWx1ZSc7XHJcblxyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KG9iamVjdCwgcHJvcGVydHksIGRlc2NyaXB0b3IpIHtcclxuXHJcblx0XHQvLyBXaGVyZSBuYXRpdmUgc3VwcG9ydCBleGlzdHMsIGFzc3VtZSBpdFxyXG5cdFx0aWYgKG5hdGl2ZURlZmluZVByb3BlcnR5ICYmIChvYmplY3QgPT09IHdpbmRvdyB8fCBvYmplY3QgPT09IGRvY3VtZW50IHx8IG9iamVjdCA9PT0gRWxlbWVudC5wcm90b3R5cGUgfHwgb2JqZWN0IGluc3RhbmNlb2YgRWxlbWVudCkpIHtcclxuXHRcdFx0cmV0dXJuIG5hdGl2ZURlZmluZVByb3BlcnR5KG9iamVjdCwgcHJvcGVydHksIGRlc2NyaXB0b3IpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChvYmplY3QgPT09IG51bGwgfHwgIShvYmplY3QgaW5zdGFuY2VvZiBPYmplY3QgfHwgdHlwZW9mIG9iamVjdCA9PT0gJ29iamVjdCcpKSB7XHJcblx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdC5kZWZpbmVQcm9wZXJ0eSBjYWxsZWQgb24gbm9uLW9iamVjdCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICghKGRlc2NyaXB0b3IgaW5zdGFuY2VvZiBPYmplY3QpKSB7XHJcblx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ1Byb3BlcnR5IGRlc2NyaXB0aW9uIG11c3QgYmUgYW4gb2JqZWN0Jyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIHByb3BlcnR5U3RyaW5nID0gU3RyaW5nKHByb3BlcnR5KTtcclxuXHRcdHZhciBoYXNWYWx1ZU9yV3JpdGFibGUgPSAndmFsdWUnIGluIGRlc2NyaXB0b3IgfHwgJ3dyaXRhYmxlJyBpbiBkZXNjcmlwdG9yO1xyXG5cdFx0dmFyIGdldHRlclR5cGUgPSAnZ2V0JyBpbiBkZXNjcmlwdG9yICYmIHR5cGVvZiBkZXNjcmlwdG9yLmdldDtcclxuXHRcdHZhciBzZXR0ZXJUeXBlID0gJ3NldCcgaW4gZGVzY3JpcHRvciAmJiB0eXBlb2YgZGVzY3JpcHRvci5zZXQ7XHJcblxyXG5cdFx0Ly8gaGFuZGxlIGRlc2NyaXB0b3IuZ2V0XHJcblx0XHRpZiAoZ2V0dGVyVHlwZSkge1xyXG5cdFx0XHRpZiAoZ2V0dGVyVHlwZSAhPT0gJ2Z1bmN0aW9uJykge1xyXG5cdFx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ0dldHRlciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoIXN1cHBvcnRzQWNjZXNzb3JzKSB7XHJcblx0XHRcdFx0dGhyb3cgbmV3IFR5cGVFcnJvcihFUlJfQUNDRVNTT1JTX05PVF9TVVBQT1JURUQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChoYXNWYWx1ZU9yV3JpdGFibGUpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKEVSUl9WQUxVRV9BQ0NFU1NPUlMpO1xyXG5cdFx0XHR9XHJcblx0XHRcdE9iamVjdC5fX2RlZmluZUdldHRlcl9fLmNhbGwob2JqZWN0LCBwcm9wZXJ0eVN0cmluZywgZGVzY3JpcHRvci5nZXQpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0b2JqZWN0W3Byb3BlcnR5U3RyaW5nXSA9IGRlc2NyaXB0b3IudmFsdWU7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gaGFuZGxlIGRlc2NyaXB0b3Iuc2V0XHJcblx0XHRpZiAoc2V0dGVyVHlwZSkge1xyXG5cdFx0XHRpZiAoc2V0dGVyVHlwZSAhPT0gJ2Z1bmN0aW9uJykge1xyXG5cdFx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ1NldHRlciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoIXN1cHBvcnRzQWNjZXNzb3JzKSB7XHJcblx0XHRcdFx0dGhyb3cgbmV3IFR5cGVFcnJvcihFUlJfQUNDRVNTT1JTX05PVF9TVVBQT1JURUQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChoYXNWYWx1ZU9yV3JpdGFibGUpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKEVSUl9WQUxVRV9BQ0NFU1NPUlMpO1xyXG5cdFx0XHR9XHJcblx0XHRcdE9iamVjdC5fX2RlZmluZVNldHRlcl9fLmNhbGwob2JqZWN0LCBwcm9wZXJ0eVN0cmluZywgZGVzY3JpcHRvci5zZXQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIE9LIHRvIGRlZmluZSB2YWx1ZSB1bmNvbmRpdGlvbmFsbHkgLSBpZiBhIGdldHRlciBoYXMgYmVlbiBzcGVjaWZpZWQgYXMgd2VsbCwgYW4gZXJyb3Igd291bGQgYmUgdGhyb3duIGFib3ZlXHJcblx0XHRpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSB7XHJcblx0XHRcdG9iamVjdFtwcm9wZXJ0eVN0cmluZ10gPSBkZXNjcmlwdG9yLnZhbHVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBvYmplY3Q7XHJcblx0fTtcclxufShPYmplY3QuZGVmaW5lUHJvcGVydHkpKTtcclxufSlcclxuLmNhbGwoJ29iamVjdCcgPT09IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93IHx8ICdvYmplY3QnID09PSB0eXBlb2Ygc2VsZiAmJiBzZWxmIHx8ICdvYmplY3QnID09PSB0eXBlb2YgZ2xvYmFsICYmIGdsb2JhbCB8fCB7fSk7XHJcblxyXG4oZnVuY3Rpb24odW5kZWZpbmVkKSB7XHJcbiAgLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlL2Jsb2IvbWFzdGVyL3BhY2thZ2VzL3BvbHlmaWxsLWxpYnJhcnkvcG9seWZpbGxzL0Z1bmN0aW9uL3Byb3RvdHlwZS9iaW5kL2RldGVjdC5qc1xyXG4gIHZhciBkZXRlY3QgPSAnYmluZCcgaW4gRnVuY3Rpb24ucHJvdG90eXBlO1xyXG5cclxuICBpZiAoZGV0ZWN0KSByZXR1cm5cclxuXHJcbiAgLy8gUG9seWZpbGwgZnJvbSBodHRwczovL2Nkbi5wb2x5ZmlsbC5pby92Mi9wb2x5ZmlsbC5qcz9mZWF0dXJlcz1GdW5jdGlvbi5wcm90b3R5cGUuYmluZCZmbGFncz1hbHdheXNcclxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnVuY3Rpb24ucHJvdG90eXBlLCAnYmluZCcsIHtcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJpbmQodGhhdCkgeyAvLyAubGVuZ3RoIGlzIDFcclxuICAgICAgICAgIC8vIGFkZCBuZWNlc3NhcnkgZXM1LXNoaW0gdXRpbGl0aWVzXHJcbiAgICAgICAgICB2YXIgJEFycmF5ID0gQXJyYXk7XHJcbiAgICAgICAgICB2YXIgJE9iamVjdCA9IE9iamVjdDtcclxuICAgICAgICAgIHZhciBPYmplY3RQcm90b3R5cGUgPSAkT2JqZWN0LnByb3RvdHlwZTtcclxuICAgICAgICAgIHZhciBBcnJheVByb3RvdHlwZSA9ICRBcnJheS5wcm90b3R5cGU7XHJcbiAgICAgICAgICB2YXIgRW1wdHkgPSBmdW5jdGlvbiBFbXB0eSgpIHt9O1xyXG4gICAgICAgICAgdmFyIHRvX3N0cmluZyA9IE9iamVjdFByb3RvdHlwZS50b1N0cmluZztcclxuICAgICAgICAgIHZhciBoYXNUb1N0cmluZ1RhZyA9IHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIFN5bWJvbC50b1N0cmluZ1RhZyA9PT0gJ3N5bWJvbCc7XHJcbiAgICAgICAgICB2YXIgaXNDYWxsYWJsZTsgLyogaW5saW5lZCBmcm9tIGh0dHBzOi8vbnBtanMuY29tL2lzLWNhbGxhYmxlICovIHZhciBmblRvU3RyID0gRnVuY3Rpb24ucHJvdG90eXBlLnRvU3RyaW5nLCB0cnlGdW5jdGlvbk9iamVjdCA9IGZ1bmN0aW9uIHRyeUZ1bmN0aW9uT2JqZWN0KHZhbHVlKSB7IHRyeSB7IGZuVG9TdHIuY2FsbCh2YWx1ZSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9LCBmbkNsYXNzID0gJ1tvYmplY3QgRnVuY3Rpb25dJywgZ2VuQ2xhc3MgPSAnW29iamVjdCBHZW5lcmF0b3JGdW5jdGlvbl0nOyBpc0NhbGxhYmxlID0gZnVuY3Rpb24gaXNDYWxsYWJsZSh2YWx1ZSkgeyBpZiAodHlwZW9mIHZhbHVlICE9PSAnZnVuY3Rpb24nKSB7IHJldHVybiBmYWxzZTsgfSBpZiAoaGFzVG9TdHJpbmdUYWcpIHsgcmV0dXJuIHRyeUZ1bmN0aW9uT2JqZWN0KHZhbHVlKTsgfSB2YXIgc3RyQ2xhc3MgPSB0b19zdHJpbmcuY2FsbCh2YWx1ZSk7IHJldHVybiBzdHJDbGFzcyA9PT0gZm5DbGFzcyB8fCBzdHJDbGFzcyA9PT0gZ2VuQ2xhc3M7IH07XHJcbiAgICAgICAgICB2YXIgYXJyYXlfc2xpY2UgPSBBcnJheVByb3RvdHlwZS5zbGljZTtcclxuICAgICAgICAgIHZhciBhcnJheV9jb25jYXQgPSBBcnJheVByb3RvdHlwZS5jb25jYXQ7XHJcbiAgICAgICAgICB2YXIgYXJyYXlfcHVzaCA9IEFycmF5UHJvdG90eXBlLnB1c2g7XHJcbiAgICAgICAgICB2YXIgbWF4ID0gTWF0aC5tYXg7XHJcbiAgICAgICAgICAvLyAvYWRkIG5lY2Vzc2FyeSBlczUtc2hpbSB1dGlsaXRpZXNcclxuXHJcbiAgICAgICAgICAvLyAxLiBMZXQgVGFyZ2V0IGJlIHRoZSB0aGlzIHZhbHVlLlxyXG4gICAgICAgICAgdmFyIHRhcmdldCA9IHRoaXM7XHJcbiAgICAgICAgICAvLyAyLiBJZiBJc0NhbGxhYmxlKFRhcmdldCkgaXMgZmFsc2UsIHRocm93IGEgVHlwZUVycm9yIGV4Y2VwdGlvbi5cclxuICAgICAgICAgIGlmICghaXNDYWxsYWJsZSh0YXJnZXQpKSB7XHJcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgY2FsbGVkIG9uIGluY29tcGF0aWJsZSAnICsgdGFyZ2V0KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIDMuIExldCBBIGJlIGEgbmV3IChwb3NzaWJseSBlbXB0eSkgaW50ZXJuYWwgbGlzdCBvZiBhbGwgb2YgdGhlXHJcbiAgICAgICAgICAvLyAgIGFyZ3VtZW50IHZhbHVlcyBwcm92aWRlZCBhZnRlciB0aGlzQXJnIChhcmcxLCBhcmcyIGV0YyksIGluIG9yZGVyLlxyXG4gICAgICAgICAgLy8gWFhYIHNsaWNlZEFyZ3Mgd2lsbCBzdGFuZCBpbiBmb3IgXCJBXCIgaWYgdXNlZFxyXG4gICAgICAgICAgdmFyIGFyZ3MgPSBhcnJheV9zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7IC8vIGZvciBub3JtYWwgY2FsbFxyXG4gICAgICAgICAgLy8gNC4gTGV0IEYgYmUgYSBuZXcgbmF0aXZlIEVDTUFTY3JpcHQgb2JqZWN0LlxyXG4gICAgICAgICAgLy8gMTEuIFNldCB0aGUgW1tQcm90b3R5cGVdXSBpbnRlcm5hbCBwcm9wZXJ0eSBvZiBGIHRvIHRoZSBzdGFuZGFyZFxyXG4gICAgICAgICAgLy8gICBidWlsdC1pbiBGdW5jdGlvbiBwcm90b3R5cGUgb2JqZWN0IGFzIHNwZWNpZmllZCBpbiAxNS4zLjMuMS5cclxuICAgICAgICAgIC8vIDEyLiBTZXQgdGhlIFtbQ2FsbF1dIGludGVybmFsIHByb3BlcnR5IG9mIEYgYXMgZGVzY3JpYmVkIGluXHJcbiAgICAgICAgICAvLyAgIDE1LjMuNC41LjEuXHJcbiAgICAgICAgICAvLyAxMy4gU2V0IHRoZSBbW0NvbnN0cnVjdF1dIGludGVybmFsIHByb3BlcnR5IG9mIEYgYXMgZGVzY3JpYmVkIGluXHJcbiAgICAgICAgICAvLyAgIDE1LjMuNC41LjIuXHJcbiAgICAgICAgICAvLyAxNC4gU2V0IHRoZSBbW0hhc0luc3RhbmNlXV0gaW50ZXJuYWwgcHJvcGVydHkgb2YgRiBhcyBkZXNjcmliZWQgaW5cclxuICAgICAgICAgIC8vICAgMTUuMy40LjUuMy5cclxuICAgICAgICAgIHZhciBib3VuZDtcclxuICAgICAgICAgIHZhciBiaW5kZXIgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgIGlmICh0aGlzIGluc3RhbmNlb2YgYm91bmQpIHtcclxuICAgICAgICAgICAgICAgICAgLy8gMTUuMy40LjUuMiBbW0NvbnN0cnVjdF1dXHJcbiAgICAgICAgICAgICAgICAgIC8vIFdoZW4gdGhlIFtbQ29uc3RydWN0XV0gaW50ZXJuYWwgbWV0aG9kIG9mIGEgZnVuY3Rpb24gb2JqZWN0LFxyXG4gICAgICAgICAgICAgICAgICAvLyBGIHRoYXQgd2FzIGNyZWF0ZWQgdXNpbmcgdGhlIGJpbmQgZnVuY3Rpb24gaXMgY2FsbGVkIHdpdGggYVxyXG4gICAgICAgICAgICAgICAgICAvLyBsaXN0IG9mIGFyZ3VtZW50cyBFeHRyYUFyZ3MsIHRoZSBmb2xsb3dpbmcgc3RlcHMgYXJlIHRha2VuOlxyXG4gICAgICAgICAgICAgICAgICAvLyAxLiBMZXQgdGFyZ2V0IGJlIHRoZSB2YWx1ZSBvZiBGJ3MgW1tUYXJnZXRGdW5jdGlvbl1dXHJcbiAgICAgICAgICAgICAgICAgIC8vICAgaW50ZXJuYWwgcHJvcGVydHkuXHJcbiAgICAgICAgICAgICAgICAgIC8vIDIuIElmIHRhcmdldCBoYXMgbm8gW1tDb25zdHJ1Y3RdXSBpbnRlcm5hbCBtZXRob2QsIGFcclxuICAgICAgICAgICAgICAgICAgLy8gICBUeXBlRXJyb3IgZXhjZXB0aW9uIGlzIHRocm93bi5cclxuICAgICAgICAgICAgICAgICAgLy8gMy4gTGV0IGJvdW5kQXJncyBiZSB0aGUgdmFsdWUgb2YgRidzIFtbQm91bmRBcmdzXV0gaW50ZXJuYWxcclxuICAgICAgICAgICAgICAgICAgLy8gICBwcm9wZXJ0eS5cclxuICAgICAgICAgICAgICAgICAgLy8gNC4gTGV0IGFyZ3MgYmUgYSBuZXcgbGlzdCBjb250YWluaW5nIHRoZSBzYW1lIHZhbHVlcyBhcyB0aGVcclxuICAgICAgICAgICAgICAgICAgLy8gICBsaXN0IGJvdW5kQXJncyBpbiB0aGUgc2FtZSBvcmRlciBmb2xsb3dlZCBieSB0aGUgc2FtZVxyXG4gICAgICAgICAgICAgICAgICAvLyAgIHZhbHVlcyBhcyB0aGUgbGlzdCBFeHRyYUFyZ3MgaW4gdGhlIHNhbWUgb3JkZXIuXHJcbiAgICAgICAgICAgICAgICAgIC8vIDUuIFJldHVybiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgdGhlIFtbQ29uc3RydWN0XV0gaW50ZXJuYWxcclxuICAgICAgICAgICAgICAgICAgLy8gICBtZXRob2Qgb2YgdGFyZ2V0IHByb3ZpZGluZyBhcmdzIGFzIHRoZSBhcmd1bWVudHMuXHJcblxyXG4gICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdGFyZ2V0LmFwcGx5KFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgIGFycmF5X2NvbmNhdC5jYWxsKGFyZ3MsIGFycmF5X3NsaWNlLmNhbGwoYXJndW1lbnRzKSlcclxuICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgaWYgKCRPYmplY3QocmVzdWx0KSA9PT0gcmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAvLyAxNS4zLjQuNS4xIFtbQ2FsbF1dXHJcbiAgICAgICAgICAgICAgICAgIC8vIFdoZW4gdGhlIFtbQ2FsbF1dIGludGVybmFsIG1ldGhvZCBvZiBhIGZ1bmN0aW9uIG9iamVjdCwgRixcclxuICAgICAgICAgICAgICAgICAgLy8gd2hpY2ggd2FzIGNyZWF0ZWQgdXNpbmcgdGhlIGJpbmQgZnVuY3Rpb24gaXMgY2FsbGVkIHdpdGggYVxyXG4gICAgICAgICAgICAgICAgICAvLyB0aGlzIHZhbHVlIGFuZCBhIGxpc3Qgb2YgYXJndW1lbnRzIEV4dHJhQXJncywgdGhlIGZvbGxvd2luZ1xyXG4gICAgICAgICAgICAgICAgICAvLyBzdGVwcyBhcmUgdGFrZW46XHJcbiAgICAgICAgICAgICAgICAgIC8vIDEuIExldCBib3VuZEFyZ3MgYmUgdGhlIHZhbHVlIG9mIEYncyBbW0JvdW5kQXJnc11dIGludGVybmFsXHJcbiAgICAgICAgICAgICAgICAgIC8vICAgcHJvcGVydHkuXHJcbiAgICAgICAgICAgICAgICAgIC8vIDIuIExldCBib3VuZFRoaXMgYmUgdGhlIHZhbHVlIG9mIEYncyBbW0JvdW5kVGhpc11dIGludGVybmFsXHJcbiAgICAgICAgICAgICAgICAgIC8vICAgcHJvcGVydHkuXHJcbiAgICAgICAgICAgICAgICAgIC8vIDMuIExldCB0YXJnZXQgYmUgdGhlIHZhbHVlIG9mIEYncyBbW1RhcmdldEZ1bmN0aW9uXV0gaW50ZXJuYWxcclxuICAgICAgICAgICAgICAgICAgLy8gICBwcm9wZXJ0eS5cclxuICAgICAgICAgICAgICAgICAgLy8gNC4gTGV0IGFyZ3MgYmUgYSBuZXcgbGlzdCBjb250YWluaW5nIHRoZSBzYW1lIHZhbHVlcyBhcyB0aGVcclxuICAgICAgICAgICAgICAgICAgLy8gICBsaXN0IGJvdW5kQXJncyBpbiB0aGUgc2FtZSBvcmRlciBmb2xsb3dlZCBieSB0aGUgc2FtZVxyXG4gICAgICAgICAgICAgICAgICAvLyAgIHZhbHVlcyBhcyB0aGUgbGlzdCBFeHRyYUFyZ3MgaW4gdGhlIHNhbWUgb3JkZXIuXHJcbiAgICAgICAgICAgICAgICAgIC8vIDUuIFJldHVybiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgdGhlIFtbQ2FsbF1dIGludGVybmFsIG1ldGhvZFxyXG4gICAgICAgICAgICAgICAgICAvLyAgIG9mIHRhcmdldCBwcm92aWRpbmcgYm91bmRUaGlzIGFzIHRoZSB0aGlzIHZhbHVlIGFuZFxyXG4gICAgICAgICAgICAgICAgICAvLyAgIHByb3ZpZGluZyBhcmdzIGFzIHRoZSBhcmd1bWVudHMuXHJcblxyXG4gICAgICAgICAgICAgICAgICAvLyBlcXVpdjogdGFyZ2V0LmNhbGwodGhpcywgLi4uYm91bmRBcmdzLCAuLi5hcmdzKVxyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0LmFwcGx5KFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGhhdCxcclxuICAgICAgICAgICAgICAgICAgICAgIGFycmF5X2NvbmNhdC5jYWxsKGFyZ3MsIGFycmF5X3NsaWNlLmNhbGwoYXJndW1lbnRzKSlcclxuICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgLy8gMTUuIElmIHRoZSBbW0NsYXNzXV0gaW50ZXJuYWwgcHJvcGVydHkgb2YgVGFyZ2V0IGlzIFwiRnVuY3Rpb25cIiwgdGhlblxyXG4gICAgICAgICAgLy8gICAgIGEuIExldCBMIGJlIHRoZSBsZW5ndGggcHJvcGVydHkgb2YgVGFyZ2V0IG1pbnVzIHRoZSBsZW5ndGggb2YgQS5cclxuICAgICAgICAgIC8vICAgICBiLiBTZXQgdGhlIGxlbmd0aCBvd24gcHJvcGVydHkgb2YgRiB0byBlaXRoZXIgMCBvciBMLCB3aGljaGV2ZXIgaXNcclxuICAgICAgICAgIC8vICAgICAgIGxhcmdlci5cclxuICAgICAgICAgIC8vIDE2LiBFbHNlIHNldCB0aGUgbGVuZ3RoIG93biBwcm9wZXJ0eSBvZiBGIHRvIDAuXHJcblxyXG4gICAgICAgICAgdmFyIGJvdW5kTGVuZ3RoID0gbWF4KDAsIHRhcmdldC5sZW5ndGggLSBhcmdzLmxlbmd0aCk7XHJcblxyXG4gICAgICAgICAgLy8gMTcuIFNldCB0aGUgYXR0cmlidXRlcyBvZiB0aGUgbGVuZ3RoIG93biBwcm9wZXJ0eSBvZiBGIHRvIHRoZSB2YWx1ZXNcclxuICAgICAgICAgIC8vICAgc3BlY2lmaWVkIGluIDE1LjMuNS4xLlxyXG4gICAgICAgICAgdmFyIGJvdW5kQXJncyA9IFtdO1xyXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBib3VuZExlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgYXJyYXlfcHVzaC5jYWxsKGJvdW5kQXJncywgJyQnICsgaSk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gWFhYIEJ1aWxkIGEgZHluYW1pYyBmdW5jdGlvbiB3aXRoIGRlc2lyZWQgYW1vdW50IG9mIGFyZ3VtZW50cyBpcyB0aGUgb25seVxyXG4gICAgICAgICAgLy8gd2F5IHRvIHNldCB0aGUgbGVuZ3RoIHByb3BlcnR5IG9mIGEgZnVuY3Rpb24uXHJcbiAgICAgICAgICAvLyBJbiBlbnZpcm9ubWVudHMgd2hlcmUgQ29udGVudCBTZWN1cml0eSBQb2xpY2llcyBlbmFibGVkIChDaHJvbWUgZXh0ZW5zaW9ucyxcclxuICAgICAgICAgIC8vIGZvciBleC4pIGFsbCB1c2Ugb2YgZXZhbCBvciBGdW5jdGlvbiBjb3N0cnVjdG9yIHRocm93cyBhbiBleGNlcHRpb24uXHJcbiAgICAgICAgICAvLyBIb3dldmVyIGluIGFsbCBvZiB0aGVzZSBlbnZpcm9ubWVudHMgRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgZXhpc3RzXHJcbiAgICAgICAgICAvLyBhbmQgc28gdGhpcyBjb2RlIHdpbGwgbmV2ZXIgYmUgZXhlY3V0ZWQuXHJcbiAgICAgICAgICBib3VuZCA9IEZ1bmN0aW9uKCdiaW5kZXInLCAncmV0dXJuIGZ1bmN0aW9uICgnICsgYm91bmRBcmdzLmpvaW4oJywnKSArICcpeyByZXR1cm4gYmluZGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0nKShiaW5kZXIpO1xyXG5cclxuICAgICAgICAgIGlmICh0YXJnZXQucHJvdG90eXBlKSB7XHJcbiAgICAgICAgICAgICAgRW1wdHkucHJvdG90eXBlID0gdGFyZ2V0LnByb3RvdHlwZTtcclxuICAgICAgICAgICAgICBib3VuZC5wcm90b3R5cGUgPSBuZXcgRW1wdHkoKTtcclxuICAgICAgICAgICAgICAvLyBDbGVhbiB1cCBkYW5nbGluZyByZWZlcmVuY2VzLlxyXG4gICAgICAgICAgICAgIEVtcHR5LnByb3RvdHlwZSA9IG51bGw7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gVE9ET1xyXG4gICAgICAgICAgLy8gMTguIFNldCB0aGUgW1tFeHRlbnNpYmxlXV0gaW50ZXJuYWwgcHJvcGVydHkgb2YgRiB0byB0cnVlLlxyXG5cclxuICAgICAgICAgIC8vIFRPRE9cclxuICAgICAgICAgIC8vIDE5LiBMZXQgdGhyb3dlciBiZSB0aGUgW1tUaHJvd1R5cGVFcnJvcl1dIGZ1bmN0aW9uIE9iamVjdCAoMTMuMi4zKS5cclxuICAgICAgICAgIC8vIDIwLiBDYWxsIHRoZSBbW0RlZmluZU93blByb3BlcnR5XV0gaW50ZXJuYWwgbWV0aG9kIG9mIEYgd2l0aFxyXG4gICAgICAgICAgLy8gICBhcmd1bWVudHMgXCJjYWxsZXJcIiwgUHJvcGVydHlEZXNjcmlwdG9yIHtbW0dldF1dOiB0aHJvd2VyLCBbW1NldF1dOlxyXG4gICAgICAgICAgLy8gICB0aHJvd2VyLCBbW0VudW1lcmFibGVdXTogZmFsc2UsIFtbQ29uZmlndXJhYmxlXV06IGZhbHNlfSwgYW5kXHJcbiAgICAgICAgICAvLyAgIGZhbHNlLlxyXG4gICAgICAgICAgLy8gMjEuIENhbGwgdGhlIFtbRGVmaW5lT3duUHJvcGVydHldXSBpbnRlcm5hbCBtZXRob2Qgb2YgRiB3aXRoXHJcbiAgICAgICAgICAvLyAgIGFyZ3VtZW50cyBcImFyZ3VtZW50c1wiLCBQcm9wZXJ0eURlc2NyaXB0b3Ige1tbR2V0XV06IHRocm93ZXIsXHJcbiAgICAgICAgICAvLyAgIFtbU2V0XV06IHRocm93ZXIsIFtbRW51bWVyYWJsZV1dOiBmYWxzZSwgW1tDb25maWd1cmFibGVdXTogZmFsc2V9LFxyXG4gICAgICAgICAgLy8gICBhbmQgZmFsc2UuXHJcblxyXG4gICAgICAgICAgLy8gVE9ET1xyXG4gICAgICAgICAgLy8gTk9URSBGdW5jdGlvbiBvYmplY3RzIGNyZWF0ZWQgdXNpbmcgRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgZG8gbm90XHJcbiAgICAgICAgICAvLyBoYXZlIGEgcHJvdG90eXBlIHByb3BlcnR5IG9yIHRoZSBbW0NvZGVdXSwgW1tGb3JtYWxQYXJhbWV0ZXJzXV0sIGFuZFxyXG4gICAgICAgICAgLy8gW1tTY29wZV1dIGludGVybmFsIHByb3BlcnRpZXMuXHJcbiAgICAgICAgICAvLyBYWFggY2FuJ3QgZGVsZXRlIHByb3RvdHlwZSBpbiBwdXJlLWpzLlxyXG5cclxuICAgICAgICAgIC8vIDIyLiBSZXR1cm4gRi5cclxuICAgICAgICAgIHJldHVybiBib3VuZDtcclxuICAgICAgfVxyXG4gIH0pO1xyXG59KVxyXG4uY2FsbCgnb2JqZWN0JyA9PT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBzZWxmICYmIHNlbGYgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBnbG9iYWwgJiYgZ2xvYmFsIHx8IHt9KTtcclxuXHJcbihmdW5jdGlvbih1bmRlZmluZWQpIHtcclxuXHJcbiAgICAvLyBEZXRlY3Rpb24gZnJvbSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLXNlcnZpY2UvbWFzdGVyL3BhY2thZ2VzL3BvbHlmaWxsLWxpYnJhcnkvcG9seWZpbGxzL0RPTVRva2VuTGlzdC9kZXRlY3QuanNcclxuICAgIHZhciBkZXRlY3QgPSAoXHJcbiAgICAgICdET01Ub2tlbkxpc3QnIGluIHRoaXMgJiYgKGZ1bmN0aW9uICh4KSB7XHJcbiAgICAgICAgcmV0dXJuICdjbGFzc0xpc3QnIGluIHggPyAheC5jbGFzc0xpc3QudG9nZ2xlKCd4JywgZmFsc2UpICYmICF4LmNsYXNzTmFtZSA6IHRydWU7XHJcbiAgICAgIH0pKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3gnKSlcclxuICAgICk7XHJcblxyXG4gICAgaWYgKGRldGVjdCkgcmV0dXJuXHJcblxyXG4gICAgLy8gUG9seWZpbGwgZnJvbSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLXNlcnZpY2UvbWFzdGVyL3BhY2thZ2VzL3BvbHlmaWxsLWxpYnJhcnkvcG9seWZpbGxzL0RPTVRva2VuTGlzdC9wb2x5ZmlsbC5qc1xyXG4gICAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcclxuICAgICAgdmFyIG5hdGl2ZUltcGwgPSBcIkRPTVRva2VuTGlzdFwiIGluIGdsb2JhbCAmJiBnbG9iYWwuRE9NVG9rZW5MaXN0O1xyXG5cclxuICAgICAgaWYgKFxyXG4gICAgICAgICAgIW5hdGl2ZUltcGwgfHxcclxuICAgICAgICAgIChcclxuICAgICAgICAgICAgISFkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMgJiZcclxuICAgICAgICAgICAgISFkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpICYmXHJcbiAgICAgICAgICAgICEoZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgXCJzdmdcIikuY2xhc3NMaXN0IGluc3RhbmNlb2YgRE9NVG9rZW5MaXN0KVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgIGdsb2JhbC5ET01Ub2tlbkxpc3QgPSAoZnVuY3Rpb24oKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcclxuICAgICAgICAgIHZhciBkcFN1cHBvcnQgPSB0cnVlO1xyXG4gICAgICAgICAgdmFyIGRlZmluZUdldHRlciA9IGZ1bmN0aW9uIChvYmplY3QsIG5hbWUsIGZuLCBjb25maWd1cmFibGUpIHtcclxuICAgICAgICAgICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSlcclxuICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqZWN0LCBuYW1lLCB7XHJcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlID09PSBkcFN1cHBvcnQgPyB0cnVlIDogISFjb25maWd1cmFibGUsXHJcbiAgICAgICAgICAgICAgICBnZXQ6IGZuXHJcbiAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBlbHNlIG9iamVjdC5fX2RlZmluZUdldHRlcl9fKG5hbWUsIGZuKTtcclxuICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgLyoqIEVuc3VyZSB0aGUgYnJvd3NlciBhbGxvd3MgT2JqZWN0LmRlZmluZVByb3BlcnR5IHRvIGJlIHVzZWQgb24gbmF0aXZlIEphdmFTY3JpcHQgb2JqZWN0cy4gKi9cclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGRlZmluZUdldHRlcih7fSwgXCJzdXBwb3J0XCIpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgZHBTdXBwb3J0ID0gZmFsc2U7XHJcbiAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgIHZhciBfRE9NVG9rZW5MaXN0ID0gZnVuY3Rpb24gKGVsLCBwcm9wKSB7XHJcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHRva2VucyA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgdG9rZW5NYXAgPSB7fTtcclxuICAgICAgICAgICAgdmFyIGxlbmd0aCA9IDA7XHJcbiAgICAgICAgICAgIHZhciBtYXhMZW5ndGggPSAwO1xyXG4gICAgICAgICAgICB2YXIgYWRkSW5kZXhHZXR0ZXIgPSBmdW5jdGlvbiAoaSkge1xyXG4gICAgICAgICAgICAgIGRlZmluZUdldHRlcih0aGF0LCBpLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBwcmVvcCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRva2Vuc1tpXTtcclxuICAgICAgICAgICAgICB9LCBmYWxzZSk7XHJcblxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgcmVpbmRleCA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgLyoqIERlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBhcnJheS1saWtlIGFjY2VzcyB0byB0aGUgdG9rZW5MaXN0J3MgY29udGVudHMuICovXHJcbiAgICAgICAgICAgICAgaWYgKGxlbmd0aCA+PSBtYXhMZW5ndGgpXHJcbiAgICAgICAgICAgICAgICBmb3IgKDsgbWF4TGVuZ3RoIDwgbGVuZ3RoOyArK21heExlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICBhZGRJbmRleEdldHRlcihtYXhMZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgLyoqIEhlbHBlciBmdW5jdGlvbiBjYWxsZWQgYXQgdGhlIHN0YXJ0IG9mIGVhY2ggY2xhc3MgbWV0aG9kLiBJbnRlcm5hbCB1c2Ugb25seS4gKi9cclxuICAgICAgICAgICAgdmFyIHByZW9wID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgIHZhciBlcnJvcjtcclxuICAgICAgICAgICAgICB2YXIgaTtcclxuICAgICAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcclxuICAgICAgICAgICAgICB2YXIgclNwYWNlID0gL1xccysvO1xyXG5cclxuICAgICAgICAgICAgICAvKiogVmFsaWRhdGUgdGhlIHRva2VuL3MgcGFzc2VkIHRvIGFuIGluc3RhbmNlIG1ldGhvZCwgaWYgYW55LiAqL1xyXG4gICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aClcclxuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgKytpKVxyXG4gICAgICAgICAgICAgICAgICBpZiAoclNwYWNlLnRlc3QoYXJnc1tpXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlcnJvciA9IG5ldyBTeW50YXhFcnJvcignU3RyaW5nIFwiJyArIGFyZ3NbaV0gKyAnXCIgJyArIFwiY29udGFpbnNcIiArICcgYW4gaW52YWxpZCBjaGFyYWN0ZXInKTtcclxuICAgICAgICAgICAgICAgICAgICBlcnJvci5jb2RlID0gNTtcclxuICAgICAgICAgICAgICAgICAgICBlcnJvci5uYW1lID0gXCJJbnZhbGlkQ2hhcmFjdGVyRXJyb3JcIjtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgLyoqIFNwbGl0IHRoZSBuZXcgdmFsdWUgYXBhcnQgYnkgd2hpdGVzcGFjZSovXHJcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlbFtwcm9wXSA9PT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICAgICAgdG9rZW5zID0gKFwiXCIgKyBlbFtwcm9wXS5iYXNlVmFsKS5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCBcIlwiKS5zcGxpdChyU3BhY2UpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0b2tlbnMgPSAoXCJcIiArIGVsW3Byb3BdKS5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCBcIlwiKS5zcGxpdChyU3BhY2UpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLyoqIEF2b2lkIHRyZWF0aW5nIGJsYW5rIHN0cmluZ3MgYXMgc2luZ2xlLWl0ZW0gdG9rZW4gbGlzdHMgKi9cclxuICAgICAgICAgICAgICBpZiAoXCJcIiA9PT0gdG9rZW5zWzBdKSB0b2tlbnMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgLyoqIFJlcG9wdWxhdGUgdGhlIGludGVybmFsIHRva2VuIGxpc3RzICovXHJcbiAgICAgICAgICAgICAgdG9rZW5NYXAgPSB7fTtcclxuICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aDsgKytpKVxyXG4gICAgICAgICAgICAgICAgdG9rZW5NYXBbdG9rZW5zW2ldXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgbGVuZ3RoID0gdG9rZW5zLmxlbmd0aDtcclxuICAgICAgICAgICAgICByZWluZGV4KCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAvKiogUG9wdWxhdGUgb3VyIGludGVybmFsIHRva2VuIGxpc3QgaWYgdGhlIHRhcmdldGVkIGF0dHJpYnV0ZSBvZiB0aGUgc3ViamVjdCBlbGVtZW50IGlzbid0IGVtcHR5LiAqL1xyXG4gICAgICAgICAgICBwcmVvcCgpO1xyXG5cclxuICAgICAgICAgICAgLyoqIFJldHVybiB0aGUgbnVtYmVyIG9mIHRva2VucyBpbiB0aGUgdW5kZXJseWluZyBzdHJpbmcuIFJlYWQtb25seS4gKi9cclxuICAgICAgICAgICAgZGVmaW5lR2V0dGVyKHRoYXQsIFwibGVuZ3RoXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICBwcmVvcCgpO1xyXG4gICAgICAgICAgICAgIHJldHVybiBsZW5ndGg7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLyoqIE92ZXJyaWRlIHRoZSBkZWZhdWx0IHRvU3RyaW5nL3RvTG9jYWxlU3RyaW5nIG1ldGhvZHMgdG8gcmV0dXJuIGEgc3BhY2UtZGVsaW1pdGVkIGxpc3Qgb2YgdG9rZW5zIHdoZW4gdHlwZWNhc3QuICovXHJcbiAgICAgICAgICAgIHRoYXQudG9Mb2NhbGVTdHJpbmcgPVxyXG4gICAgICAgICAgICAgIHRoYXQudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBwcmVvcCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRva2Vucy5qb2luKFwiIFwiKTtcclxuICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdGhhdC5pdGVtID0gZnVuY3Rpb24gKGlkeCkge1xyXG4gICAgICAgICAgICAgIHByZW9wKCk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHRva2Vuc1tpZHhdO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdGhhdC5jb250YWlucyA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgICAgICAgIHByZW9wKCk7XHJcbiAgICAgICAgICAgICAgcmV0dXJuICEhdG9rZW5NYXBbdG9rZW5dO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdGhhdC5hZGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgcHJlb3AuYXBwbHkodGhhdCwgYXJncyA9IGFyZ3VtZW50cyk7XHJcblxyXG4gICAgICAgICAgICAgIGZvciAodmFyIGFyZ3MsIHRva2VuLCBpID0gMCwgbCA9IGFyZ3MubGVuZ3RoOyBpIDwgbDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICB0b2tlbiA9IGFyZ3NbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRva2VuTWFwW3Rva2VuXSkge1xyXG4gICAgICAgICAgICAgICAgICB0b2tlbnMucHVzaCh0b2tlbik7XHJcbiAgICAgICAgICAgICAgICAgIHRva2VuTWFwW3Rva2VuXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAvKiogVXBkYXRlIHRoZSB0YXJnZXRlZCBhdHRyaWJ1dGUgb2YgdGhlIGF0dGFjaGVkIGVsZW1lbnQgaWYgdGhlIHRva2VuIGxpc3QncyBjaGFuZ2VkLiAqL1xyXG4gICAgICAgICAgICAgIGlmIChsZW5ndGggIT09IHRva2Vucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGxlbmd0aCA9IHRva2Vucy5sZW5ndGggPj4+IDA7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVsW3Byb3BdID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgIGVsW3Byb3BdLmJhc2VWYWwgPSB0b2tlbnMuam9pbihcIiBcIik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICBlbFtwcm9wXSA9IHRva2Vucy5qb2luKFwiIFwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJlaW5kZXgoKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB0aGF0LnJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICBwcmVvcC5hcHBseSh0aGF0LCBhcmdzID0gYXJndW1lbnRzKTtcclxuXHJcbiAgICAgICAgICAgICAgLyoqIEJ1aWxkIGEgaGFzaCBvZiB0b2tlbiBuYW1lcyB0byBjb21wYXJlIGFnYWluc3Qgd2hlbiByZWNvbGxlY3Rpbmcgb3VyIHRva2VuIGxpc3QuICovXHJcbiAgICAgICAgICAgICAgZm9yICh2YXIgYXJncywgaWdub3JlID0ge30sIGkgPSAwLCB0ID0gW107IGkgPCBhcmdzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICBpZ25vcmVbYXJnc1tpXV0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRva2VuTWFwW2FyZ3NbaV1dO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLyoqIFJ1biB0aHJvdWdoIG91ciB0b2tlbnMgbGlzdCBhbmQgcmVhc3NpZ24gb25seSB0aG9zZSB0aGF0IGFyZW4ndCBkZWZpbmVkIGluIHRoZSBoYXNoIGRlY2xhcmVkIGFib3ZlLiAqL1xyXG4gICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyArK2kpXHJcbiAgICAgICAgICAgICAgICBpZiAoIWlnbm9yZVt0b2tlbnNbaV1dKSB0LnB1c2godG9rZW5zW2ldKTtcclxuXHJcbiAgICAgICAgICAgICAgdG9rZW5zID0gdDtcclxuICAgICAgICAgICAgICBsZW5ndGggPSB0Lmxlbmd0aCA+Pj4gMDtcclxuXHJcbiAgICAgICAgICAgICAgLyoqIFVwZGF0ZSB0aGUgdGFyZ2V0ZWQgYXR0cmlidXRlIG9mIHRoZSBhdHRhY2hlZCBlbGVtZW50LiAqL1xyXG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgZWxbcHJvcF0gPT09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgIGVsW3Byb3BdLmJhc2VWYWwgPSB0b2tlbnMuam9pbihcIiBcIik7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGVsW3Byb3BdID0gdG9rZW5zLmpvaW4oXCIgXCIpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICByZWluZGV4KCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB0aGF0LnRvZ2dsZSA9IGZ1bmN0aW9uICh0b2tlbiwgZm9yY2UpIHtcclxuICAgICAgICAgICAgICBwcmVvcC5hcHBseSh0aGF0LCBbdG9rZW5dKTtcclxuXHJcbiAgICAgICAgICAgICAgLyoqIFRva2VuIHN0YXRlJ3MgYmVpbmcgZm9yY2VkLiAqL1xyXG4gICAgICAgICAgICAgIGlmICh1bmRlZmluZWQgIT09IGZvcmNlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9yY2UpIHtcclxuICAgICAgICAgICAgICAgICAgdGhhdC5hZGQodG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgIHRoYXQucmVtb3ZlKHRva2VuKTtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLyoqIFRva2VuIGFscmVhZHkgZXhpc3RzIGluIHRva2VuTGlzdC4gUmVtb3ZlIGl0LCBhbmQgcmV0dXJuIEZBTFNFLiAqL1xyXG4gICAgICAgICAgICAgIGlmICh0b2tlbk1hcFt0b2tlbl0pIHtcclxuICAgICAgICAgICAgICAgIHRoYXQucmVtb3ZlKHRva2VuKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8qKiBPdGhlcndpc2UsIGFkZCB0aGUgdG9rZW4gYW5kIHJldHVybiBUUlVFLiAqL1xyXG4gICAgICAgICAgICAgIHRoYXQuYWRkKHRva2VuKTtcclxuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGF0O1xyXG4gICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICByZXR1cm4gX0RPTVRva2VuTGlzdDtcclxuICAgICAgICB9KCkpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBBZGQgc2Vjb25kIGFyZ3VtZW50IHRvIG5hdGl2ZSBET01Ub2tlbkxpc3QudG9nZ2xlKCkgaWYgbmVjZXNzYXJ5XHJcbiAgICAgIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgICAgaWYgKCEoJ2NsYXNzTGlzdCcgaW4gZSkpIHJldHVybjtcclxuICAgICAgICBlLmNsYXNzTGlzdC50b2dnbGUoJ3gnLCBmYWxzZSk7XHJcbiAgICAgICAgaWYgKCFlLmNsYXNzTGlzdC5jb250YWlucygneCcpKSByZXR1cm47XHJcbiAgICAgICAgZS5jbGFzc0xpc3QuY29uc3RydWN0b3IucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uIHRvZ2dsZSh0b2tlbiAvKiwgZm9yY2UqLykge1xyXG4gICAgICAgICAgdmFyIGZvcmNlID0gYXJndW1lbnRzWzFdO1xyXG4gICAgICAgICAgaWYgKGZvcmNlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdmFyIGFkZCA9ICF0aGlzLmNvbnRhaW5zKHRva2VuKTtcclxuICAgICAgICAgICAgdGhpc1thZGQgPyAnYWRkJyA6ICdyZW1vdmUnXSh0b2tlbik7XHJcbiAgICAgICAgICAgIHJldHVybiBhZGQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBmb3JjZSA9ICEhZm9yY2U7XHJcbiAgICAgICAgICB0aGlzW2ZvcmNlID8gJ2FkZCcgOiAncmVtb3ZlJ10odG9rZW4pO1xyXG4gICAgICAgICAgcmV0dXJuIGZvcmNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0oKSk7XHJcblxyXG4gICAgICAvLyBBZGQgbXVsdGlwbGUgYXJndW1lbnRzIHRvIG5hdGl2ZSBET01Ub2tlbkxpc3QuYWRkKCkgaWYgbmVjZXNzYXJ5XHJcbiAgICAgIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgICAgaWYgKCEoJ2NsYXNzTGlzdCcgaW4gZSkpIHJldHVybjtcclxuICAgICAgICBlLmNsYXNzTGlzdC5hZGQoJ2EnLCAnYicpO1xyXG4gICAgICAgIGlmIChlLmNsYXNzTGlzdC5jb250YWlucygnYicpKSByZXR1cm47XHJcbiAgICAgICAgdmFyIG5hdGl2ZSA9IGUuY2xhc3NMaXN0LmNvbnN0cnVjdG9yLnByb3RvdHlwZS5hZGQ7XHJcbiAgICAgICAgZS5jbGFzc0xpc3QuY29uc3RydWN0b3IucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xyXG4gICAgICAgICAgdmFyIGwgPSBhcmd1bWVudHMubGVuZ3RoO1xyXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICAgICAgbmF0aXZlLmNhbGwodGhpcywgYXJnc1tpXSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgfSgpKTtcclxuXHJcbiAgICAgIC8vIEFkZCBtdWx0aXBsZSBhcmd1bWVudHMgdG8gbmF0aXZlIERPTVRva2VuTGlzdC5yZW1vdmUoKSBpZiBuZWNlc3NhcnlcclxuICAgICAgKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgICBpZiAoISgnY2xhc3NMaXN0JyBpbiBlKSkgcmV0dXJuO1xyXG4gICAgICAgIGUuY2xhc3NMaXN0LmFkZCgnYScpO1xyXG4gICAgICAgIGUuY2xhc3NMaXN0LmFkZCgnYicpO1xyXG4gICAgICAgIGUuY2xhc3NMaXN0LnJlbW92ZSgnYScsICdiJyk7XHJcbiAgICAgICAgaWYgKCFlLmNsYXNzTGlzdC5jb250YWlucygnYicpKSByZXR1cm47XHJcbiAgICAgICAgdmFyIG5hdGl2ZSA9IGUuY2xhc3NMaXN0LmNvbnN0cnVjdG9yLnByb3RvdHlwZS5yZW1vdmU7XHJcbiAgICAgICAgZS5jbGFzc0xpc3QuY29uc3RydWN0b3IucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xyXG4gICAgICAgICAgdmFyIGwgPSBhcmd1bWVudHMubGVuZ3RoO1xyXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICAgICAgbmF0aXZlLmNhbGwodGhpcywgYXJnc1tpXSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgfSgpKTtcclxuXHJcbiAgICB9KHRoaXMpKTtcclxuXHJcbn0pLmNhbGwoJ29iamVjdCcgPT09IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93IHx8ICdvYmplY3QnID09PSB0eXBlb2Ygc2VsZiAmJiBzZWxmIHx8ICdvYmplY3QnID09PSB0eXBlb2YgZ2xvYmFsICYmIGdsb2JhbCB8fCB7fSk7XHJcblxyXG4oZnVuY3Rpb24odW5kZWZpbmVkKSB7XHJcblxyXG4vLyBEZXRlY3Rpb24gZnJvbSBodHRwczovL2dpdGh1Yi5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLXNlcnZpY2UvYmxvYi9tYXN0ZXIvcGFja2FnZXMvcG9seWZpbGwtbGlicmFyeS9wb2x5ZmlsbHMvRG9jdW1lbnQvZGV0ZWN0LmpzXHJcbnZhciBkZXRlY3QgPSAoXCJEb2N1bWVudFwiIGluIHRoaXMpO1xyXG5cclxuaWYgKGRldGVjdCkgcmV0dXJuXHJcblxyXG4vLyBQb2x5ZmlsbCBmcm9tIGh0dHBzOi8vY2RuLnBvbHlmaWxsLmlvL3YyL3BvbHlmaWxsLmpzP2ZlYXR1cmVzPURvY3VtZW50JmZsYWdzPWFsd2F5c1xyXG5pZiAoKHR5cGVvZiBXb3JrZXJHbG9iYWxTY29wZSA9PT0gXCJ1bmRlZmluZWRcIikgJiYgKHR5cGVvZiBpbXBvcnRTY3JpcHRzICE9PSBcImZ1bmN0aW9uXCIpKSB7XHJcblxyXG5cdGlmICh0aGlzLkhUTUxEb2N1bWVudCkgeyAvLyBJRThcclxuXHJcblx0XHQvLyBIVE1MRG9jdW1lbnQgaXMgYW4gZXh0ZW5zaW9uIG9mIERvY3VtZW50LiAgSWYgdGhlIGJyb3dzZXIgaGFzIEhUTUxEb2N1bWVudCBidXQgbm90IERvY3VtZW50LCB0aGUgZm9ybWVyIHdpbGwgc3VmZmljZSBhcyBhbiBhbGlhcyBmb3IgdGhlIGxhdHRlci5cclxuXHRcdHRoaXMuRG9jdW1lbnQgPSB0aGlzLkhUTUxEb2N1bWVudDtcclxuXHJcblx0fSBlbHNlIHtcclxuXHJcblx0XHQvLyBDcmVhdGUgYW4gZW1wdHkgZnVuY3Rpb24gdG8gYWN0IGFzIHRoZSBtaXNzaW5nIGNvbnN0cnVjdG9yIGZvciB0aGUgZG9jdW1lbnQgb2JqZWN0LCBhdHRhY2ggdGhlIGRvY3VtZW50IG9iamVjdCBhcyBpdHMgcHJvdG90eXBlLiAgVGhlIGZ1bmN0aW9uIG5lZWRzIHRvIGJlIGFub255bW91cyBlbHNlIGl0IGlzIGhvaXN0ZWQgYW5kIGNhdXNlcyB0aGUgZmVhdHVyZSBkZXRlY3QgdG8gcHJlbWF0dXJlbHkgcGFzcywgcHJldmVudGluZyB0aGUgYXNzaWdubWVudHMgYmVsb3cgYmVpbmcgbWFkZS5cclxuXHRcdHRoaXMuRG9jdW1lbnQgPSB0aGlzLkhUTUxEb2N1bWVudCA9IGRvY3VtZW50LmNvbnN0cnVjdG9yID0gKG5ldyBGdW5jdGlvbigncmV0dXJuIGZ1bmN0aW9uIERvY3VtZW50KCkge30nKSgpKTtcclxuXHRcdHRoaXMuRG9jdW1lbnQucHJvdG90eXBlID0gZG9jdW1lbnQ7XHJcblx0fVxyXG59XHJcblxyXG5cclxufSlcclxuLmNhbGwoJ29iamVjdCcgPT09IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93IHx8ICdvYmplY3QnID09PSB0eXBlb2Ygc2VsZiAmJiBzZWxmIHx8ICdvYmplY3QnID09PSB0eXBlb2YgZ2xvYmFsICYmIGdsb2JhbCB8fCB7fSk7XHJcblxyXG4oZnVuY3Rpb24odW5kZWZpbmVkKSB7XHJcblxyXG4vLyBEZXRlY3Rpb24gZnJvbSBodHRwczovL2dpdGh1Yi5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLXNlcnZpY2UvYmxvYi9tYXN0ZXIvcGFja2FnZXMvcG9seWZpbGwtbGlicmFyeS9wb2x5ZmlsbHMvRWxlbWVudC9kZXRlY3QuanNcclxudmFyIGRldGVjdCA9ICgnRWxlbWVudCcgaW4gdGhpcyAmJiAnSFRNTEVsZW1lbnQnIGluIHRoaXMpO1xyXG5cclxuaWYgKGRldGVjdCkgcmV0dXJuXHJcblxyXG4vLyBQb2x5ZmlsbCBmcm9tIGh0dHBzOi8vY2RuLnBvbHlmaWxsLmlvL3YyL3BvbHlmaWxsLmpzP2ZlYXR1cmVzPUVsZW1lbnQmZmxhZ3M9YWx3YXlzXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG5cdC8vIElFOFxyXG5cdGlmICh3aW5kb3cuRWxlbWVudCAmJiAhd2luZG93LkhUTUxFbGVtZW50KSB7XHJcblx0XHR3aW5kb3cuSFRNTEVsZW1lbnQgPSB3aW5kb3cuRWxlbWVudDtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdC8vIGNyZWF0ZSBFbGVtZW50IGNvbnN0cnVjdG9yXHJcblx0d2luZG93LkVsZW1lbnQgPSB3aW5kb3cuSFRNTEVsZW1lbnQgPSBuZXcgRnVuY3Rpb24oJ3JldHVybiBmdW5jdGlvbiBFbGVtZW50KCkge30nKSgpO1xyXG5cclxuXHQvLyBnZW5lcmF0ZSBzYW5kYm94ZWQgaWZyYW1lXHJcblx0dmFyIHZib2R5ID0gZG9jdW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYm9keScpKTtcclxuXHR2YXIgZnJhbWUgPSB2Ym9keS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKSk7XHJcblxyXG5cdC8vIHVzZSBzYW5kYm94ZWQgaWZyYW1lIHRvIHJlcGxpY2F0ZSBFbGVtZW50IGZ1bmN0aW9uYWxpdHlcclxuXHR2YXIgZnJhbWVEb2N1bWVudCA9IGZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XHJcblx0dmFyIHByb3RvdHlwZSA9IEVsZW1lbnQucHJvdG90eXBlID0gZnJhbWVEb2N1bWVudC5hcHBlbmRDaGlsZChmcmFtZURvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJyonKSk7XHJcblx0dmFyIGNhY2hlID0ge307XHJcblxyXG5cdC8vIHBvbHlmaWxsIEVsZW1lbnQucHJvdG90eXBlIG9uIGFuIGVsZW1lbnRcclxuXHR2YXIgc2hpdiA9IGZ1bmN0aW9uIChlbGVtZW50LCBkZWVwKSB7XHJcblx0XHR2YXJcclxuXHRcdGNoaWxkTm9kZXMgPSBlbGVtZW50LmNoaWxkTm9kZXMgfHwgW10sXHJcblx0XHRpbmRleCA9IC0xLFxyXG5cdFx0a2V5LCB2YWx1ZSwgY2hpbGROb2RlO1xyXG5cclxuXHRcdGlmIChlbGVtZW50Lm5vZGVUeXBlID09PSAxICYmIGVsZW1lbnQuY29uc3RydWN0b3IgIT09IEVsZW1lbnQpIHtcclxuXHRcdFx0ZWxlbWVudC5jb25zdHJ1Y3RvciA9IEVsZW1lbnQ7XHJcblxyXG5cdFx0XHRmb3IgKGtleSBpbiBjYWNoZSkge1xyXG5cdFx0XHRcdHZhbHVlID0gY2FjaGVba2V5XTtcclxuXHRcdFx0XHRlbGVtZW50W2tleV0gPSB2YWx1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHdoaWxlIChjaGlsZE5vZGUgPSBkZWVwICYmIGNoaWxkTm9kZXNbKytpbmRleF0pIHtcclxuXHRcdFx0c2hpdihjaGlsZE5vZGUsIGRlZXApO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBlbGVtZW50O1xyXG5cdH07XHJcblxyXG5cdHZhciBlbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCcqJyk7XHJcblx0dmFyIG5hdGl2ZUNyZWF0ZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50O1xyXG5cdHZhciBpbnRlcnZhbDtcclxuXHR2YXIgbG9vcExpbWl0ID0gMTAwO1xyXG5cclxuXHRwcm90b3R5cGUuYXR0YWNoRXZlbnQoJ29ucHJvcGVydHljaGFuZ2UnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHRcdHZhclxyXG5cdFx0cHJvcGVydHlOYW1lID0gZXZlbnQucHJvcGVydHlOYW1lLFxyXG5cdFx0bm9uVmFsdWUgPSAhY2FjaGUuaGFzT3duUHJvcGVydHkocHJvcGVydHlOYW1lKSxcclxuXHRcdG5ld1ZhbHVlID0gcHJvdG90eXBlW3Byb3BlcnR5TmFtZV0sXHJcblx0XHRvbGRWYWx1ZSA9IGNhY2hlW3Byb3BlcnR5TmFtZV0sXHJcblx0XHRpbmRleCA9IC0xLFxyXG5cdFx0ZWxlbWVudDtcclxuXHJcblx0XHR3aGlsZSAoZWxlbWVudCA9IGVsZW1lbnRzWysraW5kZXhdKSB7XHJcblx0XHRcdGlmIChlbGVtZW50Lm5vZGVUeXBlID09PSAxKSB7XHJcblx0XHRcdFx0aWYgKG5vblZhbHVlIHx8IGVsZW1lbnRbcHJvcGVydHlOYW1lXSA9PT0gb2xkVmFsdWUpIHtcclxuXHRcdFx0XHRcdGVsZW1lbnRbcHJvcGVydHlOYW1lXSA9IG5ld1ZhbHVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGNhY2hlW3Byb3BlcnR5TmFtZV0gPSBuZXdWYWx1ZTtcclxuXHR9KTtcclxuXHJcblx0cHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRWxlbWVudDtcclxuXHJcblx0aWYgKCFwcm90b3R5cGUuaGFzQXR0cmlidXRlKSB7XHJcblx0XHQvLyA8RWxlbWVudD4uaGFzQXR0cmlidXRlXHJcblx0XHRwcm90b3R5cGUuaGFzQXR0cmlidXRlID0gZnVuY3Rpb24gaGFzQXR0cmlidXRlKG5hbWUpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKG5hbWUpICE9PSBudWxsO1xyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdC8vIEFwcGx5IEVsZW1lbnQgcHJvdG90eXBlIHRvIHRoZSBwcmUtZXhpc3RpbmcgRE9NIGFzIHNvb24gYXMgdGhlIGJvZHkgZWxlbWVudCBhcHBlYXJzLlxyXG5cdGZ1bmN0aW9uIGJvZHlDaGVjaygpIHtcclxuXHRcdGlmICghKGxvb3BMaW1pdC0tKSkgY2xlYXJUaW1lb3V0KGludGVydmFsKTtcclxuXHRcdGlmIChkb2N1bWVudC5ib2R5ICYmICFkb2N1bWVudC5ib2R5LnByb3RvdHlwZSAmJiAvKGNvbXBsZXRlfGludGVyYWN0aXZlKS8udGVzdChkb2N1bWVudC5yZWFkeVN0YXRlKSkge1xyXG5cdFx0XHRzaGl2KGRvY3VtZW50LCB0cnVlKTtcclxuXHRcdFx0aWYgKGludGVydmFsICYmIGRvY3VtZW50LmJvZHkucHJvdG90eXBlKSBjbGVhclRpbWVvdXQoaW50ZXJ2YWwpO1xyXG5cdFx0XHRyZXR1cm4gKCEhZG9jdW1lbnQuYm9keS5wcm90b3R5cGUpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHRpZiAoIWJvZHlDaGVjaygpKSB7XHJcblx0XHRkb2N1bWVudC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBib2R5Q2hlY2s7XHJcblx0XHRpbnRlcnZhbCA9IHNldEludGVydmFsKGJvZHlDaGVjaywgMjUpO1xyXG5cdH1cclxuXHJcblx0Ly8gQXBwbHkgdG8gYW55IG5ldyBlbGVtZW50cyBjcmVhdGVkIGFmdGVyIGxvYWRcclxuXHRkb2N1bWVudC5jcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gY3JlYXRlRWxlbWVudChub2RlTmFtZSkge1xyXG5cdFx0dmFyIGVsZW1lbnQgPSBuYXRpdmVDcmVhdGVFbGVtZW50KFN0cmluZyhub2RlTmFtZSkudG9Mb3dlckNhc2UoKSk7XHJcblx0XHRyZXR1cm4gc2hpdihlbGVtZW50KTtcclxuXHR9O1xyXG5cclxuXHQvLyByZW1vdmUgc2FuZGJveGVkIGlmcmFtZVxyXG5cdGRvY3VtZW50LnJlbW92ZUNoaWxkKHZib2R5KTtcclxufSgpKTtcclxuXHJcbn0pXHJcbi5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG5cclxuICAgIC8vIERldGVjdGlvbiBmcm9tIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtc2VydmljZS84NzE3YTllMDRhYzdhZmY5OWI0OTgwZmJlZGVhZDk4MDM2YjA5MjlhL3BhY2thZ2VzL3BvbHlmaWxsLWxpYnJhcnkvcG9seWZpbGxzL0VsZW1lbnQvcHJvdG90eXBlL2NsYXNzTGlzdC9kZXRlY3QuanNcclxuICAgIHZhciBkZXRlY3QgPSAoXHJcbiAgICAgICdkb2N1bWVudCcgaW4gdGhpcyAmJiBcImNsYXNzTGlzdFwiIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCAmJiAnRWxlbWVudCcgaW4gdGhpcyAmJiAnY2xhc3NMaXN0JyBpbiBFbGVtZW50LnByb3RvdHlwZSAmJiAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgICAgIGUuY2xhc3NMaXN0LmFkZCgnYScsICdiJyk7XHJcbiAgICAgICAgcmV0dXJuIGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdiJyk7XHJcbiAgICAgIH0oKSlcclxuICAgICk7XHJcblxyXG4gICAgaWYgKGRldGVjdCkgcmV0dXJuXHJcblxyXG4gICAgLy8gUG9seWZpbGwgZnJvbSBodHRwczovL2Nkbi5wb2x5ZmlsbC5pby92Mi9wb2x5ZmlsbC5qcz9mZWF0dXJlcz1FbGVtZW50LnByb3RvdHlwZS5jbGFzc0xpc3QmZmxhZ3M9YWx3YXlzXHJcbiAgICAoZnVuY3Rpb24gKGdsb2JhbCkge1xyXG4gICAgICB2YXIgZHBTdXBwb3J0ID0gdHJ1ZTtcclxuICAgICAgdmFyIGRlZmluZUdldHRlciA9IGZ1bmN0aW9uIChvYmplY3QsIG5hbWUsIGZuLCBjb25maWd1cmFibGUpIHtcclxuICAgICAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KVxyXG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iamVjdCwgbmFtZSwge1xyXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlID09PSBkcFN1cHBvcnQgPyB0cnVlIDogISFjb25maWd1cmFibGUsXHJcbiAgICAgICAgICAgIGdldDogZm5cclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICBlbHNlIG9iamVjdC5fX2RlZmluZUdldHRlcl9fKG5hbWUsIGZuKTtcclxuICAgICAgfTtcclxuICAgICAgLyoqIEVuc3VyZSB0aGUgYnJvd3NlciBhbGxvd3MgT2JqZWN0LmRlZmluZVByb3BlcnR5IHRvIGJlIHVzZWQgb24gbmF0aXZlIEphdmFTY3JpcHQgb2JqZWN0cy4gKi9cclxuICAgICAgdHJ5IHtcclxuICAgICAgICBkZWZpbmVHZXR0ZXIoe30sIFwic3VwcG9ydFwiKTtcclxuICAgICAgfVxyXG4gICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIGRwU3VwcG9ydCA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIC8qKiBQb2x5ZmlsbHMgYSBwcm9wZXJ0eSB3aXRoIGEgRE9NVG9rZW5MaXN0ICovXHJcbiAgICAgIHZhciBhZGRQcm9wID0gZnVuY3Rpb24gKG8sIG5hbWUsIGF0dHIpIHtcclxuXHJcbiAgICAgICAgZGVmaW5lR2V0dGVyKG8ucHJvdG90eXBlLCBuYW1lLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICB2YXIgdG9rZW5MaXN0O1xyXG5cclxuICAgICAgICAgIHZhciBUSElTID0gdGhpcyxcclxuXHJcbiAgICAgICAgICAvKiogUHJldmVudCB0aGlzIGZyb20gZmlyaW5nIHR3aWNlIGZvciBzb21lIHJlYXNvbi4gV2hhdCB0aGUgaGVsbCwgSUUuICovXHJcbiAgICAgICAgICBnaWJiZXJpc2hQcm9wZXJ0eSA9IFwiX19kZWZpbmVHZXR0ZXJfX1wiICsgXCJERUZJTkVfUFJPUEVSVFlcIiArIG5hbWU7XHJcbiAgICAgICAgICBpZihUSElTW2dpYmJlcmlzaFByb3BlcnR5XSkgcmV0dXJuIHRva2VuTGlzdDtcclxuICAgICAgICAgIFRISVNbZ2liYmVyaXNoUHJvcGVydHldID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAvKipcclxuICAgICAgICAgICAqIElFOCBjYW4ndCBkZWZpbmUgcHJvcGVydGllcyBvbiBuYXRpdmUgSmF2YVNjcmlwdCBvYmplY3RzLCBzbyB3ZSdsbCB1c2UgYSBkdW1iIGhhY2sgaW5zdGVhZC5cclxuICAgICAgICAgICAqXHJcbiAgICAgICAgICAgKiBXaGF0IHRoaXMgaXMgZG9pbmcgaXMgY3JlYXRpbmcgYSBkdW1teSBlbGVtZW50IChcInJlZmxlY3Rpb25cIikgaW5zaWRlIGEgZGV0YWNoZWQgcGhhbnRvbSBub2RlIChcIm1pcnJvclwiKVxyXG4gICAgICAgICAgICogdGhhdCBzZXJ2ZXMgYXMgdGhlIHRhcmdldCBvZiBPYmplY3QuZGVmaW5lUHJvcGVydHkgaW5zdGVhZC4gV2hpbGUgd2UgY291bGQgc2ltcGx5IHVzZSB0aGUgc3ViamVjdCBIVE1MXHJcbiAgICAgICAgICAgKiBlbGVtZW50IGluc3RlYWQsIHRoaXMgd291bGQgY29uZmxpY3Qgd2l0aCBlbGVtZW50IHR5cGVzIHdoaWNoIHVzZSBpbmRleGVkIHByb3BlcnRpZXMgKHN1Y2ggYXMgZm9ybXMgYW5kXHJcbiAgICAgICAgICAgKiBzZWxlY3QgbGlzdHMpLlxyXG4gICAgICAgICAgICovXHJcbiAgICAgICAgICBpZiAoZmFsc2UgPT09IGRwU3VwcG9ydCkge1xyXG5cclxuICAgICAgICAgICAgdmFyIHZpc2FnZTtcclxuICAgICAgICAgICAgdmFyIG1pcnJvciA9IGFkZFByb3AubWlycm9yIHx8IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgIHZhciByZWZsZWN0aW9ucyA9IG1pcnJvci5jaGlsZE5vZGVzO1xyXG4gICAgICAgICAgICB2YXIgbCA9IHJlZmxlY3Rpb25zLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbDsgKytpKVxyXG4gICAgICAgICAgICAgIGlmIChyZWZsZWN0aW9uc1tpXS5fUiA9PT0gVEhJUykge1xyXG4gICAgICAgICAgICAgICAgdmlzYWdlID0gcmVmbGVjdGlvbnNbaV07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKiogQ291bGRuJ3QgZmluZCBhbiBlbGVtZW50J3MgcmVmbGVjdGlvbiBpbnNpZGUgdGhlIG1pcnJvci4gTWF0ZXJpYWxpc2Ugb25lLiAqL1xyXG4gICAgICAgICAgICB2aXNhZ2UgfHwgKHZpc2FnZSA9IG1pcnJvci5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKSk7XHJcblxyXG4gICAgICAgICAgICB0b2tlbkxpc3QgPSBET01Ub2tlbkxpc3QuY2FsbCh2aXNhZ2UsIFRISVMsIGF0dHIpO1xyXG4gICAgICAgICAgfSBlbHNlIHRva2VuTGlzdCA9IG5ldyBET01Ub2tlbkxpc3QoVEhJUywgYXR0cik7XHJcblxyXG4gICAgICAgICAgZGVmaW5lR2V0dGVyKFRISVMsIG5hbWUsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRva2VuTGlzdDtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgZGVsZXRlIFRISVNbZ2liYmVyaXNoUHJvcGVydHldO1xyXG5cclxuICAgICAgICAgIHJldHVybiB0b2tlbkxpc3Q7XHJcbiAgICAgICAgfSwgdHJ1ZSk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBhZGRQcm9wKGdsb2JhbC5FbGVtZW50LCBcImNsYXNzTGlzdFwiLCBcImNsYXNzTmFtZVwiKTtcclxuICAgICAgYWRkUHJvcChnbG9iYWwuSFRNTEVsZW1lbnQsIFwiY2xhc3NMaXN0XCIsIFwiY2xhc3NOYW1lXCIpO1xyXG4gICAgICBhZGRQcm9wKGdsb2JhbC5IVE1MTGlua0VsZW1lbnQsIFwicmVsTGlzdFwiLCBcInJlbFwiKTtcclxuICAgICAgYWRkUHJvcChnbG9iYWwuSFRNTEFuY2hvckVsZW1lbnQsIFwicmVsTGlzdFwiLCBcInJlbFwiKTtcclxuICAgICAgYWRkUHJvcChnbG9iYWwuSFRNTEFyZWFFbGVtZW50LCBcInJlbExpc3RcIiwgXCJyZWxcIik7XHJcbiAgICB9KHRoaXMpKTtcclxuXHJcbn0pLmNhbGwoJ29iamVjdCcgPT09IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93IHx8ICdvYmplY3QnID09PSB0eXBlb2Ygc2VsZiAmJiBzZWxmIHx8ICdvYmplY3QnID09PSB0eXBlb2YgZ2xvYmFsICYmIGdsb2JhbCB8fCB7fSk7XHJcblxyXG4oZnVuY3Rpb24odW5kZWZpbmVkKSB7XHJcblxyXG4gICAgLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL21kbi9jb250ZW50L2Jsb2IvY2Y2MDdkNjg1MjJjZDM1ZWU3NjcwNzgyZDNlZTNhMzYxZWFlZjJlNC9maWxlcy9lbi11cy93ZWIvamF2YXNjcmlwdC9yZWZlcmVuY2UvZ2xvYmFsX29iamVjdHMvc3RyaW5nL3RyaW0vaW5kZXgubWQjcG9seWZpbGxcclxuICAgIHZhciBkZXRlY3QgPSAoJ3RyaW0nIGluIFN0cmluZy5wcm90b3R5cGUpO1xyXG4gICAgXHJcbiAgICBpZiAoZGV0ZWN0KSByZXR1cm5cclxuXHJcbiAgICAvLyBQb2x5ZmlsbCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9tZG4vY29udGVudC9ibG9iL2NmNjA3ZDY4NTIyY2QzNWVlNzY3MDc4MmQzZWUzYTM2MWVhZWYyZTQvZmlsZXMvZW4tdXMvd2ViL2phdmFzY3JpcHQvcmVmZXJlbmNlL2dsb2JhbF9vYmplY3RzL3N0cmluZy90cmltL2luZGV4Lm1kI3BvbHlmaWxsXHJcbiAgICBTdHJpbmcucHJvdG90eXBlLnRyaW0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVwbGFjZSgvXltcXHNcXHVGRUZGXFx4QTBdK3xbXFxzXFx1RkVGRlxceEEwXSskL2csICcnKTtcclxuICAgIH07XHJcblxyXG59KS5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG5cclxuICAvLyBEZXRlY3Rpb24gZnJvbSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLWxpYnJhcnkvMTNjZjdjMzQwOTc0ZDEyOGQ1NTc1ODBiNWUyZGFmY2QxYjExOTJkMS9wb2x5ZmlsbHMvRWxlbWVudC9wcm90b3R5cGUvZGF0YXNldC9kZXRlY3QuanNcclxuICB2YXIgZGV0ZWN0ID0gKGZ1bmN0aW9uKCl7XHJcbiAgICBpZiAoIWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kYXRhc2V0KSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgZWwuc2V0QXR0cmlidXRlKFwiZGF0YS1hLWJcIiwgXCJjXCIpO1xyXG4gICAgcmV0dXJuIGVsLmRhdGFzZXQgJiYgZWwuZGF0YXNldC5hQiA9PSBcImNcIjtcclxuICB9KCkpO1xyXG5cclxuICBpZiAoZGV0ZWN0KSByZXR1cm5cclxuXHJcbiAgLy8gUG9seWZpbGwgZGVyaXZlZCBmcm9tICBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLWxpYnJhcnkvMTNjZjdjMzQwOTc0ZDEyOGQ1NTc1ODBiNWUyZGFmY2QxYjExOTJkMS9wb2x5ZmlsbHMvRWxlbWVudC9wcm90b3R5cGUvZGF0YXNldC9wb2x5ZmlsbC5qc1xyXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFbGVtZW50LnByb3RvdHlwZSwgJ2RhdGFzZXQnLCB7XHJcbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgZWxlbWVudCA9IHRoaXM7XHJcbiAgICAgIHZhciBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzO1xyXG4gICAgICB2YXIgbWFwID0ge307XHJcbiAgXHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXR0cmlidXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBhdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzW2ldO1xyXG4gIFxyXG4gICAgICAgIC8vIFRoaXMgcmVnZXggaGFzIGJlZW4gZWRpdGVkIGZyb20gdGhlIG9yaWdpbmFsIHBvbHlmaWxsLCB0byBhZGRcclxuICAgICAgICAvLyBzdXBwb3J0IGZvciBwZXJpb2QgKC4pIHNlcGFyYXRvcnMgaW4gZGF0YS0qIGF0dHJpYnV0ZSBuYW1lcy4gVGhlc2VcclxuICAgICAgICAvLyBhcmUgYWxsb3dlZCBpbiB0aGUgSFRNTCBzcGVjLCBidXQgd2VyZSBub3QgY292ZXJlZCBieSB0aGUgb3JpZ2luYWxcclxuICAgICAgICAvLyBwb2x5ZmlsbCdzIHJlZ2V4LiBXZSB1c2UgcGVyaW9kcyBpbiBvdXIgaTE4biBpbXBsZW1lbnRhdGlvbi5cclxuICAgICAgICBpZiAoYXR0cmlidXRlICYmIGF0dHJpYnV0ZS5uYW1lICYmICgvXmRhdGEtXFx3Wy5cXHctXSokLykudGVzdChhdHRyaWJ1dGUubmFtZSkpIHtcclxuICAgICAgICAgIHZhciBuYW1lID0gYXR0cmlidXRlLm5hbWU7XHJcbiAgICAgICAgICB2YXIgdmFsdWUgPSBhdHRyaWJ1dGUudmFsdWU7XHJcbiAgXHJcbiAgICAgICAgICB2YXIgcHJvcE5hbWUgPSBuYW1lLnN1YnN0cig1KS5yZXBsYWNlKC8tLi9nLCBmdW5jdGlvbiAocHJvcCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvcC5jaGFyQXQoMSkudG9VcHBlckNhc2UoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBJZiB0aGlzIGJyb3dzZXIgc3VwcG9ydHMgX19kZWZpbmVHZXR0ZXJfXyBhbmQgX19kZWZpbmVTZXR0ZXJfXyxcclxuICAgICAgICAgIC8vIGNvbnRpbnVlIHVzaW5nIGRlZmluZVByb3BlcnR5LiBJZiBub3QgKGxpa2UgSUUgOCBhbmQgYmVsb3cpLCB3ZSB1c2VcclxuICAgICAgICAgIC8vIGEgaGFja3kgZmFsbGJhY2sgd2hpY2ggYXQgbGVhc3QgZ2l2ZXMgYW4gb2JqZWN0IGluIHRoZSByaWdodCBmb3JtYXRcclxuICAgICAgICAgIGlmICgnX19kZWZpbmVHZXR0ZXJfXycgaW4gT2JqZWN0LnByb3RvdHlwZSAmJiAnX19kZWZpbmVTZXR0ZXJfXycgaW4gT2JqZWN0LnByb3RvdHlwZSkge1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobWFwLCBwcm9wTmFtZSwge1xyXG4gICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlO1xyXG4gICAgICAgICAgICAgIH0uYmluZCh7dmFsdWU6IHZhbHVlIHx8ICcnfSksXHJcbiAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXR0ZXIobmFtZSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0uYmluZChlbGVtZW50LCBuYW1lKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG1hcFtwcm9wTmFtZV0gPSB2YWx1ZTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIHJldHVybiBtYXA7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG59KS5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxuLyoqXHJcbiAqIE5vcm1hbGlzZSBzdHJpbmdcclxuICpcclxuICogJ0lmIGl0IGxvb2tzIGxpa2UgYSBkdWNrLCBhbmQgaXQgcXVhY2tzIGxpa2UgYSBkdWNr4oCmJyDwn6aGXHJcbiAqXHJcbiAqIElmIHRoZSBwYXNzZWQgdmFsdWUgbG9va3MgbGlrZSBhIGJvb2xlYW4gb3IgYSBudW1iZXIsIGNvbnZlcnQgaXQgdG8gYSBib29sZWFuXHJcbiAqIG9yIG51bWJlci5cclxuICpcclxuICogRGVzaWduZWQgdG8gYmUgdXNlZCB0byBjb252ZXJ0IGNvbmZpZyBwYXNzZWQgdmlhIGRhdGEgYXR0cmlidXRlcyAod2hpY2ggYXJlXHJcbiAqIGFsd2F5cyBzdHJpbmdzKSBpbnRvIHNvbWV0aGluZyBzZW5zaWJsZS5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIHZhbHVlIHRvIG5vcm1hbGlzZVxyXG4gKiBAcmV0dXJucyB7c3RyaW5nIHwgYm9vbGVhbiB8IG51bWJlciB8IHVuZGVmaW5lZH0gTm9ybWFsaXNlZCBkYXRhXHJcbiAqL1xyXG5mdW5jdGlvbiBub3JtYWxpc2VTdHJpbmcgKHZhbHVlKSB7XHJcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcclxuICAgIHJldHVybiB2YWx1ZVxyXG4gIH1cclxuXHJcbiAgdmFyIHRyaW1tZWRWYWx1ZSA9IHZhbHVlLnRyaW0oKTtcclxuXHJcbiAgaWYgKHRyaW1tZWRWYWx1ZSA9PT0gJ3RydWUnKSB7XHJcbiAgICByZXR1cm4gdHJ1ZVxyXG4gIH1cclxuXHJcbiAgaWYgKHRyaW1tZWRWYWx1ZSA9PT0gJ2ZhbHNlJykge1xyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG5cclxuICAvLyBFbXB0eSAvIHdoaXRlc3BhY2Utb25seSBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGZpbml0ZSBzbyB3ZSBuZWVkIHRvIGNoZWNrXHJcbiAgLy8gdGhlIGxlbmd0aCBvZiB0aGUgdHJpbW1lZCBzdHJpbmcgYXMgd2VsbFxyXG4gIGlmICh0cmltbWVkVmFsdWUubGVuZ3RoID4gMCAmJiBpc0Zpbml0ZSh0cmltbWVkVmFsdWUpKSB7XHJcbiAgICByZXR1cm4gTnVtYmVyKHRyaW1tZWRWYWx1ZSlcclxuICB9XHJcblxyXG4gIHJldHVybiB2YWx1ZVxyXG59XHJcblxyXG4vKipcclxuICogTm9ybWFsaXNlIGRhdGFzZXRcclxuICpcclxuICogTG9vcCBvdmVyIGFuIG9iamVjdCBhbmQgbm9ybWFsaXNlIGVhY2ggdmFsdWUgdXNpbmcgbm9ybWFsaXNlRGF0YSBmdW5jdGlvblxyXG4gKlxyXG4gKiBAcGFyYW0ge0RPTVN0cmluZ01hcH0gZGF0YXNldCAtIEhUTUwgZWxlbWVudCBkYXRhc2V0XHJcbiAqIEByZXR1cm5zIHtPYmplY3Q8c3RyaW5nLCBzdHJpbmcgfCBib29sZWFuIHwgbnVtYmVyIHwgdW5kZWZpbmVkPn0gTm9ybWFsaXNlZCBkYXRhc2V0XHJcbiAqL1xyXG5mdW5jdGlvbiBub3JtYWxpc2VEYXRhc2V0IChkYXRhc2V0KSB7XHJcbiAgdmFyIG91dCA9IHt9O1xyXG5cclxuICBmb3IgKHZhciBrZXkgaW4gZGF0YXNldCkge1xyXG4gICAgb3V0W2tleV0gPSBub3JtYWxpc2VTdHJpbmcoZGF0YXNldFtrZXldKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBvdXRcclxufVxyXG5cclxuLyoqXHJcbiAqIEBjb25zdGFudFxyXG4gKiBAdHlwZSB7QWNjb3JkaW9uVHJhbnNsYXRpb25zfVxyXG4gKiBAc2VlIERlZmF1bHQgdmFsdWUgZm9yIHtAbGluayBBY2NvcmRpb25Db25maWcuaTE4bn1cclxuICogQGRlZmF1bHRcclxuICovXHJcbnZhciBBQ0NPUkRJT05fVFJBTlNMQVRJT05TID0ge1xyXG4gIGhpZGVBbGxTZWN0aW9uczogJ0hpZGUgYWxsIHNlY3Rpb25zJyxcclxuICBoaWRlU2VjdGlvbjogJ0hpZGUnLFxyXG4gIGhpZGVTZWN0aW9uQXJpYUxhYmVsOiAnSGlkZSB0aGlzIHNlY3Rpb24nLFxyXG4gIHNob3dBbGxTZWN0aW9uczogJ1Nob3cgYWxsIHNlY3Rpb25zJyxcclxuICBzaG93U2VjdGlvbjogJ1Nob3cnLFxyXG4gIHNob3dTZWN0aW9uQXJpYUxhYmVsOiAnU2hvdyB0aGlzIHNlY3Rpb24nXHJcbn07XHJcblxyXG4vKipcclxuICogQWNjb3JkaW9uIGNvbXBvbmVudFxyXG4gKlxyXG4gKiBUaGlzIGFsbG93cyBhIGNvbGxlY3Rpb24gb2Ygc2VjdGlvbnMgdG8gYmUgY29sbGFwc2VkIGJ5IGRlZmF1bHQsIHNob3dpbmcgb25seVxyXG4gKiB0aGVpciBoZWFkZXJzLiBTZWN0aW9ucyBjYW4gYmUgZXhwYW5kZWQgb3IgY29sbGFwc2VkIGluZGl2aWR1YWxseSBieSBjbGlja2luZ1xyXG4gKiB0aGVpciBoZWFkZXJzLiBBIFwiU2hvdyBhbGwgc2VjdGlvbnNcIiBidXR0b24gaXMgYWxzbyBhZGRlZCB0byB0aGUgdG9wIG9mIHRoZVxyXG4gKiBhY2NvcmRpb24sIHdoaWNoIHN3aXRjaGVzIHRvIFwiSGlkZSBhbGwgc2VjdGlvbnNcIiB3aGVuIGFsbCB0aGUgc2VjdGlvbnMgYXJlXHJcbiAqIGV4cGFuZGVkLlxyXG4gKlxyXG4gKiBUaGUgc3RhdGUgb2YgZWFjaCBzZWN0aW9uIGlzIHNhdmVkIHRvIHRoZSBET00gdmlhIHRoZSBgYXJpYS1leHBhbmRlZGBcclxuICogYXR0cmlidXRlLCB3aGljaCBhbHNvIHByb3ZpZGVzIGFjY2Vzc2liaWxpdHkuXHJcbiAqXHJcbiAqIEBjbGFzc1xyXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAkbW9kdWxlIC0gSFRNTCBlbGVtZW50IHRvIHVzZSBmb3IgYWNjb3JkaW9uXHJcbiAqIEBwYXJhbSB7QWNjb3JkaW9uQ29uZmlnfSBbY29uZmlnXSAtIEFjY29yZGlvbiBjb25maWdcclxuICovXHJcbmZ1bmN0aW9uIEFjY29yZGlvbiAoJG1vZHVsZSwgY29uZmlnKSB7XHJcbiAgdGhpcy4kbW9kdWxlID0gJG1vZHVsZTtcclxuICB0aGlzLiRzZWN0aW9ucyA9ICRtb2R1bGUucXVlcnlTZWxlY3RvckFsbCgnLmdvdnVrLWFjY29yZGlvbl9fc2VjdGlvbicpO1xyXG4gIHRoaXMuYnJvd3NlclN1cHBvcnRzU2Vzc2lvblN0b3JhZ2UgPSBoZWxwZXIuY2hlY2tGb3JTZXNzaW9uU3RvcmFnZSgpO1xyXG5cclxuICB2YXIgZGVmYXVsdENvbmZpZyA9IHtcclxuICAgIGkxOG46IEFDQ09SRElPTl9UUkFOU0xBVElPTlNcclxuICB9O1xyXG4gIHRoaXMuY29uZmlnID0gbWVyZ2VDb25maWdzKFxyXG4gICAgZGVmYXVsdENvbmZpZyxcclxuICAgIGNvbmZpZyB8fCB7fSxcclxuICAgIG5vcm1hbGlzZURhdGFzZXQoJG1vZHVsZS5kYXRhc2V0KVxyXG4gICk7XHJcbiAgdGhpcy5pMThuID0gbmV3IEkxOG4oZXh0cmFjdENvbmZpZ0J5TmFtZXNwYWNlKHRoaXMuY29uZmlnLCAnaTE4bicpKTtcclxuXHJcbiAgdGhpcy5jb250cm9sc0NsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fY29udHJvbHMnO1xyXG4gIHRoaXMuc2hvd0FsbENsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2hvdy1hbGwnO1xyXG4gIHRoaXMuc2hvd0FsbFRleHRDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3Nob3ctYWxsLXRleHQnO1xyXG5cclxuICB0aGlzLnNlY3Rpb25FeHBhbmRlZENsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi0tZXhwYW5kZWQnO1xyXG4gIHRoaXMuc2VjdGlvbkJ1dHRvbkNsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi1idXR0b24nO1xyXG4gIHRoaXMuc2VjdGlvbkhlYWRlckNsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi1oZWFkZXInO1xyXG4gIHRoaXMuc2VjdGlvbkhlYWRpbmdDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24taGVhZGluZyc7XHJcbiAgdGhpcy5zZWN0aW9uSGVhZGluZ1RleHRDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24taGVhZGluZy10ZXh0JztcclxuICB0aGlzLnNlY3Rpb25IZWFkaW5nVGV4dEZvY3VzQ2xhc3MgPSAnZ292dWstYWNjb3JkaW9uX19zZWN0aW9uLWhlYWRpbmctdGV4dC1mb2N1cyc7XHJcblxyXG4gIHRoaXMuc2VjdGlvblNob3dIaWRlVG9nZ2xlQ2xhc3MgPSAnZ292dWstYWNjb3JkaW9uX19zZWN0aW9uLXRvZ2dsZSc7XHJcbiAgdGhpcy5zZWN0aW9uU2hvd0hpZGVUb2dnbGVGb2N1c0NsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi10b2dnbGUtZm9jdXMnO1xyXG4gIHRoaXMuc2VjdGlvblNob3dIaWRlVGV4dENsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi10b2dnbGUtdGV4dCc7XHJcbiAgdGhpcy51cENoZXZyb25JY29uQ2xhc3MgPSAnZ292dWstYWNjb3JkaW9uLW5hdl9fY2hldnJvbic7XHJcbiAgdGhpcy5kb3duQ2hldnJvbkljb25DbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb24tbmF2X19jaGV2cm9uLS1kb3duJztcclxuXHJcbiAgdGhpcy5zZWN0aW9uU3VtbWFyeUNsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi1zdW1tYXJ5JztcclxuICB0aGlzLnNlY3Rpb25TdW1tYXJ5Rm9jdXNDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24tc3VtbWFyeS1mb2N1cyc7XHJcbn1cclxuXHJcbi8vIEluaXRpYWxpemUgY29tcG9uZW50XHJcbkFjY29yZGlvbi5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAvLyBDaGVjayBmb3IgbW9kdWxlXHJcbiAgaWYgKCF0aGlzLiRtb2R1bGUpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgdGhpcy5pbml0Q29udHJvbHMoKTtcclxuICB0aGlzLmluaXRTZWN0aW9uSGVhZGVycygpO1xyXG5cclxuICAvLyBTZWUgaWYgXCJTaG93IGFsbCBzZWN0aW9uc1wiIGJ1dHRvbiB0ZXh0IHNob3VsZCBiZSB1cGRhdGVkXHJcbiAgdmFyIGFyZUFsbFNlY3Rpb25zT3BlbiA9IHRoaXMuY2hlY2tJZkFsbFNlY3Rpb25zT3BlbigpO1xyXG4gIHRoaXMudXBkYXRlU2hvd0FsbEJ1dHRvbihhcmVBbGxTZWN0aW9uc09wZW4pO1xyXG59O1xyXG5cclxuLy8gSW5pdGlhbGlzZSBjb250cm9scyBhbmQgc2V0IGF0dHJpYnV0ZXNcclxuQWNjb3JkaW9uLnByb3RvdHlwZS5pbml0Q29udHJvbHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgLy8gQ3JlYXRlIFwiU2hvdyBhbGxcIiBidXR0b24gYW5kIHNldCBhdHRyaWJ1dGVzXHJcbiAgdGhpcy4kc2hvd0FsbEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gIHRoaXMuJHNob3dBbGxCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xyXG4gIHRoaXMuJHNob3dBbGxCdXR0b24uc2V0QXR0cmlidXRlKCdjbGFzcycsIHRoaXMuc2hvd0FsbENsYXNzKTtcclxuICB0aGlzLiRzaG93QWxsQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xyXG5cclxuICAvLyBDcmVhdGUgaWNvbiwgYWRkIHRvIGVsZW1lbnRcclxuICB2YXIgJGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgJGljb24uY2xhc3NMaXN0LmFkZCh0aGlzLnVwQ2hldnJvbkljb25DbGFzcyk7XHJcbiAgdGhpcy4kc2hvd0FsbEJ1dHRvbi5hcHBlbmRDaGlsZCgkaWNvbik7XHJcblxyXG4gIC8vIENyZWF0ZSBjb250cm9sIHdyYXBwZXIgYW5kIGFkZCBjb250cm9scyB0byBpdFxyXG4gIHZhciAkYWNjb3JkaW9uQ29udHJvbHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAkYWNjb3JkaW9uQ29udHJvbHMuc2V0QXR0cmlidXRlKCdjbGFzcycsIHRoaXMuY29udHJvbHNDbGFzcyk7XHJcbiAgJGFjY29yZGlvbkNvbnRyb2xzLmFwcGVuZENoaWxkKHRoaXMuJHNob3dBbGxCdXR0b24pO1xyXG4gIHRoaXMuJG1vZHVsZS5pbnNlcnRCZWZvcmUoJGFjY29yZGlvbkNvbnRyb2xzLCB0aGlzLiRtb2R1bGUuZmlyc3RDaGlsZCk7XHJcblxyXG4gIC8vIEJ1aWxkIGFkZGl0aW9uYWwgd3JhcHBlciBmb3IgU2hvdyBhbGwgdG9nZ2xlIHRleHQgYW5kIHBsYWNlIGFmdGVyIGljb25cclxuICB2YXIgJHdyYXBwZXJzaG93QWxsVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAkd3JhcHBlcnNob3dBbGxUZXh0LmNsYXNzTGlzdC5hZGQodGhpcy5zaG93QWxsVGV4dENsYXNzKTtcclxuICB0aGlzLiRzaG93QWxsQnV0dG9uLmFwcGVuZENoaWxkKCR3cmFwcGVyc2hvd0FsbFRleHQpO1xyXG5cclxuICAvLyBIYW5kbGUgY2xpY2sgZXZlbnRzIG9uIHRoZSBzaG93L2hpZGUgYWxsIGJ1dHRvblxyXG4gIHRoaXMuJHNob3dBbGxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uU2hvd09ySGlkZUFsbFRvZ2dsZS5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8vIEluaXRpYWxpc2Ugc2VjdGlvbiBoZWFkZXJzXHJcbkFjY29yZGlvbi5wcm90b3R5cGUuaW5pdFNlY3Rpb25IZWFkZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gIC8vIExvb3AgdGhyb3VnaCBzZWN0aW9uIGhlYWRlcnNcclxuICBub2RlTGlzdEZvckVhY2godGhpcy4kc2VjdGlvbnMsIGZ1bmN0aW9uICgkc2VjdGlvbiwgaSkge1xyXG4gICAgLy8gU2V0IGhlYWRlciBhdHRyaWJ1dGVzXHJcbiAgICB2YXIgJGhlYWRlciA9ICRzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5zZWN0aW9uSGVhZGVyQ2xhc3MpO1xyXG4gICAgdGhpcy5jb25zdHJ1Y3RIZWFkZXJNYXJrdXAoJGhlYWRlciwgaSk7XHJcbiAgICB0aGlzLnNldEV4cGFuZGVkKHRoaXMuaXNFeHBhbmRlZCgkc2VjdGlvbiksICRzZWN0aW9uKTtcclxuXHJcbiAgICAvLyBIYW5kbGUgZXZlbnRzXHJcbiAgICAkaGVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vblNlY3Rpb25Ub2dnbGUuYmluZCh0aGlzLCAkc2VjdGlvbikpO1xyXG5cclxuICAgIC8vIFNlZSBpZiB0aGVyZSBpcyBhbnkgc3RhdGUgc3RvcmVkIGluIHNlc3Npb25TdG9yYWdlIGFuZCBzZXQgdGhlIHNlY3Rpb25zIHRvXHJcbiAgICAvLyBvcGVuIG9yIGNsb3NlZC5cclxuICAgIHRoaXMuc2V0SW5pdGlhbFN0YXRlKCRzZWN0aW9uKTtcclxuICB9LmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuQWNjb3JkaW9uLnByb3RvdHlwZS5jb25zdHJ1Y3RIZWFkZXJNYXJrdXAgPSBmdW5jdGlvbiAoJGhlYWRlcldyYXBwZXIsIGluZGV4KSB7XHJcbiAgdmFyICRzcGFuID0gJGhlYWRlcldyYXBwZXIucXVlcnlTZWxlY3RvcignLicgKyB0aGlzLnNlY3Rpb25CdXR0b25DbGFzcyk7XHJcbiAgdmFyICRoZWFkaW5nID0gJGhlYWRlcldyYXBwZXIucXVlcnlTZWxlY3RvcignLicgKyB0aGlzLnNlY3Rpb25IZWFkaW5nQ2xhc3MpO1xyXG4gIHZhciAkc3VtbWFyeSA9ICRoZWFkZXJXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5zZWN0aW9uU3VtbWFyeUNsYXNzKTtcclxuXHJcbiAgLy8gQ3JlYXRlIGEgYnV0dG9uIGVsZW1lbnQgdGhhdCB3aWxsIHJlcGxhY2UgdGhlICcuZ292dWstYWNjb3JkaW9uX19zZWN0aW9uLWJ1dHRvbicgc3BhblxyXG4gIHZhciAkYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgJGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJyk7XHJcbiAgJGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnLCB0aGlzLiRtb2R1bGUuaWQgKyAnLWNvbnRlbnQtJyArIChpbmRleCArIDEpKTtcclxuXHJcbiAgLy8gQ29weSBhbGwgYXR0cmlidXRlcyAoaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0VsZW1lbnQvYXR0cmlidXRlcykgZnJvbSAkc3BhbiB0byAkYnV0dG9uXHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCAkc3Bhbi5hdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICB2YXIgYXR0ciA9ICRzcGFuLmF0dHJpYnV0ZXMuaXRlbShpKTtcclxuICAgIC8vIEFkZCBhbGwgYXR0cmlidXRlcyBidXQgbm90IElEIGFzIHRoaXMgaXMgYmVpbmcgYWRkZWQgdG9cclxuICAgIC8vIHRoZSBzZWN0aW9uIGhlYWRpbmcgKCRoZWFkaW5nVGV4dClcclxuICAgIGlmIChhdHRyLm5vZGVOYW1lICE9PSAnaWQnKSB7XHJcbiAgICAgICRidXR0b24uc2V0QXR0cmlidXRlKGF0dHIubm9kZU5hbWUsIGF0dHIubm9kZVZhbHVlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIENyZWF0ZSBjb250YWluZXIgZm9yIGhlYWRpbmcgdGV4dCBzbyBpdCBjYW4gYmUgc3R5bGVkXHJcbiAgdmFyICRoZWFkaW5nVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAkaGVhZGluZ1RleHQuY2xhc3NMaXN0LmFkZCh0aGlzLnNlY3Rpb25IZWFkaW5nVGV4dENsYXNzKTtcclxuICAvLyBDb3B5IHRoZSBzcGFuIElEIHRvIHRoZSBoZWFkaW5nIHRleHQgdG8gYWxsb3cgaXQgdG8gYmUgcmVmZXJlbmNlZCBieSBgYXJpYS1sYWJlbGxlZGJ5YCBvbiB0aGVcclxuICAvLyBoaWRkZW4gY29udGVudCBhcmVhIHdpdGhvdXQgXCJTaG93IHRoaXMgc2VjdGlvblwiXHJcbiAgJGhlYWRpbmdUZXh0LmlkID0gJHNwYW4uaWQ7XHJcblxyXG4gIC8vIENyZWF0ZSBhbiBpbm5lciBoZWFkaW5nIHRleHQgY29udGFpbmVyIHRvIGxpbWl0IHRoZSB3aWR0aCBvZiB0aGUgZm9jdXMgc3RhdGVcclxuICB2YXIgJGhlYWRpbmdUZXh0Rm9jdXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgJGhlYWRpbmdUZXh0Rm9jdXMuY2xhc3NMaXN0LmFkZCh0aGlzLnNlY3Rpb25IZWFkaW5nVGV4dEZvY3VzQ2xhc3MpO1xyXG4gICRoZWFkaW5nVGV4dC5hcHBlbmRDaGlsZCgkaGVhZGluZ1RleHRGb2N1cyk7XHJcbiAgLy8gc3BhbiBjb3VsZCBjb250YWluIEhUTUwgZWxlbWVudHMgKHNlZSBodHRwczovL3d3dy53My5vcmcvVFIvMjAxMS9XRC1odG1sNS0yMDExMDUyNS9jb250ZW50LW1vZGVscy5odG1sI3BocmFzaW5nLWNvbnRlbnQpXHJcbiAgJGhlYWRpbmdUZXh0Rm9jdXMuaW5uZXJIVE1MID0gJHNwYW4uaW5uZXJIVE1MO1xyXG5cclxuICAvLyBDcmVhdGUgY29udGFpbmVyIGZvciBzaG93IC8gaGlkZSBpY29ucyBhbmQgdGV4dC5cclxuICB2YXIgJHNob3dUb2dnbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgJHNob3dUb2dnbGUuY2xhc3NMaXN0LmFkZCh0aGlzLnNlY3Rpb25TaG93SGlkZVRvZ2dsZUNsYXNzKTtcclxuICAvLyBUZWxsIEdvb2dsZSBub3QgdG8gaW5kZXggdGhlICdzaG93JyB0ZXh0IGFzIHBhcnQgb2YgdGhlIGhlYWRpbmdcclxuICAvLyBGb3IgdGhlIHNuaXBwZXQgdG8gd29yayB3aXRoIEphdmFTY3JpcHQsIGl0IG11c3QgYmUgYWRkZWQgYmVmb3JlIGFkZGluZyB0aGUgcGFnZSBlbGVtZW50IHRvIHRoZVxyXG4gIC8vIHBhZ2UncyBET00uIFNlZSBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS9zZWFyY2gvZG9jcy9hZHZhbmNlZC9yb2JvdHMvcm9ib3RzX21ldGFfdGFnI2RhdGEtbm9zbmlwcGV0LWF0dHJcclxuICAkc2hvd1RvZ2dsZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtbm9zbmlwcGV0JywgJycpO1xyXG4gIC8vIENyZWF0ZSBhbiBpbm5lciBjb250YWluZXIgdG8gbGltaXQgdGhlIHdpZHRoIG9mIHRoZSBmb2N1cyBzdGF0ZVxyXG4gIHZhciAkc2hvd1RvZ2dsZUZvY3VzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICRzaG93VG9nZ2xlRm9jdXMuY2xhc3NMaXN0LmFkZCh0aGlzLnNlY3Rpb25TaG93SGlkZVRvZ2dsZUZvY3VzQ2xhc3MpO1xyXG4gICRzaG93VG9nZ2xlLmFwcGVuZENoaWxkKCRzaG93VG9nZ2xlRm9jdXMpO1xyXG4gIC8vIENyZWF0ZSB3cmFwcGVyIGZvciB0aGUgc2hvdyAvIGhpZGUgdGV4dC4gQXBwZW5kIHRleHQgYWZ0ZXIgdGhlIHNob3cvaGlkZSBpY29uXHJcbiAgdmFyICRzaG93VG9nZ2xlVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICB2YXIgJGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgJGljb24uY2xhc3NMaXN0LmFkZCh0aGlzLnVwQ2hldnJvbkljb25DbGFzcyk7XHJcbiAgJHNob3dUb2dnbGVGb2N1cy5hcHBlbmRDaGlsZCgkaWNvbik7XHJcbiAgJHNob3dUb2dnbGVUZXh0LmNsYXNzTGlzdC5hZGQodGhpcy5zZWN0aW9uU2hvd0hpZGVUZXh0Q2xhc3MpO1xyXG4gICRzaG93VG9nZ2xlRm9jdXMuYXBwZW5kQ2hpbGQoJHNob3dUb2dnbGVUZXh0KTtcclxuXHJcbiAgLy8gQXBwZW5kIGVsZW1lbnRzIHRvIHRoZSBidXR0b246XHJcbiAgLy8gMS4gSGVhZGluZyB0ZXh0XHJcbiAgLy8gMi4gUHVuY3R1YXRpb25cclxuICAvLyAzLiAoT3B0aW9uYWw6IFN1bW1hcnkgbGluZSBmb2xsb3dlZCBieSBwdW5jdHVhdGlvbilcclxuICAvLyA0LiBTaG93IC8gaGlkZSB0b2dnbGVcclxuICAkYnV0dG9uLmFwcGVuZENoaWxkKCRoZWFkaW5nVGV4dCk7XHJcbiAgJGJ1dHRvbi5hcHBlbmRDaGlsZCh0aGlzLmdldEJ1dHRvblB1bmN0dWF0aW9uRWwoKSk7XHJcblxyXG4gIC8vIElmIHN1bW1hcnkgY29udGVudCBleGlzdHMgYWRkIHRvIERPTSBpbiBjb3JyZWN0IG9yZGVyXHJcbiAgaWYgKHR5cGVvZiAoJHN1bW1hcnkpICE9PSAndW5kZWZpbmVkJyAmJiAkc3VtbWFyeSAhPT0gbnVsbCkge1xyXG4gICAgLy8gQ3JlYXRlIGEgbmV3IGBzcGFuYCBlbGVtZW50IGFuZCBjb3B5IHRoZSBzdW1tYXJ5IGxpbmUgY29udGVudCBmcm9tIHRoZSBvcmlnaW5hbCBgZGl2YCB0byB0aGVcclxuICAgIC8vIG5ldyBgc3BhbmBcclxuICAgIC8vIFRoaXMgaXMgYmVjYXVzZSB0aGUgc3VtbWFyeSBsaW5lIHRleHQgaXMgbm93IGluc2lkZSBhIGJ1dHRvbiBlbGVtZW50LCB3aGljaCBjYW4gb25seSBjb250YWluXHJcbiAgICAvLyBwaHJhc2luZyBjb250ZW50XHJcbiAgICB2YXIgJHN1bW1hcnlTcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgLy8gQ3JlYXRlIGFuIGlubmVyIHN1bW1hcnkgY29udGFpbmVyIHRvIGxpbWl0IHRoZSB3aWR0aCBvZiB0aGUgc3VtbWFyeSBmb2N1cyBzdGF0ZVxyXG4gICAgdmFyICRzdW1tYXJ5U3BhbkZvY3VzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgJHN1bW1hcnlTcGFuRm9jdXMuY2xhc3NMaXN0LmFkZCh0aGlzLnNlY3Rpb25TdW1tYXJ5Rm9jdXNDbGFzcyk7XHJcbiAgICAkc3VtbWFyeVNwYW4uYXBwZW5kQ2hpbGQoJHN1bW1hcnlTcGFuRm9jdXMpO1xyXG5cclxuICAgIC8vIEdldCBvcmlnaW5hbCBhdHRyaWJ1dGVzLCBhbmQgcGFzcyB0aGVtIHRvIHRoZSByZXBsYWNlbWVudFxyXG4gICAgZm9yICh2YXIgaiA9IDAsIGwgPSAkc3VtbWFyeS5hdHRyaWJ1dGVzLmxlbmd0aDsgaiA8IGw7ICsraikge1xyXG4gICAgICB2YXIgbm9kZU5hbWUgPSAkc3VtbWFyeS5hdHRyaWJ1dGVzLml0ZW0oaikubm9kZU5hbWU7XHJcbiAgICAgIHZhciBub2RlVmFsdWUgPSAkc3VtbWFyeS5hdHRyaWJ1dGVzLml0ZW0oaikubm9kZVZhbHVlO1xyXG4gICAgICAkc3VtbWFyeVNwYW4uc2V0QXR0cmlidXRlKG5vZGVOYW1lLCBub2RlVmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENvcHkgb3JpZ2luYWwgY29udGVudHMgb2Ygc3VtbWFyeSB0byB0aGUgbmV3IHN1bW1hcnkgc3BhblxyXG4gICAgJHN1bW1hcnlTcGFuRm9jdXMuaW5uZXJIVE1MID0gJHN1bW1hcnkuaW5uZXJIVE1MO1xyXG5cclxuICAgIC8vIFJlcGxhY2UgdGhlIG9yaWdpbmFsIHN1bW1hcnkgYGRpdmAgd2l0aCB0aGUgbmV3IHN1bW1hcnkgYHNwYW5gXHJcbiAgICAkc3VtbWFyeS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZCgkc3VtbWFyeVNwYW4sICRzdW1tYXJ5KTtcclxuXHJcbiAgICAkYnV0dG9uLmFwcGVuZENoaWxkKCRzdW1tYXJ5U3Bhbik7XHJcbiAgICAkYnV0dG9uLmFwcGVuZENoaWxkKHRoaXMuZ2V0QnV0dG9uUHVuY3R1YXRpb25FbCgpKTtcclxuICB9XHJcblxyXG4gICRidXR0b24uYXBwZW5kQ2hpbGQoJHNob3dUb2dnbGUpO1xyXG5cclxuICAkaGVhZGluZy5yZW1vdmVDaGlsZCgkc3Bhbik7XHJcbiAgJGhlYWRpbmcuYXBwZW5kQ2hpbGQoJGJ1dHRvbik7XHJcbn07XHJcblxyXG4vLyBXaGVuIHNlY3Rpb24gdG9nZ2xlZCwgc2V0IGFuZCBzdG9yZSBzdGF0ZVxyXG5BY2NvcmRpb24ucHJvdG90eXBlLm9uU2VjdGlvblRvZ2dsZSA9IGZ1bmN0aW9uICgkc2VjdGlvbikge1xyXG4gIHZhciBleHBhbmRlZCA9IHRoaXMuaXNFeHBhbmRlZCgkc2VjdGlvbik7XHJcbiAgdGhpcy5zZXRFeHBhbmRlZCghZXhwYW5kZWQsICRzZWN0aW9uKTtcclxuXHJcbiAgLy8gU3RvcmUgdGhlIHN0YXRlIGluIHNlc3Npb25TdG9yYWdlIHdoZW4gYSBjaGFuZ2UgaXMgdHJpZ2dlcmVkXHJcbiAgdGhpcy5zdG9yZVN0YXRlKCRzZWN0aW9uKTtcclxufTtcclxuXHJcbi8vIFdoZW4gT3Blbi9DbG9zZSBBbGwgdG9nZ2xlZCwgc2V0IGFuZCBzdG9yZSBzdGF0ZVxyXG5BY2NvcmRpb24ucHJvdG90eXBlLm9uU2hvd09ySGlkZUFsbFRvZ2dsZSA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJG1vZHVsZSA9IHRoaXM7XHJcbiAgdmFyICRzZWN0aW9ucyA9IHRoaXMuJHNlY3Rpb25zO1xyXG4gIHZhciBub3dFeHBhbmRlZCA9ICF0aGlzLmNoZWNrSWZBbGxTZWN0aW9uc09wZW4oKTtcclxuXHJcbiAgbm9kZUxpc3RGb3JFYWNoKCRzZWN0aW9ucywgZnVuY3Rpb24gKCRzZWN0aW9uKSB7XHJcbiAgICAkbW9kdWxlLnNldEV4cGFuZGVkKG5vd0V4cGFuZGVkLCAkc2VjdGlvbik7XHJcbiAgICAvLyBTdG9yZSB0aGUgc3RhdGUgaW4gc2Vzc2lvblN0b3JhZ2Ugd2hlbiBhIGNoYW5nZSBpcyB0cmlnZ2VyZWRcclxuICAgICRtb2R1bGUuc3RvcmVTdGF0ZSgkc2VjdGlvbik7XHJcbiAgfSk7XHJcblxyXG4gICRtb2R1bGUudXBkYXRlU2hvd0FsbEJ1dHRvbihub3dFeHBhbmRlZCk7XHJcbn07XHJcblxyXG4vLyBTZXQgc2VjdGlvbiBhdHRyaWJ1dGVzIHdoZW4gb3BlbmVkL2Nsb3NlZFxyXG5BY2NvcmRpb24ucHJvdG90eXBlLnNldEV4cGFuZGVkID0gZnVuY3Rpb24gKGV4cGFuZGVkLCAkc2VjdGlvbikge1xyXG4gIHZhciAkaWNvbiA9ICRzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy51cENoZXZyb25JY29uQ2xhc3MpO1xyXG4gIHZhciAkc2hvd0hpZGVUZXh0ID0gJHNlY3Rpb24ucXVlcnlTZWxlY3RvcignLicgKyB0aGlzLnNlY3Rpb25TaG93SGlkZVRleHRDbGFzcyk7XHJcbiAgdmFyICRidXR0b24gPSAkc2VjdGlvbi5xdWVyeVNlbGVjdG9yKCcuJyArIHRoaXMuc2VjdGlvbkJ1dHRvbkNsYXNzKTtcclxuICB2YXIgbmV3QnV0dG9uVGV4dCA9IGV4cGFuZGVkXHJcbiAgICA/IHRoaXMuaTE4bi50KCdoaWRlU2VjdGlvbicpXHJcbiAgICA6IHRoaXMuaTE4bi50KCdzaG93U2VjdGlvbicpO1xyXG5cclxuICAkc2hvd0hpZGVUZXh0LmlubmVyVGV4dCA9IG5ld0J1dHRvblRleHQ7XHJcbiAgJGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCBleHBhbmRlZCk7XHJcblxyXG4gIC8vIFVwZGF0ZSBhcmlhLWxhYmVsIGNvbWJpbmluZ1xyXG4gIHZhciAkaGVhZGVyID0gJHNlY3Rpb24ucXVlcnlTZWxlY3RvcignLicgKyB0aGlzLnNlY3Rpb25IZWFkaW5nVGV4dENsYXNzKTtcclxuICB2YXIgYXJpYUxhYmVsUGFydHMgPSBbJGhlYWRlci5pbm5lclRleHQudHJpbSgpXTtcclxuXHJcbiAgdmFyICRzdW1tYXJ5ID0gJHNlY3Rpb24ucXVlcnlTZWxlY3RvcignLicgKyB0aGlzLnNlY3Rpb25TdW1tYXJ5Q2xhc3MpO1xyXG4gIGlmICgkc3VtbWFyeSkge1xyXG4gICAgYXJpYUxhYmVsUGFydHMucHVzaCgkc3VtbWFyeS5pbm5lclRleHQudHJpbSgpKTtcclxuICB9XHJcblxyXG4gIHZhciBhcmlhTGFiZWxNZXNzYWdlID0gZXhwYW5kZWRcclxuICAgID8gdGhpcy5pMThuLnQoJ2hpZGVTZWN0aW9uQXJpYUxhYmVsJylcclxuICAgIDogdGhpcy5pMThuLnQoJ3Nob3dTZWN0aW9uQXJpYUxhYmVsJyk7XHJcbiAgYXJpYUxhYmVsUGFydHMucHVzaChhcmlhTGFiZWxNZXNzYWdlKTtcclxuXHJcbiAgLypcclxuICAgKiBKb2luIHdpdGggYSBjb21tYSB0byBhZGQgcGF1c2UgZm9yIGFzc2lzdGl2ZSB0ZWNobm9sb2d5LlxyXG4gICAqIEV4YW1wbGU6IFtoZWFkaW5nXVNlY3Rpb24gQSAsW3BhdXNlXSBTaG93IHRoaXMgc2VjdGlvbi5cclxuICAgKiBodHRwczovL2FjY2Vzc2liaWxpdHkuYmxvZy5nb3YudWsvMjAxNy8xMi8xOC93aGF0LXdvcmtpbmctb24tZ292LXVrLW5hdmlnYXRpb24tdGF1Z2h0LXVzLWFib3V0LWFjY2Vzc2liaWxpdHkvXHJcbiAgICovXHJcbiAgJGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBhcmlhTGFiZWxQYXJ0cy5qb2luKCcgLCAnKSk7XHJcblxyXG4gIC8vIFN3YXAgaWNvbiwgY2hhbmdlIGNsYXNzXHJcbiAgaWYgKGV4cGFuZGVkKSB7XHJcbiAgICAkc2VjdGlvbi5jbGFzc0xpc3QuYWRkKHRoaXMuc2VjdGlvbkV4cGFuZGVkQ2xhc3MpO1xyXG4gICAgJGljb24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLmRvd25DaGV2cm9uSWNvbkNsYXNzKTtcclxuICB9IGVsc2Uge1xyXG4gICAgJHNlY3Rpb24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLnNlY3Rpb25FeHBhbmRlZENsYXNzKTtcclxuICAgICRpY29uLmNsYXNzTGlzdC5hZGQodGhpcy5kb3duQ2hldnJvbkljb25DbGFzcyk7XHJcbiAgfVxyXG5cclxuICAvLyBTZWUgaWYgXCJTaG93IGFsbCBzZWN0aW9uc1wiIGJ1dHRvbiB0ZXh0IHNob3VsZCBiZSB1cGRhdGVkXHJcbiAgdmFyIGFyZUFsbFNlY3Rpb25zT3BlbiA9IHRoaXMuY2hlY2tJZkFsbFNlY3Rpb25zT3BlbigpO1xyXG4gIHRoaXMudXBkYXRlU2hvd0FsbEJ1dHRvbihhcmVBbGxTZWN0aW9uc09wZW4pO1xyXG59O1xyXG5cclxuLy8gR2V0IHN0YXRlIG9mIHNlY3Rpb25cclxuQWNjb3JkaW9uLnByb3RvdHlwZS5pc0V4cGFuZGVkID0gZnVuY3Rpb24gKCRzZWN0aW9uKSB7XHJcbiAgcmV0dXJuICRzZWN0aW9uLmNsYXNzTGlzdC5jb250YWlucyh0aGlzLnNlY3Rpb25FeHBhbmRlZENsYXNzKVxyXG59O1xyXG5cclxuLy8gQ2hlY2sgaWYgYWxsIHNlY3Rpb25zIGFyZSBvcGVuXHJcbkFjY29yZGlvbi5wcm90b3R5cGUuY2hlY2tJZkFsbFNlY3Rpb25zT3BlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAvLyBHZXQgYSBjb3VudCBvZiBhbGwgdGhlIEFjY29yZGlvbiBzZWN0aW9uc1xyXG4gIHZhciBzZWN0aW9uc0NvdW50ID0gdGhpcy4kc2VjdGlvbnMubGVuZ3RoO1xyXG4gIC8vIEdldCBhIGNvdW50IG9mIGFsbCBBY2NvcmRpb24gc2VjdGlvbnMgdGhhdCBhcmUgZXhwYW5kZWRcclxuICB2YXIgZXhwYW5kZWRTZWN0aW9uQ291bnQgPSB0aGlzLiRtb2R1bGUucXVlcnlTZWxlY3RvckFsbCgnLicgKyB0aGlzLnNlY3Rpb25FeHBhbmRlZENsYXNzKS5sZW5ndGg7XHJcbiAgdmFyIGFyZUFsbFNlY3Rpb25zT3BlbiA9IHNlY3Rpb25zQ291bnQgPT09IGV4cGFuZGVkU2VjdGlvbkNvdW50O1xyXG5cclxuICByZXR1cm4gYXJlQWxsU2VjdGlvbnNPcGVuXHJcbn07XHJcblxyXG4vLyBVcGRhdGUgXCJTaG93IGFsbCBzZWN0aW9uc1wiIGJ1dHRvblxyXG5BY2NvcmRpb24ucHJvdG90eXBlLnVwZGF0ZVNob3dBbGxCdXR0b24gPSBmdW5jdGlvbiAoZXhwYW5kZWQpIHtcclxuICB2YXIgJHNob3dBbGxJY29uID0gdGhpcy4kc2hvd0FsbEJ1dHRvbi5xdWVyeVNlbGVjdG9yKCcuJyArIHRoaXMudXBDaGV2cm9uSWNvbkNsYXNzKTtcclxuICB2YXIgJHNob3dBbGxUZXh0ID0gdGhpcy4kc2hvd0FsbEJ1dHRvbi5xdWVyeVNlbGVjdG9yKCcuJyArIHRoaXMuc2hvd0FsbFRleHRDbGFzcyk7XHJcbiAgdmFyIG5ld0J1dHRvblRleHQgPSBleHBhbmRlZFxyXG4gICAgPyB0aGlzLmkxOG4udCgnaGlkZUFsbFNlY3Rpb25zJylcclxuICAgIDogdGhpcy5pMThuLnQoJ3Nob3dBbGxTZWN0aW9ucycpO1xyXG4gIHRoaXMuJHNob3dBbGxCdXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgZXhwYW5kZWQpO1xyXG4gICRzaG93QWxsVGV4dC5pbm5lclRleHQgPSBuZXdCdXR0b25UZXh0O1xyXG5cclxuICAvLyBTd2FwIGljb24sIHRvZ2dsZSBjbGFzc1xyXG4gIGlmIChleHBhbmRlZCkge1xyXG4gICAgJHNob3dBbGxJY29uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5kb3duQ2hldnJvbkljb25DbGFzcyk7XHJcbiAgfSBlbHNlIHtcclxuICAgICRzaG93QWxsSWNvbi5jbGFzc0xpc3QuYWRkKHRoaXMuZG93bkNoZXZyb25JY29uQ2xhc3MpO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIENoZWNrIGZvciBgd2luZG93LnNlc3Npb25TdG9yYWdlYCwgYW5kIHRoYXQgaXQgYWN0dWFsbHkgd29ya3MuXHJcbnZhciBoZWxwZXIgPSB7XHJcbiAgY2hlY2tGb3JTZXNzaW9uU3RvcmFnZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHRlc3RTdHJpbmcgPSAndGhpcyBpcyB0aGUgdGVzdCBzdHJpbmcnO1xyXG4gICAgdmFyIHJlc3VsdDtcclxuICAgIHRyeSB7XHJcbiAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKHRlc3RTdHJpbmcsIHRlc3RTdHJpbmcpO1xyXG4gICAgICByZXN1bHQgPSB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSh0ZXN0U3RyaW5nKSA9PT0gdGVzdFN0cmluZy50b1N0cmluZygpO1xyXG4gICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSh0ZXN0U3RyaW5nKTtcclxuICAgICAgcmV0dXJuIHJlc3VsdFxyXG4gICAgfSBjYXRjaCAoZXhjZXB0aW9uKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgfVxyXG4gIH1cclxufTtcclxuXHJcbi8vIFNldCB0aGUgc3RhdGUgb2YgdGhlIGFjY29yZGlvbnMgaW4gc2Vzc2lvblN0b3JhZ2VcclxuQWNjb3JkaW9uLnByb3RvdHlwZS5zdG9yZVN0YXRlID0gZnVuY3Rpb24gKCRzZWN0aW9uKSB7XHJcbiAgaWYgKHRoaXMuYnJvd3NlclN1cHBvcnRzU2Vzc2lvblN0b3JhZ2UpIHtcclxuICAgIC8vIFdlIG5lZWQgYSB1bmlxdWUgd2F5IG9mIGlkZW50aWZ5aW5nIGVhY2ggY29udGVudCBpbiB0aGUgQWNjb3JkaW9uLiBTaW5jZVxyXG4gICAgLy8gYW4gYCNpZGAgc2hvdWxkIGJlIHVuaXF1ZSBhbmQgYW4gYGlkYCBpcyByZXF1aXJlZCBmb3IgYGFyaWEtYCBhdHRyaWJ1dGVzXHJcbiAgICAvLyBgaWRgIGNhbiBiZSBzYWZlbHkgdXNlZC5cclxuICAgIHZhciAkYnV0dG9uID0gJHNlY3Rpb24ucXVlcnlTZWxlY3RvcignLicgKyB0aGlzLnNlY3Rpb25CdXR0b25DbGFzcyk7XHJcblxyXG4gICAgaWYgKCRidXR0b24pIHtcclxuICAgICAgdmFyIGNvbnRlbnRJZCA9ICRidXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJyk7XHJcbiAgICAgIHZhciBjb250ZW50U3RhdGUgPSAkYnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcpO1xyXG5cclxuICAgICAgLy8gT25seSBzZXQgdGhlIHN0YXRlIHdoZW4gYm90aCBgY29udGVudElkYCBhbmQgYGNvbnRlbnRTdGF0ZWAgYXJlIHRha2VuIGZyb20gdGhlIERPTS5cclxuICAgICAgaWYgKGNvbnRlbnRJZCAmJiBjb250ZW50U3RhdGUpIHtcclxuICAgICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShjb250ZW50SWQsIGNvbnRlbnRTdGF0ZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG4vLyBSZWFkIHRoZSBzdGF0ZSBvZiB0aGUgYWNjb3JkaW9ucyBmcm9tIHNlc3Npb25TdG9yYWdlXHJcbkFjY29yZGlvbi5wcm90b3R5cGUuc2V0SW5pdGlhbFN0YXRlID0gZnVuY3Rpb24gKCRzZWN0aW9uKSB7XHJcbiAgaWYgKHRoaXMuYnJvd3NlclN1cHBvcnRzU2Vzc2lvblN0b3JhZ2UpIHtcclxuICAgIHZhciAkYnV0dG9uID0gJHNlY3Rpb24ucXVlcnlTZWxlY3RvcignLicgKyB0aGlzLnNlY3Rpb25CdXR0b25DbGFzcyk7XHJcblxyXG4gICAgaWYgKCRidXR0b24pIHtcclxuICAgICAgdmFyIGNvbnRlbnRJZCA9ICRidXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJyk7XHJcbiAgICAgIHZhciBjb250ZW50U3RhdGUgPSBjb250ZW50SWQgPyB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShjb250ZW50SWQpIDogbnVsbDtcclxuXHJcbiAgICAgIGlmIChjb250ZW50U3RhdGUgIT09IG51bGwpIHtcclxuICAgICAgICB0aGlzLnNldEV4cGFuZGVkKGNvbnRlbnRTdGF0ZSA9PT0gJ3RydWUnLCAkc2VjdGlvbik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFuIGVsZW1lbnQgdG8gaW1wcm92ZSBzZW1hbnRpY3Mgb2YgdGhlIHNlY3Rpb24gYnV0dG9uIHdpdGggcHVuY3R1YXRpb25cclxuICpcclxuICogQHJldHVybnMge0hUTUxTcGFuRWxlbWVudH0gRE9NIGVsZW1lbnRcclxuICpcclxuICogQWRkaW5nIHB1bmN0dWF0aW9uIHRvIHRoZSBidXR0b24gY2FuIGFsc28gaW1wcm92ZSBpdHMgZ2VuZXJhbCBzZW1hbnRpY3MgYnkgZGl2aWRpbmcgaXRzIGNvbnRlbnRzXHJcbiAqIGludG8gdGhlbWF0aWMgY2h1bmtzLlxyXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2FscGhhZ292L2dvdnVrLWZyb250ZW5kL2lzc3Vlcy8yMzI3I2lzc3VlY29tbWVudC05MjI5NTc0NDJcclxuICovXHJcbkFjY29yZGlvbi5wcm90b3R5cGUuZ2V0QnV0dG9uUHVuY3R1YXRpb25FbCA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJHB1bmN0dWF0aW9uRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgJHB1bmN0dWF0aW9uRWwuY2xhc3NMaXN0LmFkZCgnZ292dWstdmlzdWFsbHktaGlkZGVuJywgJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi1oZWFkaW5nLWRpdmlkZXInKTtcclxuICAkcHVuY3R1YXRpb25FbC5pbm5lckhUTUwgPSAnLCAnO1xyXG4gIHJldHVybiAkcHVuY3R1YXRpb25FbFxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEFjY29yZGlvbiBjb25maWdcclxuICpcclxuICogQHR5cGVkZWYge29iamVjdH0gQWNjb3JkaW9uQ29uZmlnXHJcbiAqIEBwcm9wZXJ0eSB7QWNjb3JkaW9uVHJhbnNsYXRpb25zfSBbaTE4biA9IEFDQ09SRElPTl9UUkFOU0xBVElPTlNdIC0gU2VlIGNvbnN0YW50IHtAbGluayBBQ0NPUkRJT05fVFJBTlNMQVRJT05TfVxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBBY2NvcmRpb24gdHJhbnNsYXRpb25zXHJcbiAqXHJcbiAqIEB0eXBlZGVmIHtvYmplY3R9IEFjY29yZGlvblRyYW5zbGF0aW9uc1xyXG4gKlxyXG4gKiBNZXNzYWdlcyB1c2VkIGJ5IHRoZSBjb21wb25lbnQgZm9yIHRoZSBsYWJlbHMgb2YgaXRzIGJ1dHRvbnMuIFRoaXMgaW5jbHVkZXNcclxuICogdGhlIHZpc2libGUgdGV4dCBzaG93biBvbiBzY3JlZW4sIGFuZCB0ZXh0IHRvIGhlbHAgYXNzaXN0aXZlIHRlY2hub2xvZ3kgdXNlcnNcclxuICogZm9yIHRoZSBidXR0b25zIHRvZ2dsaW5nIGVhY2ggc2VjdGlvbi5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IFtoaWRlQWxsU2VjdGlvbnNdIC0gVGhlIHRleHQgY29udGVudCBmb3IgdGhlICdIaWRlIGFsbFxyXG4gKiBzZWN0aW9ucycgYnV0dG9uLCB1c2VkIHdoZW4gYXQgbGVhc3Qgb25lIHNlY3Rpb24gaXMgZXhwYW5kZWQuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbaGlkZVNlY3Rpb25dIC0gVGhlIHRleHQgY29udGVudCBmb3IgdGhlICdIaWRlJ1xyXG4gKiBidXR0b24sIHVzZWQgd2hlbiBhIHNlY3Rpb24gaXMgZXhwYW5kZWQuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbaGlkZVNlY3Rpb25BcmlhTGFiZWxdIC0gVGhlIHRleHQgY29udGVudCBhcHBlbmRlZCB0byB0aGVcclxuICogJ0hpZGUnIGJ1dHRvbidzIGFjY2Vzc2libGUgbmFtZSB3aGVuIGEgc2VjdGlvbiBpcyBleHBhbmRlZC5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IFtzaG93QWxsU2VjdGlvbnNdIC0gVGhlIHRleHQgY29udGVudCBmb3IgdGhlICdTaG93IGFsbFxyXG4gKiBzZWN0aW9ucycgYnV0dG9uLCB1c2VkIHdoZW4gYWxsIHNlY3Rpb25zIGFyZSBjb2xsYXBzZWQuXHJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbc2hvd1NlY3Rpb25dIC0gVGhlIHRleHQgY29udGVudCBmb3IgdGhlICdTaG93J1xyXG4gKiBidXR0b24sIHVzZWQgd2hlbiBhIHNlY3Rpb24gaXMgY29sbGFwc2VkLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW3Nob3dTZWN0aW9uQXJpYUxhYmVsXSAtIFRoZSB0ZXh0IGNvbnRlbnQgYXBwZW5kZWQgdG8gdGhlXHJcbiAqICdTaG93JyBidXR0b24ncyBhY2Nlc3NpYmxlIG5hbWUgd2hlbiBhIHNlY3Rpb24gaXMgZXhwYW5kZWQuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG5cclxuLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlL2Jsb2IvbWFzdGVyL3BhY2thZ2VzL3BvbHlmaWxsLWxpYnJhcnkvcG9seWZpbGxzL1dpbmRvdy9kZXRlY3QuanNcclxudmFyIGRldGVjdCA9ICgnV2luZG93JyBpbiB0aGlzKTtcclxuXHJcbmlmIChkZXRlY3QpIHJldHVyblxyXG5cclxuLy8gUG9seWZpbGwgZnJvbSBodHRwczovL2Nkbi5wb2x5ZmlsbC5pby92Mi9wb2x5ZmlsbC5qcz9mZWF0dXJlcz1XaW5kb3cmZmxhZ3M9YWx3YXlzXHJcbmlmICgodHlwZW9mIFdvcmtlckdsb2JhbFNjb3BlID09PSBcInVuZGVmaW5lZFwiKSAmJiAodHlwZW9mIGltcG9ydFNjcmlwdHMgIT09IFwiZnVuY3Rpb25cIikpIHtcclxuXHQoZnVuY3Rpb24gKGdsb2JhbCkge1xyXG5cdFx0aWYgKGdsb2JhbC5jb25zdHJ1Y3Rvcikge1xyXG5cdFx0XHRnbG9iYWwuV2luZG93ID0gZ2xvYmFsLmNvbnN0cnVjdG9yO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0KGdsb2JhbC5XaW5kb3cgPSBnbG9iYWwuY29uc3RydWN0b3IgPSBuZXcgRnVuY3Rpb24oJ3JldHVybiBmdW5jdGlvbiBXaW5kb3coKSB7fScpKCkpLnByb3RvdHlwZSA9IHRoaXM7XHJcblx0XHR9XHJcblx0fSh0aGlzKSk7XHJcbn1cclxuXHJcbn0pXHJcbi5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG5cclxuLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlL2Jsb2IvbWFzdGVyL3BhY2thZ2VzL3BvbHlmaWxsLWxpYnJhcnkvcG9seWZpbGxzL0V2ZW50L2RldGVjdC5qc1xyXG52YXIgZGV0ZWN0ID0gKFxyXG4gIChmdW5jdGlvbihnbG9iYWwpIHtcclxuXHJcbiAgXHRpZiAoISgnRXZlbnQnIGluIGdsb2JhbCkpIHJldHVybiBmYWxzZTtcclxuICBcdGlmICh0eXBlb2YgZ2xvYmFsLkV2ZW50ID09PSAnZnVuY3Rpb24nKSByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgXHR0cnkge1xyXG5cclxuICBcdFx0Ly8gSW4gSUUgOS0xMSwgdGhlIEV2ZW50IG9iamVjdCBleGlzdHMgYnV0IGNhbm5vdCBiZSBpbnN0YW50aWF0ZWRcclxuICBcdFx0bmV3IEV2ZW50KCdjbGljaycpO1xyXG4gIFx0XHRyZXR1cm4gdHJ1ZTtcclxuICBcdH0gY2F0Y2goZSkge1xyXG4gIFx0XHRyZXR1cm4gZmFsc2U7XHJcbiAgXHR9XHJcbiAgfSh0aGlzKSlcclxuKTtcclxuXHJcbmlmIChkZXRlY3QpIHJldHVyblxyXG5cclxuLy8gUG9seWZpbGwgZnJvbSBodHRwczovL2Nkbi5wb2x5ZmlsbC5pby92Mi9wb2x5ZmlsbC5qcz9mZWF0dXJlcz1FdmVudCZmbGFncz1hbHdheXNcclxuKGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgdW5saXN0ZW5hYmxlV2luZG93RXZlbnRzID0ge1xyXG5cdFx0Y2xpY2s6IDEsXHJcblx0XHRkYmxjbGljazogMSxcclxuXHRcdGtleXVwOiAxLFxyXG5cdFx0a2V5cHJlc3M6IDEsXHJcblx0XHRrZXlkb3duOiAxLFxyXG5cdFx0bW91c2Vkb3duOiAxLFxyXG5cdFx0bW91c2V1cDogMSxcclxuXHRcdG1vdXNlbW92ZTogMSxcclxuXHRcdG1vdXNlb3ZlcjogMSxcclxuXHRcdG1vdXNlZW50ZXI6IDEsXHJcblx0XHRtb3VzZWxlYXZlOiAxLFxyXG5cdFx0bW91c2VvdXQ6IDEsXHJcblx0XHRzdG9yYWdlOiAxLFxyXG5cdFx0c3RvcmFnZWNvbW1pdDogMSxcclxuXHRcdHRleHRpbnB1dDogMVxyXG5cdH07XHJcblxyXG5cdC8vIFRoaXMgcG9seWZpbGwgZGVwZW5kcyBvbiBhdmFpbGFiaWxpdHkgb2YgYGRvY3VtZW50YCBzbyB3aWxsIG5vdCBydW4gaW4gYSB3b3JrZXJcclxuXHQvLyBIb3dldmVyLCB3ZSBhc3NzdW1lIHRoZXJlIGFyZSBubyBicm93c2VycyB3aXRoIHdvcmtlciBzdXBwb3J0IHRoYXQgbGFjayBwcm9wZXJcclxuXHQvLyBzdXBwb3J0IGZvciBgRXZlbnRgIHdpdGhpbiB0aGUgd29ya2VyXHJcblx0aWYgKHR5cGVvZiBkb2N1bWVudCA9PT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybjtcclxuXHJcblx0ZnVuY3Rpb24gaW5kZXhPZihhcnJheSwgZWxlbWVudCkge1xyXG5cdFx0dmFyXHJcblx0XHRpbmRleCA9IC0xLFxyXG5cdFx0bGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xyXG5cclxuXHRcdHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XHJcblx0XHRcdGlmIChpbmRleCBpbiBhcnJheSAmJiBhcnJheVtpbmRleF0gPT09IGVsZW1lbnQpIHtcclxuXHRcdFx0XHRyZXR1cm4gaW5kZXg7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gLTE7XHJcblx0fVxyXG5cclxuXHR2YXIgZXhpc3RpbmdQcm90byA9ICh3aW5kb3cuRXZlbnQgJiYgd2luZG93LkV2ZW50LnByb3RvdHlwZSkgfHwgbnVsbDtcclxuXHR3aW5kb3cuRXZlbnQgPSBXaW5kb3cucHJvdG90eXBlLkV2ZW50ID0gZnVuY3Rpb24gRXZlbnQodHlwZSwgZXZlbnRJbml0RGljdCkge1xyXG5cdFx0aWYgKCF0eXBlKSB7XHJcblx0XHRcdHRocm93IG5ldyBFcnJvcignTm90IGVub3VnaCBhcmd1bWVudHMnKTtcclxuXHRcdH1cclxuXHJcblx0XHR2YXIgZXZlbnQ7XHJcblx0XHQvLyBTaG9ydGN1dCBpZiBicm93c2VyIHN1cHBvcnRzIGNyZWF0ZUV2ZW50XHJcblx0XHRpZiAoJ2NyZWF0ZUV2ZW50JyBpbiBkb2N1bWVudCkge1xyXG5cdFx0XHRldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpO1xyXG5cdFx0XHR2YXIgYnViYmxlcyA9IGV2ZW50SW5pdERpY3QgJiYgZXZlbnRJbml0RGljdC5idWJibGVzICE9PSB1bmRlZmluZWQgPyBldmVudEluaXREaWN0LmJ1YmJsZXMgOiBmYWxzZTtcclxuXHRcdFx0dmFyIGNhbmNlbGFibGUgPSBldmVudEluaXREaWN0ICYmIGV2ZW50SW5pdERpY3QuY2FuY2VsYWJsZSAhPT0gdW5kZWZpbmVkID8gZXZlbnRJbml0RGljdC5jYW5jZWxhYmxlIDogZmFsc2U7XHJcblxyXG5cdFx0XHRldmVudC5pbml0RXZlbnQodHlwZSwgYnViYmxlcywgY2FuY2VsYWJsZSk7XHJcblxyXG5cdFx0XHRyZXR1cm4gZXZlbnQ7XHJcblx0XHR9XHJcblxyXG5cdFx0ZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCgpO1xyXG5cclxuXHRcdGV2ZW50LnR5cGUgPSB0eXBlO1xyXG5cdFx0ZXZlbnQuYnViYmxlcyA9IGV2ZW50SW5pdERpY3QgJiYgZXZlbnRJbml0RGljdC5idWJibGVzICE9PSB1bmRlZmluZWQgPyBldmVudEluaXREaWN0LmJ1YmJsZXMgOiBmYWxzZTtcclxuXHRcdGV2ZW50LmNhbmNlbGFibGUgPSBldmVudEluaXREaWN0ICYmIGV2ZW50SW5pdERpY3QuY2FuY2VsYWJsZSAhPT0gdW5kZWZpbmVkID8gZXZlbnRJbml0RGljdC5jYW5jZWxhYmxlIDogZmFsc2U7XHJcblxyXG5cdFx0cmV0dXJuIGV2ZW50O1xyXG5cdH07XHJcblx0aWYgKGV4aXN0aW5nUHJvdG8pIHtcclxuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3cuRXZlbnQsICdwcm90b3R5cGUnLCB7XHJcblx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXHJcblx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxyXG5cdFx0XHR3cml0YWJsZTogdHJ1ZSxcclxuXHRcdFx0dmFsdWU6IGV4aXN0aW5nUHJvdG9cclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0aWYgKCEoJ2NyZWF0ZUV2ZW50JyBpbiBkb2N1bWVudCkpIHtcclxuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyID0gV2luZG93LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gRG9jdW1lbnQucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBFbGVtZW50LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcigpIHtcclxuXHRcdFx0dmFyXHJcblx0XHRcdGVsZW1lbnQgPSB0aGlzLFxyXG5cdFx0XHR0eXBlID0gYXJndW1lbnRzWzBdLFxyXG5cdFx0XHRsaXN0ZW5lciA9IGFyZ3VtZW50c1sxXTtcclxuXHJcblx0XHRcdGlmIChlbGVtZW50ID09PSB3aW5kb3cgJiYgdHlwZSBpbiB1bmxpc3RlbmFibGVXaW5kb3dFdmVudHMpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0luIElFOCB0aGUgZXZlbnQ6ICcgKyB0eXBlICsgJyBpcyBub3QgYXZhaWxhYmxlIG9uIHRoZSB3aW5kb3cgb2JqZWN0LiBQbGVhc2Ugc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtc2VydmljZS9pc3N1ZXMvMzE3IGZvciBtb3JlIGluZm9ybWF0aW9uLicpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoIWVsZW1lbnQuX2V2ZW50cykge1xyXG5cdFx0XHRcdGVsZW1lbnQuX2V2ZW50cyA9IHt9O1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoIWVsZW1lbnQuX2V2ZW50c1t0eXBlXSkge1xyXG5cdFx0XHRcdGVsZW1lbnQuX2V2ZW50c1t0eXBlXSA9IGZ1bmN0aW9uIChldmVudCkge1xyXG5cdFx0XHRcdFx0dmFyXHJcblx0XHRcdFx0XHRsaXN0ID0gZWxlbWVudC5fZXZlbnRzW2V2ZW50LnR5cGVdLmxpc3QsXHJcblx0XHRcdFx0XHRldmVudHMgPSBsaXN0LnNsaWNlKCksXHJcblx0XHRcdFx0XHRpbmRleCA9IC0xLFxyXG5cdFx0XHRcdFx0bGVuZ3RoID0gZXZlbnRzLmxlbmd0aCxcclxuXHRcdFx0XHRcdGV2ZW50RWxlbWVudDtcclxuXHJcblx0XHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCA9IGZ1bmN0aW9uIHByZXZlbnREZWZhdWx0KCkge1xyXG5cdFx0XHRcdFx0XHRpZiAoZXZlbnQuY2FuY2VsYWJsZSAhPT0gZmFsc2UpIHtcclxuXHRcdFx0XHRcdFx0XHRldmVudC5yZXR1cm5WYWx1ZSA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9O1xyXG5cclxuXHRcdFx0XHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbiA9IGZ1bmN0aW9uIHN0b3BQcm9wYWdhdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0ZXZlbnQuY2FuY2VsQnViYmxlID0gdHJ1ZTtcclxuXHRcdFx0XHRcdH07XHJcblxyXG5cdFx0XHRcdFx0ZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uID0gZnVuY3Rpb24gc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRldmVudC5jYW5jZWxCdWJibGUgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRldmVudC5jYW5jZWxJbW1lZGlhdGUgPSB0cnVlO1xyXG5cdFx0XHRcdFx0fTtcclxuXHJcblx0XHRcdFx0XHRldmVudC5jdXJyZW50VGFyZ2V0ID0gZWxlbWVudDtcclxuXHRcdFx0XHRcdGV2ZW50LnJlbGF0ZWRUYXJnZXQgPSBldmVudC5mcm9tRWxlbWVudCB8fCBudWxsO1xyXG5cdFx0XHRcdFx0ZXZlbnQudGFyZ2V0ID0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50LnNyY0VsZW1lbnQgfHwgZWxlbWVudDtcclxuXHRcdFx0XHRcdGV2ZW50LnRpbWVTdGFtcCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG5cclxuXHRcdFx0XHRcdGlmIChldmVudC5jbGllbnRYKSB7XHJcblx0XHRcdFx0XHRcdGV2ZW50LnBhZ2VYID0gZXZlbnQuY2xpZW50WCArIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0O1xyXG5cdFx0XHRcdFx0XHRldmVudC5wYWdlWSA9IGV2ZW50LmNsaWVudFkgKyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoICYmICFldmVudC5jYW5jZWxJbW1lZGlhdGUpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGluZGV4IGluIGV2ZW50cykge1xyXG5cdFx0XHRcdFx0XHRcdGV2ZW50RWxlbWVudCA9IGV2ZW50c1tpbmRleF07XHJcblxyXG5cdFx0XHRcdFx0XHRcdGlmIChpbmRleE9mKGxpc3QsIGV2ZW50RWxlbWVudCkgIT09IC0xICYmIHR5cGVvZiBldmVudEVsZW1lbnQgPT09ICdmdW5jdGlvbicpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGV2ZW50RWxlbWVudC5jYWxsKGVsZW1lbnQsIGV2ZW50KTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9O1xyXG5cclxuXHRcdFx0XHRlbGVtZW50Ll9ldmVudHNbdHlwZV0ubGlzdCA9IFtdO1xyXG5cclxuXHRcdFx0XHRpZiAoZWxlbWVudC5hdHRhY2hFdmVudCkge1xyXG5cdFx0XHRcdFx0ZWxlbWVudC5hdHRhY2hFdmVudCgnb24nICsgdHlwZSwgZWxlbWVudC5fZXZlbnRzW3R5cGVdKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGVsZW1lbnQuX2V2ZW50c1t0eXBlXS5saXN0LnB1c2gobGlzdGVuZXIpO1xyXG5cdFx0fTtcclxuXHJcblx0XHR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IFdpbmRvdy5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IERvY3VtZW50LnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gRWxlbWVudC5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIHJlbW92ZUV2ZW50TGlzdGVuZXIoKSB7XHJcblx0XHRcdHZhclxyXG5cdFx0XHRlbGVtZW50ID0gdGhpcyxcclxuXHRcdFx0dHlwZSA9IGFyZ3VtZW50c1swXSxcclxuXHRcdFx0bGlzdGVuZXIgPSBhcmd1bWVudHNbMV0sXHJcblx0XHRcdGluZGV4O1xyXG5cclxuXHRcdFx0aWYgKGVsZW1lbnQuX2V2ZW50cyAmJiBlbGVtZW50Ll9ldmVudHNbdHlwZV0gJiYgZWxlbWVudC5fZXZlbnRzW3R5cGVdLmxpc3QpIHtcclxuXHRcdFx0XHRpbmRleCA9IGluZGV4T2YoZWxlbWVudC5fZXZlbnRzW3R5cGVdLmxpc3QsIGxpc3RlbmVyKTtcclxuXHJcblx0XHRcdFx0aWYgKGluZGV4ICE9PSAtMSkge1xyXG5cdFx0XHRcdFx0ZWxlbWVudC5fZXZlbnRzW3R5cGVdLmxpc3Quc3BsaWNlKGluZGV4LCAxKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoIWVsZW1lbnQuX2V2ZW50c1t0eXBlXS5saXN0Lmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRpZiAoZWxlbWVudC5kZXRhY2hFdmVudCkge1xyXG5cdFx0XHRcdFx0XHRcdGVsZW1lbnQuZGV0YWNoRXZlbnQoJ29uJyArIHR5cGUsIGVsZW1lbnQuX2V2ZW50c1t0eXBlXSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0ZGVsZXRlIGVsZW1lbnQuX2V2ZW50c1t0eXBlXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblxyXG5cdFx0d2luZG93LmRpc3BhdGNoRXZlbnQgPSBXaW5kb3cucHJvdG90eXBlLmRpc3BhdGNoRXZlbnQgPSBEb2N1bWVudC5wcm90b3R5cGUuZGlzcGF0Y2hFdmVudCA9IEVsZW1lbnQucHJvdG90eXBlLmRpc3BhdGNoRXZlbnQgPSBmdW5jdGlvbiBkaXNwYXRjaEV2ZW50KGV2ZW50KSB7XHJcblx0XHRcdGlmICghYXJndW1lbnRzLmxlbmd0aCkge1xyXG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcignTm90IGVub3VnaCBhcmd1bWVudHMnKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCFldmVudCB8fCB0eXBlb2YgZXZlbnQudHlwZSAhPT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ0RPTSBFdmVudHMgRXhjZXB0aW9uIDAnKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dmFyIGVsZW1lbnQgPSB0aGlzLCB0eXBlID0gZXZlbnQudHlwZTtcclxuXHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0aWYgKCFldmVudC5idWJibGVzKSB7XHJcblx0XHRcdFx0XHRldmVudC5jYW5jZWxCdWJibGUgPSB0cnVlO1xyXG5cclxuXHRcdFx0XHRcdHZhciBjYW5jZWxCdWJibGVFdmVudCA9IGZ1bmN0aW9uIChldmVudCkge1xyXG5cdFx0XHRcdFx0XHRldmVudC5jYW5jZWxCdWJibGUgPSB0cnVlO1xyXG5cclxuXHRcdFx0XHRcdFx0KGVsZW1lbnQgfHwgd2luZG93KS5kZXRhY2hFdmVudCgnb24nICsgdHlwZSwgY2FuY2VsQnViYmxlRXZlbnQpO1xyXG5cdFx0XHRcdFx0fTtcclxuXHJcblx0XHRcdFx0XHR0aGlzLmF0dGFjaEV2ZW50KCdvbicgKyB0eXBlLCBjYW5jZWxCdWJibGVFdmVudCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR0aGlzLmZpcmVFdmVudCgnb24nICsgdHlwZSwgZXZlbnQpO1xyXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0XHRcdGV2ZW50LnRhcmdldCA9IGVsZW1lbnQ7XHJcblxyXG5cdFx0XHRcdGRvIHtcclxuXHRcdFx0XHRcdGV2ZW50LmN1cnJlbnRUYXJnZXQgPSBlbGVtZW50O1xyXG5cclxuXHRcdFx0XHRcdGlmICgnX2V2ZW50cycgaW4gZWxlbWVudCAmJiB0eXBlb2YgZWxlbWVudC5fZXZlbnRzW3R5cGVdID09PSAnZnVuY3Rpb24nKSB7XHJcblx0XHRcdFx0XHRcdGVsZW1lbnQuX2V2ZW50c1t0eXBlXS5jYWxsKGVsZW1lbnQsIGV2ZW50KTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRpZiAodHlwZW9mIGVsZW1lbnRbJ29uJyArIHR5cGVdID09PSAnZnVuY3Rpb24nKSB7XHJcblx0XHRcdFx0XHRcdGVsZW1lbnRbJ29uJyArIHR5cGVdLmNhbGwoZWxlbWVudCwgZXZlbnQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdGVsZW1lbnQgPSBlbGVtZW50Lm5vZGVUeXBlID09PSA5ID8gZWxlbWVudC5wYXJlbnRXaW5kb3cgOiBlbGVtZW50LnBhcmVudE5vZGU7XHJcblx0XHRcdFx0fSB3aGlsZSAoZWxlbWVudCAmJiAhZXZlbnQuY2FuY2VsQnViYmxlKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9O1xyXG5cclxuXHRcdC8vIEFkZCB0aGUgRE9NQ29udGVudExvYWRlZCBFdmVudFxyXG5cdFx0ZG9jdW1lbnQuYXR0YWNoRXZlbnQoJ29ucmVhZHlzdGF0ZWNoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2NvbXBsZXRlJykge1xyXG5cdFx0XHRcdGRvY3VtZW50LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdET01Db250ZW50TG9hZGVkJywge1xyXG5cdFx0XHRcdFx0YnViYmxlczogdHJ1ZVxyXG5cdFx0XHRcdH0pKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59KCkpO1xyXG5cclxufSlcclxuLmNhbGwoJ29iamVjdCcgPT09IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93IHx8ICdvYmplY3QnID09PSB0eXBlb2Ygc2VsZiAmJiBzZWxmIHx8ICdvYmplY3QnID09PSB0eXBlb2YgZ2xvYmFsICYmIGdsb2JhbCB8fCB7fSk7XHJcblxyXG52YXIgS0VZX1NQQUNFID0gMzI7XHJcbnZhciBERUJPVU5DRV9USU1FT1VUX0lOX1NFQ09ORFMgPSAxO1xyXG5cclxuLyoqXHJcbiAqIEphdmFTY3JpcHQgZW5oYW5jZW1lbnRzIGZvciB0aGUgQnV0dG9uIGNvbXBvbmVudFxyXG4gKlxyXG4gKiBAY2xhc3NcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gJG1vZHVsZSAtIFRoZSBlbGVtZW50IHRoaXMgY29tcG9uZW50IGNvbnRyb2xzXHJcbiAqIEBwYXJhbSB7QnV0dG9uQ29uZmlnfSBjb25maWcgLSBCdXR0b24gY29uZmlnXHJcbiAqL1xyXG5mdW5jdGlvbiBCdXR0b24gKCRtb2R1bGUsIGNvbmZpZykge1xyXG4gIGlmICghJG1vZHVsZSkge1xyXG4gICAgcmV0dXJuIHRoaXNcclxuICB9XHJcblxyXG4gIHRoaXMuJG1vZHVsZSA9ICRtb2R1bGU7XHJcbiAgdGhpcy5kZWJvdW5jZUZvcm1TdWJtaXRUaW1lciA9IG51bGw7XHJcblxyXG4gIHZhciBkZWZhdWx0Q29uZmlnID0ge1xyXG4gICAgcHJldmVudERvdWJsZUNsaWNrOiBmYWxzZVxyXG4gIH07XHJcbiAgdGhpcy5jb25maWcgPSBtZXJnZUNvbmZpZ3MoXHJcbiAgICBkZWZhdWx0Q29uZmlnLFxyXG4gICAgY29uZmlnIHx8IHt9LFxyXG4gICAgbm9ybWFsaXNlRGF0YXNldCgkbW9kdWxlLmRhdGFzZXQpXHJcbiAgKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpc2UgY29tcG9uZW50XHJcbiAqL1xyXG5CdXR0b24ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgaWYgKCF0aGlzLiRtb2R1bGUpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgdGhpcy4kbW9kdWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleURvd24pO1xyXG4gIHRoaXMuJG1vZHVsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuZGVib3VuY2UuYmluZCh0aGlzKSk7XHJcbn07XHJcblxyXG4vKipcclxuICogVHJpZ2dlciBhIGNsaWNrIGV2ZW50IHdoZW4gdGhlIHNwYWNlIGtleSBpcyBwcmVzc2VkXHJcbiAqXHJcbiAqIFNvbWUgc2NyZWVuIHJlYWRlcnMgdGVsbCB1c2VycyB0aGV5IGNhbiBhY3RpdmF0ZSB0aGluZ3Mgd2l0aCB0aGUgJ2J1dHRvbidcclxuICogcm9sZSwgc28gd2UgbmVlZCB0byBtYXRjaCB0aGUgZnVuY3Rpb25hbGl0eSBvZiBuYXRpdmUgSFRNTCBidXR0b25zXHJcbiAqXHJcbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vYWxwaGFnb3YvZ292dWtfZWxlbWVudHMvcHVsbC8yNzIjaXNzdWVjb21tZW50LTIzMzAyODI3MFxyXG4gKlxyXG4gKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2ZW50XHJcbiAqL1xyXG5CdXR0b24ucHJvdG90eXBlLmhhbmRsZUtleURvd24gPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xyXG5cclxuICBpZiAodGFyZ2V0LmdldEF0dHJpYnV0ZSgncm9sZScpID09PSAnYnV0dG9uJyAmJiBldmVudC5rZXlDb2RlID09PSBLRVlfU1BBQ0UpIHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IC8vIHByZXZlbnQgdGhlIHBhZ2UgZnJvbSBzY3JvbGxpbmdcclxuICAgIHRhcmdldC5jbGljaygpO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBEZWJvdW5jZSBkb3VibGUtY2xpY2tzXHJcbiAqXHJcbiAqIElmIHRoZSBjbGljayBxdWlja2x5IHN1Y2NlZWRzIGEgcHJldmlvdXMgY2xpY2sgdGhlbiBub3RoaW5nIHdpbGwgaGFwcGVuLiBUaGlzXHJcbiAqIHN0b3BzIHBlb3BsZSBhY2NpZGVudGFsbHkgY2F1c2luZyBtdWx0aXBsZSBmb3JtIHN1Ym1pc3Npb25zIGJ5IGRvdWJsZVxyXG4gKiBjbGlja2luZyBidXR0b25zLlxyXG4gKlxyXG4gKiBAcGFyYW0ge01vdXNlRXZlbnR9IGV2ZW50XHJcbiAqIEByZXR1cm5zIHt1bmRlZmluZWQgfCBmYWxzZX0gLSBSZXR1cm5zIHVuZGVmaW5lZCwgb3IgZmFsc2Ugd2hlbiBkZWJvdW5jZWRcclxuICovXHJcbkJ1dHRvbi5wcm90b3R5cGUuZGVib3VuY2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAvLyBDaGVjayB0aGUgYnV0dG9uIHRoYXQgd2FzIGNsaWNrZWQgaGFzIHByZXZlbnREb3VibGVDbGljayBlbmFibGVkXHJcbiAgaWYgKCF0aGlzLmNvbmZpZy5wcmV2ZW50RG91YmxlQ2xpY2spIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgLy8gSWYgdGhlIHRpbWVyIGlzIHN0aWxsIHJ1bm5pbmcsIHByZXZlbnQgdGhlIGNsaWNrIGZyb20gc3VibWl0dGluZyB0aGUgZm9ybVxyXG4gIGlmICh0aGlzLmRlYm91bmNlRm9ybVN1Ym1pdFRpbWVyKSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG5cclxuICB0aGlzLmRlYm91bmNlRm9ybVN1Ym1pdFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmRlYm91bmNlRm9ybVN1Ym1pdFRpbWVyID0gbnVsbDtcclxuICB9LmJpbmQodGhpcyksIERFQk9VTkNFX1RJTUVPVVRfSU5fU0VDT05EUyAqIDEwMDApO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEJ1dHRvbiBjb25maWdcclxuICpcclxuICogQHR5cGVkZWYge29iamVjdH0gQnV0dG9uQ29uZmlnXHJcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gW3ByZXZlbnREb3VibGVDbGljayA9IGZhbHNlXSAtXHJcbiAqICBQcmV2ZW50IGFjY2lkZW50YWwgZG91YmxlIGNsaWNrcyBvbiBzdWJtaXQgYnV0dG9ucyBmcm9tIHN1Ym1pdHRpbmcgZm9ybXNcclxuICogIG11bHRpcGxlIHRpbWVzLlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBKYXZhU2NyaXB0ICdwb2x5ZmlsbCcgZm9yIEhUTUw1J3MgPGRldGFpbHM+IGFuZCA8c3VtbWFyeT4gZWxlbWVudHNcclxuICogYW5kICdzaGltJyB0byBhZGQgYWNjZXNzaWJsaXR5IGVuaGFuY2VtZW50cyBmb3IgYWxsIGJyb3dzZXJzXHJcbiAqXHJcbiAqIGh0dHA6Ly9jYW5pdXNlLmNvbS8jZmVhdD1kZXRhaWxzXHJcbiAqL1xyXG5cclxudmFyIEtFWV9FTlRFUiA9IDEzO1xyXG52YXIgS0VZX1NQQUNFJDEgPSAzMjtcclxuXHJcbi8qKlxyXG4gKiBEZXRhaWxzIGNvbXBvbmVudFxyXG4gKlxyXG4gKiBAY2xhc3NcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gJG1vZHVsZSAtIEhUTUwgZWxlbWVudCB0byB1c2UgZm9yIGRldGFpbHNcclxuICovXHJcbmZ1bmN0aW9uIERldGFpbHMgKCRtb2R1bGUpIHtcclxuICB0aGlzLiRtb2R1bGUgPSAkbW9kdWxlO1xyXG59XHJcblxyXG5EZXRhaWxzLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gIGlmICghdGhpcy4kbW9kdWxlKSB7XHJcbiAgICByZXR1cm5cclxuICB9XHJcblxyXG4gIC8vIElmIHRoZXJlIGlzIG5hdGl2ZSBkZXRhaWxzIHN1cHBvcnQsIHdlIHdhbnQgdG8gYXZvaWQgcnVubmluZyBjb2RlIHRvIHBvbHlmaWxsIG5hdGl2ZSBiZWhhdmlvdXIuXHJcbiAgdmFyIGhhc05hdGl2ZURldGFpbHMgPSB0eXBlb2YgdGhpcy4kbW9kdWxlLm9wZW4gPT09ICdib29sZWFuJztcclxuXHJcbiAgaWYgKGhhc05hdGl2ZURldGFpbHMpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgdGhpcy5wb2x5ZmlsbERldGFpbHMoKTtcclxufTtcclxuXHJcbkRldGFpbHMucHJvdG90eXBlLnBvbHlmaWxsRGV0YWlscyA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJG1vZHVsZSA9IHRoaXMuJG1vZHVsZTtcclxuXHJcbiAgLy8gU2F2ZSBzaG9ydGN1dHMgdG8gdGhlIGlubmVyIHN1bW1hcnkgYW5kIGNvbnRlbnQgZWxlbWVudHNcclxuICB2YXIgJHN1bW1hcnkgPSB0aGlzLiRzdW1tYXJ5ID0gJG1vZHVsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc3VtbWFyeScpLml0ZW0oMCk7XHJcbiAgdmFyICRjb250ZW50ID0gdGhpcy4kY29udGVudCA9ICRtb2R1bGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2RpdicpLml0ZW0oMCk7XHJcblxyXG4gIC8vIElmIDxkZXRhaWxzPiBkb2Vzbid0IGhhdmUgYSA8c3VtbWFyeT4gYW5kIGEgPGRpdj4gcmVwcmVzZW50aW5nIHRoZSBjb250ZW50XHJcbiAgLy8gaXQgbWVhbnMgdGhlIHJlcXVpcmVkIEhUTUwgc3RydWN0dXJlIGlzIG5vdCBtZXQgc28gdGhlIHNjcmlwdCB3aWxsIHN0b3BcclxuICBpZiAoISRzdW1tYXJ5IHx8ICEkY29udGVudCkge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICAvLyBJZiB0aGUgY29udGVudCBkb2Vzbid0IGhhdmUgYW4gSUQsIGFzc2lnbiBpdCBvbmUgbm93XHJcbiAgLy8gd2hpY2ggd2UnbGwgbmVlZCBmb3IgdGhlIHN1bW1hcnkncyBhcmlhLWNvbnRyb2xzIGFzc2lnbm1lbnRcclxuICBpZiAoISRjb250ZW50LmlkKSB7XHJcbiAgICAkY29udGVudC5pZCA9ICdkZXRhaWxzLWNvbnRlbnQtJyArIGdlbmVyYXRlVW5pcXVlSUQoKTtcclxuICB9XHJcblxyXG4gIC8vIEFkZCBBUklBIHJvbGU9XCJncm91cFwiIHRvIGRldGFpbHNcclxuICAkbW9kdWxlLnNldEF0dHJpYnV0ZSgncm9sZScsICdncm91cCcpO1xyXG5cclxuICAvLyBBZGQgcm9sZT1idXR0b24gdG8gc3VtbWFyeVxyXG4gICRzdW1tYXJ5LnNldEF0dHJpYnV0ZSgncm9sZScsICdidXR0b24nKTtcclxuXHJcbiAgLy8gQWRkIGFyaWEtY29udHJvbHNcclxuICAkc3VtbWFyeS5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnLCAkY29udGVudC5pZCk7XHJcblxyXG4gIC8vIFNldCB0YWJJbmRleCBzbyB0aGUgc3VtbWFyeSBpcyBrZXlib2FyZCBhY2Nlc3NpYmxlIGZvciBub24tbmF0aXZlIGVsZW1lbnRzXHJcbiAgLy9cclxuICAvLyBXZSBoYXZlIHRvIHVzZSB0aGUgY2FtZWxjYXNlIGB0YWJJbmRleGAgcHJvcGVydHkgYXMgdGhlcmUgaXMgYSBidWcgaW4gSUU2L0lFNyB3aGVuIHdlIHNldCB0aGUgY29ycmVjdCBhdHRyaWJ1dGUgbG93ZXJjYXNlOlxyXG4gIC8vIFNlZSBodHRwOi8vd2ViLmFyY2hpdmUub3JnL3dlYi8yMDE3MDEyMDE5NDAzNi9odHRwOi8vd3d3LnNhbGllbmNlcy5jb20vYnJvd3NlckJ1Z3MvdGFiSW5kZXguaHRtbCBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cclxuICAkc3VtbWFyeS50YWJJbmRleCA9IDA7XHJcblxyXG4gIC8vIERldGVjdCBpbml0aWFsIG9wZW4gc3RhdGVcclxuICBpZiAodGhpcy4kbW9kdWxlLmhhc0F0dHJpYnV0ZSgnb3BlbicpKSB7XHJcbiAgICAkc3VtbWFyeS5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAkc3VtbWFyeS5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcclxuICAgICRjb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgfVxyXG5cclxuICAvLyBCaW5kIGFuIGV2ZW50IHRvIGhhbmRsZSBzdW1tYXJ5IGVsZW1lbnRzXHJcbiAgdGhpcy5wb2x5ZmlsbEhhbmRsZUlucHV0cygkc3VtbWFyeSwgdGhpcy5wb2x5ZmlsbFNldEF0dHJpYnV0ZXMuYmluZCh0aGlzKSk7XHJcbn07XHJcblxyXG4vKipcclxuICogRGVmaW5lIGEgc3RhdGVjaGFuZ2UgZnVuY3Rpb24gdGhhdCB1cGRhdGVzIGFyaWEtZXhwYW5kZWQgYW5kIHN0eWxlLmRpc3BsYXlcclxuICpcclxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgdHJ1ZVxyXG4gKi9cclxuRGV0YWlscy5wcm90b3R5cGUucG9seWZpbGxTZXRBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKCkge1xyXG4gIGlmICh0aGlzLiRtb2R1bGUuaGFzQXR0cmlidXRlKCdvcGVuJykpIHtcclxuICAgIHRoaXMuJG1vZHVsZS5yZW1vdmVBdHRyaWJ1dGUoJ29wZW4nKTtcclxuICAgIHRoaXMuJHN1bW1hcnkuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XHJcbiAgICB0aGlzLiRjb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgfSBlbHNlIHtcclxuICAgIHRoaXMuJG1vZHVsZS5zZXRBdHRyaWJ1dGUoJ29wZW4nLCAnb3BlbicpO1xyXG4gICAgdGhpcy4kc3VtbWFyeS5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xyXG4gICAgdGhpcy4kY29udGVudC5zdHlsZS5kaXNwbGF5ID0gJyc7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gdHJ1ZVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEhhbmRsZSBjcm9zcy1tb2RhbCBjbGljayBldmVudHNcclxuICpcclxuICogQHBhcmFtIHtvYmplY3R9IG5vZGUgLSBlbGVtZW50XHJcbiAqIEBwYXJhbSB7cG9seWZpbGxIYW5kbGVJbnB1dHNDYWxsYmFja30gY2FsbGJhY2sgLSBmdW5jdGlvblxyXG4gKi9cclxuRGV0YWlscy5wcm90b3R5cGUucG9seWZpbGxIYW5kbGVJbnB1dHMgPSBmdW5jdGlvbiAobm9kZSwgY2FsbGJhY2spIHtcclxuICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgLy8gV2hlbiB0aGUga2V5IGdldHMgcHJlc3NlZCAtIGNoZWNrIGlmIGl0IGlzIGVudGVyIG9yIHNwYWNlXHJcbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gS0VZX0VOVEVSIHx8IGV2ZW50LmtleUNvZGUgPT09IEtFWV9TUEFDRSQxKSB7XHJcbiAgICAgIGlmICh0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3N1bW1hcnknKSB7XHJcbiAgICAgICAgLy8gUHJldmVudCBzcGFjZSBmcm9tIHNjcm9sbGluZyB0aGUgcGFnZVxyXG4gICAgICAgIC8vIGFuZCBlbnRlciBmcm9tIHN1Ym1pdHRpbmcgYSBmb3JtXHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAvLyBDbGljayB0byBsZXQgdGhlIGNsaWNrIGV2ZW50IGRvIGFsbCB0aGUgbmVjZXNzYXJ5IGFjdGlvblxyXG4gICAgICAgIGlmICh0YXJnZXQuY2xpY2spIHtcclxuICAgICAgICAgIHRhcmdldC5jbGljaygpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvLyBleGNlcHQgU2FmYXJpIDUuMSBhbmQgdW5kZXIgZG9uJ3Qgc3VwcG9ydCAuY2xpY2soKSBoZXJlXHJcbiAgICAgICAgICBjYWxsYmFjayhldmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIC8vIFByZXZlbnQga2V5dXAgdG8gcHJldmVudCBjbGlja2luZyB0d2ljZSBpbiBGaXJlZm94IHdoZW4gdXNpbmcgc3BhY2Uga2V5XHJcbiAgbm9kZS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDtcclxuICAgIGlmIChldmVudC5rZXlDb2RlID09PSBLRVlfU1BBQ0UkMSkge1xyXG4gICAgICBpZiAodGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdzdW1tYXJ5Jykge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgbm9kZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNhbGxiYWNrKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBAY2FsbGJhY2sgcG9seWZpbGxIYW5kbGVJbnB1dHNDYWxsYmFja1xyXG4gKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2ZW50IC0gS2V5Ym9hcmQgZXZlbnRcclxuICogQHJldHVybnMge3VuZGVmaW5lZH1cclxuICovXHJcblxyXG4oZnVuY3Rpb24odW5kZWZpbmVkKSB7XHJcblxyXG4gICAgLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1saWJyYXJ5L2Jsb2IvdjMuMTExLjAvcG9seWZpbGxzL0RhdGUvbm93L2RldGVjdC5qc1xyXG4gICAgdmFyIGRldGVjdCA9ICgnRGF0ZScgaW4gc2VsZiAmJiAnbm93JyBpbiBzZWxmLkRhdGUgJiYgJ2dldFRpbWUnIGluIHNlbGYuRGF0ZS5wcm90b3R5cGUpO1xyXG5cclxuICAgIGlmIChkZXRlY3QpIHJldHVyblxyXG5cclxuICAgIC8vIFBvbHlmaWxsIGZyb20gaHR0cHM6Ly9wb2x5ZmlsbC5pby92My9wb2x5ZmlsbC5qcz92ZXJzaW9uPTMuMTExLjAmZmVhdHVyZXM9RGF0ZS5ub3cmZmxhZ3M9YWx3YXlzXHJcbiAgICBEYXRlLm5vdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcbiAgICB9O1xyXG5cclxufSkuY2FsbCgnb2JqZWN0JyA9PT0gdHlwZW9mIHdpbmRvdyAmJiB3aW5kb3cgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBzZWxmICYmIHNlbGYgfHwgJ29iamVjdCcgPT09IHR5cGVvZiBnbG9iYWwgJiYgZ2xvYmFsIHx8IHt9KTtcclxuXHJcbihmdW5jdGlvbih1bmRlZmluZWQpIHtcclxuXHJcbiAgLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlLzFmM2MwOWI0MDJmNjViZjZlMzkzZjkzM2ExNWJhNjNmMWI4NmVmMWYvcGFja2FnZXMvcG9seWZpbGwtbGlicmFyeS9wb2x5ZmlsbHMvRWxlbWVudC9wcm90b3R5cGUvbWF0Y2hlcy9kZXRlY3QuanNcclxuICB2YXIgZGV0ZWN0ID0gKFxyXG4gICAgJ2RvY3VtZW50JyBpbiB0aGlzICYmIFwibWF0Y2hlc1wiIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudFxyXG4gICk7XHJcblxyXG4gIGlmIChkZXRlY3QpIHJldHVyblxyXG5cclxuICAvLyBQb2x5ZmlsbCBmcm9tIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtc2VydmljZS8xZjNjMDliNDAyZjY1YmY2ZTM5M2Y5MzNhMTViYTYzZjFiODZlZjFmL3BhY2thZ2VzL3BvbHlmaWxsLWxpYnJhcnkvcG9seWZpbGxzL0VsZW1lbnQvcHJvdG90eXBlL21hdGNoZXMvcG9seWZpbGwuanNcclxuICBFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzID0gRWxlbWVudC5wcm90b3R5cGUud2Via2l0TWF0Y2hlc1NlbGVjdG9yIHx8IEVsZW1lbnQucHJvdG90eXBlLm9NYXRjaGVzU2VsZWN0b3IgfHwgRWxlbWVudC5wcm90b3R5cGUubXNNYXRjaGVzU2VsZWN0b3IgfHwgRWxlbWVudC5wcm90b3R5cGUubW96TWF0Y2hlc1NlbGVjdG9yIHx8IGZ1bmN0aW9uIG1hdGNoZXMoc2VsZWN0b3IpIHtcclxuICAgIHZhciBlbGVtZW50ID0gdGhpcztcclxuICAgIHZhciBlbGVtZW50cyA9IChlbGVtZW50LmRvY3VtZW50IHx8IGVsZW1lbnQub3duZXJEb2N1bWVudCkucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XHJcbiAgICB2YXIgaW5kZXggPSAwO1xyXG5cclxuICAgIHdoaWxlIChlbGVtZW50c1tpbmRleF0gJiYgZWxlbWVudHNbaW5kZXhdICE9PSBlbGVtZW50KSB7XHJcbiAgICAgICsraW5kZXg7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuICEhZWxlbWVudHNbaW5kZXhdO1xyXG4gIH07XHJcblxyXG59KS5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG5cclxuICAvLyBEZXRlY3Rpb24gZnJvbSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLXNlcnZpY2UvMWYzYzA5YjQwMmY2NWJmNmUzOTNmOTMzYTE1YmE2M2YxYjg2ZWYxZi9wYWNrYWdlcy9wb2x5ZmlsbC1saWJyYXJ5L3BvbHlmaWxscy9FbGVtZW50L3Byb3RvdHlwZS9jbG9zZXN0L2RldGVjdC5qc1xyXG4gIHZhciBkZXRlY3QgPSAoXHJcbiAgICAnZG9jdW1lbnQnIGluIHRoaXMgJiYgXCJjbG9zZXN0XCIgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50XHJcbiAgKTtcclxuXHJcbiAgaWYgKGRldGVjdCkgcmV0dXJuXHJcblxyXG4gIC8vIFBvbHlmaWxsIGZyb20gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlLzFmM2MwOWI0MDJmNjViZjZlMzkzZjkzM2ExNWJhNjNmMWI4NmVmMWYvcGFja2FnZXMvcG9seWZpbGwtbGlicmFyeS9wb2x5ZmlsbHMvRWxlbWVudC9wcm90b3R5cGUvY2xvc2VzdC9wb2x5ZmlsbC5qc1xyXG4gIEVsZW1lbnQucHJvdG90eXBlLmNsb3Nlc3QgPSBmdW5jdGlvbiBjbG9zZXN0KHNlbGVjdG9yKSB7XHJcbiAgICB2YXIgbm9kZSA9IHRoaXM7XHJcblxyXG4gICAgd2hpbGUgKG5vZGUpIHtcclxuICAgICAgaWYgKG5vZGUubWF0Y2hlcyhzZWxlY3RvcikpIHJldHVybiBub2RlO1xyXG4gICAgICBlbHNlIG5vZGUgPSAnU1ZHRWxlbWVudCcgaW4gd2luZG93ICYmIG5vZGUgaW5zdGFuY2VvZiBTVkdFbGVtZW50ID8gbm9kZS5wYXJlbnROb2RlIDogbm9kZS5wYXJlbnRFbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH07XHJcblxyXG59KS5jYWxsKCdvYmplY3QnID09PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdyB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIHNlbGYgJiYgc2VsZiB8fCAnb2JqZWN0JyA9PT0gdHlwZW9mIGdsb2JhbCAmJiBnbG9iYWwgfHwge30pO1xyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBnaXZlbiBhdHRyaWJ1dGUgY2xvc2VzdCB0byB0aGUgZ2l2ZW4gZWxlbWVudCAoaW5jbHVkaW5nIGl0c2VsZilcclxuICpcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gJGVsZW1lbnQgLSBUaGUgZWxlbWVudCB0byBzdGFydCB3YWxraW5nIHRoZSBET00gdHJlZSB1cFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gYXR0cmlidXRlTmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBhdHRyaWJ1dGVcclxuICogQHJldHVybnMge3N0cmluZyB8IHVuZGVmaW5lZH0gQXR0cmlidXRlIHZhbHVlXHJcbiAqL1xyXG5mdW5jdGlvbiBjbG9zZXN0QXR0cmlidXRlVmFsdWUgKCRlbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XHJcbiAgdmFyIGNsb3Nlc3RFbGVtZW50V2l0aEF0dHJpYnV0ZSA9ICRlbGVtZW50LmNsb3Nlc3QoJ1snICsgYXR0cmlidXRlTmFtZSArICddJyk7XHJcbiAgaWYgKGNsb3Nlc3RFbGVtZW50V2l0aEF0dHJpYnV0ZSkge1xyXG4gICAgcmV0dXJuIGNsb3Nlc3RFbGVtZW50V2l0aEF0dHJpYnV0ZS5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSlcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAY29uc3RhbnRcclxuICogQHR5cGUge0NoYXJhY3RlckNvdW50VHJhbnNsYXRpb25zfVxyXG4gKiBAc2VlIERlZmF1bHQgdmFsdWUgZm9yIHtAbGluayBDaGFyYWN0ZXJDb3VudENvbmZpZy5pMThufVxyXG4gKiBAZGVmYXVsdFxyXG4gKi9cclxudmFyIENIQVJBQ1RFUl9DT1VOVF9UUkFOU0xBVElPTlMgPSB7XHJcbiAgLy8gQ2hhcmFjdGVyc1xyXG4gIGNoYXJhY3RlcnNVbmRlckxpbWl0OiB7XHJcbiAgICBvbmU6ICdZb3UgaGF2ZSAle2NvdW50fSBjaGFyYWN0ZXIgcmVtYWluaW5nJyxcclxuICAgIG90aGVyOiAnWW91IGhhdmUgJXtjb3VudH0gY2hhcmFjdGVycyByZW1haW5pbmcnXHJcbiAgfSxcclxuICBjaGFyYWN0ZXJzQXRMaW1pdDogJ1lvdSBoYXZlIDAgY2hhcmFjdGVycyByZW1haW5pbmcnLFxyXG4gIGNoYXJhY3RlcnNPdmVyTGltaXQ6IHtcclxuICAgIG9uZTogJ1lvdSBoYXZlICV7Y291bnR9IGNoYXJhY3RlciB0b28gbWFueScsXHJcbiAgICBvdGhlcjogJ1lvdSBoYXZlICV7Y291bnR9IGNoYXJhY3RlcnMgdG9vIG1hbnknXHJcbiAgfSxcclxuICAvLyBXb3Jkc1xyXG4gIHdvcmRzVW5kZXJMaW1pdDoge1xyXG4gICAgb25lOiAnWW91IGhhdmUgJXtjb3VudH0gd29yZCByZW1haW5pbmcnLFxyXG4gICAgb3RoZXI6ICdZb3UgaGF2ZSAle2NvdW50fSB3b3JkcyByZW1haW5pbmcnXHJcbiAgfSxcclxuICB3b3Jkc0F0TGltaXQ6ICdZb3UgaGF2ZSAwIHdvcmRzIHJlbWFpbmluZycsXHJcbiAgd29yZHNPdmVyTGltaXQ6IHtcclxuICAgIG9uZTogJ1lvdSBoYXZlICV7Y291bnR9IHdvcmQgdG9vIG1hbnknLFxyXG4gICAgb3RoZXI6ICdZb3UgaGF2ZSAle2NvdW50fSB3b3JkcyB0b28gbWFueSdcclxuICB9LFxyXG4gIHRleHRhcmVhRGVzY3JpcHRpb246IHtcclxuICAgIG90aGVyOiAnJ1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBKYXZhU2NyaXB0IGVuaGFuY2VtZW50cyBmb3IgdGhlIENoYXJhY3RlckNvdW50IGNvbXBvbmVudFxyXG4gKlxyXG4gKiBUcmFja3MgdGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIG9yIHdvcmRzIGluIHRoZSBgLmdvdnVrLWpzLWNoYXJhY3Rlci1jb3VudGBcclxuICogYDx0ZXh0YXJlYT5gIGluc2lkZSB0aGUgZWxlbWVudC4gRGlzcGxheXMgYSBtZXNzYWdlIHdpdGggdGhlIHJlbWFpbmluZyBudW1iZXJcclxuICogb2YgY2hhcmFjdGVycy93b3JkcyBhdmFpbGFibGUsIG9yIHRoZSBudW1iZXIgb2YgY2hhcmFjdGVycy93b3JkcyBpbiBleGNlc3MuXHJcbiAqXHJcbiAqIFlvdSBjYW4gY29uZmlndXJlIHRoZSBtZXNzYWdlIHRvIG9ubHkgYXBwZWFyIGFmdGVyIGEgY2VydGFpbiBwZXJjZW50YWdlXHJcbiAqIG9mIHRoZSBhdmFpbGFibGUgY2hhcmFjdGVycy93b3JkcyBoYXMgYmVlbiBlbnRlcmVkLlxyXG4gKlxyXG4gKiBAY2xhc3NcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gJG1vZHVsZSAtIFRoZSBlbGVtZW50IHRoaXMgY29tcG9uZW50IGNvbnRyb2xzXHJcbiAqIEBwYXJhbSB7Q2hhcmFjdGVyQ291bnRDb25maWd9IFtjb25maWddIC0gQ2hhcmFjdGVyIGNvdW50IGNvbmZpZ1xyXG4gKi9cclxuZnVuY3Rpb24gQ2hhcmFjdGVyQ291bnQgKCRtb2R1bGUsIGNvbmZpZykge1xyXG4gIGlmICghJG1vZHVsZSkge1xyXG4gICAgcmV0dXJuIHRoaXNcclxuICB9XHJcblxyXG4gIHZhciBkZWZhdWx0Q29uZmlnID0ge1xyXG4gICAgdGhyZXNob2xkOiAwLFxyXG4gICAgaTE4bjogQ0hBUkFDVEVSX0NPVU5UX1RSQU5TTEFUSU9OU1xyXG4gIH07XHJcblxyXG4gIC8vIFJlYWQgY29uZmlnIHNldCB1c2luZyBkYXRhc2V0ICgnZGF0YS0nIHZhbHVlcylcclxuICB2YXIgZGF0YXNldENvbmZpZyA9IG5vcm1hbGlzZURhdGFzZXQoJG1vZHVsZS5kYXRhc2V0KTtcclxuXHJcbiAgLy8gVG8gZW5zdXJlIGRhdGEtYXR0cmlidXRlcyB0YWtlIGNvbXBsZXRlIHByZWNlZGVuY2UsIGV2ZW4gaWYgdGhleSBjaGFuZ2UgdGhlXHJcbiAgLy8gdHlwZSBvZiBjb3VudCwgd2UgbmVlZCB0byByZXNldCB0aGUgYG1heGxlbmd0aGAgYW5kIGBtYXh3b3Jkc2AgZnJvbSB0aGVcclxuICAvLyBKYXZhU2NyaXB0IGNvbmZpZy5cclxuICAvL1xyXG4gIC8vIFdlIGNhbid0IG11dGF0ZSBgY29uZmlnYCwgdGhvdWdoLCBhcyBpdCBtYXkgYmUgc2hhcmVkIGFjcm9zcyBtdWx0aXBsZVxyXG4gIC8vIGNvbXBvbmVudHMgaW5zaWRlIGBpbml0QWxsYC5cclxuICB2YXIgY29uZmlnT3ZlcnJpZGVzID0ge307XHJcbiAgaWYgKCdtYXh3b3JkcycgaW4gZGF0YXNldENvbmZpZyB8fCAnbWF4bGVuZ3RoJyBpbiBkYXRhc2V0Q29uZmlnKSB7XHJcbiAgICBjb25maWdPdmVycmlkZXMgPSB7XHJcbiAgICAgIG1heGxlbmd0aDogZmFsc2UsXHJcbiAgICAgIG1heHdvcmRzOiBmYWxzZVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHRoaXMuY29uZmlnID0gbWVyZ2VDb25maWdzKFxyXG4gICAgZGVmYXVsdENvbmZpZyxcclxuICAgIGNvbmZpZyB8fCB7fSxcclxuICAgIGNvbmZpZ092ZXJyaWRlcyxcclxuICAgIGRhdGFzZXRDb25maWdcclxuICApO1xyXG5cclxuICB0aGlzLmkxOG4gPSBuZXcgSTE4bihleHRyYWN0Q29uZmlnQnlOYW1lc3BhY2UodGhpcy5jb25maWcsICdpMThuJyksIHtcclxuICAgIC8vIFJlYWQgdGhlIGZhbGxiYWNrIGlmIG5lY2Vzc2FyeSByYXRoZXIgdGhhbiBoYXZlIGl0IHNldCBpbiB0aGUgZGVmYXVsdHNcclxuICAgIGxvY2FsZTogY2xvc2VzdEF0dHJpYnV0ZVZhbHVlKCRtb2R1bGUsICdsYW5nJylcclxuICB9KTtcclxuXHJcbiAgLy8gRGV0ZXJtaW5lIHRoZSBsaW1pdCBhdHRyaWJ1dGUgKGNoYXJhY3RlcnMgb3Igd29yZHMpXHJcbiAgaWYgKHRoaXMuY29uZmlnLm1heHdvcmRzKSB7XHJcbiAgICB0aGlzLm1heExlbmd0aCA9IHRoaXMuY29uZmlnLm1heHdvcmRzO1xyXG4gIH0gZWxzZSBpZiAodGhpcy5jb25maWcubWF4bGVuZ3RoKSB7XHJcbiAgICB0aGlzLm1heExlbmd0aCA9IHRoaXMuY29uZmlnLm1heGxlbmd0aDtcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICB0aGlzLiRtb2R1bGUgPSAkbW9kdWxlO1xyXG4gIHRoaXMuJHRleHRhcmVhID0gJG1vZHVsZS5xdWVyeVNlbGVjdG9yKCcuZ292dWstanMtY2hhcmFjdGVyLWNvdW50Jyk7XHJcbiAgdGhpcy4kdmlzaWJsZUNvdW50TWVzc2FnZSA9IG51bGw7XHJcbiAgdGhpcy4kc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlID0gbnVsbDtcclxuICB0aGlzLmxhc3RJbnB1dFRpbWVzdGFtcCA9IG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXNlIGNvbXBvbmVudFxyXG4gKi9cclxuQ2hhcmFjdGVyQ291bnQucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgLy8gQ2hlY2sgdGhhdCByZXF1aXJlZCBlbGVtZW50cyBhcmUgcHJlc2VudFxyXG4gIGlmICghdGhpcy4kdGV4dGFyZWEpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgdmFyICR0ZXh0YXJlYSA9IHRoaXMuJHRleHRhcmVhO1xyXG4gIHZhciAkdGV4dGFyZWFEZXNjcmlwdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCR0ZXh0YXJlYS5pZCArICctaW5mbycpO1xyXG5cclxuICAvLyBJbmplY3QgYSBkZWNyaXB0aW9uIGZvciB0aGUgdGV4dGFyZWEgaWYgbm9uZSBpcyBwcmVzZW50IGFscmVhZHlcclxuICAvLyBmb3Igd2hlbiB0aGUgY29tcG9uZW50IHdhcyByZW5kZXJlZCB3aXRoIG5vIG1heGxlbmd0aCwgbWF4d29yZHNcclxuICAvLyBub3IgY3VzdG9tIHRleHRhcmVhRGVzY3JpcHRpb25UZXh0XHJcbiAgaWYgKCR0ZXh0YXJlYURlc2NyaXB0aW9uLmlubmVyVGV4dC5tYXRjaCgvXlxccyokLykpIHtcclxuICAgICR0ZXh0YXJlYURlc2NyaXB0aW9uLmlubmVyVGV4dCA9IHRoaXMuaTE4bi50KCd0ZXh0YXJlYURlc2NyaXB0aW9uJywgeyBjb3VudDogdGhpcy5tYXhMZW5ndGggfSk7XHJcbiAgfVxyXG5cclxuICAvLyBNb3ZlIHRoZSB0ZXh0YXJlYSBkZXNjcmlwdGlvbiB0byBiZSBpbW1lZGlhdGVseSBhZnRlciB0aGUgdGV4dGFyZWFcclxuICAvLyBLZXB0IGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eVxyXG4gICR0ZXh0YXJlYS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgJHRleHRhcmVhRGVzY3JpcHRpb24pO1xyXG5cclxuICAvLyBDcmVhdGUgdGhlICpzY3JlZW4gcmVhZGVyKiBzcGVjaWZpYyBsaXZlLXVwZGF0aW5nIGNvdW50ZXJcclxuICAvLyBUaGlzIGRvZXNuJ3QgbmVlZCBhbnkgc3R5bGluZyBjbGFzc2VzLCBhcyBpdCBpcyBuZXZlciB2aXNpYmxlXHJcbiAgdmFyICRzY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAkc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlLmNsYXNzTmFtZSA9ICdnb3Z1ay1jaGFyYWN0ZXItY291bnRfX3NyLXN0YXR1cyBnb3Z1ay12aXN1YWxseS1oaWRkZW4nO1xyXG4gICRzY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2Uuc2V0QXR0cmlidXRlKCdhcmlhLWxpdmUnLCAncG9saXRlJyk7XHJcbiAgdGhpcy4kc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlID0gJHNjcmVlblJlYWRlckNvdW50TWVzc2FnZTtcclxuICAkdGV4dGFyZWFEZXNjcmlwdGlvbi5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgJHNjcmVlblJlYWRlckNvdW50TWVzc2FnZSk7XHJcblxyXG4gIC8vIENyZWF0ZSBvdXIgbGl2ZS11cGRhdGluZyBjb3VudGVyIGVsZW1lbnQsIGNvcHlpbmcgdGhlIGNsYXNzZXMgZnJvbSB0aGVcclxuICAvLyB0ZXh0YXJlYSBkZXNjcmlwdGlvbiBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkgYXMgdGhlc2UgbWF5IGhhdmUgYmVlblxyXG4gIC8vIGNvbmZpZ3VyZWRcclxuICB2YXIgJHZpc2libGVDb3VudE1lc3NhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAkdmlzaWJsZUNvdW50TWVzc2FnZS5jbGFzc05hbWUgPSAkdGV4dGFyZWFEZXNjcmlwdGlvbi5jbGFzc05hbWU7XHJcbiAgJHZpc2libGVDb3VudE1lc3NhZ2UuY2xhc3NMaXN0LmFkZCgnZ292dWstY2hhcmFjdGVyLWNvdW50X19zdGF0dXMnKTtcclxuICAkdmlzaWJsZUNvdW50TWVzc2FnZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcclxuICB0aGlzLiR2aXNpYmxlQ291bnRNZXNzYWdlID0gJHZpc2libGVDb3VudE1lc3NhZ2U7XHJcbiAgJHRleHRhcmVhRGVzY3JpcHRpb24uaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmVuZCcsICR2aXNpYmxlQ291bnRNZXNzYWdlKTtcclxuXHJcbiAgLy8gSGlkZSB0aGUgdGV4dGFyZWEgZGVzY3JpcHRpb25cclxuICAkdGV4dGFyZWFEZXNjcmlwdGlvbi5jbGFzc0xpc3QuYWRkKCdnb3Z1ay12aXN1YWxseS1oaWRkZW4nKTtcclxuXHJcbiAgLy8gUmVtb3ZlIGhhcmQgbGltaXQgaWYgc2V0XHJcbiAgJHRleHRhcmVhLnJlbW92ZUF0dHJpYnV0ZSgnbWF4bGVuZ3RoJyk7XHJcblxyXG4gIHRoaXMuYmluZENoYW5nZUV2ZW50cygpO1xyXG5cclxuICAvLyBXaGVuIHRoZSBwYWdlIGlzIHJlc3RvcmVkIGFmdGVyIG5hdmlnYXRpbmcgJ2JhY2snIGluIHNvbWUgYnJvd3NlcnMgdGhlXHJcbiAgLy8gc3RhdGUgb2YgdGhlIGNoYXJhY3RlciBjb3VudCBpcyBub3QgcmVzdG9yZWQgdW50aWwgKmFmdGVyKiB0aGVcclxuICAvLyBET01Db250ZW50TG9hZGVkIGV2ZW50IGlzIGZpcmVkLCBzbyB3ZSBuZWVkIHRvIG1hbnVhbGx5IHVwZGF0ZSBpdCBhZnRlciB0aGVcclxuICAvLyBwYWdlc2hvdyBldmVudCBpbiBicm93c2VycyB0aGF0IHN1cHBvcnQgaXQuXHJcbiAgaWYgKCdvbnBhZ2VzaG93JyBpbiB3aW5kb3cpIHtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwYWdlc2hvdycsIHRoaXMudXBkYXRlQ291bnRNZXNzYWdlLmJpbmQodGhpcykpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIHRoaXMudXBkYXRlQ291bnRNZXNzYWdlLmJpbmQodGhpcykpO1xyXG4gIH1cclxuICB0aGlzLnVwZGF0ZUNvdW50TWVzc2FnZSgpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEJpbmQgY2hhbmdlIGV2ZW50c1xyXG4gKlxyXG4gKiBTZXQgdXAgZXZlbnQgbGlzdGVuZXJzIG9uIHRoZSAkdGV4dGFyZWEgc28gdGhhdCB0aGUgY291bnQgbWVzc2FnZXMgdXBkYXRlXHJcbiAqIHdoZW4gdGhlIHVzZXIgdHlwZXMuXHJcbiAqL1xyXG5DaGFyYWN0ZXJDb3VudC5wcm90b3R5cGUuYmluZENoYW5nZUV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJHRleHRhcmVhID0gdGhpcy4kdGV4dGFyZWE7XHJcbiAgJHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5oYW5kbGVLZXlVcC5iaW5kKHRoaXMpKTtcclxuXHJcbiAgLy8gQmluZCBmb2N1cy9ibHVyIGV2ZW50cyB0byBzdGFydC9zdG9wIHBvbGxpbmdcclxuICAkdGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzLmhhbmRsZUZvY3VzLmJpbmQodGhpcykpO1xyXG4gICR0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5oYW5kbGVCbHVyLmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEhhbmRsZSBrZXkgdXAgZXZlbnRcclxuICpcclxuICogVXBkYXRlIHRoZSB2aXNpYmxlIGNoYXJhY3RlciBjb3VudGVyIGFuZCBrZWVwIHRyYWNrIG9mIHdoZW4gdGhlIGxhc3QgdXBkYXRlXHJcbiAqIGhhcHBlbmVkIGZvciBlYWNoIGtleXByZXNzXHJcbiAqL1xyXG5DaGFyYWN0ZXJDb3VudC5wcm90b3R5cGUuaGFuZGxlS2V5VXAgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdGhpcy51cGRhdGVWaXNpYmxlQ291bnRNZXNzYWdlKCk7XHJcbiAgdGhpcy5sYXN0SW5wdXRUaW1lc3RhbXAgPSBEYXRlLm5vdygpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEhhbmRsZSBmb2N1cyBldmVudFxyXG4gKlxyXG4gKiBTcGVlY2ggcmVjb2duaXRpb24gc29mdHdhcmUgc3VjaCBhcyBEcmFnb24gTmF0dXJhbGx5U3BlYWtpbmcgd2lsbCBtb2RpZnkgdGhlXHJcbiAqIGZpZWxkcyBieSBkaXJlY3RseSBjaGFuZ2luZyBpdHMgYHZhbHVlYC4gVGhlc2UgY2hhbmdlcyBkb24ndCB0cmlnZ2VyIGV2ZW50c1xyXG4gKiBpbiBKYXZhU2NyaXB0LCBzbyB3ZSBuZWVkIHRvIHBvbGwgdG8gaGFuZGxlIHdoZW4gYW5kIGlmIHRoZXkgb2NjdXIuXHJcbiAqXHJcbiAqIE9uY2UgdGhlIGtleXVwIGV2ZW50IGhhc24ndCBiZWVuIGRldGVjdGVkIGZvciBhdCBsZWFzdCAxMDAwIG1zICgxcyksIGNoZWNrIGlmXHJcbiAqIHRoZSB0ZXh0YXJlYSB2YWx1ZSBoYXMgY2hhbmdlZCBhbmQgdXBkYXRlIHRoZSBjb3VudCBtZXNzYWdlIGlmIGl0IGhhcy5cclxuICpcclxuICogVGhpcyBpcyBzbyB0aGF0IHRoZSB1cGRhdGUgdHJpZ2dlcmVkIGJ5IHRoZSBtYW51YWwgY29tcGFyaXNvbiBkb2Vzbid0XHJcbiAqIGNvbmZsaWN0IHdpdGggZGVib3VuY2VkIEtleWJvYXJkRXZlbnQgdXBkYXRlcy5cclxuICovXHJcbkNoYXJhY3RlckNvdW50LnByb3RvdHlwZS5oYW5kbGVGb2N1cyA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLnZhbHVlQ2hlY2tlciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICghdGhpcy5sYXN0SW5wdXRUaW1lc3RhbXAgfHwgKERhdGUubm93KCkgLSA1MDApID49IHRoaXMubGFzdElucHV0VGltZXN0YW1wKSB7XHJcbiAgICAgIHRoaXMudXBkYXRlSWZWYWx1ZUNoYW5nZWQoKTtcclxuICAgIH1cclxuICB9LmJpbmQodGhpcyksIDEwMDApO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEhhbmRsZSBibHVyIGV2ZW50XHJcbiAqXHJcbiAqIFN0b3AgY2hlY2tpbmcgdGhlIHRleHRhcmVhIHZhbHVlIG9uY2UgdGhlIHRleHRhcmVhIG5vIGxvbmdlciBoYXMgZm9jdXNcclxuICovXHJcbkNoYXJhY3RlckNvdW50LnByb3RvdHlwZS5oYW5kbGVCbHVyID0gZnVuY3Rpb24gKCkge1xyXG4gIC8vIENhbmNlbCB2YWx1ZSBjaGVja2luZyBvbiBibHVyXHJcbiAgY2xlYXJJbnRlcnZhbCh0aGlzLnZhbHVlQ2hlY2tlcik7XHJcbn07XHJcblxyXG4vKipcclxuICogVXBkYXRlIGNvdW50IG1lc3NhZ2UgaWYgdGV4dGFyZWEgdmFsdWUgaGFzIGNoYW5nZWRcclxuICovXHJcbkNoYXJhY3RlckNvdW50LnByb3RvdHlwZS51cGRhdGVJZlZhbHVlQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcclxuICBpZiAoIXRoaXMuJHRleHRhcmVhLm9sZFZhbHVlKSB0aGlzLiR0ZXh0YXJlYS5vbGRWYWx1ZSA9ICcnO1xyXG4gIGlmICh0aGlzLiR0ZXh0YXJlYS52YWx1ZSAhPT0gdGhpcy4kdGV4dGFyZWEub2xkVmFsdWUpIHtcclxuICAgIHRoaXMuJHRleHRhcmVhLm9sZFZhbHVlID0gdGhpcy4kdGV4dGFyZWEudmFsdWU7XHJcbiAgICB0aGlzLnVwZGF0ZUNvdW50TWVzc2FnZSgpO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgY291bnQgbWVzc2FnZVxyXG4gKlxyXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gdXBkYXRlIGJvdGggdGhlIHZpc2libGUgYW5kIHNjcmVlbiByZWFkZXItc3BlY2lmaWNcclxuICogY291bnRlcnMgc2ltdWx0YW5lb3VzbHkgKGUuZy4gb24gaW5pdClcclxuICovXHJcbkNoYXJhY3RlckNvdW50LnByb3RvdHlwZS51cGRhdGVDb3VudE1lc3NhZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdGhpcy51cGRhdGVWaXNpYmxlQ291bnRNZXNzYWdlKCk7XHJcbiAgdGhpcy51cGRhdGVTY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2UoKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgdmlzaWJsZSBjb3VudCBtZXNzYWdlXHJcbiAqL1xyXG5DaGFyYWN0ZXJDb3VudC5wcm90b3R5cGUudXBkYXRlVmlzaWJsZUNvdW50TWVzc2FnZSA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJHRleHRhcmVhID0gdGhpcy4kdGV4dGFyZWE7XHJcbiAgdmFyICR2aXNpYmxlQ291bnRNZXNzYWdlID0gdGhpcy4kdmlzaWJsZUNvdW50TWVzc2FnZTtcclxuICB2YXIgcmVtYWluaW5nTnVtYmVyID0gdGhpcy5tYXhMZW5ndGggLSB0aGlzLmNvdW50KCR0ZXh0YXJlYS52YWx1ZSk7XHJcblxyXG4gIC8vIElmIGlucHV0IGlzIG92ZXIgdGhlIHRocmVzaG9sZCwgcmVtb3ZlIHRoZSBkaXNhYmxlZCBjbGFzcyB3aGljaCByZW5kZXJzIHRoZVxyXG4gIC8vIGNvdW50ZXIgaW52aXNpYmxlLlxyXG4gIGlmICh0aGlzLmlzT3ZlclRocmVzaG9sZCgpKSB7XHJcbiAgICAkdmlzaWJsZUNvdW50TWVzc2FnZS5jbGFzc0xpc3QucmVtb3ZlKCdnb3Z1ay1jaGFyYWN0ZXItY291bnRfX21lc3NhZ2UtLWRpc2FibGVkJyk7XHJcbiAgfSBlbHNlIHtcclxuICAgICR2aXNpYmxlQ291bnRNZXNzYWdlLmNsYXNzTGlzdC5hZGQoJ2dvdnVrLWNoYXJhY3Rlci1jb3VudF9fbWVzc2FnZS0tZGlzYWJsZWQnKTtcclxuICB9XHJcblxyXG4gIC8vIFVwZGF0ZSBzdHlsZXNcclxuICBpZiAocmVtYWluaW5nTnVtYmVyIDwgMCkge1xyXG4gICAgJHRleHRhcmVhLmNsYXNzTGlzdC5hZGQoJ2dvdnVrLXRleHRhcmVhLS1lcnJvcicpO1xyXG4gICAgJHZpc2libGVDb3VudE1lc3NhZ2UuY2xhc3NMaXN0LnJlbW92ZSgnZ292dWstaGludCcpO1xyXG4gICAgJHZpc2libGVDb3VudE1lc3NhZ2UuY2xhc3NMaXN0LmFkZCgnZ292dWstZXJyb3ItbWVzc2FnZScpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAkdGV4dGFyZWEuY2xhc3NMaXN0LnJlbW92ZSgnZ292dWstdGV4dGFyZWEtLWVycm9yJyk7XHJcbiAgICAkdmlzaWJsZUNvdW50TWVzc2FnZS5jbGFzc0xpc3QucmVtb3ZlKCdnb3Z1ay1lcnJvci1tZXNzYWdlJyk7XHJcbiAgICAkdmlzaWJsZUNvdW50TWVzc2FnZS5jbGFzc0xpc3QuYWRkKCdnb3Z1ay1oaW50Jyk7XHJcbiAgfVxyXG5cclxuICAvLyBVcGRhdGUgbWVzc2FnZVxyXG4gICR2aXNpYmxlQ291bnRNZXNzYWdlLmlubmVyVGV4dCA9IHRoaXMuZ2V0Q291bnRNZXNzYWdlKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogVXBkYXRlIHNjcmVlbiByZWFkZXIgY291bnQgbWVzc2FnZVxyXG4gKi9cclxuQ2hhcmFjdGVyQ291bnQucHJvdG90eXBlLnVwZGF0ZVNjcmVlblJlYWRlckNvdW50TWVzc2FnZSA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJHNjcmVlblJlYWRlckNvdW50TWVzc2FnZSA9IHRoaXMuJHNjcmVlblJlYWRlckNvdW50TWVzc2FnZTtcclxuXHJcbiAgLy8gSWYgb3ZlciB0aGUgdGhyZXNob2xkLCByZW1vdmUgdGhlIGFyaWEtaGlkZGVuIGF0dHJpYnV0ZSwgYWxsb3dpbmcgc2NyZWVuXHJcbiAgLy8gcmVhZGVycyB0byBhbm5vdW5jZSB0aGUgY29udGVudCBvZiB0aGUgZWxlbWVudC5cclxuICBpZiAodGhpcy5pc092ZXJUaHJlc2hvbGQoKSkge1xyXG4gICAgJHNjcmVlblJlYWRlckNvdW50TWVzc2FnZS5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJyk7XHJcbiAgfSBlbHNlIHtcclxuICAgICRzY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2Uuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsIHRydWUpO1xyXG4gIH1cclxuXHJcbiAgLy8gVXBkYXRlIG1lc3NhZ2VcclxuICAkc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlLmlubmVyVGV4dCA9IHRoaXMuZ2V0Q291bnRNZXNzYWdlKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogQ291bnQgdGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIChvciB3b3JkcywgaWYgYGNvbmZpZy5tYXh3b3Jkc2AgaXMgc2V0KVxyXG4gKiBpbiB0aGUgZ2l2ZW4gdGV4dFxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIFRoZSB0ZXh0IHRvIGNvdW50IHRoZSBjaGFyYWN0ZXJzIG9mXHJcbiAqIEByZXR1cm5zIHtudW1iZXJ9IHRoZSBudW1iZXIgb2YgY2hhcmFjdGVycyAob3Igd29yZHMpIGluIHRoZSB0ZXh0XHJcbiAqL1xyXG5DaGFyYWN0ZXJDb3VudC5wcm90b3R5cGUuY291bnQgPSBmdW5jdGlvbiAodGV4dCkge1xyXG4gIGlmICh0aGlzLmNvbmZpZy5tYXh3b3Jkcykge1xyXG4gICAgdmFyIHRva2VucyA9IHRleHQubWF0Y2goL1xcUysvZykgfHwgW107IC8vIE1hdGNoZXMgY29uc2VjdXRpdmUgbm9uLXdoaXRlc3BhY2UgY2hhcnNcclxuICAgIHJldHVybiB0b2tlbnMubGVuZ3RoXHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVybiB0ZXh0Lmxlbmd0aFxyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgY291bnQgbWVzc2FnZVxyXG4gKlxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBTdGF0dXMgbWVzc2FnZVxyXG4gKi9cclxuQ2hhcmFjdGVyQ291bnQucHJvdG90eXBlLmdldENvdW50TWVzc2FnZSA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgcmVtYWluaW5nTnVtYmVyID0gdGhpcy5tYXhMZW5ndGggLSB0aGlzLmNvdW50KHRoaXMuJHRleHRhcmVhLnZhbHVlKTtcclxuXHJcbiAgdmFyIGNvdW50VHlwZSA9IHRoaXMuY29uZmlnLm1heHdvcmRzID8gJ3dvcmRzJyA6ICdjaGFyYWN0ZXJzJztcclxuICByZXR1cm4gdGhpcy5mb3JtYXRDb3VudE1lc3NhZ2UocmVtYWluaW5nTnVtYmVyLCBjb3VudFR5cGUpXHJcbn07XHJcblxyXG4vKipcclxuICogRm9ybWF0cyB0aGUgbWVzc2FnZSBzaG93biB0byB1c2VycyBhY2NvcmRpbmcgdG8gd2hhdCdzIGNvdW50ZWRcclxuICogYW5kIGhvdyBtYW55IHJlbWFpblxyXG4gKlxyXG4gKiBAcGFyYW0ge251bWJlcn0gcmVtYWluaW5nTnVtYmVyIC0gVGhlIG51bWJlciBvZiB3b3Jkcy9jaGFyYWNhdGVycyByZW1haW5pbmdcclxuICogQHBhcmFtIHtzdHJpbmd9IGNvdW50VHlwZSAtIFwid29yZHNcIiBvciBcImNoYXJhY3RlcnNcIlxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBTdGF0dXMgbWVzc2FnZVxyXG4gKi9cclxuQ2hhcmFjdGVyQ291bnQucHJvdG90eXBlLmZvcm1hdENvdW50TWVzc2FnZSA9IGZ1bmN0aW9uIChyZW1haW5pbmdOdW1iZXIsIGNvdW50VHlwZSkge1xyXG4gIGlmIChyZW1haW5pbmdOdW1iZXIgPT09IDApIHtcclxuICAgIHJldHVybiB0aGlzLmkxOG4udChjb3VudFR5cGUgKyAnQXRMaW1pdCcpXHJcbiAgfVxyXG5cclxuICB2YXIgdHJhbnNsYXRpb25LZXlTdWZmaXggPSByZW1haW5pbmdOdW1iZXIgPCAwID8gJ092ZXJMaW1pdCcgOiAnVW5kZXJMaW1pdCc7XHJcblxyXG4gIHJldHVybiB0aGlzLmkxOG4udChjb3VudFR5cGUgKyB0cmFuc2xhdGlvbktleVN1ZmZpeCwgeyBjb3VudDogTWF0aC5hYnMocmVtYWluaW5nTnVtYmVyKSB9KVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIGNvdW50IGlzIG92ZXIgdGhyZXNob2xkXHJcbiAqXHJcbiAqIENoZWNrcyB3aGV0aGVyIHRoZSB2YWx1ZSBpcyBvdmVyIHRoZSBjb25maWd1cmVkIHRocmVzaG9sZCBmb3IgdGhlIGlucHV0LlxyXG4gKiBJZiB0aGVyZSBpcyBubyBjb25maWd1cmVkIHRocmVzaG9sZCwgaXQgaXMgc2V0IHRvIDAgYW5kIHRoaXMgZnVuY3Rpb24gd2lsbFxyXG4gKiBhbHdheXMgcmV0dXJuIHRydWUuXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlIGlmIHRoZSBjdXJyZW50IGNvdW50IGlzIG92ZXIgdGhlIGNvbmZpZy50aHJlc2hvbGRcclxuICogICAob3Igbm8gdGhyZXNob2xkIGlzIHNldClcclxuICovXHJcbkNoYXJhY3RlckNvdW50LnByb3RvdHlwZS5pc092ZXJUaHJlc2hvbGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgLy8gTm8gdGhyZXNob2xkIG1lYW5zIHdlJ3JlIGFsd2F5cyBhYm92ZSB0aHJlc2hvbGQgc28gc2F2ZSBzb21lIGNvbXB1dGF0aW9uXHJcbiAgaWYgKCF0aGlzLmNvbmZpZy50aHJlc2hvbGQpIHtcclxuICAgIHJldHVybiB0cnVlXHJcbiAgfVxyXG5cclxuICB2YXIgJHRleHRhcmVhID0gdGhpcy4kdGV4dGFyZWE7XHJcblxyXG4gIC8vIERldGVybWluZSB0aGUgcmVtYWluaW5nIG51bWJlciBvZiBjaGFyYWN0ZXJzL3dvcmRzXHJcbiAgdmFyIGN1cnJlbnRMZW5ndGggPSB0aGlzLmNvdW50KCR0ZXh0YXJlYS52YWx1ZSk7XHJcbiAgdmFyIG1heExlbmd0aCA9IHRoaXMubWF4TGVuZ3RoO1xyXG5cclxuICB2YXIgdGhyZXNob2xkVmFsdWUgPSBtYXhMZW5ndGggKiB0aGlzLmNvbmZpZy50aHJlc2hvbGQgLyAxMDA7XHJcblxyXG4gIHJldHVybiAodGhyZXNob2xkVmFsdWUgPD0gY3VycmVudExlbmd0aClcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDaGFyYWN0ZXIgY291bnQgY29uZmlnXHJcbiAqXHJcbiAqIEB0eXBlZGVmIHtDaGFyYWN0ZXJDb3VudENvbmZpZ1dpdGhNYXhMZW5ndGggfCBDaGFyYWN0ZXJDb3VudENvbmZpZ1dpdGhNYXhXb3Jkc30gQ2hhcmFjdGVyQ291bnRDb25maWdcclxuICovXHJcblxyXG4vKipcclxuICogQ2hhcmFjdGVyIGNvdW50IGNvbmZpZyAod2l0aCBtYXhpbXVtIG51bWJlciBvZiBjaGFyYWN0ZXJzKVxyXG4gKlxyXG4gKiBAdHlwZWRlZiB7b2JqZWN0fSBDaGFyYWN0ZXJDb3VudENvbmZpZ1dpdGhNYXhMZW5ndGhcclxuICogQHByb3BlcnR5IHtudW1iZXJ9IFttYXhsZW5ndGhdIC0gVGhlIG1heGltdW0gbnVtYmVyIG9mIGNoYXJhY3RlcnMuXHJcbiAqICBJZiBtYXh3b3JkcyBpcyBwcm92aWRlZCwgdGhlIG1heGxlbmd0aCBvcHRpb24gd2lsbCBiZSBpZ25vcmVkLlxyXG4gKiBAcHJvcGVydHkge251bWJlcn0gW3RocmVzaG9sZCA9IDBdIC0gVGhlIHBlcmNlbnRhZ2UgdmFsdWUgb2YgdGhlIGxpbWl0IGF0XHJcbiAqICB3aGljaCBwb2ludCB0aGUgY291bnQgbWVzc2FnZSBpcyBkaXNwbGF5ZWQuIElmIHRoaXMgYXR0cmlidXRlIGlzIHNldCwgdGhlXHJcbiAqICBjb3VudCBtZXNzYWdlIHdpbGwgYmUgaGlkZGVuIGJ5IGRlZmF1bHQuXHJcbiAqIEBwcm9wZXJ0eSB7Q2hhcmFjdGVyQ291bnRUcmFuc2xhdGlvbnN9IFtpMThuID0gQ0hBUkFDVEVSX0NPVU5UX1RSQU5TTEFUSU9OU10gLSBTZWUgY29uc3RhbnQge0BsaW5rIENIQVJBQ1RFUl9DT1VOVF9UUkFOU0xBVElPTlN9XHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIENoYXJhY3RlciBjb3VudCBjb25maWcgKHdpdGggbWF4aW11bSBudW1iZXIgb2Ygd29yZHMpXHJcbiAqXHJcbiAqIEB0eXBlZGVmIHtvYmplY3R9IENoYXJhY3RlckNvdW50Q29uZmlnV2l0aE1heFdvcmRzXHJcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBbbWF4d29yZHNdIC0gVGhlIG1heGltdW0gbnVtYmVyIG9mIHdvcmRzLiBJZiBtYXh3b3JkcyBpc1xyXG4gKiAgcHJvdmlkZWQsIHRoZSBtYXhsZW5ndGggb3B0aW9uIHdpbGwgYmUgaWdub3JlZC5cclxuICogQHByb3BlcnR5IHtudW1iZXJ9IFt0aHJlc2hvbGQgPSAwXSAtIFRoZSBwZXJjZW50YWdlIHZhbHVlIG9mIHRoZSBsaW1pdCBhdFxyXG4gKiAgd2hpY2ggcG9pbnQgdGhlIGNvdW50IG1lc3NhZ2UgaXMgZGlzcGxheWVkLiBJZiB0aGlzIGF0dHJpYnV0ZSBpcyBzZXQsIHRoZVxyXG4gKiAgY291bnQgbWVzc2FnZSB3aWxsIGJlIGhpZGRlbiBieSBkZWZhdWx0LlxyXG4gKiBAcHJvcGVydHkge0NoYXJhY3RlckNvdW50VHJhbnNsYXRpb25zfSBbaTE4biA9IENIQVJBQ1RFUl9DT1VOVF9UUkFOU0xBVElPTlNdIC0gU2VlIGNvbnN0YW50IHtAbGluayBDSEFSQUNURVJfQ09VTlRfVFJBTlNMQVRJT05TfVxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBDaGFyYWN0ZXIgY291bnQgdHJhbnNsYXRpb25zXHJcbiAqXHJcbiAqIEB0eXBlZGVmIHtvYmplY3R9IENoYXJhY3RlckNvdW50VHJhbnNsYXRpb25zXHJcbiAqXHJcbiAqIE1lc3NhZ2VzIHNob3duIHRvIHVzZXJzIGFzIHRoZXkgdHlwZS4gSXQgcHJvdmlkZXMgZmVlZGJhY2sgb24gaG93IG1hbnkgd29yZHNcclxuICogb3IgY2hhcmFjdGVycyB0aGV5IGhhdmUgcmVtYWluaW5nIG9yIGlmIHRoZXkgYXJlIG92ZXIgdGhlIGxpbWl0LiBUaGlzIGFsc29cclxuICogaW5jbHVkZXMgYSBtZXNzYWdlIHVzZWQgYXMgYW4gYWNjZXNzaWJsZSBkZXNjcmlwdGlvbiBmb3IgdGhlIHRleHRhcmVhLlxyXG4gKiBAcHJvcGVydHkge1RyYW5zbGF0aW9uUGx1cmFsRm9ybXN9IFtjaGFyYWN0ZXJzVW5kZXJMaW1pdF0gLSBNZXNzYWdlIGRpc3BsYXllZFxyXG4gKiAgIHdoZW4gdGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIGlzIHVuZGVyIHRoZSBjb25maWd1cmVkIG1heGltdW0sIGBtYXhsZW5ndGhgLlxyXG4gKiAgIFRoaXMgbWVzc2FnZSBpcyBkaXNwbGF5ZWQgdmlzdWFsbHkgYW5kIHRocm91Z2ggYXNzaXN0aXZlIHRlY2hub2xvZ2llcy4gVGhlXHJcbiAqICAgY29tcG9uZW50IHdpbGwgcmVwbGFjZSB0aGUgYCV7Y291bnR9YCBwbGFjZWhvbGRlciB3aXRoIHRoZSBudW1iZXIgb2ZcclxuICogICByZW1haW5pbmcgY2hhcmFjdGVycy4gVGhpcyBpcyBhIFtwbHVyYWxpc2VkIGxpc3Qgb2ZcclxuICogICBtZXNzYWdlc10oaHR0cHM6Ly9mcm9udGVuZC5kZXNpZ24tc3lzdGVtLnNlcnZpY2UuZ292LnVrL2xvY2FsaXNlLWdvdnVrLWZyb250ZW5kKS5cclxuICogQHByb3BlcnR5IHtzdHJpbmd9IFtjaGFyYWN0ZXJzQXRMaW1pdF0gLSBNZXNzYWdlIGRpc3BsYXllZCB3aGVuIHRoZSBudW1iZXIgb2ZcclxuICogICBjaGFyYWN0ZXJzIHJlYWNoZXMgdGhlIGNvbmZpZ3VyZWQgbWF4aW11bSwgYG1heGxlbmd0aGAuIFRoaXMgbWVzc2FnZSBpc1xyXG4gKiAgIGRpc3BsYXllZCB2aXN1YWxseSBhbmQgdGhyb3VnaCBhc3Npc3RpdmUgdGVjaG5vbG9naWVzLlxyXG4gKiBAcHJvcGVydHkge1RyYW5zbGF0aW9uUGx1cmFsRm9ybXN9IFtjaGFyYWN0ZXJzT3ZlckxpbWl0XSAtIE1lc3NhZ2UgZGlzcGxheWVkXHJcbiAqICAgd2hlbiB0aGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMgaXMgb3ZlciB0aGUgY29uZmlndXJlZCBtYXhpbXVtLCBgbWF4bGVuZ3RoYC5cclxuICogICBUaGlzIG1lc3NhZ2UgaXMgZGlzcGxheWVkIHZpc3VhbGx5IGFuZCB0aHJvdWdoIGFzc2lzdGl2ZSB0ZWNobm9sb2dpZXMuIFRoZVxyXG4gKiAgIGNvbXBvbmVudCB3aWxsIHJlcGxhY2UgdGhlIGAle2NvdW50fWAgcGxhY2Vob2xkZXIgd2l0aCB0aGUgbnVtYmVyIG9mXHJcbiAqICAgcmVtYWluaW5nIGNoYXJhY3RlcnMuIFRoaXMgaXMgYSBbcGx1cmFsaXNlZCBsaXN0IG9mXHJcbiAqICAgbWVzc2FnZXNdKGh0dHBzOi8vZnJvbnRlbmQuZGVzaWduLXN5c3RlbS5zZXJ2aWNlLmdvdi51ay9sb2NhbGlzZS1nb3Z1ay1mcm9udGVuZCkuXHJcbiAqIEBwcm9wZXJ0eSB7VHJhbnNsYXRpb25QbHVyYWxGb3Jtc30gW3dvcmRzVW5kZXJMaW1pdF0gLSBNZXNzYWdlIGRpc3BsYXllZCB3aGVuXHJcbiAqICAgdGhlIG51bWJlciBvZiB3b3JkcyBpcyB1bmRlciB0aGUgY29uZmlndXJlZCBtYXhpbXVtLCBgbWF4bGVuZ3RoYC4gVGhpc1xyXG4gKiAgIG1lc3NhZ2UgaXMgZGlzcGxheWVkIHZpc3VhbGx5IGFuZCB0aHJvdWdoIGFzc2lzdGl2ZSB0ZWNobm9sb2dpZXMuIFRoZVxyXG4gKiAgIGNvbXBvbmVudCB3aWxsIHJlcGxhY2UgdGhlIGAle2NvdW50fWAgcGxhY2Vob2xkZXIgd2l0aCB0aGUgbnVtYmVyIG9mXHJcbiAqICAgcmVtYWluaW5nIHdvcmRzLiBUaGlzIGlzIGEgW3BsdXJhbGlzZWQgbGlzdCBvZlxyXG4gKiAgIG1lc3NhZ2VzXShodHRwczovL2Zyb250ZW5kLmRlc2lnbi1zeXN0ZW0uc2VydmljZS5nb3YudWsvbG9jYWxpc2UtZ292dWstZnJvbnRlbmQpLlxyXG4gKiBAcHJvcGVydHkge3N0cmluZ30gW3dvcmRzQXRMaW1pdF0gLSBNZXNzYWdlIGRpc3BsYXllZCB3aGVuIHRoZSBudW1iZXIgb2ZcclxuICogICB3b3JkcyByZWFjaGVzIHRoZSBjb25maWd1cmVkIG1heGltdW0sIGBtYXhsZW5ndGhgLiBUaGlzIG1lc3NhZ2UgaXNcclxuICogICBkaXNwbGF5ZWQgdmlzdWFsbHkgYW5kIHRocm91Z2ggYXNzaXN0aXZlIHRlY2hub2xvZ2llcy5cclxuICogQHByb3BlcnR5IHtUcmFuc2xhdGlvblBsdXJhbEZvcm1zfSBbd29yZHNPdmVyTGltaXRdIC0gTWVzc2FnZSBkaXNwbGF5ZWQgd2hlblxyXG4gKiAgIHRoZSBudW1iZXIgb2Ygd29yZHMgaXMgb3ZlciB0aGUgY29uZmlndXJlZCBtYXhpbXVtLCBgbWF4bGVuZ3RoYC4gVGhpc1xyXG4gKiAgIG1lc3NhZ2UgaXMgZGlzcGxheWVkIHZpc3VhbGx5IGFuZCB0aHJvdWdoIGFzc2lzdGl2ZSB0ZWNobm9sb2dpZXMuIFRoZVxyXG4gKiAgIGNvbXBvbmVudCB3aWxsIHJlcGxhY2UgdGhlIGAle2NvdW50fWAgcGxhY2Vob2xkZXIgd2l0aCB0aGUgbnVtYmVyIG9mXHJcbiAqICAgcmVtYWluaW5nIHdvcmRzLiBUaGlzIGlzIGEgW3BsdXJhbGlzZWQgbGlzdCBvZlxyXG4gKiAgIG1lc3NhZ2VzXShodHRwczovL2Zyb250ZW5kLmRlc2lnbi1zeXN0ZW0uc2VydmljZS5nb3YudWsvbG9jYWxpc2UtZ292dWstZnJvbnRlbmQpLlxyXG4gKiBAcHJvcGVydHkge1RyYW5zbGF0aW9uUGx1cmFsRm9ybXN9IFt0ZXh0YXJlYURlc2NyaXB0aW9uXSAtIE1lc3NhZ2UgbWFkZVxyXG4gKiAgIGF2YWlsYWJsZSB0byBhc3Npc3RpdmUgdGVjaG5vbG9naWVzLCBpZiBub25lIGlzIGFscmVhZHkgcHJlc2VudCBpbiB0aGVcclxuICogICBIVE1MLCB0byBkZXNjcmliZSB0aGF0IHRoZSBjb21wb25lbnQgYWNjZXB0cyBvbmx5IGEgbGltaXRlZCBhbW91bnQgb2ZcclxuICogICBjb250ZW50LiBJdCBpcyB2aXNpYmxlIG9uIHRoZSBwYWdlIHdoZW4gSmF2YVNjcmlwdCBpcyB1bmF2YWlsYWJsZS4gVGhlXHJcbiAqICAgY29tcG9uZW50IHdpbGwgcmVwbGFjZSB0aGUgYCV7Y291bnR9YCBwbGFjZWhvbGRlciB3aXRoIHRoZSB2YWx1ZSBvZiB0aGVcclxuICogICBgbWF4bGVuZ3RoYCBvciBgbWF4d29yZHNgIHBhcmFtZXRlci5cclxuICovXHJcblxyXG4vKipcclxuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vaTE4bi5tanMnKS5UcmFuc2xhdGlvblBsdXJhbEZvcm1zfSBUcmFuc2xhdGlvblBsdXJhbEZvcm1zXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIENoZWNrYm94ZXMgY29tcG9uZW50XHJcbiAqXHJcbiAqIEBjbGFzc1xyXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAkbW9kdWxlIC0gSFRNTCBlbGVtZW50IHRvIHVzZSBmb3IgY2hlY2tib3hlc1xyXG4gKi9cclxuZnVuY3Rpb24gQ2hlY2tib3hlcyAoJG1vZHVsZSkge1xyXG4gIHRoaXMuJG1vZHVsZSA9ICRtb2R1bGU7XHJcbiAgdGhpcy4kaW5wdXRzID0gJG1vZHVsZS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpc2UgQ2hlY2tib3hlc1xyXG4gKlxyXG4gKiBDaGVja2JveGVzIGNhbiBiZSBhc3NvY2lhdGVkIHdpdGggYSAnY29uZGl0aW9uYWxseSByZXZlYWxlZCcgY29udGVudCBibG9jayDigJNcclxuICogZm9yIGV4YW1wbGUsIGEgY2hlY2tib3ggZm9yICdQaG9uZScgY291bGQgcmV2ZWFsIGFuIGFkZGl0aW9uYWwgZm9ybSBmaWVsZCBmb3JcclxuICogdGhlIHVzZXIgdG8gZW50ZXIgdGhlaXIgcGhvbmUgbnVtYmVyLlxyXG4gKlxyXG4gKiBUaGVzZSBhc3NvY2lhdGlvbnMgYXJlIG1hZGUgdXNpbmcgYSBgZGF0YS1hcmlhLWNvbnRyb2xzYCBhdHRyaWJ1dGUsIHdoaWNoIGlzXHJcbiAqIHByb21vdGVkIHRvIGFuIGFyaWEtY29udHJvbHMgYXR0cmlidXRlIGR1cmluZyBpbml0aWFsaXNhdGlvbi5cclxuICpcclxuICogV2UgYWxzbyBuZWVkIHRvIHJlc3RvcmUgdGhlIHN0YXRlIG9mIGFueSBjb25kaXRpb25hbCByZXZlYWxzIG9uIHRoZSBwYWdlIChmb3JcclxuICogZXhhbXBsZSBpZiB0aGUgdXNlciBoYXMgbmF2aWdhdGVkIGJhY2spLCBhbmQgc2V0IHVwIGV2ZW50IGhhbmRsZXJzIHRvIGtlZXBcclxuICogdGhlIHJldmVhbCBpbiBzeW5jIHdpdGggdGhlIGNoZWNrYm94IHN0YXRlLlxyXG4gKi9cclxuQ2hlY2tib3hlcy5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJG1vZHVsZSA9IHRoaXMuJG1vZHVsZTtcclxuICB2YXIgJGlucHV0cyA9IHRoaXMuJGlucHV0cztcclxuXHJcbiAgbm9kZUxpc3RGb3JFYWNoKCRpbnB1dHMsIGZ1bmN0aW9uICgkaW5wdXQpIHtcclxuICAgIHZhciB0YXJnZXQgPSAkaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLWFyaWEtY29udHJvbHMnKTtcclxuXHJcbiAgICAvLyBTa2lwIGNoZWNrYm94ZXMgd2l0aG91dCBkYXRhLWFyaWEtY29udHJvbHMgYXR0cmlidXRlcywgb3Igd2hlcmUgdGhlXHJcbiAgICAvLyB0YXJnZXQgZWxlbWVudCBkb2VzIG5vdCBleGlzdC5cclxuICAgIGlmICghdGFyZ2V0IHx8ICFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXQpKSB7XHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIC8vIFByb21vdGUgdGhlIGRhdGEtYXJpYS1jb250cm9scyBhdHRyaWJ1dGUgdG8gYSBhcmlhLWNvbnRyb2xzIGF0dHJpYnV0ZVxyXG4gICAgLy8gc28gdGhhdCB0aGUgcmVsYXRpb25zaGlwIGlzIGV4cG9zZWQgaW4gdGhlIEFPTVxyXG4gICAgJGlucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsIHRhcmdldCk7XHJcbiAgICAkaW5wdXQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWFyaWEtY29udHJvbHMnKTtcclxuICB9KTtcclxuXHJcbiAgLy8gV2hlbiB0aGUgcGFnZSBpcyByZXN0b3JlZCBhZnRlciBuYXZpZ2F0aW5nICdiYWNrJyBpbiBzb21lIGJyb3dzZXJzIHRoZVxyXG4gIC8vIHN0YXRlIG9mIGZvcm0gY29udHJvbHMgaXMgbm90IHJlc3RvcmVkIHVudGlsICphZnRlciogdGhlIERPTUNvbnRlbnRMb2FkZWRcclxuICAvLyBldmVudCBpcyBmaXJlZCwgc28gd2UgbmVlZCB0byBzeW5jIGFmdGVyIHRoZSBwYWdlc2hvdyBldmVudCBpbiBicm93c2Vyc1xyXG4gIC8vIHRoYXQgc3VwcG9ydCBpdC5cclxuICBpZiAoJ29ucGFnZXNob3cnIGluIHdpbmRvdykge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BhZ2VzaG93JywgdGhpcy5zeW5jQWxsQ29uZGl0aW9uYWxSZXZlYWxzLmJpbmQodGhpcykpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIHRoaXMuc3luY0FsbENvbmRpdGlvbmFsUmV2ZWFscy5iaW5kKHRoaXMpKTtcclxuICB9XHJcblxyXG4gIC8vIEFsdGhvdWdoIHdlJ3ZlIHNldCB1cCBoYW5kbGVycyB0byBzeW5jIHN0YXRlIG9uIHRoZSBwYWdlc2hvdyBvclxyXG4gIC8vIERPTUNvbnRlbnRMb2FkZWQgZXZlbnQsIGluaXQgY291bGQgYmUgY2FsbGVkIGFmdGVyIHRob3NlIGV2ZW50cyBoYXZlIGZpcmVkLFxyXG4gIC8vIGZvciBleGFtcGxlIGlmIHRoZXkgYXJlIGFkZGVkIHRvIHRoZSBwYWdlIGR5bmFtaWNhbGx5LCBzbyBzeW5jIG5vdyB0b28uXHJcbiAgdGhpcy5zeW5jQWxsQ29uZGl0aW9uYWxSZXZlYWxzKCk7XHJcblxyXG4gICRtb2R1bGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZUNsaWNrLmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFN5bmMgdGhlIGNvbmRpdGlvbmFsIHJldmVhbCBzdGF0ZXMgZm9yIGFsbCBpbnB1dHMgaW4gdGhpcyAkbW9kdWxlLlxyXG4gKi9cclxuQ2hlY2tib3hlcy5wcm90b3R5cGUuc3luY0FsbENvbmRpdGlvbmFsUmV2ZWFscyA9IGZ1bmN0aW9uICgpIHtcclxuICBub2RlTGlzdEZvckVhY2godGhpcy4kaW5wdXRzLCB0aGlzLnN5bmNDb25kaXRpb25hbFJldmVhbFdpdGhJbnB1dFN0YXRlLmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFN5bmMgY29uZGl0aW9uYWwgcmV2ZWFsIHdpdGggdGhlIGlucHV0IHN0YXRlXHJcbiAqXHJcbiAqIFN5bmNocm9uaXNlIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBjb25kaXRpb25hbCByZXZlYWwsIGFuZCBpdHMgYWNjZXNzaWJsZVxyXG4gKiBzdGF0ZSwgd2l0aCB0aGUgaW5wdXQncyBjaGVja2VkIHN0YXRlLlxyXG4gKlxyXG4gKiBAcGFyYW0ge0hUTUxJbnB1dEVsZW1lbnR9ICRpbnB1dCAtIENoZWNrYm94IGlucHV0XHJcbiAqL1xyXG5DaGVja2JveGVzLnByb3RvdHlwZS5zeW5jQ29uZGl0aW9uYWxSZXZlYWxXaXRoSW5wdXRTdGF0ZSA9IGZ1bmN0aW9uICgkaW5wdXQpIHtcclxuICB2YXIgJHRhcmdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCRpbnB1dC5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnKSk7XHJcblxyXG4gIGlmICgkdGFyZ2V0ICYmICR0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdnb3Z1ay1jaGVja2JveGVzX19jb25kaXRpb25hbCcpKSB7XHJcbiAgICB2YXIgaW5wdXRJc0NoZWNrZWQgPSAkaW5wdXQuY2hlY2tlZDtcclxuXHJcbiAgICAkaW5wdXQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgaW5wdXRJc0NoZWNrZWQpO1xyXG4gICAgJHRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdnb3Z1ay1jaGVja2JveGVzX19jb25kaXRpb25hbC0taGlkZGVuJywgIWlucHV0SXNDaGVja2VkKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogVW5jaGVjayBvdGhlciBjaGVja2JveGVzXHJcbiAqXHJcbiAqIEZpbmQgYW55IG90aGVyIGNoZWNrYm94IGlucHV0cyB3aXRoIHRoZSBzYW1lIG5hbWUgdmFsdWUsIGFuZCB1bmNoZWNrIHRoZW0uXHJcbiAqIFRoaXMgaXMgdXNlZnVsIGZvciB3aGVuIGEg4oCcTm9uZSBvZiB0aGVzZVwiIGNoZWNrYm94IGlzIGNoZWNrZWQuXHJcbiAqL1xyXG5DaGVja2JveGVzLnByb3RvdHlwZS51bkNoZWNrQWxsSW5wdXRzRXhjZXB0ID0gZnVuY3Rpb24gKCRpbnB1dCkge1xyXG4gIHZhciBhbGxJbnB1dHNXaXRoU2FtZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl1bbmFtZT1cIicgKyAkaW5wdXQubmFtZSArICdcIl0nKTtcclxuXHJcbiAgbm9kZUxpc3RGb3JFYWNoKGFsbElucHV0c1dpdGhTYW1lTmFtZSwgZnVuY3Rpb24gKCRpbnB1dFdpdGhTYW1lTmFtZSkge1xyXG4gICAgdmFyIGhhc1NhbWVGb3JtT3duZXIgPSAoJGlucHV0LmZvcm0gPT09ICRpbnB1dFdpdGhTYW1lTmFtZS5mb3JtKTtcclxuICAgIGlmIChoYXNTYW1lRm9ybU93bmVyICYmICRpbnB1dFdpdGhTYW1lTmFtZSAhPT0gJGlucHV0KSB7XHJcbiAgICAgICRpbnB1dFdpdGhTYW1lTmFtZS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuc3luY0NvbmRpdGlvbmFsUmV2ZWFsV2l0aElucHV0U3RhdGUoJGlucHV0V2l0aFNhbWVOYW1lKTtcclxuICAgIH1cclxuICB9LmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFVuY2hlY2sgZXhjbHVzaXZlIGlucHV0c1xyXG4gKlxyXG4gKiBGaW5kIGFueSBjaGVja2JveCBpbnB1dHMgd2l0aCB0aGUgc2FtZSBuYW1lIHZhbHVlIGFuZCB0aGUgJ2V4Y2x1c2l2ZScgYmVoYXZpb3VyLFxyXG4gKiBhbmQgdW5jaGVjayB0aGVtLiBUaGlzIGhlbHBzIHByZXZlbnQgc29tZW9uZSBjaGVja2luZyBib3RoIGEgcmVndWxhciBjaGVja2JveCBhbmQgYVxyXG4gKiBcIk5vbmUgb2YgdGhlc2VcIiBjaGVja2JveCBpbiB0aGUgc2FtZSBmaWVsZHNldC5cclxuICovXHJcbkNoZWNrYm94ZXMucHJvdG90eXBlLnVuQ2hlY2tFeGNsdXNpdmVJbnB1dHMgPSBmdW5jdGlvbiAoJGlucHV0KSB7XHJcbiAgdmFyIGFsbElucHV0c1dpdGhTYW1lTmFtZUFuZEV4Y2x1c2l2ZUJlaGF2aW91ciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXHJcbiAgICAnaW5wdXRbZGF0YS1iZWhhdmlvdXI9XCJleGNsdXNpdmVcIl1bdHlwZT1cImNoZWNrYm94XCJdW25hbWU9XCInICsgJGlucHV0Lm5hbWUgKyAnXCJdJ1xyXG4gICk7XHJcblxyXG4gIG5vZGVMaXN0Rm9yRWFjaChhbGxJbnB1dHNXaXRoU2FtZU5hbWVBbmRFeGNsdXNpdmVCZWhhdmlvdXIsIGZ1bmN0aW9uICgkZXhjbHVzaXZlSW5wdXQpIHtcclxuICAgIHZhciBoYXNTYW1lRm9ybU93bmVyID0gKCRpbnB1dC5mb3JtID09PSAkZXhjbHVzaXZlSW5wdXQuZm9ybSk7XHJcbiAgICBpZiAoaGFzU2FtZUZvcm1Pd25lcikge1xyXG4gICAgICAkZXhjbHVzaXZlSW5wdXQuY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnN5bmNDb25kaXRpb25hbFJldmVhbFdpdGhJbnB1dFN0YXRlKCRleGNsdXNpdmVJbnB1dCk7XHJcbiAgICB9XHJcbiAgfS5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDbGljayBldmVudCBoYW5kbGVyXHJcbiAqXHJcbiAqIEhhbmRsZSBhIGNsaWNrIHdpdGhpbiB0aGUgJG1vZHVsZSDigJMgaWYgdGhlIGNsaWNrIG9jY3VycmVkIG9uIGEgY2hlY2tib3gsIHN5bmNcclxuICogdGhlIHN0YXRlIG9mIGFueSBhc3NvY2lhdGVkIGNvbmRpdGlvbmFsIHJldmVhbCB3aXRoIHRoZSBjaGVja2JveCBzdGF0ZS5cclxuICpcclxuICogQHBhcmFtIHtNb3VzZUV2ZW50fSBldmVudCAtIENsaWNrIGV2ZW50XHJcbiAqL1xyXG5DaGVja2JveGVzLnByb3RvdHlwZS5oYW5kbGVDbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gIHZhciAkdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xyXG5cclxuICAvLyBJZ25vcmUgY2xpY2tzIG9uIHRoaW5ncyB0aGF0IGFyZW4ndCBjaGVja2JveCBpbnB1dHNcclxuICBpZiAoJHRhcmdldC50eXBlICE9PSAnY2hlY2tib3gnKSB7XHJcbiAgICByZXR1cm5cclxuICB9XHJcblxyXG4gIC8vIElmIHRoZSBjaGVja2JveCBjb25kaXRpb25hbGx5LXJldmVhbHMgc29tZSBjb250ZW50LCBzeW5jIHRoZSBzdGF0ZVxyXG4gIHZhciBoYXNBcmlhQ29udHJvbHMgPSAkdGFyZ2V0LmdldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycpO1xyXG4gIGlmIChoYXNBcmlhQ29udHJvbHMpIHtcclxuICAgIHRoaXMuc3luY0NvbmRpdGlvbmFsUmV2ZWFsV2l0aElucHV0U3RhdGUoJHRhcmdldCk7XHJcbiAgfVxyXG5cclxuICAvLyBObyBmdXJ0aGVyIGJlaGF2aW91ciBuZWVkZWQgZm9yIHVuY2hlY2tpbmdcclxuICBpZiAoISR0YXJnZXQuY2hlY2tlZCkge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICAvLyBIYW5kbGUgJ2V4Y2x1c2l2ZScgY2hlY2tib3ggYmVoYXZpb3VyIChpZSBcIk5vbmUgb2YgdGhlc2VcIilcclxuICB2YXIgaGFzQmVoYXZpb3VyRXhjbHVzaXZlID0gKCR0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWJlaGF2aW91cicpID09PSAnZXhjbHVzaXZlJyk7XHJcbiAgaWYgKGhhc0JlaGF2aW91ckV4Y2x1c2l2ZSkge1xyXG4gICAgdGhpcy51bkNoZWNrQWxsSW5wdXRzRXhjZXB0KCR0YXJnZXQpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0aGlzLnVuQ2hlY2tFeGNsdXNpdmVJbnB1dHMoJHRhcmdldCk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEphdmFTY3JpcHQgZW5oYW5jZW1lbnRzIGZvciB0aGUgRXJyb3JTdW1tYXJ5XHJcbiAqXHJcbiAqIFRha2VzIGZvY3VzIG9uIGluaXRpYWxpc2F0aW9uIGZvciBhY2Nlc3NpYmxlIGFubm91bmNlbWVudCwgdW5sZXNzIGRpc2FibGVkIGluIGNvbmZpZ3VyYXRpb24uXHJcbiAqXHJcbiAqIEBjbGFzc1xyXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAkbW9kdWxlIC0gVGhlIGVsZW1lbnQgdGhpcyBjb21wb25lbnQgY29udHJvbHNcclxuICogQHBhcmFtIHtFcnJvclN1bW1hcnlDb25maWd9IGNvbmZpZyAtIEVycm9yIHN1bW1hcnkgY29uZmlnXHJcbiAqL1xyXG5mdW5jdGlvbiBFcnJvclN1bW1hcnkgKCRtb2R1bGUsIGNvbmZpZykge1xyXG4gIC8vIFNvbWUgY29uc3VtaW5nIGNvZGUgbWF5IG5vdCBiZSBwYXNzaW5nIGEgbW9kdWxlLFxyXG4gIC8vIGZvciBleGFtcGxlIGlmIHRoZXkgaW5pdGlhbGlzZSB0aGUgY29tcG9uZW50XHJcbiAgLy8gb24gdGhlaXIgb3duIGJ5IGRpcmVjdGx5IHBhc3NpbmcgdGhlIHJlc3VsdFxyXG4gIC8vIG9mIGBkb2N1bWVudC5xdWVyeVNlbGVjdG9yYC5cclxuICAvLyBUbyBhdm9pZCBicmVha2luZyBmdXJ0aGVyIEphdmFTY3JpcHQgaW5pdGlhbGlzYXRpb25cclxuICAvLyB3ZSBuZWVkIHRvIHNhZmVndWFyZCBhZ2FpbnN0IHRoaXMgc28gdGhpbmdzIGtlZXBcclxuICAvLyB3b3JraW5nIHRoZSBzYW1lIG5vdyB3ZSByZWFkIHRoZSBlbGVtZW50cyBkYXRhIGF0dHJpYnV0ZXNcclxuICBpZiAoISRtb2R1bGUpIHtcclxuICAgIC8vIExpdHRsZSBzYWZldHkgaW4gY2FzZSBjb2RlIGdldHMgcG9ydGVkIGFzLWlzXHJcbiAgICAvLyBpbnRvIGFuZCBFUzYgY2xhc3MgY29uc3RydWN0b3IsIHdoZXJlIHRoZSByZXR1cm4gdmFsdWUgbWF0dGVyc1xyXG4gICAgcmV0dXJuIHRoaXNcclxuICB9XHJcblxyXG4gIHRoaXMuJG1vZHVsZSA9ICRtb2R1bGU7XHJcblxyXG4gIHZhciBkZWZhdWx0Q29uZmlnID0ge1xyXG4gICAgZGlzYWJsZUF1dG9Gb2N1czogZmFsc2VcclxuICB9O1xyXG4gIHRoaXMuY29uZmlnID0gbWVyZ2VDb25maWdzKFxyXG4gICAgZGVmYXVsdENvbmZpZyxcclxuICAgIGNvbmZpZyB8fCB7fSxcclxuICAgIG5vcm1hbGlzZURhdGFzZXQoJG1vZHVsZS5kYXRhc2V0KVxyXG4gICk7XHJcbn1cclxuXHJcbkVycm9yU3VtbWFyeS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJG1vZHVsZSA9IHRoaXMuJG1vZHVsZTtcclxuICBpZiAoISRtb2R1bGUpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgdGhpcy5zZXRGb2N1cygpO1xyXG4gICRtb2R1bGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZUNsaWNrLmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEZvY3VzIHRoZSBlcnJvciBzdW1tYXJ5XHJcbiAqL1xyXG5FcnJvclN1bW1hcnkucHJvdG90eXBlLnNldEZvY3VzID0gZnVuY3Rpb24gKCkge1xyXG4gIHZhciAkbW9kdWxlID0gdGhpcy4kbW9kdWxlO1xyXG5cclxuICBpZiAodGhpcy5jb25maWcuZGlzYWJsZUF1dG9Gb2N1cykge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICAvLyBTZXQgdGFiaW5kZXggdG8gLTEgdG8gbWFrZSB0aGUgZWxlbWVudCBwcm9ncmFtbWF0aWNhbGx5IGZvY3VzYWJsZSwgYnV0XHJcbiAgLy8gcmVtb3ZlIGl0IG9uIGJsdXIgYXMgdGhlIGVycm9yIHN1bW1hcnkgZG9lc24ndCBuZWVkIHRvIGJlIGZvY3VzZWQgYWdhaW4uXHJcbiAgJG1vZHVsZS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XHJcblxyXG4gICRtb2R1bGUuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGZ1bmN0aW9uICgpIHtcclxuICAgICRtb2R1bGUucmVtb3ZlQXR0cmlidXRlKCd0YWJpbmRleCcpO1xyXG4gIH0pO1xyXG5cclxuICAkbW9kdWxlLmZvY3VzKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogQ2xpY2sgZXZlbnQgaGFuZGxlclxyXG4gKlxyXG4gKiBAcGFyYW0ge01vdXNlRXZlbnR9IGV2ZW50IC0gQ2xpY2sgZXZlbnRcclxuICovXHJcbkVycm9yU3VtbWFyeS5wcm90b3R5cGUuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xyXG4gIGlmICh0aGlzLmZvY3VzVGFyZ2V0KHRhcmdldCkpIHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEZvY3VzIHRoZSB0YXJnZXQgZWxlbWVudFxyXG4gKlxyXG4gKiBCeSBkZWZhdWx0LCB0aGUgYnJvd3NlciB3aWxsIHNjcm9sbCB0aGUgdGFyZ2V0IGludG8gdmlldy4gQmVjYXVzZSBvdXIgbGFiZWxzXHJcbiAqIG9yIGxlZ2VuZHMgYXBwZWFyIGFib3ZlIHRoZSBpbnB1dCwgdGhpcyBtZWFucyB0aGUgdXNlciB3aWxsIGJlIHByZXNlbnRlZCB3aXRoXHJcbiAqIGFuIGlucHV0IHdpdGhvdXQgYW55IGNvbnRleHQsIGFzIHRoZSBsYWJlbCBvciBsZWdlbmQgd2lsbCBiZSBvZmYgdGhlIHRvcCBvZlxyXG4gKiB0aGUgc2NyZWVuLlxyXG4gKlxyXG4gKiBNYW51YWxseSBoYW5kbGluZyB0aGUgY2xpY2sgZXZlbnQsIHNjcm9sbGluZyB0aGUgcXVlc3Rpb24gaW50byB2aWV3IGFuZCB0aGVuXHJcbiAqIGZvY3Vzc2luZyB0aGUgZWxlbWVudCBzb2x2ZXMgdGhpcy5cclxuICpcclxuICogVGhpcyBhbHNvIHJlc3VsdHMgaW4gdGhlIGxhYmVsIGFuZC9vciBsZWdlbmQgYmVpbmcgYW5ub3VuY2VkIGNvcnJlY3RseSBpblxyXG4gKiBOVkRBIChhcyB0ZXN0ZWQgaW4gMjAxOC4zLjIpIC0gd2l0aG91dCB0aGlzIG9ubHkgdGhlIGZpZWxkIHR5cGUgaXMgYW5ub3VuY2VkXHJcbiAqIChlLmcuIFwiRWRpdCwgaGFzIGF1dG9jb21wbGV0ZVwiKS5cclxuICpcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gJHRhcmdldCAtIEV2ZW50IHRhcmdldFxyXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgdGFyZ2V0IHdhcyBhYmxlIHRvIGJlIGZvY3Vzc2VkXHJcbiAqL1xyXG5FcnJvclN1bW1hcnkucHJvdG90eXBlLmZvY3VzVGFyZ2V0ID0gZnVuY3Rpb24gKCR0YXJnZXQpIHtcclxuICAvLyBJZiB0aGUgZWxlbWVudCB0aGF0IHdhcyBjbGlja2VkIHdhcyBub3QgYSBsaW5rLCByZXR1cm4gZWFybHlcclxuICBpZiAoJHRhcmdldC50YWdOYW1lICE9PSAnQScgfHwgJHRhcmdldC5ocmVmID09PSBmYWxzZSkge1xyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG5cclxuICB2YXIgaW5wdXRJZCA9IHRoaXMuZ2V0RnJhZ21lbnRGcm9tVXJsKCR0YXJnZXQuaHJlZik7XHJcbiAgdmFyICRpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlucHV0SWQpO1xyXG4gIGlmICghJGlucHV0KSB7XHJcbiAgICByZXR1cm4gZmFsc2VcclxuICB9XHJcblxyXG4gIHZhciAkbGVnZW5kT3JMYWJlbCA9IHRoaXMuZ2V0QXNzb2NpYXRlZExlZ2VuZE9yTGFiZWwoJGlucHV0KTtcclxuICBpZiAoISRsZWdlbmRPckxhYmVsKSB7XHJcbiAgICByZXR1cm4gZmFsc2VcclxuICB9XHJcblxyXG4gIC8vIFNjcm9sbCB0aGUgbGVnZW5kIG9yIGxhYmVsIGludG8gdmlldyAqYmVmb3JlKiBjYWxsaW5nIGZvY3VzIG9uIHRoZSBpbnB1dCB0b1xyXG4gIC8vIGF2b2lkIGV4dHJhIHNjcm9sbGluZyBpbiBicm93c2VycyB0aGF0IGRvbid0IHN1cHBvcnQgYHByZXZlbnRTY3JvbGxgICh3aGljaFxyXG4gIC8vIGF0IHRpbWUgb2Ygd3JpdGluZyBpcyBtb3N0IG9mIHRoZW0uLi4pXHJcbiAgJGxlZ2VuZE9yTGFiZWwuc2Nyb2xsSW50b1ZpZXcoKTtcclxuICAkaW5wdXQuZm9jdXMoeyBwcmV2ZW50U2Nyb2xsOiB0cnVlIH0pO1xyXG5cclxuICByZXR1cm4gdHJ1ZVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldCBmcmFnbWVudCBmcm9tIFVSTFxyXG4gKlxyXG4gKiBFeHRyYWN0IHRoZSBmcmFnbWVudCAoZXZlcnl0aGluZyBhZnRlciB0aGUgaGFzaCkgZnJvbSBhIFVSTCwgYnV0IG5vdCBpbmNsdWRpbmdcclxuICogdGhlIGhhc2guXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgLSBVUkxcclxuICogQHJldHVybnMge3N0cmluZ30gRnJhZ21lbnQgZnJvbSBVUkwsIHdpdGhvdXQgdGhlIGhhc2hcclxuICovXHJcbkVycm9yU3VtbWFyeS5wcm90b3R5cGUuZ2V0RnJhZ21lbnRGcm9tVXJsID0gZnVuY3Rpb24gKHVybCkge1xyXG4gIGlmICh1cmwuaW5kZXhPZignIycpID09PSAtMSkge1xyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG5cclxuICByZXR1cm4gdXJsLnNwbGl0KCcjJykucG9wKClcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgYXNzb2NpYXRlZCBsZWdlbmQgb3IgbGFiZWxcclxuICpcclxuICogUmV0dXJucyB0aGUgZmlyc3QgZWxlbWVudCB0aGF0IGV4aXN0cyBmcm9tIHRoaXMgbGlzdDpcclxuICpcclxuICogLSBUaGUgYDxsZWdlbmQ+YCBhc3NvY2lhdGVkIHdpdGggdGhlIGNsb3Nlc3QgYDxmaWVsZHNldD5gIGFuY2VzdG9yLCBhcyBsb25nXHJcbiAqICAgYXMgdGhlIHRvcCBvZiBpdCBpcyBubyBtb3JlIHRoYW4gaGFsZiBhIHZpZXdwb3J0IGhlaWdodCBhd2F5IGZyb20gdGhlXHJcbiAqICAgYm90dG9tIG9mIHRoZSBpbnB1dFxyXG4gKiAtIFRoZSBmaXJzdCBgPGxhYmVsPmAgdGhhdCBpcyBhc3NvY2lhdGVkIHdpdGggdGhlIGlucHV0IHVzaW5nIGZvcj1cImlucHV0SWRcIlxyXG4gKiAtIFRoZSBjbG9zZXN0IHBhcmVudCBgPGxhYmVsPmBcclxuICpcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gJGlucHV0IC0gVGhlIGlucHV0XHJcbiAqIEByZXR1cm5zIHtIVE1MRWxlbWVudH0gQXNzb2NpYXRlZCBsZWdlbmQgb3IgbGFiZWwsIG9yIG51bGwgaWYgbm8gYXNzb2NpYXRlZFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIGxlZ2VuZCBvciBsYWJlbCBjYW4gYmUgZm91bmRcclxuICovXHJcbkVycm9yU3VtbWFyeS5wcm90b3R5cGUuZ2V0QXNzb2NpYXRlZExlZ2VuZE9yTGFiZWwgPSBmdW5jdGlvbiAoJGlucHV0KSB7XHJcbiAgdmFyICRmaWVsZHNldCA9ICRpbnB1dC5jbG9zZXN0KCdmaWVsZHNldCcpO1xyXG5cclxuICBpZiAoJGZpZWxkc2V0KSB7XHJcbiAgICB2YXIgbGVnZW5kcyA9ICRmaWVsZHNldC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbGVnZW5kJyk7XHJcblxyXG4gICAgaWYgKGxlZ2VuZHMubGVuZ3RoKSB7XHJcbiAgICAgIHZhciAkY2FuZGlkYXRlTGVnZW5kID0gbGVnZW5kc1swXTtcclxuXHJcbiAgICAgIC8vIElmIHRoZSBpbnB1dCB0eXBlIGlzIHJhZGlvIG9yIGNoZWNrYm94LCBhbHdheXMgdXNlIHRoZSBsZWdlbmQgaWYgdGhlcmVcclxuICAgICAgLy8gaXMgb25lLlxyXG4gICAgICBpZiAoJGlucHV0LnR5cGUgPT09ICdjaGVja2JveCcgfHwgJGlucHV0LnR5cGUgPT09ICdyYWRpbycpIHtcclxuICAgICAgICByZXR1cm4gJGNhbmRpZGF0ZUxlZ2VuZFxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBGb3Igb3RoZXIgaW5wdXQgdHlwZXMsIG9ubHkgc2Nyb2xsIHRvIHRoZSBmaWVsZHNldOKAmXMgbGVnZW5kIChpbnN0ZWFkIG9mXHJcbiAgICAgIC8vIHRoZSBsYWJlbCBhc3NvY2lhdGVkIHdpdGggdGhlIGlucHV0KSBpZiB0aGUgaW5wdXQgd291bGQgZW5kIHVwIGluIHRoZVxyXG4gICAgICAvLyB0b3AgaGFsZiBvZiB0aGUgc2NyZWVuLlxyXG4gICAgICAvL1xyXG4gICAgICAvLyBUaGlzIHNob3VsZCBhdm9pZCBzaXR1YXRpb25zIHdoZXJlIHRoZSBpbnB1dCBlaXRoZXIgZW5kcyB1cCBvZmYgdGhlXHJcbiAgICAgIC8vIHNjcmVlbiwgb3Igb2JzY3VyZWQgYnkgYSBzb2Z0d2FyZSBrZXlib2FyZC5cclxuICAgICAgdmFyIGxlZ2VuZFRvcCA9ICRjYW5kaWRhdGVMZWdlbmQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xyXG4gICAgICB2YXIgaW5wdXRSZWN0ID0gJGlucHV0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgLy8gSWYgdGhlIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0XHJcbiAgICAgIC8vIG9yIHdpbmRvdy5pbm5lckhlaWdodCAobGlrZSBJRTgpLCBiYWlsIGFuZCBqdXN0IGxpbmsgdG8gdGhlIGxhYmVsLlxyXG4gICAgICBpZiAoaW5wdXRSZWN0LmhlaWdodCAmJiB3aW5kb3cuaW5uZXJIZWlnaHQpIHtcclxuICAgICAgICB2YXIgaW5wdXRCb3R0b20gPSBpbnB1dFJlY3QudG9wICsgaW5wdXRSZWN0LmhlaWdodDtcclxuXHJcbiAgICAgICAgaWYgKGlucHV0Qm90dG9tIC0gbGVnZW5kVG9wIDwgd2luZG93LmlubmVySGVpZ2h0IC8gMikge1xyXG4gICAgICAgICAgcmV0dXJuICRjYW5kaWRhdGVMZWdlbmRcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibGFiZWxbZm9yPSdcIiArICRpbnB1dC5nZXRBdHRyaWJ1dGUoJ2lkJykgKyBcIiddXCIpIHx8XHJcbiAgICAkaW5wdXQuY2xvc2VzdCgnbGFiZWwnKVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEVycm9yIHN1bW1hcnkgY29uZmlnXHJcbiAqXHJcbiAqIEB0eXBlZGVmIHtvYmplY3R9IEVycm9yU3VtbWFyeUNvbmZpZ1xyXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IFtkaXNhYmxlQXV0b0ZvY3VzID0gZmFsc2VdIC1cclxuICogIElmIHNldCB0byBgdHJ1ZWAgdGhlIGVycm9yIHN1bW1hcnkgd2lsbCBub3QgYmUgZm9jdXNzZWQgd2hlbiB0aGUgcGFnZSBsb2Fkcy5cclxuICovXHJcblxyXG4vKipcclxuICogTm90aWZpY2F0aW9uIEJhbm5lciBjb21wb25lbnRcclxuICpcclxuICogQGNsYXNzXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICRtb2R1bGUgLSBIVE1MIGVsZW1lbnQgdG8gdXNlIGZvciBub3RpZmljYXRpb24gYmFubmVyXHJcbiAqIEBwYXJhbSB7Tm90aWZpY2F0aW9uQmFubmVyQ29uZmlnfSBjb25maWcgLSBOb3RpZmljYXRpb24gYmFubmVyIGNvbmZpZ1xyXG4gKi9cclxuZnVuY3Rpb24gTm90aWZpY2F0aW9uQmFubmVyICgkbW9kdWxlLCBjb25maWcpIHtcclxuICB0aGlzLiRtb2R1bGUgPSAkbW9kdWxlO1xyXG5cclxuICB2YXIgZGVmYXVsdENvbmZpZyA9IHtcclxuICAgIGRpc2FibGVBdXRvRm9jdXM6IGZhbHNlXHJcbiAgfTtcclxuICB0aGlzLmNvbmZpZyA9IG1lcmdlQ29uZmlncyhcclxuICAgIGRlZmF1bHRDb25maWcsXHJcbiAgICBjb25maWcgfHwge30sXHJcbiAgICBub3JtYWxpc2VEYXRhc2V0KCRtb2R1bGUuZGF0YXNldClcclxuICApO1xyXG59XHJcblxyXG4vKipcclxuICogSW5pdGlhbGlzZSB0aGUgY29tcG9uZW50XHJcbiAqL1xyXG5Ob3RpZmljYXRpb25CYW5uZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICRtb2R1bGUgPSB0aGlzLiRtb2R1bGU7XHJcbiAgLy8gQ2hlY2sgZm9yIG1vZHVsZVxyXG4gIGlmICghJG1vZHVsZSkge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICB0aGlzLnNldEZvY3VzKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogRm9jdXMgdGhlIGVsZW1lbnRcclxuICpcclxuICogSWYgYHJvbGU9XCJhbGVydFwiYCBpcyBzZXQsIGZvY3VzIHRoZSBlbGVtZW50IHRvIGhlbHAgc29tZSBhc3Npc3RpdmUgdGVjaG5vbG9naWVzXHJcbiAqIHByaW9yaXRpc2UgYW5ub3VuY2luZyBpdC5cclxuICpcclxuICogWW91IGNhbiB0dXJuIG9mZiB0aGUgYXV0by1mb2N1cyBmdW5jdGlvbmFsaXR5IGJ5IHNldHRpbmcgYGRhdGEtZGlzYWJsZS1hdXRvLWZvY3VzPVwidHJ1ZVwiYCBpbiB0aGVcclxuICogY29tcG9uZW50IEhUTUwuIFlvdSBtaWdodCB3aXNoIHRvIGRvIHRoaXMgYmFzZWQgb24gdXNlciByZXNlYXJjaCBmaW5kaW5ncywgb3IgdG8gYXZvaWQgYSBjbGFzaFxyXG4gKiB3aXRoIGFub3RoZXIgZWxlbWVudCB3aGljaCBzaG91bGQgYmUgZm9jdXNlZCB3aGVuIHRoZSBwYWdlIGxvYWRzLlxyXG4gKi9cclxuTm90aWZpY2F0aW9uQmFubmVyLnByb3RvdHlwZS5zZXRGb2N1cyA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJG1vZHVsZSA9IHRoaXMuJG1vZHVsZTtcclxuXHJcbiAgaWYgKHRoaXMuY29uZmlnLmRpc2FibGVBdXRvRm9jdXMpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgaWYgKCRtb2R1bGUuZ2V0QXR0cmlidXRlKCdyb2xlJykgIT09ICdhbGVydCcpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgLy8gU2V0IHRhYmluZGV4IHRvIC0xIHRvIG1ha2UgdGhlIGVsZW1lbnQgZm9jdXNhYmxlIHdpdGggSmF2YVNjcmlwdC5cclxuICAvLyBSZW1vdmUgdGhlIHRhYmluZGV4IG9uIGJsdXIgYXMgdGhlIGNvbXBvbmVudCBkb2Vzbid0IG5lZWQgdG8gYmUgZm9jdXNhYmxlIGFmdGVyIHRoZSBwYWdlIGhhc1xyXG4gIC8vIGxvYWRlZC5cclxuICBpZiAoISRtb2R1bGUuZ2V0QXR0cmlidXRlKCd0YWJpbmRleCcpKSB7XHJcbiAgICAkbW9kdWxlLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcclxuXHJcbiAgICAkbW9kdWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICRtb2R1bGUucmVtb3ZlQXR0cmlidXRlKCd0YWJpbmRleCcpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAkbW9kdWxlLmZvY3VzKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogTm90aWZpY2F0aW9uIGJhbm5lciBjb25maWdcclxuICpcclxuICogQHR5cGVkZWYge29iamVjdH0gTm90aWZpY2F0aW9uQmFubmVyQ29uZmlnXHJcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gW2Rpc2FibGVBdXRvRm9jdXMgPSBmYWxzZV0gLVxyXG4gKiAgIElmIHNldCB0byBgdHJ1ZWAgdGhlIG5vdGlmaWNhdGlvbiBiYW5uZXIgd2lsbCBub3QgYmUgZm9jdXNzZWQgd2hlbiB0aGUgcGFnZVxyXG4gKiAgIGxvYWRzLiBUaGlzIG9ubHkgYXBwbGllcyBpZiB0aGUgY29tcG9uZW50IGhhcyBhIGByb2xlYCBvZiBgYWxlcnRgIOKAkyBpblxyXG4gKiAgIG90aGVyIGNhc2VzIHRoZSBjb21wb25lbnQgd2lsbCBub3QgYmUgZm9jdXNlZCBvbiBwYWdlIGxvYWQsIHJlZ2FyZGxlc3Mgb2ZcclxuICogICB0aGlzIG9wdGlvbi5cclxuICovXHJcblxyXG4vKipcclxuICogSGVhZGVyIGNvbXBvbmVudFxyXG4gKlxyXG4gKiBAY2xhc3NcclxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gJG1vZHVsZSAtIEhUTUwgZWxlbWVudCB0byB1c2UgZm9yIGhlYWRlclxyXG4gKi9cclxuZnVuY3Rpb24gSGVhZGVyICgkbW9kdWxlKSB7XHJcbiAgdGhpcy4kbW9kdWxlID0gJG1vZHVsZTtcclxuICB0aGlzLiRtZW51QnV0dG9uID0gJG1vZHVsZSAmJiAkbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoJy5nb3Z1ay1qcy1oZWFkZXItdG9nZ2xlJyk7XHJcbiAgdGhpcy4kbWVudSA9IHRoaXMuJG1lbnVCdXR0b24gJiYgJG1vZHVsZS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgJyMnICsgdGhpcy4kbWVudUJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnKVxyXG4gICk7XHJcblxyXG4gIC8vIFNhdmUgdGhlIG9wZW5lZC9jbG9zZWQgc3RhdGUgZm9yIHRoZSBuYXYgaW4gbWVtb3J5IHNvIHRoYXQgd2UgY2FuXHJcbiAgLy8gYWNjdXJhdGVseSBtYWludGFpbiBzdGF0ZSB3aGVuIHRoZSBzY3JlZW4gaXMgY2hhbmdlZCBmcm9tIHNtYWxsIHRvXHJcbiAgLy8gYmlnIGFuZCBiYWNrIHRvIHNtYWxsXHJcbiAgdGhpcy5tZW51SXNPcGVuID0gZmFsc2U7XHJcblxyXG4gIC8vIEEgZ2xvYmFsIGNvbnN0IGZvciBzdG9yaW5nIGEgbWF0Y2hNZWRpYSBpbnN0YW5jZSB3aGljaCB3ZSdsbCB1c2UgdG9cclxuICAvLyBkZXRlY3Qgd2hlbiBhIHNjcmVlbiBzaXplIGNoYW5nZSBoYXBwZW5zLiBXZSBzZXQgdGhpcyBsYXRlciBkdXJpbmcgdGhlXHJcbiAgLy8gaW5pdCBmdW5jdGlvbiBhbmQgcmVseSBvbiBpdCBiZWluZyBudWxsIGlmIHRoZSBmZWF0dXJlIGlzbid0IGF2YWlsYWJsZVxyXG4gIC8vIHRvIGluaXRpYWxseSBhcHBseSBoaWRkZW4gYXR0cmlidXRlc1xyXG4gIHRoaXMubXFsID0gbnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpc2UgaGVhZGVyXHJcbiAqXHJcbiAqIENoZWNrIGZvciB0aGUgcHJlc2VuY2Ugb2YgdGhlIGhlYWRlciwgbWVudSBhbmQgbWVudSBidXR0b24g4oCTIGlmIGFueSBhcmVcclxuICogbWlzc2luZyB0aGVuIHRoZXJlJ3Mgbm90aGluZyB0byBkbyBzbyByZXR1cm4gZWFybHkuXHJcbiAqIEZlYXR1cmUgc25pZmYgZm9yIGFuZCBhcHBseSBhIG1hdGNoTWVkaWEgZm9yIGRlc2t0b3Agd2hpY2ggd2lsbFxyXG4gKiB0cmlnZ2VyIGEgc3RhdGUgc3luYyBpZiB0aGUgYnJvd3NlciB2aWV3cG9ydCBtb3ZlcyBiZXR3ZWVuIHN0YXRlcy4gSWZcclxuICogbWF0Y2hNZWRpYSBpc24ndCBhdmFpbGFibGUsIGhpZGUgdGhlIG1lbnUgYnV0dG9uIGFuZCBwcmVzZW50IHRoZSBcIm5vIGpzXCJcclxuICogdmVyc2lvbiBvZiB0aGUgbWVudSB0byB0aGUgdXNlci5cclxuICovXHJcbkhlYWRlci5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICBpZiAoIXRoaXMuJG1vZHVsZSB8fCAhdGhpcy4kbWVudUJ1dHRvbiB8fCAhdGhpcy4kbWVudSkge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICBpZiAoJ21hdGNoTWVkaWEnIGluIHdpbmRvdykge1xyXG4gICAgLy8gU2V0IHRoZSBtYXRjaE1lZGlhIHRvIHRoZSBnb3Z1ay1mcm9udGVuZCBkZXNrdG9wIGJyZWFrcG9pbnRcclxuICAgIHRoaXMubXFsID0gd2luZG93Lm1hdGNoTWVkaWEoJyhtaW4td2lkdGg6IDQ4LjA2MjVlbSknKTtcclxuXHJcbiAgICBpZiAoJ2FkZEV2ZW50TGlzdGVuZXInIGluIHRoaXMubXFsKSB7XHJcbiAgICAgIHRoaXMubXFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMuc3luY1N0YXRlLmJpbmQodGhpcykpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gYWRkTGlzdGVuZXIgaXMgYSBkZXByZWNhdGVkIGZ1bmN0aW9uLCBob3dldmVyIGFkZEV2ZW50TGlzdGVuZXJcclxuICAgICAgLy8gaXNuJ3Qgc3VwcG9ydGVkIGJ5IElFIG9yIFNhZmFyaS4gV2UgdGhlcmVmb3JlIGFkZCB0aGlzIGluIGFzXHJcbiAgICAgIC8vIGEgZmFsbGJhY2sgZm9yIHRob3NlIGJyb3dzZXJzXHJcbiAgICAgIHRoaXMubXFsLmFkZExpc3RlbmVyKHRoaXMuc3luY1N0YXRlLmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuc3luY1N0YXRlKCk7XHJcbiAgICB0aGlzLiRtZW51QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVNZW51QnV0dG9uQ2xpY2suYmluZCh0aGlzKSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHRoaXMuJG1lbnVCdXR0b24uc2V0QXR0cmlidXRlKCdoaWRkZW4nLCAnJyk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFN5bmMgbWVudSBzdGF0ZVxyXG4gKlxyXG4gKiBVc2VzIHRoZSBnbG9iYWwgdmFyaWFibGUgbWVudUlzT3BlbiB0byBjb3JyZWN0bHkgc2V0IHRoZSBhY2Nlc3NpYmxlIGFuZFxyXG4gKiB2aXN1YWwgc3RhdGVzIG9mIHRoZSBtZW51IGFuZCB0aGUgbWVudSBidXR0b24uXHJcbiAqIEFkZGl0aW9uYWxseSB3aWxsIGZvcmNlIHRoZSBtZW51IHRvIGJlIHZpc2libGUgYW5kIHRoZSBtZW51IGJ1dHRvbiB0byBiZVxyXG4gKiBoaWRkZW4gaWYgdGhlIG1hdGNoTWVkaWEgaXMgdHJpZ2dlcmVkIHRvIGRlc2t0b3AuXHJcbiAqL1xyXG5IZWFkZXIucHJvdG90eXBlLnN5bmNTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICBpZiAodGhpcy5tcWwubWF0Y2hlcykge1xyXG4gICAgdGhpcy4kbWVudS5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpO1xyXG4gICAgdGhpcy4kbWVudUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhpcy4kbWVudUJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpO1xyXG4gICAgdGhpcy4kbWVudUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCB0aGlzLm1lbnVJc09wZW4pO1xyXG5cclxuICAgIGlmICh0aGlzLm1lbnVJc09wZW4pIHtcclxuICAgICAgdGhpcy4kbWVudS5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy4kbWVudS5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogSGFuZGxlIG1lbnUgYnV0dG9uIGNsaWNrXHJcbiAqXHJcbiAqIFdoZW4gdGhlIG1lbnUgYnV0dG9uIGlzIGNsaWNrZWQsIGNoYW5nZSB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgbWVudSBhbmQgdGhlblxyXG4gKiBzeW5jIHRoZSBhY2Nlc3NpYmlsaXR5IHN0YXRlIGFuZCBtZW51IGJ1dHRvbiBzdGF0ZVxyXG4gKi9cclxuSGVhZGVyLnByb3RvdHlwZS5oYW5kbGVNZW51QnV0dG9uQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdGhpcy5tZW51SXNPcGVuID0gIXRoaXMubWVudUlzT3BlbjtcclxuICB0aGlzLnN5bmNTdGF0ZSgpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFJhZGlvcyBjb21wb25lbnRcclxuICpcclxuICogQGNsYXNzXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICRtb2R1bGUgLSBIVE1MIGVsZW1lbnQgdG8gdXNlIGZvciByYWRpb3NcclxuICovXHJcbmZ1bmN0aW9uIFJhZGlvcyAoJG1vZHVsZSkge1xyXG4gIHRoaXMuJG1vZHVsZSA9ICRtb2R1bGU7XHJcbiAgdGhpcy4kaW5wdXRzID0gJG1vZHVsZS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPVwicmFkaW9cIl0nKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpc2UgUmFkaW9zXHJcbiAqXHJcbiAqIFJhZGlvcyBjYW4gYmUgYXNzb2NpYXRlZCB3aXRoIGEgJ2NvbmRpdGlvbmFsbHkgcmV2ZWFsZWQnIGNvbnRlbnQgYmxvY2sg4oCTIGZvclxyXG4gKiBleGFtcGxlLCBhIHJhZGlvIGZvciAnUGhvbmUnIGNvdWxkIHJldmVhbCBhbiBhZGRpdGlvbmFsIGZvcm0gZmllbGQgZm9yIHRoZVxyXG4gKiB1c2VyIHRvIGVudGVyIHRoZWlyIHBob25lIG51bWJlci5cclxuICpcclxuICogVGhlc2UgYXNzb2NpYXRpb25zIGFyZSBtYWRlIHVzaW5nIGEgYGRhdGEtYXJpYS1jb250cm9sc2AgYXR0cmlidXRlLCB3aGljaCBpc1xyXG4gKiBwcm9tb3RlZCB0byBhbiBhcmlhLWNvbnRyb2xzIGF0dHJpYnV0ZSBkdXJpbmcgaW5pdGlhbGlzYXRpb24uXHJcbiAqXHJcbiAqIFdlIGFsc28gbmVlZCB0byByZXN0b3JlIHRoZSBzdGF0ZSBvZiBhbnkgY29uZGl0aW9uYWwgcmV2ZWFscyBvbiB0aGUgcGFnZSAoZm9yXHJcbiAqIGV4YW1wbGUgaWYgdGhlIHVzZXIgaGFzIG5hdmlnYXRlZCBiYWNrKSwgYW5kIHNldCB1cCBldmVudCBoYW5kbGVycyB0byBrZWVwXHJcbiAqIHRoZSByZXZlYWwgaW4gc3luYyB3aXRoIHRoZSByYWRpbyBzdGF0ZS5cclxuICovXHJcblJhZGlvcy5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJG1vZHVsZSA9IHRoaXMuJG1vZHVsZTtcclxuICB2YXIgJGlucHV0cyA9IHRoaXMuJGlucHV0cztcclxuXHJcbiAgbm9kZUxpc3RGb3JFYWNoKCRpbnB1dHMsIGZ1bmN0aW9uICgkaW5wdXQpIHtcclxuICAgIHZhciB0YXJnZXQgPSAkaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLWFyaWEtY29udHJvbHMnKTtcclxuXHJcbiAgICAvLyBTa2lwIHJhZGlvcyB3aXRob3V0IGRhdGEtYXJpYS1jb250cm9scyBhdHRyaWJ1dGVzLCBvciB3aGVyZSB0aGVcclxuICAgIC8vIHRhcmdldCBlbGVtZW50IGRvZXMgbm90IGV4aXN0LlxyXG4gICAgaWYgKCF0YXJnZXQgfHwgIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldCkpIHtcclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gUHJvbW90ZSB0aGUgZGF0YS1hcmlhLWNvbnRyb2xzIGF0dHJpYnV0ZSB0byBhIGFyaWEtY29udHJvbHMgYXR0cmlidXRlXHJcbiAgICAvLyBzbyB0aGF0IHRoZSByZWxhdGlvbnNoaXAgaXMgZXhwb3NlZCBpbiB0aGUgQU9NXHJcbiAgICAkaW5wdXQuc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgdGFyZ2V0KTtcclxuICAgICRpbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtYXJpYS1jb250cm9scycpO1xyXG4gIH0pO1xyXG5cclxuICAvLyBXaGVuIHRoZSBwYWdlIGlzIHJlc3RvcmVkIGFmdGVyIG5hdmlnYXRpbmcgJ2JhY2snIGluIHNvbWUgYnJvd3NlcnMgdGhlXHJcbiAgLy8gc3RhdGUgb2YgZm9ybSBjb250cm9scyBpcyBub3QgcmVzdG9yZWQgdW50aWwgKmFmdGVyKiB0aGUgRE9NQ29udGVudExvYWRlZFxyXG4gIC8vIGV2ZW50IGlzIGZpcmVkLCBzbyB3ZSBuZWVkIHRvIHN5bmMgYWZ0ZXIgdGhlIHBhZ2VzaG93IGV2ZW50IGluIGJyb3dzZXJzXHJcbiAgLy8gdGhhdCBzdXBwb3J0IGl0LlxyXG4gIGlmICgnb25wYWdlc2hvdycgaW4gd2luZG93KSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncGFnZXNob3cnLCB0aGlzLnN5bmNBbGxDb25kaXRpb25hbFJldmVhbHMuYmluZCh0aGlzKSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgdGhpcy5zeW5jQWxsQ29uZGl0aW9uYWxSZXZlYWxzLmJpbmQodGhpcykpO1xyXG4gIH1cclxuXHJcbiAgLy8gQWx0aG91Z2ggd2UndmUgc2V0IHVwIGhhbmRsZXJzIHRvIHN5bmMgc3RhdGUgb24gdGhlIHBhZ2VzaG93IG9yXHJcbiAgLy8gRE9NQ29udGVudExvYWRlZCBldmVudCwgaW5pdCBjb3VsZCBiZSBjYWxsZWQgYWZ0ZXIgdGhvc2UgZXZlbnRzIGhhdmUgZmlyZWQsXHJcbiAgLy8gZm9yIGV4YW1wbGUgaWYgdGhleSBhcmUgYWRkZWQgdG8gdGhlIHBhZ2UgZHluYW1pY2FsbHksIHNvIHN5bmMgbm93IHRvby5cclxuICB0aGlzLnN5bmNBbGxDb25kaXRpb25hbFJldmVhbHMoKTtcclxuXHJcbiAgLy8gSGFuZGxlIGV2ZW50c1xyXG4gICRtb2R1bGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZUNsaWNrLmJpbmQodGhpcykpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFN5bmMgdGhlIGNvbmRpdGlvbmFsIHJldmVhbCBzdGF0ZXMgZm9yIGFsbCBpbnB1dHMgaW4gdGhpcyAkbW9kdWxlLlxyXG4gKi9cclxuUmFkaW9zLnByb3RvdHlwZS5zeW5jQWxsQ29uZGl0aW9uYWxSZXZlYWxzID0gZnVuY3Rpb24gKCkge1xyXG4gIG5vZGVMaXN0Rm9yRWFjaCh0aGlzLiRpbnB1dHMsIHRoaXMuc3luY0NvbmRpdGlvbmFsUmV2ZWFsV2l0aElucHV0U3RhdGUuYmluZCh0aGlzKSk7XHJcbn07XHJcblxyXG4vKipcclxuICogU3luYyBjb25kaXRpb25hbCByZXZlYWwgd2l0aCB0aGUgaW5wdXQgc3RhdGVcclxuICpcclxuICogU3luY2hyb25pc2UgdGhlIHZpc2liaWxpdHkgb2YgdGhlIGNvbmRpdGlvbmFsIHJldmVhbCwgYW5kIGl0cyBhY2Nlc3NpYmxlXHJcbiAqIHN0YXRlLCB3aXRoIHRoZSBpbnB1dCdzIGNoZWNrZWQgc3RhdGUuXHJcbiAqXHJcbiAqIEBwYXJhbSB7SFRNTElucHV0RWxlbWVudH0gJGlucHV0IC0gUmFkaW8gaW5wdXRcclxuICovXHJcblJhZGlvcy5wcm90b3R5cGUuc3luY0NvbmRpdGlvbmFsUmV2ZWFsV2l0aElucHV0U3RhdGUgPSBmdW5jdGlvbiAoJGlucHV0KSB7XHJcbiAgdmFyICR0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgkaW5wdXQuZ2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJykpO1xyXG5cclxuICBpZiAoJHRhcmdldCAmJiAkdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZ292dWstcmFkaW9zX19jb25kaXRpb25hbCcpKSB7XHJcbiAgICB2YXIgaW5wdXRJc0NoZWNrZWQgPSAkaW5wdXQuY2hlY2tlZDtcclxuXHJcbiAgICAkaW5wdXQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgaW5wdXRJc0NoZWNrZWQpO1xyXG4gICAgJHRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdnb3Z1ay1yYWRpb3NfX2NvbmRpdGlvbmFsLS1oaWRkZW4nLCAhaW5wdXRJc0NoZWNrZWQpO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBDbGljayBldmVudCBoYW5kbGVyXHJcbiAqXHJcbiAqIEhhbmRsZSBhIGNsaWNrIHdpdGhpbiB0aGUgJG1vZHVsZSDigJMgaWYgdGhlIGNsaWNrIG9jY3VycmVkIG9uIGEgcmFkaW8sIHN5bmNcclxuICogdGhlIHN0YXRlIG9mIHRoZSBjb25kaXRpb25hbCByZXZlYWwgZm9yIGFsbCByYWRpbyBidXR0b25zIGluIHRoZSBzYW1lIGZvcm1cclxuICogd2l0aCB0aGUgc2FtZSBuYW1lIChiZWNhdXNlIGNoZWNraW5nIG9uZSByYWRpbyBjb3VsZCBoYXZlIHVuLWNoZWNrZWQgYSByYWRpb1xyXG4gKiBpbiBhbm90aGVyICRtb2R1bGUpXHJcbiAqXHJcbiAqIEBwYXJhbSB7TW91c2VFdmVudH0gZXZlbnQgLSBDbGljayBldmVudFxyXG4gKi9cclxuUmFkaW9zLnByb3RvdHlwZS5oYW5kbGVDbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gIHZhciAkY2xpY2tlZElucHV0ID0gZXZlbnQudGFyZ2V0O1xyXG5cclxuICAvLyBJZ25vcmUgY2xpY2tzIG9uIHRoaW5ncyB0aGF0IGFyZW4ndCByYWRpbyBidXR0b25zXHJcbiAgaWYgKCRjbGlja2VkSW5wdXQudHlwZSAhPT0gJ3JhZGlvJykge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICAvLyBXZSBvbmx5IG5lZWQgdG8gY29uc2lkZXIgcmFkaW9zIHdpdGggY29uZGl0aW9uYWwgcmV2ZWFscywgd2hpY2ggd2lsbCBoYXZlXHJcbiAgLy8gYXJpYS1jb250cm9scyBhdHRyaWJ1dGVzLlxyXG4gIHZhciAkYWxsSW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT1cInJhZGlvXCJdW2FyaWEtY29udHJvbHNdJyk7XHJcblxyXG4gIG5vZGVMaXN0Rm9yRWFjaCgkYWxsSW5wdXRzLCBmdW5jdGlvbiAoJGlucHV0KSB7XHJcbiAgICB2YXIgaGFzU2FtZUZvcm1Pd25lciA9ICgkaW5wdXQuZm9ybSA9PT0gJGNsaWNrZWRJbnB1dC5mb3JtKTtcclxuICAgIHZhciBoYXNTYW1lTmFtZSA9ICgkaW5wdXQubmFtZSA9PT0gJGNsaWNrZWRJbnB1dC5uYW1lKTtcclxuXHJcbiAgICBpZiAoaGFzU2FtZU5hbWUgJiYgaGFzU2FtZUZvcm1Pd25lcikge1xyXG4gICAgICB0aGlzLnN5bmNDb25kaXRpb25hbFJldmVhbFdpdGhJbnB1dFN0YXRlKCRpbnB1dCk7XHJcbiAgICB9XHJcbiAgfS5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTa2lwIGxpbmsgY29tcG9uZW50XHJcbiAqXHJcbiAqIEBjbGFzc1xyXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSAkbW9kdWxlIC0gSFRNTCBlbGVtZW50IHRvIHVzZSBmb3Igc2tpcCBsaW5rXHJcbiAqL1xyXG5mdW5jdGlvbiBTa2lwTGluayAoJG1vZHVsZSkge1xyXG4gIHRoaXMuJG1vZHVsZSA9ICRtb2R1bGU7XHJcbiAgdGhpcy4kbGlua2VkRWxlbWVudCA9IG51bGw7XHJcbiAgdGhpcy5saW5rZWRFbGVtZW50TGlzdGVuZXIgPSBmYWxzZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpc2UgdGhlIGNvbXBvbmVudFxyXG4gKi9cclxuU2tpcExpbmsucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgLy8gQ2hlY2sgZm9yIG1vZHVsZVxyXG4gIGlmICghdGhpcy4kbW9kdWxlKSB7XHJcbiAgICByZXR1cm5cclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGZvciBsaW5rZWQgZWxlbWVudFxyXG4gIHRoaXMuJGxpbmtlZEVsZW1lbnQgPSB0aGlzLmdldExpbmtlZEVsZW1lbnQoKTtcclxuICBpZiAoIXRoaXMuJGxpbmtlZEVsZW1lbnQpIHtcclxuICAgIHJldHVyblxyXG4gIH1cclxuXHJcbiAgdGhpcy4kbW9kdWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5mb2N1c0xpbmtlZEVsZW1lbnQuYmluZCh0aGlzKSk7XHJcbn07XHJcblxyXG4vKipcclxuICogR2V0IGxpbmtlZCBlbGVtZW50XHJcbiAqXHJcbiAqIEByZXR1cm5zIHtIVE1MRWxlbWVudH0gJGxpbmtlZEVsZW1lbnQgLSBET00gZWxlbWVudCBsaW5rZWQgdG8gZnJvbSB0aGUgc2tpcCBsaW5rXHJcbiAqL1xyXG5Ta2lwTGluay5wcm90b3R5cGUuZ2V0TGlua2VkRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgbGlua2VkRWxlbWVudElkID0gdGhpcy5nZXRGcmFnbWVudEZyb21VcmwoKTtcclxuXHJcbiAgaWYgKCFsaW5rZWRFbGVtZW50SWQpIHtcclxuICAgIHJldHVybiBmYWxzZVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGxpbmtlZEVsZW1lbnRJZClcclxufTtcclxuXHJcbi8qKlxyXG4gKiBGb2N1cyB0aGUgbGlua2VkIGVsZW1lbnRcclxuICpcclxuICogU2V0IHRhYmluZGV4IGFuZCBoZWxwZXIgQ1NTIGNsYXNzLiBTZXQgbGlzdGVuZXIgdG8gcmVtb3ZlIHRoZW0gb24gYmx1ci5cclxuICovXHJcblNraXBMaW5rLnByb3RvdHlwZS5mb2N1c0xpbmtlZEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyICRsaW5rZWRFbGVtZW50ID0gdGhpcy4kbGlua2VkRWxlbWVudDtcclxuXHJcbiAgaWYgKCEkbGlua2VkRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JykpIHtcclxuICAgIC8vIFNldCB0aGUgZWxlbWVudCB0YWJpbmRleCB0byAtMSBzbyBpdCBjYW4gYmUgZm9jdXNlZCB3aXRoIEphdmFTY3JpcHQuXHJcbiAgICAkbGlua2VkRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XHJcbiAgICAkbGlua2VkRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdnb3Z1ay1za2lwLWxpbmstZm9jdXNlZC1lbGVtZW50Jyk7XHJcblxyXG4gICAgLy8gQWRkIGxpc3RlbmVyIGZvciBibHVyIG9uIHRoZSBmb2N1c2VkIGVsZW1lbnQgKHVubGVzcyB0aGUgbGlzdGVuZXIgaGFzIHByZXZpb3VzbHkgYmVlbiBhZGRlZClcclxuICAgIGlmICghdGhpcy5saW5rZWRFbGVtZW50TGlzdGVuZXIpIHtcclxuICAgICAgdGhpcy4kbGlua2VkRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5yZW1vdmVGb2N1c1Byb3BlcnRpZXMuYmluZCh0aGlzKSk7XHJcbiAgICAgIHRoaXMubGlua2VkRWxlbWVudExpc3RlbmVyID0gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcbiAgJGxpbmtlZEVsZW1lbnQuZm9jdXMoKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBSZW1vdmUgdGhlIHRhYmluZGV4IHRoYXQgbWFrZXMgdGhlIGxpbmtlZCBlbGVtZW50IGZvY3VzYWJsZSBiZWNhdXNlIHRoZSBlbGVtZW50IG9ubHkgbmVlZHMgdG8gYmVcclxuICogZm9jdXNhYmxlIHVudGlsIGl0IGhhcyByZWNlaXZlZCBwcm9ncmFtbWF0aWMgZm9jdXMgYW5kIGEgc2NyZWVuIHJlYWRlciBoYXMgYW5ub3VuY2VkIGl0LlxyXG4gKlxyXG4gKiBSZW1vdmUgdGhlIENTUyBjbGFzcyB0aGF0IHJlbW92ZXMgdGhlIG5hdGl2ZSBmb2N1cyBzdHlsZXMuXHJcbiAqL1xyXG5Ta2lwTGluay5wcm90b3R5cGUucmVtb3ZlRm9jdXNQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xyXG4gIHRoaXMuJGxpbmtlZEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCd0YWJpbmRleCcpO1xyXG4gIHRoaXMuJGxpbmtlZEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZ292dWstc2tpcC1saW5rLWZvY3VzZWQtZWxlbWVudCcpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldCBmcmFnbWVudCBmcm9tIFVSTFxyXG4gKlxyXG4gKiBFeHRyYWN0IHRoZSBmcmFnbWVudCAoZXZlcnl0aGluZyBhZnRlciB0aGUgaGFzaCBzeW1ib2wpIGZyb20gYSBVUkwsIGJ1dCBub3QgaW5jbHVkaW5nXHJcbiAqIHRoZSBzeW1ib2wuXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9IEZyYWdtZW50IGZyb20gVVJMLCB3aXRob3V0IHRoZSBoYXNoIHN5bWJvbFxyXG4gKi9cclxuU2tpcExpbmsucHJvdG90eXBlLmdldEZyYWdtZW50RnJvbVVybCA9IGZ1bmN0aW9uICgpIHtcclxuICAvLyBCYWlsIGlmIHRoZSBhbmNob3IgbGluayBkb2Vzbid0IGhhdmUgYSBoYXNoXHJcbiAgaWYgKCF0aGlzLiRtb2R1bGUuaGFzaCkge1xyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG5cclxuICByZXR1cm4gdGhpcy4kbW9kdWxlLmhhc2guc3BsaXQoJyMnKS5wb3AoKVxyXG59O1xyXG5cclxuKGZ1bmN0aW9uKHVuZGVmaW5lZCkge1xyXG5cclxuICAgIC8vIERldGVjdGlvbiBmcm9tIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtbGlicmFyeS9tYXN0ZXIvcG9seWZpbGxzL0VsZW1lbnQvcHJvdG90eXBlL25leHRFbGVtZW50U2libGluZy9kZXRlY3QuanNcclxuICAgIHZhciBkZXRlY3QgPSAoXHJcbiAgICAgICdkb2N1bWVudCcgaW4gdGhpcyAmJiBcIm5leHRFbGVtZW50U2libGluZ1wiIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudFxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAoZGV0ZWN0KSByZXR1cm5cclxuXHJcbiAgICAvLyBQb2x5ZmlsbCBmcm9tIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtbGlicmFyeS9tYXN0ZXIvcG9seWZpbGxzL0VsZW1lbnQvcHJvdG90eXBlL25leHRFbGVtZW50U2libGluZy9wb2x5ZmlsbC5qc1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVsZW1lbnQucHJvdG90eXBlLCBcIm5leHRFbGVtZW50U2libGluZ1wiLCB7XHJcbiAgICAgIGdldDogZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgZWwgPSB0aGlzLm5leHRTaWJsaW5nO1xyXG4gICAgICAgIHdoaWxlIChlbCAmJiBlbC5ub2RlVHlwZSAhPT0gMSkgeyBlbCA9IGVsLm5leHRTaWJsaW5nOyB9XHJcbiAgICAgICAgcmV0dXJuIGVsO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbn0pLmNhbGwoJ29iamVjdCcgPT09IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93IHx8ICdvYmplY3QnID09PSB0eXBlb2Ygc2VsZiAmJiBzZWxmIHx8ICdvYmplY3QnID09PSB0eXBlb2YgZ2xvYmFsICYmIGdsb2JhbCB8fCB7fSk7XHJcblxyXG4oZnVuY3Rpb24odW5kZWZpbmVkKSB7XHJcblxyXG4gICAgLy8gRGV0ZWN0aW9uIGZyb20gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1saWJyYXJ5L21hc3Rlci9wb2x5ZmlsbHMvRWxlbWVudC9wcm90b3R5cGUvcHJldmlvdXNFbGVtZW50U2libGluZy9kZXRlY3QuanNcclxuICAgIHZhciBkZXRlY3QgPSAoXHJcbiAgICAgICdkb2N1bWVudCcgaW4gdGhpcyAmJiBcInByZXZpb3VzRWxlbWVudFNpYmxpbmdcIiBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnRcclxuICAgICk7XHJcblxyXG4gICAgaWYgKGRldGVjdCkgcmV0dXJuXHJcblxyXG4gICAgLy8gUG9seWZpbGwgZnJvbSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRmluYW5jaWFsLVRpbWVzL3BvbHlmaWxsLWxpYnJhcnkvbWFzdGVyL3BvbHlmaWxscy9FbGVtZW50L3Byb3RvdHlwZS9wcmV2aW91c0VsZW1lbnRTaWJsaW5nL3BvbHlmaWxsLmpzXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRWxlbWVudC5wcm90b3R5cGUsICdwcmV2aW91c0VsZW1lbnRTaWJsaW5nJywge1xyXG4gICAgICBnZXQ6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGVsID0gdGhpcy5wcmV2aW91c1NpYmxpbmc7XHJcbiAgICAgICAgd2hpbGUgKGVsICYmIGVsLm5vZGVUeXBlICE9PSAxKSB7IGVsID0gZWwucHJldmlvdXNTaWJsaW5nOyB9XHJcbiAgICAgICAgcmV0dXJuIGVsO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbn0pLmNhbGwoJ29iamVjdCcgPT09IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93IHx8ICdvYmplY3QnID09PSB0eXBlb2Ygc2VsZiAmJiBzZWxmIHx8ICdvYmplY3QnID09PSB0eXBlb2YgZ2xvYmFsICYmIGdsb2JhbCB8fCB7fSk7XHJcblxyXG4vKipcclxuICogVGFicyBjb21wb25lbnRcclxuICpcclxuICogQGNsYXNzXHJcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9ICRtb2R1bGUgLSBIVE1MIGVsZW1lbnQgdG8gdXNlIGZvciB0YWJzXHJcbiAqL1xyXG5mdW5jdGlvbiBUYWJzICgkbW9kdWxlKSB7XHJcbiAgdGhpcy4kbW9kdWxlID0gJG1vZHVsZTtcclxuICB0aGlzLiR0YWJzID0gJG1vZHVsZS5xdWVyeVNlbGVjdG9yQWxsKCcuZ292dWstdGFic19fdGFiJyk7XHJcblxyXG4gIHRoaXMua2V5cyA9IHsgbGVmdDogMzcsIHJpZ2h0OiAzOSwgdXA6IDM4LCBkb3duOiA0MCB9O1xyXG4gIHRoaXMuanNIaWRkZW5DbGFzcyA9ICdnb3Z1ay10YWJzX19wYW5lbC0taGlkZGVuJztcclxufVxyXG5cclxuVGFicy5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICBpZiAodHlwZW9mIHdpbmRvdy5tYXRjaE1lZGlhID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICB0aGlzLnNldHVwUmVzcG9uc2l2ZUNoZWNrcygpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0aGlzLnNldHVwKCk7XHJcbiAgfVxyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUuc2V0dXBSZXNwb25zaXZlQ2hlY2tzID0gZnVuY3Rpb24gKCkge1xyXG4gIHRoaXMubXFsID0gd2luZG93Lm1hdGNoTWVkaWEoJyhtaW4td2lkdGg6IDQwLjA2MjVlbSknKTtcclxuICB0aGlzLm1xbC5hZGRMaXN0ZW5lcih0aGlzLmNoZWNrTW9kZS5iaW5kKHRoaXMpKTtcclxuICB0aGlzLmNoZWNrTW9kZSgpO1xyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUuY2hlY2tNb2RlID0gZnVuY3Rpb24gKCkge1xyXG4gIGlmICh0aGlzLm1xbC5tYXRjaGVzKSB7XHJcbiAgICB0aGlzLnNldHVwKCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHRoaXMudGVhcmRvd24oKTtcclxuICB9XHJcbn07XHJcblxyXG5UYWJzLnByb3RvdHlwZS5zZXR1cCA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJG1vZHVsZSA9IHRoaXMuJG1vZHVsZTtcclxuICB2YXIgJHRhYnMgPSB0aGlzLiR0YWJzO1xyXG4gIHZhciAkdGFiTGlzdCA9ICRtb2R1bGUucXVlcnlTZWxlY3RvcignLmdvdnVrLXRhYnNfX2xpc3QnKTtcclxuICB2YXIgJHRhYkxpc3RJdGVtcyA9ICRtb2R1bGUucXVlcnlTZWxlY3RvckFsbCgnLmdvdnVrLXRhYnNfX2xpc3QtaXRlbScpO1xyXG5cclxuICBpZiAoISR0YWJzIHx8ICEkdGFiTGlzdCB8fCAhJHRhYkxpc3RJdGVtcykge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICAkdGFiTGlzdC5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAndGFibGlzdCcpO1xyXG5cclxuICBub2RlTGlzdEZvckVhY2goJHRhYkxpc3RJdGVtcywgZnVuY3Rpb24gKCRpdGVtKSB7XHJcbiAgICAkaXRlbS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAncHJlc2VudGF0aW9uJyk7XHJcbiAgfSk7XHJcblxyXG4gIG5vZGVMaXN0Rm9yRWFjaCgkdGFicywgZnVuY3Rpb24gKCR0YWIpIHtcclxuICAgIC8vIFNldCBIVE1MIGF0dHJpYnV0ZXNcclxuICAgIHRoaXMuc2V0QXR0cmlidXRlcygkdGFiKTtcclxuXHJcbiAgICAvLyBTYXZlIGJvdW5kZWQgZnVuY3Rpb25zIHRvIHVzZSB3aGVuIHJlbW92aW5nIGV2ZW50IGxpc3RlbmVycyBkdXJpbmcgdGVhcmRvd25cclxuICAgICR0YWIuYm91bmRUYWJDbGljayA9IHRoaXMub25UYWJDbGljay5iaW5kKHRoaXMpO1xyXG4gICAgJHRhYi5ib3VuZFRhYktleWRvd24gPSB0aGlzLm9uVGFiS2V5ZG93bi5iaW5kKHRoaXMpO1xyXG5cclxuICAgIC8vIEhhbmRsZSBldmVudHNcclxuICAgICR0YWIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAkdGFiLmJvdW5kVGFiQ2xpY2ssIHRydWUpO1xyXG4gICAgJHRhYi5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgJHRhYi5ib3VuZFRhYktleWRvd24sIHRydWUpO1xyXG5cclxuICAgIC8vIFJlbW92ZSBvbGQgYWN0aXZlIHBhbmVsc1xyXG4gICAgdGhpcy5oaWRlVGFiKCR0YWIpO1xyXG4gIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gIC8vIFNob3cgZWl0aGVyIHRoZSBhY3RpdmUgdGFiIGFjY29yZGluZyB0byB0aGUgVVJMJ3MgaGFzaCBvciB0aGUgZmlyc3QgdGFiXHJcbiAgdmFyICRhY3RpdmVUYWIgPSB0aGlzLmdldFRhYih3aW5kb3cubG9jYXRpb24uaGFzaCkgfHwgdGhpcy4kdGFic1swXTtcclxuICB0aGlzLnNob3dUYWIoJGFjdGl2ZVRhYik7XHJcblxyXG4gIC8vIEhhbmRsZSBoYXNoY2hhbmdlIGV2ZW50c1xyXG4gICRtb2R1bGUuYm91bmRPbkhhc2hDaGFuZ2UgPSB0aGlzLm9uSGFzaENoYW5nZS5iaW5kKHRoaXMpO1xyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgJG1vZHVsZS5ib3VuZE9uSGFzaENoYW5nZSwgdHJ1ZSk7XHJcbn07XHJcblxyXG5UYWJzLnByb3RvdHlwZS50ZWFyZG93biA9IGZ1bmN0aW9uICgpIHtcclxuICB2YXIgJG1vZHVsZSA9IHRoaXMuJG1vZHVsZTtcclxuICB2YXIgJHRhYnMgPSB0aGlzLiR0YWJzO1xyXG4gIHZhciAkdGFiTGlzdCA9ICRtb2R1bGUucXVlcnlTZWxlY3RvcignLmdvdnVrLXRhYnNfX2xpc3QnKTtcclxuICB2YXIgJHRhYkxpc3RJdGVtcyA9ICRtb2R1bGUucXVlcnlTZWxlY3RvckFsbCgnLmdvdnVrLXRhYnNfX2xpc3QtaXRlbScpO1xyXG5cclxuICBpZiAoISR0YWJzIHx8ICEkdGFiTGlzdCB8fCAhJHRhYkxpc3RJdGVtcykge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICAkdGFiTGlzdC5yZW1vdmVBdHRyaWJ1dGUoJ3JvbGUnKTtcclxuXHJcbiAgbm9kZUxpc3RGb3JFYWNoKCR0YWJMaXN0SXRlbXMsIGZ1bmN0aW9uICgkaXRlbSkge1xyXG4gICAgJGl0ZW0ucmVtb3ZlQXR0cmlidXRlKCdyb2xlJywgJ3ByZXNlbnRhdGlvbicpO1xyXG4gIH0pO1xyXG5cclxuICBub2RlTGlzdEZvckVhY2goJHRhYnMsIGZ1bmN0aW9uICgkdGFiKSB7XHJcbiAgICAvLyBSZW1vdmUgZXZlbnRzXHJcbiAgICAkdGFiLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgJHRhYi5ib3VuZFRhYkNsaWNrLCB0cnVlKTtcclxuICAgICR0YWIucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsICR0YWIuYm91bmRUYWJLZXlkb3duLCB0cnVlKTtcclxuXHJcbiAgICAvLyBVbnNldCBIVE1MIGF0dHJpYnV0ZXNcclxuICAgIHRoaXMudW5zZXRBdHRyaWJ1dGVzKCR0YWIpO1xyXG4gIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gIC8vIFJlbW92ZSBoYXNoY2hhbmdlIGV2ZW50IGhhbmRsZXJcclxuICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsICRtb2R1bGUuYm91bmRPbkhhc2hDaGFuZ2UsIHRydWUpO1xyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUub25IYXNoQ2hhbmdlID0gZnVuY3Rpb24gKGUpIHtcclxuICB2YXIgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoO1xyXG4gIHZhciAkdGFiV2l0aEhhc2ggPSB0aGlzLmdldFRhYihoYXNoKTtcclxuICBpZiAoISR0YWJXaXRoSGFzaCkge1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICAvLyBQcmV2ZW50IGNoYW5naW5nIHRoZSBoYXNoXHJcbiAgaWYgKHRoaXMuY2hhbmdpbmdIYXNoKSB7XHJcbiAgICB0aGlzLmNoYW5naW5nSGFzaCA9IGZhbHNlO1xyXG4gICAgcmV0dXJuXHJcbiAgfVxyXG5cclxuICAvLyBTaG93IGVpdGhlciB0aGUgYWN0aXZlIHRhYiBhY2NvcmRpbmcgdG8gdGhlIFVSTCdzIGhhc2ggb3IgdGhlIGZpcnN0IHRhYlxyXG4gIHZhciAkcHJldmlvdXNUYWIgPSB0aGlzLmdldEN1cnJlbnRUYWIoKTtcclxuXHJcbiAgdGhpcy5oaWRlVGFiKCRwcmV2aW91c1RhYik7XHJcbiAgdGhpcy5zaG93VGFiKCR0YWJXaXRoSGFzaCk7XHJcbiAgJHRhYldpdGhIYXNoLmZvY3VzKCk7XHJcbn07XHJcblxyXG5UYWJzLnByb3RvdHlwZS5oaWRlVGFiID0gZnVuY3Rpb24gKCR0YWIpIHtcclxuICB0aGlzLnVuaGlnaGxpZ2h0VGFiKCR0YWIpO1xyXG4gIHRoaXMuaGlkZVBhbmVsKCR0YWIpO1xyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUuc2hvd1RhYiA9IGZ1bmN0aW9uICgkdGFiKSB7XHJcbiAgdGhpcy5oaWdobGlnaHRUYWIoJHRhYik7XHJcbiAgdGhpcy5zaG93UGFuZWwoJHRhYik7XHJcbn07XHJcblxyXG5UYWJzLnByb3RvdHlwZS5nZXRUYWIgPSBmdW5jdGlvbiAoaGFzaCkge1xyXG4gIHJldHVybiB0aGlzLiRtb2R1bGUucXVlcnlTZWxlY3RvcignLmdvdnVrLXRhYnNfX3RhYltocmVmPVwiJyArIGhhc2ggKyAnXCJdJylcclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLnNldEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoJHRhYikge1xyXG4gIC8vIHNldCB0YWIgYXR0cmlidXRlc1xyXG4gIHZhciBwYW5lbElkID0gdGhpcy5nZXRIcmVmKCR0YWIpLnNsaWNlKDEpO1xyXG4gICR0YWIuc2V0QXR0cmlidXRlKCdpZCcsICd0YWJfJyArIHBhbmVsSWQpO1xyXG4gICR0YWIuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3RhYicpO1xyXG4gICR0YWIuc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgcGFuZWxJZCk7XHJcbiAgJHRhYi5zZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAnZmFsc2UnKTtcclxuICAkdGFiLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcclxuXHJcbiAgLy8gc2V0IHBhbmVsIGF0dHJpYnV0ZXNcclxuICB2YXIgJHBhbmVsID0gdGhpcy5nZXRQYW5lbCgkdGFiKTtcclxuICAkcGFuZWwuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3RhYnBhbmVsJyk7XHJcbiAgJHBhbmVsLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbGxlZGJ5JywgJHRhYi5pZCk7XHJcbiAgJHBhbmVsLmNsYXNzTGlzdC5hZGQodGhpcy5qc0hpZGRlbkNsYXNzKTtcclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLnVuc2V0QXR0cmlidXRlcyA9IGZ1bmN0aW9uICgkdGFiKSB7XHJcbiAgLy8gdW5zZXQgdGFiIGF0dHJpYnV0ZXNcclxuICAkdGFiLnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTtcclxuICAkdGFiLnJlbW92ZUF0dHJpYnV0ZSgncm9sZScpO1xyXG4gICR0YWIucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJyk7XHJcbiAgJHRhYi5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnKTtcclxuICAkdGFiLnJlbW92ZUF0dHJpYnV0ZSgndGFiaW5kZXgnKTtcclxuXHJcbiAgLy8gdW5zZXQgcGFuZWwgYXR0cmlidXRlc1xyXG4gIHZhciAkcGFuZWwgPSB0aGlzLmdldFBhbmVsKCR0YWIpO1xyXG4gICRwYW5lbC5yZW1vdmVBdHRyaWJ1dGUoJ3JvbGUnKTtcclxuICAkcGFuZWwucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWxhYmVsbGVkYnknKTtcclxuICAkcGFuZWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLmpzSGlkZGVuQ2xhc3MpO1xyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUub25UYWJDbGljayA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgaWYgKCFlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2dvdnVrLXRhYnNfX3RhYicpKSB7XHJcbiAgLy8gQWxsb3cgZXZlbnRzIG9uIGNoaWxkIERPTSBlbGVtZW50cyB0byBidWJibGUgdXAgdG8gdGFiIHBhcmVudFxyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICB2YXIgJG5ld1RhYiA9IGUudGFyZ2V0O1xyXG4gIHZhciAkY3VycmVudFRhYiA9IHRoaXMuZ2V0Q3VycmVudFRhYigpO1xyXG4gIHRoaXMuaGlkZVRhYigkY3VycmVudFRhYik7XHJcbiAgdGhpcy5zaG93VGFiKCRuZXdUYWIpO1xyXG4gIHRoaXMuY3JlYXRlSGlzdG9yeUVudHJ5KCRuZXdUYWIpO1xyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUuY3JlYXRlSGlzdG9yeUVudHJ5ID0gZnVuY3Rpb24gKCR0YWIpIHtcclxuICB2YXIgJHBhbmVsID0gdGhpcy5nZXRQYW5lbCgkdGFiKTtcclxuXHJcbiAgLy8gU2F2ZSBhbmQgcmVzdG9yZSB0aGUgaWRcclxuICAvLyBzbyB0aGUgcGFnZSBkb2Vzbid0IGp1bXAgd2hlbiBhIHVzZXIgY2xpY2tzIGEgdGFiICh3aGljaCBjaGFuZ2VzIHRoZSBoYXNoKVxyXG4gIHZhciBpZCA9ICRwYW5lbC5pZDtcclxuICAkcGFuZWwuaWQgPSAnJztcclxuICB0aGlzLmNoYW5naW5nSGFzaCA9IHRydWU7XHJcbiAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSB0aGlzLmdldEhyZWYoJHRhYikuc2xpY2UoMSk7XHJcbiAgJHBhbmVsLmlkID0gaWQ7XHJcbn07XHJcblxyXG5UYWJzLnByb3RvdHlwZS5vblRhYktleWRvd24gPSBmdW5jdGlvbiAoZSkge1xyXG4gIHN3aXRjaCAoZS5rZXlDb2RlKSB7XHJcbiAgICBjYXNlIHRoaXMua2V5cy5sZWZ0OlxyXG4gICAgY2FzZSB0aGlzLmtleXMudXA6XHJcbiAgICAgIHRoaXMuYWN0aXZhdGVQcmV2aW91c1RhYigpO1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGJyZWFrXHJcbiAgICBjYXNlIHRoaXMua2V5cy5yaWdodDpcclxuICAgIGNhc2UgdGhpcy5rZXlzLmRvd246XHJcbiAgICAgIHRoaXMuYWN0aXZhdGVOZXh0VGFiKCk7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgYnJlYWtcclxuICB9XHJcbn07XHJcblxyXG5UYWJzLnByb3RvdHlwZS5hY3RpdmF0ZU5leHRUYWIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyIGN1cnJlbnRUYWIgPSB0aGlzLmdldEN1cnJlbnRUYWIoKTtcclxuICB2YXIgbmV4dFRhYkxpc3RJdGVtID0gY3VycmVudFRhYi5wYXJlbnROb2RlLm5leHRFbGVtZW50U2libGluZztcclxuICBpZiAobmV4dFRhYkxpc3RJdGVtKSB7XHJcbiAgICB2YXIgbmV4dFRhYiA9IG5leHRUYWJMaXN0SXRlbS5xdWVyeVNlbGVjdG9yKCcuZ292dWstdGFic19fdGFiJyk7XHJcbiAgfVxyXG4gIGlmIChuZXh0VGFiKSB7XHJcbiAgICB0aGlzLmhpZGVUYWIoY3VycmVudFRhYik7XHJcbiAgICB0aGlzLnNob3dUYWIobmV4dFRhYik7XHJcbiAgICBuZXh0VGFiLmZvY3VzKCk7XHJcbiAgICB0aGlzLmNyZWF0ZUhpc3RvcnlFbnRyeShuZXh0VGFiKTtcclxuICB9XHJcbn07XHJcblxyXG5UYWJzLnByb3RvdHlwZS5hY3RpdmF0ZVByZXZpb3VzVGFiID0gZnVuY3Rpb24gKCkge1xyXG4gIHZhciBjdXJyZW50VGFiID0gdGhpcy5nZXRDdXJyZW50VGFiKCk7XHJcbiAgdmFyIHByZXZpb3VzVGFiTGlzdEl0ZW0gPSBjdXJyZW50VGFiLnBhcmVudE5vZGUucHJldmlvdXNFbGVtZW50U2libGluZztcclxuICBpZiAocHJldmlvdXNUYWJMaXN0SXRlbSkge1xyXG4gICAgdmFyIHByZXZpb3VzVGFiID0gcHJldmlvdXNUYWJMaXN0SXRlbS5xdWVyeVNlbGVjdG9yKCcuZ292dWstdGFic19fdGFiJyk7XHJcbiAgfVxyXG4gIGlmIChwcmV2aW91c1RhYikge1xyXG4gICAgdGhpcy5oaWRlVGFiKGN1cnJlbnRUYWIpO1xyXG4gICAgdGhpcy5zaG93VGFiKHByZXZpb3VzVGFiKTtcclxuICAgIHByZXZpb3VzVGFiLmZvY3VzKCk7XHJcbiAgICB0aGlzLmNyZWF0ZUhpc3RvcnlFbnRyeShwcmV2aW91c1RhYik7XHJcbiAgfVxyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUuZ2V0UGFuZWwgPSBmdW5jdGlvbiAoJHRhYikge1xyXG4gIHZhciAkcGFuZWwgPSB0aGlzLiRtb2R1bGUucXVlcnlTZWxlY3Rvcih0aGlzLmdldEhyZWYoJHRhYikpO1xyXG4gIHJldHVybiAkcGFuZWxcclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLnNob3dQYW5lbCA9IGZ1bmN0aW9uICgkdGFiKSB7XHJcbiAgdmFyICRwYW5lbCA9IHRoaXMuZ2V0UGFuZWwoJHRhYik7XHJcbiAgJHBhbmVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5qc0hpZGRlbkNsYXNzKTtcclxufTtcclxuXHJcblRhYnMucHJvdG90eXBlLmhpZGVQYW5lbCA9IGZ1bmN0aW9uICh0YWIpIHtcclxuICB2YXIgJHBhbmVsID0gdGhpcy5nZXRQYW5lbCh0YWIpO1xyXG4gICRwYW5lbC5jbGFzc0xpc3QuYWRkKHRoaXMuanNIaWRkZW5DbGFzcyk7XHJcbn07XHJcblxyXG5UYWJzLnByb3RvdHlwZS51bmhpZ2hsaWdodFRhYiA9IGZ1bmN0aW9uICgkdGFiKSB7XHJcbiAgJHRhYi5zZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnLCAnZmFsc2UnKTtcclxuICAkdGFiLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnZ292dWstdGFic19fbGlzdC1pdGVtLS1zZWxlY3RlZCcpO1xyXG4gICR0YWIuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUuaGlnaGxpZ2h0VGFiID0gZnVuY3Rpb24gKCR0YWIpIHtcclxuICAkdGFiLnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICd0cnVlJyk7XHJcbiAgJHRhYi5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2dvdnVrLXRhYnNfX2xpc3QtaXRlbS0tc2VsZWN0ZWQnKTtcclxuICAkdGFiLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnMCcpO1xyXG59O1xyXG5cclxuVGFicy5wcm90b3R5cGUuZ2V0Q3VycmVudFRhYiA9IGZ1bmN0aW9uICgpIHtcclxuICByZXR1cm4gdGhpcy4kbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoJy5nb3Z1ay10YWJzX19saXN0LWl0ZW0tLXNlbGVjdGVkIC5nb3Z1ay10YWJzX190YWInKVxyXG59O1xyXG5cclxuLy8gdGhpcyBpcyBiZWNhdXNlIElFIGRvZXNuJ3QgYWx3YXlzIHJldHVybiB0aGUgYWN0dWFsIHZhbHVlIGJ1dCBhIHJlbGF0aXZlIGZ1bGwgcGF0aFxyXG4vLyBzaG91bGQgYmUgYSB1dGlsaXR5IGZ1bmN0aW9uIG1vc3QgcHJvYlxyXG4vLyBodHRwOi8vbGFicy50aGVzZWRheXMuY29tL2Jsb2cvMjAxMC8wMS8wOC9nZXR0aW5nLXRoZS1ocmVmLXZhbHVlLXdpdGgtanF1ZXJ5LWluLWllL1xyXG5UYWJzLnByb3RvdHlwZS5nZXRIcmVmID0gZnVuY3Rpb24gKCR0YWIpIHtcclxuICB2YXIgaHJlZiA9ICR0YWIuZ2V0QXR0cmlidXRlKCdocmVmJyk7XHJcbiAgdmFyIGhhc2ggPSBocmVmLnNsaWNlKGhyZWYuaW5kZXhPZignIycpLCBocmVmLmxlbmd0aCk7XHJcbiAgcmV0dXJuIGhhc2hcclxufTtcclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXNlIGFsbCBjb21wb25lbnRzXHJcbiAqXHJcbiAqIFVzZSB0aGUgYGRhdGEtbW9kdWxlYCBhdHRyaWJ1dGVzIHRvIGZpbmQsIGluc3RhbnRpYXRlIGFuZCBpbml0IGFsbCBvZiB0aGVcclxuICogY29tcG9uZW50cyBwcm92aWRlZCBhcyBwYXJ0IG9mIEdPVi5VSyBGcm9udGVuZC5cclxuICpcclxuICogQHBhcmFtIHtDb25maWd9IFtjb25maWddIC0gQ29uZmlnIGZvciBhbGwgY29tcG9uZW50c1xyXG4gKi9cclxuZnVuY3Rpb24gaW5pdEFsbCAoY29uZmlnKSB7XHJcbiAgY29uZmlnID0gdHlwZW9mIGNvbmZpZyAhPT0gJ3VuZGVmaW5lZCcgPyBjb25maWcgOiB7fTtcclxuXHJcbiAgLy8gQWxsb3cgdGhlIHVzZXIgdG8gaW5pdGlhbGlzZSBHT1YuVUsgRnJvbnRlbmQgaW4gb25seSBjZXJ0YWluIHNlY3Rpb25zIG9mIHRoZSBwYWdlXHJcbiAgLy8gRGVmYXVsdHMgdG8gdGhlIGVudGlyZSBkb2N1bWVudCBpZiBub3RoaW5nIGlzIHNldC5cclxuICB2YXIgJHNjb3BlID0gdHlwZW9mIGNvbmZpZy5zY29wZSAhPT0gJ3VuZGVmaW5lZCcgPyBjb25maWcuc2NvcGUgOiBkb2N1bWVudDtcclxuXHJcbiAgdmFyICRhY2NvcmRpb25zID0gJHNjb3BlLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1vZHVsZT1cImdvdnVrLWFjY29yZGlvblwiXScpO1xyXG4gIG5vZGVMaXN0Rm9yRWFjaCgkYWNjb3JkaW9ucywgZnVuY3Rpb24gKCRhY2NvcmRpb24pIHtcclxuICAgIG5ldyBBY2NvcmRpb24oJGFjY29yZGlvbiwgY29uZmlnLmFjY29yZGlvbikuaW5pdCgpO1xyXG4gIH0pO1xyXG5cclxuICB2YXIgJGJ1dHRvbnMgPSAkc2NvcGUucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtbW9kdWxlPVwiZ292dWstYnV0dG9uXCJdJyk7XHJcbiAgbm9kZUxpc3RGb3JFYWNoKCRidXR0b25zLCBmdW5jdGlvbiAoJGJ1dHRvbikge1xyXG4gICAgbmV3IEJ1dHRvbigkYnV0dG9uLCBjb25maWcuYnV0dG9uKS5pbml0KCk7XHJcbiAgfSk7XHJcblxyXG4gIHZhciAkY2hhcmFjdGVyQ291bnRzID0gJHNjb3BlLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1vZHVsZT1cImdvdnVrLWNoYXJhY3Rlci1jb3VudFwiXScpO1xyXG4gIG5vZGVMaXN0Rm9yRWFjaCgkY2hhcmFjdGVyQ291bnRzLCBmdW5jdGlvbiAoJGNoYXJhY3RlckNvdW50KSB7XHJcbiAgICBuZXcgQ2hhcmFjdGVyQ291bnQoJGNoYXJhY3RlckNvdW50LCBjb25maWcuY2hhcmFjdGVyQ291bnQpLmluaXQoKTtcclxuICB9KTtcclxuXHJcbiAgdmFyICRjaGVja2JveGVzID0gJHNjb3BlLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLW1vZHVsZT1cImdvdnVrLWNoZWNrYm94ZXNcIl0nKTtcclxuICBub2RlTGlzdEZvckVhY2goJGNoZWNrYm94ZXMsIGZ1bmN0aW9uICgkY2hlY2tib3gpIHtcclxuICAgIG5ldyBDaGVja2JveGVzKCRjaGVja2JveCkuaW5pdCgpO1xyXG4gIH0pO1xyXG5cclxuICB2YXIgJGRldGFpbHMgPSAkc2NvcGUucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtbW9kdWxlPVwiZ292dWstZGV0YWlsc1wiXScpO1xyXG4gIG5vZGVMaXN0Rm9yRWFjaCgkZGV0YWlscywgZnVuY3Rpb24gKCRkZXRhaWwpIHtcclxuICAgIG5ldyBEZXRhaWxzKCRkZXRhaWwpLmluaXQoKTtcclxuICB9KTtcclxuXHJcbiAgLy8gRmluZCBmaXJzdCBlcnJvciBzdW1tYXJ5IG1vZHVsZSB0byBlbmhhbmNlLlxyXG4gIHZhciAkZXJyb3JTdW1tYXJ5ID0gJHNjb3BlLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLW1vZHVsZT1cImdvdnVrLWVycm9yLXN1bW1hcnlcIl0nKTtcclxuICBpZiAoJGVycm9yU3VtbWFyeSkge1xyXG4gICAgbmV3IEVycm9yU3VtbWFyeSgkZXJyb3JTdW1tYXJ5LCBjb25maWcuZXJyb3JTdW1tYXJ5KS5pbml0KCk7XHJcbiAgfVxyXG5cclxuICAvLyBGaW5kIGZpcnN0IGhlYWRlciBtb2R1bGUgdG8gZW5oYW5jZS5cclxuICB2YXIgJGhlYWRlciA9ICRzY29wZS5xdWVyeVNlbGVjdG9yKCdbZGF0YS1tb2R1bGU9XCJnb3Z1ay1oZWFkZXJcIl0nKTtcclxuICBpZiAoJGhlYWRlcikge1xyXG4gICAgbmV3IEhlYWRlcigkaGVhZGVyKS5pbml0KCk7XHJcbiAgfVxyXG5cclxuICB2YXIgJG5vdGlmaWNhdGlvbkJhbm5lcnMgPSAkc2NvcGUucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtbW9kdWxlPVwiZ292dWstbm90aWZpY2F0aW9uLWJhbm5lclwiXScpO1xyXG4gIG5vZGVMaXN0Rm9yRWFjaCgkbm90aWZpY2F0aW9uQmFubmVycywgZnVuY3Rpb24gKCRub3RpZmljYXRpb25CYW5uZXIpIHtcclxuICAgIG5ldyBOb3RpZmljYXRpb25CYW5uZXIoJG5vdGlmaWNhdGlvbkJhbm5lciwgY29uZmlnLm5vdGlmaWNhdGlvbkJhbm5lcikuaW5pdCgpO1xyXG4gIH0pO1xyXG5cclxuICB2YXIgJHJhZGlvcyA9ICRzY29wZS5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1tb2R1bGU9XCJnb3Z1ay1yYWRpb3NcIl0nKTtcclxuICBub2RlTGlzdEZvckVhY2goJHJhZGlvcywgZnVuY3Rpb24gKCRyYWRpbykge1xyXG4gICAgbmV3IFJhZGlvcygkcmFkaW8pLmluaXQoKTtcclxuICB9KTtcclxuXHJcbiAgLy8gRmluZCBmaXJzdCBza2lwIGxpbmsgbW9kdWxlIHRvIGVuaGFuY2UuXHJcbiAgdmFyICRza2lwTGluayA9ICRzY29wZS5xdWVyeVNlbGVjdG9yKCdbZGF0YS1tb2R1bGU9XCJnb3Z1ay1za2lwLWxpbmtcIl0nKTtcclxuICBuZXcgU2tpcExpbmsoJHNraXBMaW5rKS5pbml0KCk7XHJcblxyXG4gIHZhciAkdGFicyA9ICRzY29wZS5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1tb2R1bGU9XCJnb3Z1ay10YWJzXCJdJyk7XHJcbiAgbm9kZUxpc3RGb3JFYWNoKCR0YWJzLCBmdW5jdGlvbiAoJHRhYnMpIHtcclxuICAgIG5ldyBUYWJzKCR0YWJzKS5pbml0KCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb25maWcgZm9yIGFsbCBjb21wb25lbnRzXHJcbiAqXHJcbiAqIEB0eXBlZGVmIHtvYmplY3R9IENvbmZpZ1xyXG4gKiBAcHJvcGVydHkge0hUTUxFbGVtZW50fSBbc2NvcGU9ZG9jdW1lbnRdIC0gU2NvcGUgdG8gcXVlcnkgZm9yIGNvbXBvbmVudHNcclxuICogQHByb3BlcnR5IHtpbXBvcnQoJy4vY29tcG9uZW50cy9hY2NvcmRpb24vYWNjb3JkaW9uLm1qcycpLkFjY29yZGlvbkNvbmZpZ30gW2FjY29yZGlvbl0gLSBBY2NvcmRpb24gY29uZmlnXHJcbiAqIEBwcm9wZXJ0eSB7aW1wb3J0KCcuL2NvbXBvbmVudHMvYnV0dG9uL2J1dHRvbi5tanMnKS5CdXR0b25Db25maWd9IFtidXR0b25dIC0gQnV0dG9uIGNvbmZpZ1xyXG4gKiBAcHJvcGVydHkge2ltcG9ydCgnLi9jb21wb25lbnRzL2NoYXJhY3Rlci1jb3VudC9jaGFyYWN0ZXItY291bnQubWpzJykuQ2hhcmFjdGVyQ291bnRDb25maWd9IFtjaGFyYWN0ZXJDb3VudF0gLSBDaGFyYWN0ZXIgQ291bnQgY29uZmlnXHJcbiAqIEBwcm9wZXJ0eSB7aW1wb3J0KCcuL2NvbXBvbmVudHMvZXJyb3Itc3VtbWFyeS9lcnJvci1zdW1tYXJ5Lm1qcycpLkVycm9yU3VtbWFyeUNvbmZpZ30gW2Vycm9yU3VtbWFyeV0gLSBFcnJvciBTdW1tYXJ5IGNvbmZpZ1xyXG4gKiBAcHJvcGVydHkge2ltcG9ydCgnLi9jb21wb25lbnRzL25vdGlmaWNhdGlvbi1iYW5uZXIvbm90aWZpY2F0aW9uLWJhbm5lci5tanMnKS5Ob3RpZmljYXRpb25CYW5uZXJDb25maWd9IFtub3RpZmljYXRpb25CYW5uZXJdIC0gTm90aWZpY2F0aW9uIEJhbm5lciBjb25maWdcclxuICovXHJcblxyXG5leHBvcnRzLmluaXRBbGwgPSBpbml0QWxsO1xyXG5leHBvcnRzLkFjY29yZGlvbiA9IEFjY29yZGlvbjtcclxuZXhwb3J0cy5CdXR0b24gPSBCdXR0b247XHJcbmV4cG9ydHMuRGV0YWlscyA9IERldGFpbHM7XHJcbmV4cG9ydHMuQ2hhcmFjdGVyQ291bnQgPSBDaGFyYWN0ZXJDb3VudDtcclxuZXhwb3J0cy5DaGVja2JveGVzID0gQ2hlY2tib3hlcztcclxuZXhwb3J0cy5FcnJvclN1bW1hcnkgPSBFcnJvclN1bW1hcnk7XHJcbmV4cG9ydHMuSGVhZGVyID0gSGVhZGVyO1xyXG5leHBvcnRzLk5vdGlmaWNhdGlvbkJhbm5lciA9IE5vdGlmaWNhdGlvbkJhbm5lcjtcclxuZXhwb3J0cy5SYWRpb3MgPSBSYWRpb3M7XHJcbmV4cG9ydHMuU2tpcExpbmsgPSBTa2lwTGluaztcclxuZXhwb3J0cy5UYWJzID0gVGFicztcclxuXHJcbn0pKSk7XHJcbiIsIi8vIGpzIGNvbXBvbmVudHMgaGF2ZSBiZWVuIHNuYWZmbGVkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2FscGhhZ292L2dvdnVrLWRlc2lnbi1zeXN0ZW0vYmxvYi9tYWluL3NyYy9qYXZhc2NyaXB0cy9jb21wb25lbnRzL1xuaW1wb3J0IENvb2tpZUJhbm5lciBmcm9tICcuL2NvbXBvbmVudHMvY29va2llLWJhbm5lci5qcyc7XG5pbXBvcnQgeyBnZXRDb25zZW50Q29va2llLCBpc1ZhbGlkQ29uc2VudENvb2tpZSB9IGZyb20gJy4vY29tcG9uZW50cy9jb29raWUtZnVuY3Rpb25zLmpzJztcbmltcG9ydCBBbmFseXRpY3MgZnJvbSAnLi9jb21wb25lbnRzL2FuYWx5dGljcy5qcyc7XG5pbXBvcnQgQ29va2llc1BhZ2UgZnJvbSAnLi9jb21wb25lbnRzL2Nvb2tpZXMtcGFnZS5qcyc7XG4vLyBJbml0aWFsaXNlIGNvb2tpZSBiYW5uZXJcbnZhciAkY29va2llQmFubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtbW9kdWxlPVwiZ292dWstY29va2llLWJhbm5lclwiXScpO1xubmV3IENvb2tpZUJhbm5lcigkY29va2llQmFubmVyKS5pbml0KCk7XG4vLyBJbml0aWFsaXNlIGFuYWx5dGljcyBpZiBjb25zZW50IGlzIGdpdmVuXG52YXIgdXNlckNvbnNlbnQgPSBnZXRDb25zZW50Q29va2llKCk7XG5pZiAodXNlckNvbnNlbnQgJiYgaXNWYWxpZENvbnNlbnRDb29raWUodXNlckNvbnNlbnQpICYmIHVzZXJDb25zZW50LmFuYWx5dGljcykge1xuICAgIEFuYWx5dGljcygpO1xufVxuLy90b2RvOiBtb3ZlIHRoaXMgaW50byBzY3JpcHRzIHNlY3Rpb24gb24gY29va2llIHBhZ2Vcbi8vIEluaXRpYWxpc2UgY29va2llIHBhZ2VcbnZhciAkY29va2llc1BhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1tb2R1bGU9XCJhcHAtY29va2llcy1wYWdlXCJdJyk7XG5uZXcgQ29va2llc1BhZ2UoJGNvb2tpZXNQYWdlKS5pbml0KCk7XG5jb25zdCBiYWNrTGlua3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmFwcC1iYWNrLWxpbmtcIik7XG5iYWNrTGlua3MuZm9yRWFjaCgobGluaykgPT4ge1xuICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgd2luZG93Lmhpc3RvcnkuYmFjaygpO1xuICAgIH0pO1xufSk7XG5jb25zdCBidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3Blbi1jbG9zZS1maWx0ZXJzJyk7XG5idXR0b24gPT09IG51bGwgfHwgYnV0dG9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiBoYW5kbGVDbGljayhldmVudCkge1xuICAgIC8vdG9kbzogdXBkYXRlIHRvIHRzIDI/XG4gICAgY29uc3QgZmlsdGVyQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmaWx0ZXJzXCIpO1xuICAgIGlmIChmaWx0ZXJCdXR0b24uc3R5bGUuZGlzcGxheSA9PT0gXCJub25lXCIpIHtcbiAgICAgICAgZmlsdGVyQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmaWx0ZXJCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIH1cbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGY4O2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKemIzVnlZMlZ6SWpwYkltRndjQzUwY3lKZExDSnVZVzFsY3lJNlcxMHNJbTFoY0hCcGJtZHpJam9pUVVGQlFTdzRTRUZCT0VnN1FVRlJPVWdzVDBGQlR5eFpRVUZaTEUxQlFVMHNLMEpCUVN0Q0xFTkJRVUU3UVVGRGVFUXNUMEZCVHl4RlFVRkZMR2RDUVVGblFpeEZRVUZGTEc5Q1FVRnZRaXhGUVVGRkxFMUJRVTBzYTBOQlFXdERMRU5CUVVFN1FVRkRla1lzVDBGQlR5eFRRVUZUTEUxQlFVMHNNa0pCUVRKQ0xFTkJRVUU3UVVGRGFrUXNUMEZCVHl4WFFVRlhMRTFCUVUwc09FSkJRVGhDTEVOQlFVRTdRVUZGZEVRc01rSkJRVEpDTzBGQlF6TkNMRWxCUVVrc1lVRkJZU3hIUVVGSExGRkJRVkVzUTBGQlF5eGhRVUZoTEVOQlFVTXNjVU5CUVhGRExFTkJRVU1zUTBGQlFUdEJRVU5xUml4SlFVRkpMRmxCUVZrc1EwRkJReXhoUVVGaExFTkJRVU1zUTBGQlF5eEpRVUZKTEVWQlFVVXNRMEZCUVR0QlFVVjBReXd5UTBGQk1rTTdRVUZETTBNc1NVRkJTU3hYUVVGWExFZEJRVWNzWjBKQlFXZENMRVZCUVVVc1EwRkJRVHRCUVVOd1F5eEpRVUZKTEZkQlFWY3NTVUZCU1N4dlFrRkJiMElzUTBGQlF5eFhRVUZYTEVOQlFVTXNTVUZCU1N4WFFVRlhMRU5CUVVNc1UwRkJVeXhGUVVGRk8wbEJRek5GTEZOQlFWTXNSVUZCUlN4RFFVRkJPME5CUTJRN1FVRkZSQ3h4UkVGQmNVUTdRVUZEY2tRc2VVSkJRWGxDTzBGQlEzcENMRWxCUVVrc1dVRkJXU3hIUVVGSExGRkJRVkVzUTBGQlF5eGhRVUZoTEVOQlFVTXNhME5CUVd0RExFTkJRVU1zUTBGQlFUdEJRVU0zUlN4SlFVRkpMRmRCUVZjc1EwRkJReXhaUVVGWkxFTkJRVU1zUTBGQlF5eEpRVUZKTEVWQlFVVXNRMEZCUVR0QlFVVndReXhOUVVGTkxGTkJRVk1zUjBGQlJ5eFJRVUZSTEVOQlFVTXNaMEpCUVdkQ0xFTkJRVU1zWjBKQlFXZENMRU5CUVVNc1EwRkJRenRCUVVNNVJDeFRRVUZUTEVOQlFVTXNUMEZCVHl4RFFVRkRMRU5CUVVNc1NVRkJkVUlzUlVGQlJTeEZRVUZGTzBsQlF6RkRMRWxCUVVrc1EwRkJReXhuUWtGQlowSXNRMEZCUXl4UFFVRlBMRVZCUVVVc1IwRkJSeXhGUVVGRk8xRkJRMmhETEUxQlFVMHNRMEZCUXl4UFFVRlBMRU5CUVVNc1NVRkJTU3hGUVVGRkxFTkJRVU03U1VGRE1VSXNRMEZCUXl4RFFVRkRMRU5CUVVNN1FVRkRVQ3hEUVVGRExFTkJRVU1zUTBGQlF6dEJRVVZJTEUxQlFVMHNUVUZCVFN4SFFVRkhMRkZCUVZFc1EwRkJReXhqUVVGakxFTkJRVU1zYjBKQlFXOUNMRU5CUVVNc1EwRkJRenRCUVVNM1JDeE5RVUZOTEdGQlFVNHNUVUZCVFN4MVFrRkJUaXhOUVVGTkxFTkJRVVVzWjBKQlFXZENMRU5CUVVNc1QwRkJUeXhGUVVGRkxGTkJRVk1zVjBGQlZ5eERRVUZETEV0QlFVczdTVUZEZUVRc2RVSkJRWFZDTzBsQlEzWkNMRTFCUVUwc1dVRkJXU3hIUVVGSExGRkJRVkVzUTBGQlF5eGpRVUZqTEVOQlFVTXNVMEZCVXl4RFFVRXdRaXhEUVVGRE8wbEJRMnBHTEVsQlFVa3NXVUZCV1N4RFFVRkRMRXRCUVVzc1EwRkJReXhQUVVGUExFdEJRVXNzVFVGQlRTeEZRVUZGTzFGQlEzWkRMRmxCUVZrc1EwRkJReXhMUVVGTExFTkJRVU1zVDBGQlR5eEhRVUZITEU5QlFVOHNRMEZCUXp0TFFVTjRRenRUUVVGTk8xRkJRMGdzV1VGQldTeERRVUZETEV0QlFVc3NRMEZCUXl4UFFVRlBMRWRCUVVjc1RVRkJUU3hEUVVGRE8wdEJRM1pETzBGQlEwd3NRMEZCUXl4RFFVRkRMRU5CUVVNaUxDSm1hV3hsSWpvaVlYQndMbXB6SWl3aWMyOTFjbU5sYzBOdmJuUmxiblFpT2xzaUx5OGdhbk1nWTI5dGNHOXVaVzUwY3lCb1lYWmxJR0psWlc0Z2MyNWhabVpzWldRZ1puSnZiU0JvZEhSd2N6b3ZMMmRwZEdoMVlpNWpiMjB2WVd4d2FHRm5iM1l2WjI5MmRXc3RaR1Z6YVdkdUxYTjVjM1JsYlM5aWJHOWlMMjFoYVc0dmMzSmpMMnBoZG1GelkzSnBjSFJ6TDJOdmJYQnZibVZ1ZEhNdlhISmNibHh5WEc1a1pXTnNZWEpsSUdkc2IySmhiQ0I3WEhKY2JpQWdJQ0JwYm5SbGNtWmhZMlVnVjJsdVpHOTNJSHRjY2x4dUlDQWdJQ0FnSUNCSFJGTmZRMDlPVTBWT1ZGOURUMDlMU1VWZlZrVlNVMGxQVGpvZ1lXNTVPMXh5WEc0Z0lDQWdmVnh5WEc1OVhISmNibHh5WEc1cGJYQnZjblFnUTI5dmEybGxRbUZ1Ym1WeUlHWnliMjBnSnk0dlkyOXRjRzl1Wlc1MGN5OWpiMjlyYVdVdFltRnVibVZ5TG1wekoxeHlYRzVwYlhCdmNuUWdleUJuWlhSRGIyNXpaVzUwUTI5dmEybGxMQ0JwYzFaaGJHbGtRMjl1YzJWdWRFTnZiMnRwWlNCOUlHWnliMjBnSnk0dlkyOXRjRzl1Wlc1MGN5OWpiMjlyYVdVdFpuVnVZM1JwYjI1ekxtcHpKMXh5WEc1cGJYQnZjblFnUVc1aGJIbDBhV056SUdaeWIyMGdKeTR2WTI5dGNHOXVaVzUwY3k5aGJtRnNlWFJwWTNNdWFuTW5YSEpjYm1sdGNHOXlkQ0JEYjI5cmFXVnpVR0ZuWlNCbWNtOXRJQ2N1TDJOdmJYQnZibVZ1ZEhNdlkyOXZhMmxsY3kxd1lXZGxMbXB6SjF4eVhHNWNjbHh1THk4Z1NXNXBkR2xoYkdselpTQmpiMjlyYVdVZ1ltRnVibVZ5WEhKY2JuWmhjaUFrWTI5dmEybGxRbUZ1Ym1WeUlEMGdaRzlqZFcxbGJuUXVjWFZsY25sVFpXeGxZM1J2Y2lnblcyUmhkR0V0Ylc5a2RXeGxQVndpWjI5MmRXc3RZMjl2YTJsbExXSmhibTVsY2x3aVhTY3BYSEpjYm01bGR5QkRiMjlyYVdWQ1lXNXVaWElvSkdOdmIydHBaVUpoYm01bGNpa3VhVzVwZENncFhISmNibHh5WEc0dkx5QkpibWwwYVdGc2FYTmxJR0Z1WVd4NWRHbGpjeUJwWmlCamIyNXpaVzUwSUdseklHZHBkbVZ1WEhKY2JuWmhjaUIxYzJWeVEyOXVjMlZ1ZENBOUlHZGxkRU52Ym5ObGJuUkRiMjlyYVdVb0tWeHlYRzVwWmlBb2RYTmxja052Ym5ObGJuUWdKaVlnYVhOV1lXeHBaRU52Ym5ObGJuUkRiMjlyYVdVb2RYTmxja052Ym5ObGJuUXBJQ1ltSUhWelpYSkRiMjV6Wlc1MExtRnVZV3g1ZEdsamN5a2dlMXh5WEc0Z0lDQWdRVzVoYkhsMGFXTnpLQ2xjY2x4dWZWeHlYRzVjY2x4dUx5OTBiMlJ2T2lCdGIzWmxJSFJvYVhNZ2FXNTBieUJ6WTNKcGNIUnpJSE5sWTNScGIyNGdiMjRnWTI5dmEybGxJSEJoWjJWY2NseHVMeThnU1c1cGRHbGhiR2x6WlNCamIyOXJhV1VnY0dGblpWeHlYRzUyWVhJZ0pHTnZiMnRwWlhOUVlXZGxJRDBnWkc5amRXMWxiblF1Y1hWbGNubFRaV3hsWTNSdmNpZ25XMlJoZEdFdGJXOWtkV3hsUFZ3aVlYQndMV052YjJ0cFpYTXRjR0ZuWlZ3aVhTY3BYSEpjYm01bGR5QkRiMjlyYVdWelVHRm5aU2drWTI5dmEybGxjMUJoWjJVcExtbHVhWFFvS1Z4eVhHNWNjbHh1WTI5dWMzUWdZbUZqYTB4cGJtdHpJRDBnWkc5amRXMWxiblF1Y1hWbGNubFRaV3hsWTNSdmNrRnNiQ2hjSWk1aGNIQXRZbUZqYXkxc2FXNXJYQ0lwTzF4eVhHNWlZV05yVEdsdWEzTXVabTl5UldGamFDZ29iR2x1YXpvZ1NGUk5URUZ1WTJodmNrVnNaVzFsYm5RcElEMCtJSHRjY2x4dUlDQWdJR3hwYm1zdVlXUmtSWFpsYm5STWFYTjBaVzVsY2loY0ltTnNhV05yWENJc0lDZ3BJRDArSUh0Y2NseHVJQ0FnSUNBZ0lDQjNhVzVrYjNjdWFHbHpkRzl5ZVM1aVlXTnJLQ2s3WEhKY2JpQWdJQ0I5S1R0Y2NseHVmU2s3WEhKY2JseHlYRzVqYjI1emRDQmlkWFIwYjI0Z1BTQmtiMk4xYldWdWRDNW5aWFJGYkdWdFpXNTBRbmxKWkNnbmIzQmxiaTFqYkc5elpTMW1hV3gwWlhKekp5azdYSEpjYm1KMWRIUnZiajh1WVdSa1JYWmxiblJNYVhOMFpXNWxjaWduWTJ4cFkyc25MQ0JtZFc1amRHbHZiaUJvWVc1a2JHVkRiR2xqYXlobGRtVnVkQ2tnZTF4eVhHNGdJQ0FnTHk5MGIyUnZPaUIxY0dSaGRHVWdkRzhnZEhNZ01qOWNjbHh1SUNBZ0lHTnZibk4wSUdacGJIUmxja0oxZEhSdmJpQTlJR1J2WTNWdFpXNTBMbWRsZEVWc1pXMWxiblJDZVVsa0tGd2labWxzZEdWeWMxd2lLU0JoY3lCSVZFMU1SR2wyUld4bGJXVnVkQ0I4SUc1MWJHdzdYSEpjYmlBZ0lDQnBaaUFvWm1sc2RHVnlRblYwZEc5dUxuTjBlV3hsTG1ScGMzQnNZWGtnUFQwOUlGd2libTl1WlZ3aUtTQjdYSEpjYmlBZ0lDQWdJQ0FnWm1sc2RHVnlRblYwZEc5dUxuTjBlV3hsTG1ScGMzQnNZWGtnUFNCY0ltSnNiMk5yWENJN1hISmNiaUFnSUNCOUlHVnNjMlVnZTF4eVhHNGdJQ0FnSUNBZ0lHWnBiSFJsY2tKMWRIUnZiaTV6ZEhsc1pTNWthWE53YkdGNUlEMGdYQ0p1YjI1bFhDSTdYSEpjYmlBZ0lDQjlYSEpjYm4wcE8xeHlYRzRpWFgwPVxuIl19\r\n"]}